/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={149:(e,t,r)=>{var n=r(276);r(9504),r(1696),r(1267),r(1598),r(7619);var i=e.exports=n.ssh=n.ssh||{};function s(e,t){var r=t.toString(16);r[0]>="8"&&(r="00"+r);var i=n.util.hexToBytes(r);e.putInt32(i.length),e.putBytes(i)}function a(e,t){e.putInt32(t.length),e.putString(t)}function o(){for(var e=n.md.sha1.create(),t=arguments.length,r=0;r<t;++r)e.update(arguments[r]);return e.digest()}i.privateKeyToPutty=function(e,t,r){var i="ssh-rsa",c=""===(t=t||"")?"none":"aes256-cbc",u="PuTTY-User-Key-File-2: "+i+"\r\n";u+="Encryption: "+c+"\r\n",u+="Comment: "+(r=r||"")+"\r\n";var l=n.util.createBuffer();a(l,i),s(l,e.e),s(l,e.n);var h=n.util.encode64(l.bytes(),64),f=Math.floor(h.length/66)+1;u+="Public-Lines: "+f+"\r\n",u+=h;var p,y=n.util.createBuffer();if(s(y,e.d),s(y,e.p),s(y,e.q),s(y,e.qInv),t){var d=y.length()+16-1;d-=d%16;var g=o(y.bytes());g.truncate(g.length()-d+y.length()),y.putBuffer(g);var m=n.util.createBuffer();m.putBuffer(o("\0\0\0\0",t)),m.putBuffer(o("\0\0\0",t));var v=n.aes.createEncryptionCipher(m.truncate(8),"CBC");v.start(n.util.createBuffer().fillWithByte(0,16)),v.update(y.copy()),v.finish();var A=v.output;A.truncate(16),p=n.util.encode64(A.bytes(),64)}else p=n.util.encode64(y.bytes(),64);u+="\r\nPrivate-Lines: "+(f=Math.floor(p.length/66)+1)+"\r\n",u+=p;var b=o("putty-private-key-file-mac-key",t),w=n.util.createBuffer();a(w,i),a(w,c),a(w,r),w.putInt32(l.length()),w.putBuffer(l),w.putInt32(y.length()),w.putBuffer(y);var E=n.hmac.create();return E.start("sha1",b),E.update(w.bytes()),u+"\r\nPrivate-MAC: "+E.digest().toHex()+"\r\n"},i.publicKeyToOpenSSH=function(e,t){var r="ssh-rsa";t=t||"";var i=n.util.createBuffer();return a(i,r),s(i,e.e),s(i,e.n),r+" "+n.util.encode64(i.bytes())+" "+t},i.privateKeyToOpenSSH=function(e,t){return t?n.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):n.pki.privateKeyToPem(e)},i.getPublicKeyFingerprint=function(e,t){var r=(t=t||{}).md||n.md.md5.create(),i=n.util.createBuffer();a(i,"ssh-rsa"),s(i,e.e),s(i,e.n),r.start(),r.update(i.getBytes());var o=r.digest();if("hex"===t.encoding){var c=o.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return o.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return o}},152:(e,t,r)=>{"use strict";var n=r(8287).hp;class i{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=i.toUint8Array(e),n=i.toUint8Array(t);if(r.length!==n.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(const e of t)r+=e.byteLength;const n=new Uint8Array(r);let i=0;for(const e of t){const t=this.toUint8Array(e);n.set(t,i),i+=t.length}return e[e.length-1]instanceof Function?this.toView(n,e[e.length-1]):n.buffer}}const s="string",a=/^[0-9a-f\s]+$/i,o=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,c=/^[a-zA-Z0-9-_]+$/;class u{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=i.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class l{static toString(e,t=!1){const r=i.toArrayBuffer(e),n=new DataView(r);let s="";for(let e=0;e<r.byteLength;e+=2){const r=n.getUint16(e,t);s+=String.fromCharCode(r)}return s}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),n=new DataView(r);for(let r=0;r<e.length;r++)n.setUint16(2*r,e.charCodeAt(r),t);return r}}class h{static isHex(e){return typeof e===s&&a.test(e)}static isBase64(e){return typeof e===s&&o.test(e)}static isBase64Url(e){return typeof e===s&&c.test(e)}static ToString(e,t="utf8"){const r=i.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return l.toString(r,!0);case"utf16":case"utf16be":return l.toString(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return l.fromString(e,!0);case"utf16":case"utf16be":return l.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=i.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return n.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!h.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(n.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!h.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=h.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return u.fromString(e);case"utf16":case"utf16be":return l.fromString(e);case"utf16le":case"usc2":return l.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=h.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return u.toString(e);case"utf16":case"utf16be":return l.toString(e);case"utf16le":case"usc2":return l.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=i.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){const t=i.toUint8Array(e);let r="";const n=t.length;for(let e=0;e<n;e++){const n=t[e];n<16&&(r+="0"),r+=n.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!h.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const n=t.slice(e,e+2);r[e/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(e,t=!1){return l.toString(e,t)}static FromUtf16String(e,t=!1){return l.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}h.DEFAULT_UTF8_ENCODING="utf8",t._H=i,t.U$=h,t.kg=function(...e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),r=new Uint8Array(t);let n=0;return e.map((e=>new Uint8Array(e))).forEach((e=>{for(const t of e)r[n++]=t})),r.buffer},t.n4=function(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}},172:(e,t,r)=>{var n=r(276);r(8106),r(7619);var i=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=i,i.create=function(){a||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,s=0;s<r;++s)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(s,a){"utf8"===a&&(s=n.util.encodeUtf8(s));var o=s.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u)i.fullMessageLength[u]+=o[1],o[1]=o[0]+(i.fullMessageLength[u]/4294967296>>>0),i.fullMessageLength[u]=i.fullMessageLength[u]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(s),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var a=n.util.createBuffer();a.putBytes(t.bytes());var o,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;a.putBytes(s.substr(0,i.blockLength-u));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(o=8*i.fullMessageLength[h+1])/4294967296>>>0,a.putInt32(l>>>0),l=o>>>0;a.putInt32(l);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(f,r,a);var p=n.util.createBuffer();return p.putInt32(f.h0),p.putInt32(f.h1),p.putInt32(f.h2),p.putInt32(f.h3),p.putInt32(f.h4),p.putInt32(f.h5),p.putInt32(f.h6),p.putInt32(f.h7),p},i};var s=null,a=!1,o=null;function c(e,t,r){for(var n,i,s,a,c,u,l,h,f,p,y,d,g,m=r.length();m>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=((n=t[c-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=((i=t[c-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=n+t[c-7]+i+t[c-16]|0;for(u=e.h0,l=e.h1,h=e.h2,f=e.h3,p=e.h4,y=e.h5,d=e.h6,g=e.h7,c=0;c<64;++c)s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),a=u&l|h&(u^l),n=g+((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(d^p&(y^d))+o[c]+t[c],g=d,d=y,y=p,p=f+n>>>0,f=h,h=l,l=u,u=n+(i=s+a)>>>0;e.h0=e.h0+u|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+f|0,e.h4=e.h4+p|0,e.h5=e.h5+y|0,e.h6=e.h6+d|0,e.h7=e.h7+g|0,m-=64}}},251:(e,t)=>{t.read=function(e,t,r,n,i){var s,a,o=8*i-n-1,c=(1<<o)-1,u=c>>1,l=-7,h=r?i-1:0,f=r?-1:1,p=e[t+h];for(h+=f,s=p&(1<<-l)-1,p>>=-l,l+=o;l>0;s=256*s+e[t+h],h+=f,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=n;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===s)s=1-u;else{if(s===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),s-=u}return(p?-1:1)*a*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var a,o,c,u=8*s-i-1,l=(1<<u)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,y=n?1:-1,d=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(a++,c/=2),a+h>=l?(o=0,a=l):a+h>=1?(o=(t*c-1)*Math.pow(2,i),a+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&o,p+=y,o/=256,i-=8);for(a=a<<i|o,u+=i;u>0;e[r+p]=255&a,p+=y,a/=256,u-=8);e[r+p-y]|=128*d}},268:(e,t,r)=>{var n=r(276);r(7619),r(3736),r(9356),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],s=new r(null);s.fromInt(30);var a=function(e,t){return e|t};t.generateProbablePrime=function(e,t,i){"function"==typeof t&&(i=t,t={});var s=(t=t||{}).algorithm||"PRIMEINC";"string"==typeof s&&(s={name:s}),s.options=s.options||{};var a=t.prng||n.random,c={nextBytes:function(e){for(var t=a.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===s.name)return function(e,t,i,s){return"workers"in i?function(e,t,i,s){if("undefined"==typeof Worker)return o(e,t,i,s);var a=u(e,t),c=i.workers,l=i.workLoad||100,h=30*l/8,f=i.workerScript||"forge/prime.worker.js";if(-1===c)return n.util.estimateCores((function(e,t){e&&(t=2),c=t-1,p()}));function p(){c=Math.max(1,c);for(var n=[],i=0;i<c;++i)n[i]=new Worker(f);for(i=0;i<c;++i)n[i].addEventListener("message",p);var o=!1;function p(i){if(!o){var c=i.data;if(c.found){for(var f=0;f<n.length;++f)n[f].terminate();return o=!0,s(null,new r(c.prime,16))}a.bitLength()>e&&(a=u(e,t));var p=a.toString(16);i.target.postMessage({hex:p,workLoad:l}),a.dAddOffset(h,0)}}}p()}(e,t,i,s):o(e,t,i,s)}(e,c,s.options,i);throw new Error("Invalid prime generation algorithm: "+s.name)}}function o(e,t,r,n){var i=u(e,t),s=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(i.bitLength());"millerRabinTests"in r&&(s=r.millerRabinTests);var a=10;"maxBlockTime"in r&&(a=r.maxBlockTime),c(i,e,t,0,s,a,n)}function c(e,t,r,s,a,o,l){var h=+new Date;do{if(e.bitLength()>t&&(e=u(t,r)),e.isProbablePrime(a))return l(null,e);e.dAddOffset(i[s++%8],0)}while(o<0||+new Date-h<o);n.util.setImmediate((function(){c(e,t,r,s,a,o,l)}))}function u(e,t){var n=new r(e,t),i=e-1;return n.testBit(i)||n.bitwiseTo(r.ONE.shiftLeft(i),a,n),n.dAddOffset(31-n.mod(s).byteValue(),0),n}}()},276:e=>{e.exports={options:{usePureJavaScript:!1}}},310:()=>{},688:(e,t,r)=>{r(1263)},761:(e,t,r)=>{const n=r(2096);t.b=class{constructor(e=n(0),t=n(0),r=n(0)){this.x=e,this.y=t,this.z=r}isAtInfinity(){return 0==this.y}}},1066:()=>{},1237:(e,t,r)=>{t.Signature=r(3765).Signature,t.PublicKey=r(7439).PublicKey,r(9181),t.Ecdsa=r(3687),r(688)},1263:(e,t,r)=>{r(1066)},1267:(e,t,r)=>{var n=r(276);r(8106),r(7619);var i=e.exports=n.md5=n.md5||{};n.md.md5=n.md.algorithms.md5=i,i.create=function(){u||function(){s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],o=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],c=new Array(64);for(var e=0;e<64;++e)c[e]=Math.floor(4294967296*Math.abs(Math.sin(e+1)));u=!0}();var e=null,t=n.util.createBuffer(),r=new Array(16),i={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,s=0;s<r;++s)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},i}};return i.start(),i.update=function(s,a){"utf8"===a&&(s=n.util.encodeUtf8(s));var o=s.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=o[1],o[1]=o[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(s),l(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var a=n.util.createBuffer();a.putBytes(t.bytes());var o=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;a.putBytes(s.substr(0,i.blockLength-o));for(var c,u=0,h=i.fullMessageLength.length-1;h>=0;--h)u=(c=8*i.fullMessageLength[h]+u)/4294967296>>>0,a.putInt32Le(c>>>0);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};l(f,r,a);var p=n.util.createBuffer();return p.putInt32Le(f.h0),p.putInt32Le(f.h1),p.putInt32Le(f.h2),p.putInt32Le(f.h3),p},i};var s=null,a=null,o=null,c=null,u=!1;function l(e,t,r){for(var n,i,s,u,l,h,f,p=r.length();p>=64;){for(i=e.h0,s=e.h1,u=e.h2,l=e.h3,f=0;f<16;++f)t[f]=r.getInt32Le(),n=i+(l^s&(u^l))+c[f]+t[f],i=l,l=u,u=s,s+=n<<(h=o[f])|n>>>32-h;for(;f<32;++f)n=i+(u^l&(s^u))+c[f]+t[a[f]],i=l,l=u,u=s,s+=n<<(h=o[f])|n>>>32-h;for(;f<48;++f)n=i+(s^u^l)+c[f]+t[a[f]],i=l,l=u,u=s,s+=n<<(h=o[f])|n>>>32-h;for(;f<64;++f)n=i+(u^(s|~l))+c[f]+t[a[f]],i=l,l=u,u=s,s+=n<<(h=o[f])|n>>>32-h;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+u|0,e.h3=e.h3+l|0,p-=64}}},1312:(module,exports,__webpack_require__)=>{var process=__webpack_require__(5606),__WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=__webpack_require__.g:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,AMD=__webpack_require__.amdO,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(r){return new Sha256(t,!0).update(r)[e]()}},createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var r=0;r<OUTPUT_TYPES.length;++r){var n=OUTPUT_TYPES[r];t[n]=createOutputMethod(n,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(e,t){return function(r,n){return new HmacSha256(r,t,!0).update(n)[e]()}},createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<OUTPUT_TYPES.length;++r){var n=OUTPUT_TYPES[r];t[n]=createHmacOutputMethod(n,e)}return t};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,r){var n,i=typeof e;if("string"===i){var s,a=[],o=e.length,c=0;for(n=0;n<o;++n)(s=e.charCodeAt(n))<128?a[c++]=s:s<2048?(a[c++]=192|s>>6,a[c++]=128|63&s):s<55296||s>=57344?(a[c++]=224|s>>12,a[c++]=128|s>>6&63,a[c++]=128|63&s):(s=65536+((1023&s)<<10|1023&e.charCodeAt(++n)),a[c++]=240|s>>18,a[c++]=128|s>>12&63,a[c++]=128|s>>6&63,a[c++]=128|63&s);e=a}else{if("object"!==i)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var u=[],l=[];for(n=0;n<64;++n){var h=e[n]||0;u[n]=92^h,l[n]=54^h}Sha256.call(this,t,r),this.update(l),this.oKeyPad=u,this.inner=!0,this.sharedMemory=r}Sha256.prototype.update=function(e){if(!this.finalized){var t,r=typeof e;if("string"!==r){if("object"!==r)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var n,i,s=0,a=e.length,o=this.blocks;s<a;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),t)for(i=this.start;s<a&&i<64;++s)o[i>>2]|=e[s]<<SHIFT[3&i++];else for(i=this.start;s<a&&i<64;++s)(n=e.charCodeAt(s))<128?o[i>>2]|=n<<SHIFT[3&i++]:n<2048?(o[i>>2]|=(192|n>>6)<<SHIFT[3&i++],o[i>>2]|=(128|63&n)<<SHIFT[3&i++]):n<55296||n>=57344?(o[i>>2]|=(224|n>>12)<<SHIFT[3&i++],o[i>>2]|=(128|n>>6&63)<<SHIFT[3&i++],o[i>>2]|=(128|63&n)<<SHIFT[3&i++]):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++s)),o[i>>2]|=(240|n>>18)<<SHIFT[3&i++],o[i>>2]|=(128|n>>12&63)<<SHIFT[3&i++],o[i>>2]|=(128|n>>6&63)<<SHIFT[3&i++],o[i>>2]|=(128|63&n)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=o[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,r,n,i,s,a,o,c,u=this.h0,l=this.h1,h=this.h2,f=this.h3,p=this.h4,y=this.h5,d=this.h6,g=this.h7,m=this.blocks;for(e=16;e<64;++e)t=((i=m[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,r=((i=m[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,m[e]=m[e-16]+t+m[e-7]+r|0;for(c=l&h,e=0;e<64;e+=4)this.first?(this.is224?(s=300032,g=(i=m[0]-1413257819)-150054599|0,f=i+24177077|0):(s=704751109,g=(i=m[0]-210244248)-1521486534|0,f=i+143694565|0),this.first=!1):(t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(s=u&l)^u&h^c,g=f+(i=g+(r=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&y^~p&d)+K[e]+m[e])|0,f=i+(t+n)|0),t=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),n=(a=f&u)^f&l^s,d=h+(i=d+(r=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&p^~g&y)+K[e+1]+m[e+1])|0,t=((h=i+(t+n)|0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),n=(o=h&f)^h&u^a,y=l+(i=y+(r=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&g^~d&p)+K[e+2]+m[e+2])|0,t=((l=i+(t+n)|0)>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),n=(c=l&h)^l&f^o,p=u+(i=p+(r=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7))+(y&d^~y&g)+K[e+3]+m[e+3])|0,u=i+(t+n)|0;this.h0=this.h0+u|0,this.h1=this.h1+l|0,this.h2=this.h2+h|0,this.h3=this.h3+f|0,this.h4=this.h4+p|0,this.h5=this.h5+y|0,this.h6=this.h6+d|0,this.h7=this.h7+g|0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,s=this.h5,a=this.h6,o=this.h7,c=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(c+=HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]),c},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,s=this.h5,a=this.h6,o=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n,i>>24&255,i>>16&255,i>>8&255,255&i,s>>24&255,s>>16&255,s>>8&255,255&s,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||c.push(o>>24&255,o>>16&255,o>>8&255,255&o),c},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))})()},1355:(e,t,r)=>{e.exports=r(8106),r(1267),r(1598),r(172),r(2313)},1373:(e,t,r)=>{var n=r(276);r(5250),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},1417:(e,t,r)=>{var n=r(276);r(9356),r(7619),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,i=e.mgf,s=r.digestLength,a=e.salt||null;if("string"==typeof a&&(a=n.util.createBuffer(a)),"saltLength"in e)t=e.saltLength;else{if(null===a)throw new Error("Salt length not specified or specific salt not given.");t=a.length()}if(null!==a&&a.length()!==t)throw new Error("Given salt length does not match length of given salt.");var o=e.prng||n.random;return{encode:function(e,c){var u,l,h=c-1,f=Math.ceil(h/8),p=e.digest().getBytes();if(f<s+t+2)throw new Error("Message is too long to encrypt.");l=null===a?o.getBytesSync(t):a.bytes();var y=new n.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(p),y.putBytes(l),r.start(),r.update(y.getBytes());var d=r.digest().getBytes(),g=new n.util.ByteBuffer;g.fillWithByte(0,f-t-s-2),g.putByte(1),g.putBytes(l);var m=g.getBytes(),v=f-s-1,A=i.generate(d,v),b="";for(u=0;u<v;u++)b+=String.fromCharCode(m.charCodeAt(u)^A.charCodeAt(u));var w=65280>>8*f-h&255;return(b=String.fromCharCode(b.charCodeAt(0)&~w)+b.substr(1))+d+String.fromCharCode(188)},verify:function(e,a,o){var c,u=o-1,l=Math.ceil(u/8);if(a=a.substr(-l),l<s+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==a.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var h=l-s-1,f=a.substr(0,h),p=a.substr(h,s),y=65280>>8*l-u&255;if(0!==(f.charCodeAt(0)&y))throw new Error("Bits beyond keysize not zero as expected.");var d=i.generate(p,h),g="";for(c=0;c<h;c++)g+=String.fromCharCode(f.charCodeAt(c)^d.charCodeAt(c));g=String.fromCharCode(g.charCodeAt(0)&~y)+g.substr(1);var m=l-s-t-2;for(c=0;c<m;c++)if(0!==g.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(m))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var v=g.substr(-t),A=new n.util.ByteBuffer;return A.fillWithByte(0,8),A.putBytes(e),A.putBytes(v),r.start(),r.update(A.getBytes()),p===r.digest().getBytes()}}}},1598:(e,t,r)=>{var n=r(276);r(8106),r(7619);var i=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=i,i.create=function(){a||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),a=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,s=0;s<r;++s)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(s,a){"utf8"===a&&(s=n.util.encodeUtf8(s));var c=s.length;i.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u)i.fullMessageLength[u]+=c[1],c[1]=c[0]+(i.fullMessageLength[u]/4294967296>>>0),i.fullMessageLength[u]=i.fullMessageLength[u]>>>0,c[0]=c[1]/4294967296>>>0;return t.putBytes(s),o(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var a=n.util.createBuffer();a.putBytes(t.bytes());var c,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;a.putBytes(s.substr(0,i.blockLength-u));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(c=8*i.fullMessageLength[h+1])/4294967296>>>0,a.putInt32(l>>>0),l=c>>>0;a.putInt32(l);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};o(f,r,a);var p=n.util.createBuffer();return p.putInt32(f.h0),p.putInt32(f.h1),p.putInt32(f.h2),p.putInt32(f.h3),p.putInt32(f.h4),p},i};var s=null,a=!1;function o(e,t,r){for(var n,i,s,a,o,c,u,l=r.length();l>=64;){for(i=e.h0,s=e.h1,a=e.h2,o=e.h3,c=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,n=(i<<5|i>>>27)+(o^s&(a^o))+c+1518500249+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=(n=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|n>>>31,t[u]=n,n=(i<<5|i>>>27)+(o^s&(a^o))+c+1518500249+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=(n=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|n>>>31,t[u]=n,n=(i<<5|i>>>27)+(s^a^o)+c+1859775393+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(s^a^o)+c+1859775393+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(s&a|o&(s^a))+c+2400959708+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(s^a^o)+c+3395469782+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+a|0,e.h3=e.h3+o|0,e.h4=e.h4+c|0,l-=64}}},1696:(e,t,r)=>{var n=r(276);r(8106),r(7619),(e.exports=n.hmac=n.hmac||{}).create=function(){var e=null,t=null,r=null,i=null,s={start:function(s,a){if(null!==s)if("string"==typeof s){if(!((s=s.toLowerCase())in n.md.algorithms))throw new Error('Unknown hash algorithm "'+s+'"');t=n.md.algorithms[s].create()}else t=s;if(null===a)a=e;else{if("string"==typeof a)a=n.util.createBuffer(a);else if(n.util.isArray(a)){var o=a;a=n.util.createBuffer();for(var c=0;c<o.length;++c)a.putByte(o[c])}var u=a.length();for(u>t.blockLength&&(t.start(),t.update(a.bytes()),a=t.digest()),r=n.util.createBuffer(),i=n.util.createBuffer(),u=a.length(),c=0;c<u;++c)o=a.at(c),r.putByte(54^o),i.putByte(92^o);if(u<t.blockLength)for(o=t.blockLength-u,c=0;c<o;++c)r.putByte(54),i.putByte(92);e=a,r=r.bytes(),i=i.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(i),t.update(e),t.digest()}};return s.digest=s.getMac,s}},2045:(e,t,r)=>{var n=r(276);r(7619),e.exports=n.log=n.log||{},n.log.levels=["none","error","warning","info","debug","verbose","max"];var i={},s=[],a=null;n.log.LEVEL_LOCKED=2,n.log.NO_LEVEL_CHECK=4,n.log.INTERPOLATE=8;for(var o=0;o<n.log.levels.length;++o){var c=n.log.levels[o];i[c]={index:o,name:c.toUpperCase()}}n.log.logMessage=function(e){for(var t=i[e.level].index,r=0;r<s.length;++r){var a=s[r];a.flags&n.log.NO_LEVEL_CHECK?a.f(e):t<=i[a.level].index&&a.f(a,e)}},n.log.prepareStandard=function(e){"standard"in e||(e.standard=i[e.level].name+" ["+e.category+"] "+e.message)},n.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]||0),e.full=n.util.format.apply(this,t)}},n.log.prepareStandardFull=function(e){"standardFull"in e||(n.log.prepareStandard(e),e.standardFull=e.standard)};var u=["error","warning","info","debug","verbose"];for(o=0;o<u.length;++o)!function(e){n.log[e]=function(t,r){var i=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:e,category:t,message:r,arguments:i};n.log.logMessage(s)}}(u[o]);if(n.log.makeLogger=function(e){var t={flags:0,f:e};return n.log.setLevel(t,"none"),t},n.log.setLevel=function(e,t){var r=!1;if(e&&!(e.flags&n.log.LEVEL_LOCKED))for(var i=0;i<n.log.levels.length;++i)if(t==n.log.levels[i]){e.level=t,r=!0;break}return r},n.log.lock=function(e,t){void 0===t||t?e.flags|=n.log.LEVEL_LOCKED:e.flags&=~n.log.LEVEL_LOCKED},n.log.addLogger=function(e){s.push(e)},"undefined"!=typeof console&&"log"in console){var l;if(console.error&&console.warn&&console.info&&console.debug){var h={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},f=function(e,t){n.log.prepareStandard(t);var r=h[t.level],i=[t.standard];i=i.concat(t.arguments.slice()),r.apply(console,i)};l=n.log.makeLogger(f)}else f=function(e,t){n.log.prepareStandardFull(t),console.log(t.standardFull)},l=n.log.makeLogger(f);n.log.setLevel(l,"debug"),n.log.addLogger(l),a=l}else console={log:function(){}};if(null!==a&&"undefined"!=typeof window&&window.location){var p=new URL(window.location.href).searchParams;p.has("console.level")&&n.log.setLevel(a,p.get("console.level").slice(-1)[0]),p.has("console.lock")&&"true"==p.get("console.lock").slice(-1)[0]&&n.log.lock(a)}n.log.consoleLogger=a},2096:(e,t,r)=>{var n;e=r.nmd(e);var i=function(e){"use strict";var t=1e7,r=9007199254740992,n=f(r),s="0123456789abcdefghijklmnopqrstuvwxyz",a="function"==typeof BigInt;function o(e,t,r,n){return void 0===e?o[0]:void 0===t||10===+t&&!r?W(e):Q(e,t,r,n)}function c(e,t){this.value=e,this.sign=t,this.isSmall=!1}function u(e){this.value=e,this.sign=e<0,this.isSmall=!0}function l(e){this.value=e}function h(e){return-r<e&&e<r}function f(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function p(e){y(e);var r=e.length;if(r<4&&U(e,n)<0)switch(r){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*t;default:return e[0]+(e[1]+e[2]*t)*t}return e}function y(e){for(var t=e.length;0===e[--t];);e.length=t+1}function d(e){for(var t=new Array(e),r=-1;++r<e;)t[r]=0;return t}function g(e){return e>0?Math.floor(e):Math.ceil(e)}function m(e,r){var n,i,s=e.length,a=r.length,o=new Array(s),c=0,u=t;for(i=0;i<a;i++)c=(n=e[i]+r[i]+c)>=u?1:0,o[i]=n-c*u;for(;i<s;)c=(n=e[i]+c)===u?1:0,o[i++]=n-c*u;return c>0&&o.push(c),o}function v(e,t){return e.length>=t.length?m(e,t):m(t,e)}function A(e,r){var n,i,s=e.length,a=new Array(s),o=t;for(i=0;i<s;i++)n=e[i]-o+r,r=Math.floor(n/o),a[i]=n-r*o,r+=1;for(;r>0;)a[i++]=r%o,r=Math.floor(r/o);return a}function b(e,r){var n,i,s=e.length,a=r.length,o=new Array(s),c=0,u=t;for(n=0;n<a;n++)(i=e[n]-c-r[n])<0?(i+=u,c=1):c=0,o[n]=i;for(n=a;n<s;n++){if(!((i=e[n]-c)<0)){o[n++]=i;break}i+=u,o[n]=i}for(;n<s;n++)o[n]=e[n];return y(o),o}function w(e,r,n){var i,s,a=e.length,o=new Array(a),l=-r,h=t;for(i=0;i<a;i++)s=e[i]+l,l=Math.floor(s/h),s%=h,o[i]=s<0?s+h:s;return"number"==typeof(o=p(o))?(n&&(o=-o),new u(o)):new c(o,n)}function E(e,r){var n,i,s,a,o=e.length,c=r.length,u=d(o+c),l=t;for(s=0;s<o;++s){a=e[s];for(var h=0;h<c;++h)n=a*r[h]+u[s+h],i=Math.floor(n/l),u[s+h]=n-i*l,u[s+h+1]+=i}return y(u),u}function S(e,r){var n,i,s=e.length,a=new Array(s),o=t,c=0;for(i=0;i<s;i++)n=e[i]*r+c,c=Math.floor(n/o),a[i]=n-c*o;for(;c>0;)a[i++]=c%o,c=Math.floor(c/o);return a}function C(e,t){for(var r=[];t-- >0;)r.push(0);return r.concat(e)}function B(e,t){var r=Math.max(e.length,t.length);if(r<=30)return E(e,t);r=Math.ceil(r/2);var n=e.slice(r),i=e.slice(0,r),s=t.slice(r),a=t.slice(0,r),o=B(i,a),c=B(n,s),u=B(v(i,n),v(a,s)),l=v(v(o,C(b(b(u,o),c),r)),C(c,2*r));return y(l),l}function I(e,r,n){return new c(e<t?S(r,e):E(r,f(e)),n)}function k(e){var r,n,i,s,a=e.length,o=d(a+a),c=t;for(i=0;i<a;i++){n=0-(s=e[i])*s;for(var u=i;u<a;u++)r=s*e[u]*2+o[i+u]+n,n=Math.floor(r/c),o[i+u]=r-n*c;o[i+a]=n}return y(o),o}function T(e,r){var n,i,s,a,o=e.length,c=d(o),u=t;for(s=0,n=o-1;n>=0;--n)s=(a=s*u+e[n])-(i=g(a/r))*r,c[n]=0|i;return[c,0|s]}function N(e,r){var n,i=W(r);if(a)return[new l(e.value/i.value),new l(e.value%i.value)];var s,h=e.value,m=i.value;if(0===m)throw new Error("Cannot divide by zero");if(e.isSmall)return i.isSmall?[new u(g(h/m)),new u(h%m)]:[o[0],e];if(i.isSmall){if(1===m)return[e,o[0]];if(-1==m)return[e.negate(),o[0]];var v=Math.abs(m);if(v<t){s=p((n=T(h,v))[0]);var A=n[1];return e.sign&&(A=-A),"number"==typeof s?(e.sign!==i.sign&&(s=-s),[new u(s),new u(A)]):[new c(s,e.sign!==i.sign),new u(A)]}m=f(v)}var w=U(h,m);if(-1===w)return[o[0],e];if(0===w)return[o[e.sign===i.sign?1:-1],o[0]];n=h.length+m.length<=200?function(e,r){var n,i,s,a,o,c,u,l=e.length,h=r.length,f=t,y=d(r.length),g=r[h-1],m=Math.ceil(f/(2*g)),v=S(e,m),A=S(r,m);for(v.length<=l&&v.push(0),A.push(0),g=A[h-1],i=l-h;i>=0;i--){for(n=f-1,v[i+h]!==g&&(n=Math.floor((v[i+h]*f+v[i+h-1])/g)),s=0,a=0,c=A.length,o=0;o<c;o++)s+=n*A[o],u=Math.floor(s/f),a+=v[i+o]-(s-u*f),s=u,a<0?(v[i+o]=a+f,a=-1):(v[i+o]=a,a=0);for(;0!==a;){for(n-=1,s=0,o=0;o<c;o++)(s+=v[i+o]-f+A[o])<0?(v[i+o]=s+f,s=0):(v[i+o]=s,s=1);a+=s}y[i]=n}return v=T(v,m)[0],[p(y),p(v)]}(h,m):function(e,r){for(var n,i,s,a,o,c=e.length,u=r.length,l=[],h=[],f=t;c;)if(h.unshift(e[--c]),y(h),U(h,r)<0)l.push(0);else{s=h[(i=h.length)-1]*f+h[i-2],a=r[u-1]*f+r[u-2],i>u&&(s=(s+1)*f),n=Math.ceil(s/a);do{if(U(o=S(r,n),h)<=0)break;n--}while(n);l.push(n),h=b(h,o)}return l.reverse(),[p(l),p(h)]}(h,m),s=n[0];var E=e.sign!==i.sign,C=n[1],B=e.sign;return"number"==typeof s?(E&&(s=-s),s=new u(s)):s=new c(s,E),"number"==typeof C?(B&&(C=-C),C=new u(C)):C=new c(C,B),[s,C]}function U(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var r=e.length-1;r>=0;r--)if(e[r]!==t[r])return e[r]>t[r]?1:-1;return 0}function x(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function D(e,t){for(var r,n,s,a=e.prev(),o=a,c=0;o.isEven();)o=o.divide(2),c++;e:for(n=0;n<t.length;n++)if(!e.lesser(t[n])&&!(s=i(t[n]).modPow(o,e)).isUnit()&&!s.equals(a)){for(r=c-1;0!=r;r--){if((s=s.square().mod(e)).isUnit())return!1;if(s.equals(a))continue e}return!1}return!0}c.prototype=Object.create(o.prototype),u.prototype=Object.create(o.prototype),l.prototype=Object.create(o.prototype),c.prototype.add=function(e){var t=W(e);if(this.sign!==t.sign)return this.subtract(t.negate());var r=this.value,n=t.value;return t.isSmall?new c(A(r,Math.abs(n)),this.sign):new c(v(r,n),this.sign)},c.prototype.plus=c.prototype.add,u.prototype.add=function(e){var t=W(e),r=this.value;if(r<0!==t.sign)return this.subtract(t.negate());var n=t.value;if(t.isSmall){if(h(r+n))return new u(r+n);n=f(Math.abs(n))}return new c(A(n,Math.abs(r)),r<0)},u.prototype.plus=u.prototype.add,l.prototype.add=function(e){return new l(this.value+W(e).value)},l.prototype.plus=l.prototype.add,c.prototype.subtract=function(e){var t=W(e);if(this.sign!==t.sign)return this.add(t.negate());var r=this.value,n=t.value;return t.isSmall?w(r,Math.abs(n),this.sign):function(e,t,r){var n;return U(e,t)>=0?n=b(e,t):(n=b(t,e),r=!r),"number"==typeof(n=p(n))?(r&&(n=-n),new u(n)):new c(n,r)}(r,n,this.sign)},c.prototype.minus=c.prototype.subtract,u.prototype.subtract=function(e){var t=W(e),r=this.value;if(r<0!==t.sign)return this.add(t.negate());var n=t.value;return t.isSmall?new u(r-n):w(n,Math.abs(r),r>=0)},u.prototype.minus=u.prototype.subtract,l.prototype.subtract=function(e){return new l(this.value-W(e).value)},l.prototype.minus=l.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},u.prototype.negate=function(){var e=this.sign,t=new u(-this.value);return t.sign=!e,t},l.prototype.negate=function(){return new l(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},c.prototype.multiply=function(e){var r,n,i,s=W(e),a=this.value,u=s.value,l=this.sign!==s.sign;if(s.isSmall){if(0===u)return o[0];if(1===u)return this;if(-1===u)return this.negate();if((r=Math.abs(u))<t)return new c(S(a,r),l);u=f(r)}return new c(-.012*(n=a.length)-.012*(i=u.length)+15e-6*n*i>0?B(a,u):E(a,u),l)},c.prototype.times=c.prototype.multiply,u.prototype._multiplyBySmall=function(e){return h(e.value*this.value)?new u(e.value*this.value):I(Math.abs(e.value),f(Math.abs(this.value)),this.sign!==e.sign)},c.prototype._multiplyBySmall=function(e){return 0===e.value?o[0]:1===e.value?this:-1===e.value?this.negate():I(Math.abs(e.value),this.value,this.sign!==e.sign)},u.prototype.multiply=function(e){return W(e)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,l.prototype.multiply=function(e){return new l(this.value*W(e).value)},l.prototype.times=l.prototype.multiply,c.prototype.square=function(){return new c(k(this.value),!1)},u.prototype.square=function(){var e=this.value*this.value;return h(e)?new u(e):new c(k(f(Math.abs(this.value))),!1)},l.prototype.square=function(e){return new l(this.value*this.value)},c.prototype.divmod=function(e){var t=N(this,e);return{quotient:t[0],remainder:t[1]}},l.prototype.divmod=u.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(e){return N(this,e)[0]},l.prototype.over=l.prototype.divide=function(e){return new l(this.value/W(e).value)},u.prototype.over=u.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(e){return N(this,e)[1]},l.prototype.mod=l.prototype.remainder=function(e){return new l(this.value%W(e).value)},u.prototype.remainder=u.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(e){var t,r,n,i=W(e),s=this.value,a=i.value;if(0===a)return o[1];if(0===s)return o[0];if(1===s)return o[1];if(-1===s)return i.isEven()?o[1]:o[-1];if(i.sign)return o[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&h(t=Math.pow(s,a)))return new u(g(t));for(r=this,n=o[1];!0&a&&(n=n.times(r),--a),0!==a;)a/=2,r=r.square();return n},u.prototype.pow=c.prototype.pow,l.prototype.pow=function(e){var t=W(e),r=this.value,n=t.value,i=BigInt(0),s=BigInt(1),a=BigInt(2);if(n===i)return o[1];if(r===i)return o[0];if(r===s)return o[1];if(r===BigInt(-1))return t.isEven()?o[1]:o[-1];if(t.isNegative())return new l(i);for(var c=this,u=o[1];(n&s)===s&&(u=u.times(c),--n),n!==i;)n/=a,c=c.square();return u},c.prototype.modPow=function(e,t){if(e=W(e),(t=W(t)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=o[1],n=this.mod(t);for(e.isNegative()&&(e=e.multiply(o[-1]),n=n.modInv(t));e.isPositive();){if(n.isZero())return o[0];e.isOdd()&&(r=r.multiply(n).mod(t)),e=e.divide(2),n=n.square().mod(t)}return r},l.prototype.modPow=u.prototype.modPow=c.prototype.modPow,c.prototype.compareAbs=function(e){var t=W(e),r=this.value,n=t.value;return t.isSmall?1:U(r,n)},u.prototype.compareAbs=function(e){var t=W(e),r=Math.abs(this.value),n=t.value;return t.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},l.prototype.compareAbs=function(e){var t=this.value,r=W(e).value;return(t=t>=0?t:-t)===(r=r>=0?r:-r)?0:t>r?1:-1},c.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=W(e),r=this.value,n=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:U(r,n)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,u.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=W(e),r=this.value,n=t.value;return t.isSmall?r==n?0:r>n?1:-1:r<0!==t.sign?r<0?-1:1:r<0?1:-1},u.prototype.compareTo=u.prototype.compare,l.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,r=W(e).value;return t===r?0:t>r?1:-1},l.prototype.compareTo=l.prototype.compare,c.prototype.equals=function(e){return 0===this.compare(e)},l.prototype.eq=l.prototype.equals=u.prototype.eq=u.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(e){return 0!==this.compare(e)},l.prototype.neq=l.prototype.notEquals=u.prototype.neq=u.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(e){return this.compare(e)>0},l.prototype.gt=l.prototype.greater=u.prototype.gt=u.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(e){return this.compare(e)<0},l.prototype.lt=l.prototype.lesser=u.prototype.lt=u.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},l.prototype.geq=l.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},l.prototype.leq=l.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return!(1&this.value[0])},u.prototype.isEven=function(){return!(1&this.value)},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return!(1&~this.value[0])},u.prototype.isOdd=function(){return!(1&~this.value)},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=u.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=u.prototype.isNegative,c.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(e){var t=W(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},l.prototype.isDivisibleBy=u.prototype.isDivisibleBy=c.prototype.isDivisibleBy,c.prototype.isPrime=function(t){var r=x(this);if(r!==e)return r;var n=this.abs(),s=n.bitLength();if(s<=64)return D(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var a=Math.log(2)*s.toJSNumber(),o=Math.ceil(!0===t?2*Math.pow(a,2):a),c=[],u=0;u<o;u++)c.push(i(u+2));return D(n,c)},l.prototype.isPrime=u.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(t,r){var n=x(this);if(n!==e)return n;for(var s=this.abs(),a=t===e?5:t,o=[],c=0;c<a;c++)o.push(i.randBetween(2,s.minus(2),r));return D(s,o)},l.prototype.isProbablePrime=u.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(e){for(var t,r,n,s=i.zero,a=i.one,o=W(e),c=this.abs();!c.isZero();)t=o.divide(c),r=s,n=o,s=a,o=c,a=r.subtract(t.multiply(a)),c=n.subtract(t.multiply(c));if(!o.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(e)),this.isNegative()?s.negate():s},l.prototype.modInv=u.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var e=this.value;return this.sign?w(e,1,this.sign):new c(A(e,1),this.sign)},u.prototype.next=function(){var e=this.value;return e+1<r?new u(e+1):new c(n,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},c.prototype.prev=function(){var e=this.value;return this.sign?new c(A(e,1),!0):w(e,1,this.sign)},u.prototype.prev=function(){var e=this.value;return e-1>-r?new u(e-1):new c(n,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var R=[1];2*R[R.length-1]<=t;)R.push(2*R[R.length-1]);var P=R.length,L=R[P-1];function _(e){return Math.abs(e)<=t}function K(e,t,r){t=W(t);for(var n=e.isNegative(),s=t.isNegative(),a=n?e.not():e,o=s?t.not():t,c=0,u=0,l=null,h=null,f=[];!a.isZero()||!o.isZero();)c=(l=N(a,L))[1].toJSNumber(),n&&(c=L-1-c),u=(h=N(o,L))[1].toJSNumber(),s&&(u=L-1-u),a=l[0],o=h[0],f.push(r(c,u));for(var p=0!==r(n?1:0,s?1:0)?i(-1):i(0),y=f.length-1;y>=0;y-=1)p=p.multiply(L).add(i(f[y]));return p}c.prototype.shiftLeft=function(e){var t=W(e).toJSNumber();if(!_(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var r=this;if(r.isZero())return r;for(;t>=P;)r=r.multiply(L),t-=P-1;return r.multiply(R[t])},l.prototype.shiftLeft=u.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(e){var t,r=W(e).toJSNumber();if(!_(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=P;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(t=N(n,L))[1].isNegative()?t[0].prev():t[0],r-=P-1}return(t=N(n,R[r]))[1].isNegative()?t[0].prev():t[0]},l.prototype.shiftRight=u.prototype.shiftRight=c.prototype.shiftRight,c.prototype.not=function(){return this.negate().prev()},l.prototype.not=u.prototype.not=c.prototype.not,c.prototype.and=function(e){return K(this,e,(function(e,t){return e&t}))},l.prototype.and=u.prototype.and=c.prototype.and,c.prototype.or=function(e){return K(this,e,(function(e,t){return e|t}))},l.prototype.or=u.prototype.or=c.prototype.or,c.prototype.xor=function(e){return K(this,e,(function(e,t){return e^t}))},l.prototype.xor=u.prototype.xor=c.prototype.xor;var O=1<<30;function M(e){var r=e.value,n="number"==typeof r?r|O:"bigint"==typeof r?r|BigInt(O):r[0]+r[1]*t|1073758208;return n&-n}function H(e,t){if(t.compareTo(e)<=0){var r=H(e,t.square(t)),n=r.p,s=r.e,a=n.multiply(t);return a.compareTo(e)<=0?{p:a,e:2*s+1}:{p:n,e:2*s}}return{p:i(1),e:0}}function V(e,t){return e=W(e),t=W(t),e.greater(t)?e:t}function F(e,t){return e=W(e),t=W(t),e.lesser(t)?e:t}function j(e,t){if(e=W(e).abs(),t=W(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var r,n,i=o[1];e.isEven()&&t.isEven();)r=F(M(e),M(t)),e=e.divide(r),t=t.divide(r),i=i.multiply(r);for(;e.isEven();)e=e.divide(M(e));do{for(;t.isEven();)t=t.divide(M(t));e.greater(t)&&(n=t,t=e,e=n),t=t.subtract(e)}while(!t.isZero());return i.isUnit()?e:e.multiply(i)}c.prototype.bitLength=function(){var e=this;return e.compareTo(i(0))<0&&(e=e.negate().subtract(i(1))),0===e.compareTo(i(0))?i(0):i(H(e,i(2)).e).add(i(1))},l.prototype.bitLength=u.prototype.bitLength=c.prototype.bitLength;var Q=function(e,t,r,n){r=r||s,e=String(e),n||(e=e.toLowerCase(),r=r.toLowerCase());var i,a=e.length,o=Math.abs(t),c={};for(i=0;i<r.length;i++)c[r[i]]=i;for(i=0;i<a;i++)if("-"!==(h=e[i])&&h in c&&c[h]>=o){if("1"===h&&1===o)continue;throw new Error(h+" is not a valid digit in base "+t+".")}t=W(t);var u=[],l="-"===e[0];for(i=l?1:0;i<e.length;i++){var h;if((h=e[i])in c)u.push(W(c[h]));else{if("<"!==h)throw new Error(h+" is not a valid character");var f=i;do{i++}while(">"!==e[i]&&i<e.length);u.push(W(e.slice(f+1,i)))}}return q(u,t,l)};function q(e,t,r){var n,i=o[0],s=o[1];for(n=e.length-1;n>=0;n--)i=i.add(e[n].times(s)),s=s.times(t);return r?i.negate():i}function z(e,t){if((t=i(t)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(e.isNegative()&&t.isPositive()&&(n=!0,e=e.abs()),t.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var s,a=[],o=e;o.isNegative()||o.compareAbs(t)>=0;){s=o.divmod(t),o=s.quotient;var c=s.remainder;c.isNegative()&&(c=t.minus(c).abs(),o=o.next()),a.push(c.toJSNumber())}return a.push(o.toJSNumber()),{value:a.reverse(),isNegative:n}}function G(e,t,r){var n=z(e,t);return(n.isNegative?"-":"")+n.value.map((function(e){return function(e,t){return e<(t=t||s).length?t[e]:"<"+e+">"}(e,r)})).join("")}function $(e){if(h(+e)){var t=+e;if(t===g(t))return a?new l(BigInt(t)):new u(t);throw new Error("Invalid integer: "+e)}var r="-"===e[0];r&&(e=e.slice(1));var n=e.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var i=n[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==g(i)||!h(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var s=n[0],o=s.indexOf(".");if(o>=0&&(i-=s.length-o-1,s=s.slice(0,o)+s.slice(o+1)),i<0)throw new Error("Cannot include negative exponent part for integers");e=s+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(a)return new l(BigInt(r?"-"+e:e));for(var f=[],p=e.length,d=p-7;p>0;)f.push(+e.slice(d,p)),(d-=7)<0&&(d=0),p-=7;return y(f),new c(f,r)}function W(e){return"number"==typeof e?function(e){if(a)return new l(BigInt(e));if(h(e)){if(e!==g(e))throw new Error(e+" is not an integer.");return new u(e)}return $(e.toString())}(e):"string"==typeof e?$(e):"bigint"==typeof e?new l(e):e}c.prototype.toArray=function(e){return z(this,e)},u.prototype.toArray=function(e){return z(this,e)},l.prototype.toArray=function(e){return z(this,e)},c.prototype.toString=function(t,r){if(t===e&&(t=10),10!==t||r)return G(this,t,r);for(var n,i=this.value,s=i.length,a=String(i[--s]);--s>=0;)n=String(i[s]),a+="0000000".slice(n.length)+n;return(this.sign?"-":"")+a},u.prototype.toString=function(t,r){return t===e&&(t=10),10!=t||r?G(this,t,r):String(this.value)},l.prototype.toString=u.prototype.toString,l.prototype.toJSON=c.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var Y=0;Y<1e3;Y++)o[Y]=W(Y),Y>0&&(o[-Y]=W(-Y));return o.one=o[1],o.zero=o[0],o.minusOne=o[-1],o.max=V,o.min=F,o.gcd=j,o.lcm=function(e,t){return e=W(e).abs(),t=W(t).abs(),e.divide(j(e,t)).multiply(t)},o.isInstance=function(e){return e instanceof c||e instanceof u||e instanceof l},o.randBetween=function(e,r,n){e=W(e),r=W(r);var i=n||Math.random,s=F(e,r),a=V(e,r).subtract(s).add(1);if(a.isSmall)return s.add(Math.floor(i()*a));for(var c=z(a,t).value,u=[],l=!0,h=0;h<c.length;h++){var f=l?c[h]+(h+1<c.length?c[h+1]/t:0):t,p=g(i()*f);u.push(p),p<c[h]&&(l=!1)}return s.add(o.fromArray(u,t,!1))},o.fromArray=function(e,t,r){return q(e.map(W),W(t||10),r)},o}();e.hasOwnProperty("exports")&&(e.exports=i),void 0===(n=function(){return i}.call(t,r,t,e))||(e.exports=n)},2313:(e,t,r)=>{var n=r(276);r(8106),r(7619);var i=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=i;var s=n.sha384=n.sha512.sha384=n.sha512.sha384||{};s.create=function(){return i.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=s,n.sha512.sha256=n.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,i.create=function(e){if(o||(a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(u={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],u["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],u["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],u["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],o=!0),void 0===e&&(e="SHA-512"),!(e in u))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=u[e],r=null,i=n.util.createBuffer(),s=new Array(80),h=0;h<80;++h)s[h]=new Array(2);var f=64;switch(e){case"SHA-384":f=48;break;case"SHA-512/256":f=32;break;case"SHA-512/224":f=28}var p={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:f,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){p.messageLength=0,p.fullMessageLength=p.messageLength128=[];for(var e=p.messageLengthSize/4,s=0;s<e;++s)p.fullMessageLength.push(0);for(i=n.util.createBuffer(),r=new Array(t.length),s=0;s<t.length;++s)r[s]=t[s].slice(0);return p}};return p.start(),p.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var a=e.length;p.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=p.fullMessageLength.length-1;o>=0;--o)p.fullMessageLength[o]+=a[1],a[1]=a[0]+(p.fullMessageLength[o]/4294967296>>>0),p.fullMessageLength[o]=p.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return i.putBytes(e),l(r,s,i),(i.read>2048||0===i.length())&&i.compact(),p},p.digest=function(){var t=n.util.createBuffer();t.putBytes(i.bytes());var o,c=p.fullMessageLength[p.fullMessageLength.length-1]+p.messageLengthSize&p.blockLength-1;t.putBytes(a.substr(0,p.blockLength-c));for(var u=8*p.fullMessageLength[0],h=0;h<p.fullMessageLength.length-1;++h)u+=(o=8*p.fullMessageLength[h+1])/4294967296>>>0,t.putInt32(u>>>0),u=o>>>0;t.putInt32(u);var f=new Array(r.length);for(h=0;h<r.length;++h)f[h]=r[h].slice(0);l(f,s,t);var y,d=n.util.createBuffer();for(y="SHA-512"===e?f.length:"SHA-384"===e?f.length-2:f.length-4,h=0;h<y;++h)d.putInt32(f[h][0]),h===y-1&&"SHA-512/224"===e||d.putInt32(f[h][1]);return d},p};var a=null,o=!1,c=null,u=null;function l(e,t,r){for(var n,i,s,a,o,u,l,h,f,p,y,d,g,m,v,A,b,w,E,S,C,B,I,k,T,N,U,x,D,R,P,L,_,K=r.length();K>=128;){for(U=0;U<16;++U)t[U][0]=r.getInt32()>>>0,t[U][1]=r.getInt32()>>>0;for(;U<80;++U)n=(((x=(R=t[U-2])[0])>>>19|(D=R[1])<<13)^(D>>>29|x<<3)^x>>>6)>>>0,i=((x<<13|D>>>19)^(D<<3|x>>>29)^(x<<26|D>>>6))>>>0,s=(((x=(L=t[U-15])[0])>>>1|(D=L[1])<<31)^(x>>>8|D<<24)^x>>>7)>>>0,a=((x<<31|D>>>1)^(x<<24|D>>>8)^(x<<25|D>>>7))>>>0,P=t[U-7],_=t[U-16],D=i+P[1]+a+_[1],t[U][0]=n+P[0]+s+_[0]+(D/4294967296>>>0)>>>0,t[U][1]=D>>>0;for(y=e[0][0],d=e[0][1],g=e[1][0],m=e[1][1],v=e[2][0],A=e[2][1],b=e[3][0],w=e[3][1],E=e[4][0],S=e[4][1],C=e[5][0],B=e[5][1],I=e[6][0],k=e[6][1],T=e[7][0],N=e[7][1],U=0;U<80;++U)l=((E>>>14|S<<18)^(E>>>18|S<<14)^(S>>>9|E<<23))>>>0,h=(I^E&(C^I))>>>0,o=((y>>>28|d<<4)^(d>>>2|y<<30)^(d>>>7|y<<25))>>>0,u=((y<<4|d>>>28)^(d<<30|y>>>2)^(d<<25|y>>>7))>>>0,f=(y&g|v&(y^g))>>>0,p=(d&m|A&(d^m))>>>0,D=N+(((E<<18|S>>>14)^(E<<14|S>>>18)^(S<<23|E>>>9))>>>0)+((k^S&(B^k))>>>0)+c[U][1]+t[U][1],n=T+l+h+c[U][0]+t[U][0]+(D/4294967296>>>0)>>>0,i=D>>>0,s=o+f+((D=u+p)/4294967296>>>0)>>>0,a=D>>>0,T=I,N=k,I=C,k=B,C=E,B=S,E=b+n+((D=w+i)/4294967296>>>0)>>>0,S=D>>>0,b=v,w=A,v=g,A=m,g=y,m=d,y=n+s+((D=i+a)/4294967296>>>0)>>>0,d=D>>>0;D=e[0][1]+d,e[0][0]=e[0][0]+y+(D/4294967296>>>0)>>>0,e[0][1]=D>>>0,D=e[1][1]+m,e[1][0]=e[1][0]+g+(D/4294967296>>>0)>>>0,e[1][1]=D>>>0,D=e[2][1]+A,e[2][0]=e[2][0]+v+(D/4294967296>>>0)>>>0,e[2][1]=D>>>0,D=e[3][1]+w,e[3][0]=e[3][0]+b+(D/4294967296>>>0)>>>0,e[3][1]=D>>>0,D=e[4][1]+S,e[4][0]=e[4][0]+E+(D/4294967296>>>0)>>>0,e[4][1]=D>>>0,D=e[5][1]+B,e[5][0]=e[5][0]+C+(D/4294967296>>>0)>>>0,e[5][1]=D>>>0,D=e[6][1]+k,e[6][0]=e[6][0]+I+(D/4294967296>>>0)>>>0,e[6][1]=D>>>0,D=e[7][1]+N,e[7][0]=e[7][0]+T+(D/4294967296>>>0)>>>0,e[7][1]=D>>>0,K-=128}}},2363:()=>{},2385:(e,t,r)=>{var n=r(276);r(7619);var i=e.exports=n.pem=n.pem||{};function s(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var s=0,a=-1;for(i=0;i<t.length;++i,++s)if(s>65&&-1!==a){var o=t[a];","===o?(++a,t=t.substr(0,a)+"\r\n "+t.substr(a)):t=t.substr(0,a)+"\r\n"+o+t.substr(a+1),s=i-a-1,a=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(a=i);return t}function a(e){return e.replace(/^\s+/,"")}i.encode=function(e,t){t=t||{};var r,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(i+=s(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(i+=s(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),i+=s(r)),e.headers)for(var a=0;a<e.headers.length;++a)i+=s(e.headers[a]);return e.procType&&(i+="\r\n"),(i+=n.util.encode64(e.body,t.maxline||64)+"\r\n")+"-----END "+e.type+"-----\r\n"},i.decode=function(e){for(var t,r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,s=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/;t=i.exec(e);){var c=t[1];"NEW CERTIFICATE REQUEST"===c&&(c="CERTIFICATE REQUEST");var u={type:c,procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(u),t[2]){for(var l=t[2].split(o),h=0;t&&h<l.length;){for(var f=l[h].replace(/\s+$/,""),p=h+1;p<l.length;++p){var y=l[p];if(!/\s/.test(y[0]))break;f+=y,h=p}if(t=f.match(s)){for(var d={name:t[1],values:[]},g=t[2].split(","),m=0;m<g.length;++m)d.values.push(a(g[m]));if(u.procType)if(u.contentDomain||"Content-Domain"!==d.name)if(u.dekInfo||"DEK-Info"!==d.name)u.headers.push(d);else{if(0===d.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:g[0],parameters:g[1]||null}}else u.contentDomain=g[0]||"";else{if("Proc-Type"!==d.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==d.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:g[0],type:g[1]}}}++h}if("ENCRYPTED"===u.procType&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},2666:(e,t,r)=>{var n=r(8287).hp;const i=r(9360),s=r(2828),a=r(5383).modulo,o=r(2096),c=127,u=128,l=n.from("0").toString("binary"),h=n.from("").toString("binary"),f=n.from("").toString("binary"),p=n.from("").toString("binary"),y=n.from("").toString("binary");function d(e){if(e<0)throw new Error("length cannot be negative");if(e<u)return String.fromCharCode(e);let t=e.toString(16);a(t.length,2)&&(t="0"+t),t=s.binaryFromHex(t);let r=t.length;return String.fromCharCode(u|r)+toString(r)}function g(e){let t=A(e);if(!(t&u))return[t&c,1];let r=t&c;if(r>e.length-1)throw new Error("ran out of length bytes");return[parseInt(s.hexFromBinary(e.slice(1,1+r)),16),1+r]}function m(e){let t,r=0,n=0;for(;;){if(n>e.length)throw new Error("ran out of length bytes");if(r<<=7,t=e.charAt(n),"number"!=typeof t&&(t=t.charCodeAt(0)),r+=t&c,n+=1,!(t&u))break}return[r,n]}function v(e,t,r){if(!e.startsWith(t))throw new Error("wanted sequence (0x"+r+"), got 0x"+A(e).toString(16))}function A(e){return"number"==typeof e[0]?e[0]:e.charCodeAt(0)}t.encodeSequence=function(){let e=[],t=0;for(let r=0;r<arguments.length;r++)e.push(arguments[r]),t+=arguments[r].length;return"0"+d(t)+e.join("")},t.encodeInteger=function(e){if(e.lesser(0))throw new Error("x cannot be negative");let t,r=e.toString(16);return r.length%2&&(r="0"+r),t="number"==typeof(e=s.binaryFromHex(r))[0]?e[0]:e.charCodeAt(0),t<=c?""+String.fromCharCode(e.length)+e:""+String.fromCharCode(e.length+1)+"\0"+e},t.encodeOid=function(e){let t=e.shift(),r=e.shift();if(t>2)throw new Error("first has to be <= 2");if(r>39)throw new Error("second has to be <= 39");let n=[];e.forEach((e=>{n.push(function(e){let t=[];for(;e;)t.unshift(e&c|u),e>>=7;t.length||t.push(0),t[t.length-1]&=c;let r=[];return t.forEach((e=>{r.push(String.fromCharCode(e))})),r.join("")}(e))}));let i=[String.fromCharCode(40*t+r)].concat(n).join("");return""+d(i.length)+i},t.encodeBitstring=function(e){return""+d(e.length)+e},t.encodeOctetString=function(e){return""+d(e.length)+e},t.encodeConstructed=function(e,t){return String.fromCharCode(160+e)+d(t.length)+t},t.removeSequence=function(e){v(e,l,"03");let t=g(e.slice(1)),r=t[0],n=t[1],i=1+n+r;return[e.slice(1+n,i),e.slice(i)]},t.removeInteger=function(e){v(e,h,"02");let t,r=g(e.slice(1)),n=r[0],i=r[1],a=e.slice(1+i,1+i+n),c=e.slice(1+i+n);if(t="number"==typeof a[0]?a[0]:a.charCodeAt(0),t>=u)throw new Error("nBytes must be < 160");return[o(s.hexFromBinary(a),16),c]},t.removeObject=function(e){v(e,y,"06");let t=g(e.slice(1)),r=t[0],n=t[1],i=e.slice(1+n,1+n+r),s=e.slice(1+n+r),a=[];for(;i;){let e=m(i),t=e[0],r=e[1];a.push(t),i=i.slice(r)}let o=a.shift(),c=Math.floor(o/40);return a=[c,o-40*c].concat(a),[a,s]},t.removeBitString=function(e){v(e,f,"03");let t=g(e.slice(1)),r=t[0],n=t[1];return[e.slice(1+n,1+n+r),e.slice(1+n+r)]},t.removeOctetString=function(e){v(e,p,"04");let t=g(e.slice(1)),r=t[0],n=t[1];return[e.slice(1+n,1+n+r),e.slice(1+n+r)]},t.removeConstructed=function(e){let t=A(e);if(160!=(224&t))throw new Error("wanted constructed tag (0xa0-0xbf), got 0x"+t);let r=31&t,n=g(e.slice(1)),i=n[0],s=n[1];return[r,e.slice(1+s,1+s+i),e.slice(1+s+i)]},t.fromPem=function(e){let t=e.split("\n"),r="";for(let e=0;e<t.length;e++)t[e].startsWith("-----")||(r+=t[e].trim());return i.decode(r)},t.toPem=function(e,t){let r=i.encode(e),n=["-----BEGIN "+t+"-----\n"];for(let e=0;e<=r.length;e+=64)n.push(r.slice(e,e+64)+"\n");return n.push("-----END "+t+"-----\n"),n.join("")}},2698:(e,t,r)=>{var n=r(276);if(r(9504),r(2746),r(9095),r(8106),r(6418),r(3254),r(2385),r(9356),r(5124),r(5805),r(7619),void 0===i)var i=n.jsbn.BigInteger;var s=n.asn1,a=n.pki=n.pki||{};e.exports=a.pbe=n.pbe=n.pbe||{};var o=a.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},u={name:"PBES2Algorithms",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l={name:"pkcs-12PbeParams",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(e,t){return e.start().update(t).digest().getBytes()}function f(e){var t;if(e){if(!(t=a.oids[s.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return p(t)}function p(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}a.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i,c,u,l=n.random.getBytesSync(r.saltSize),h=r.count,f=s.integerToDer(h);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var y,d,g;switch(r.algorithm){case"aes128":i=16,y=16,d=o["aes128-CBC"],g=n.aes.createEncryptionCipher;break;case"aes192":i=24,y=16,d=o["aes192-CBC"],g=n.aes.createEncryptionCipher;break;case"aes256":i=32,y=16,d=o["aes256-CBC"],g=n.aes.createEncryptionCipher;break;case"des":i=8,y=8,d=o.desCBC,g=n.des.createEncryptionCipher;break;default:throw(E=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,E}var m="hmacWith"+r.prfAlgorithm.toUpperCase(),v=p(m),A=n.pkcs5.pbkdf2(t,l,h,i,v),b=n.random.getBytesSync(y);(S=g(A)).start(b),S.update(s.toDer(e)),S.finish(),u=S.output.getBytes();var w=function(e,t,r,i){var o=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,t.getBytes())]);return"hmacWithSHA1"!==i&&o.value.push(s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(a.oids[i]).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])),o}(l,f,i,m);c=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.pkcs5PBES2).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.pkcs5PBKDF2).getBytes()),w]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(d).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,b)])])])}else{var E;if("3des"!==r.algorithm)throw(E=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,E;i=24;var S,C=new n.util.ByteBuffer(l);A=a.pbe.generatePkcs12Key(t,C,1,h,i),b=a.pbe.generatePkcs12Key(t,C,2,h,i),(S=n.des.createEncryptionCipher(A)).start(b),S.update(s.toDer(e)),S.finish(),u=S.output.getBytes(),c=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,l),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,f.getBytes())])])}return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[c,s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,u)])},a.decryptPrivateKeyInfo=function(e,t){var r=null,i={},o=[];if(!s.validate(e,c,i,o)){var u=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw u.errors=o,u}var l=s.derToOid(i.encryptionOid),h=a.pbe.getCipher(l,i.encryptionParams,t),f=n.util.createBuffer(i.encryptedData);return h.update(f),h.finish()&&(r=s.fromDer(h.output)),r},a.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:s.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},a.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return s.fromDer(t.body)},a.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var i=a.wrapRsaPrivateKey(a.privateKeyToAsn1(e));return i=a.encryptPrivateKeyInfo(i,t,r),a.encryptedPrivateKeyToPem(i)}var o,c,u,l;switch(r.algorithm){case"aes128":o="AES-128-CBC",u=16,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",u=24,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",u=32,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",u=24,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;case"des":o="DES-CBC",u=8,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;default:var h=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw h.algorithm=r.algorithm,h}var f=l(n.pbe.opensslDeriveBytes(t,c.substr(0,8),u));f.start(c),f.update(s.toDer(a.privateKeyToAsn1(e))),f.finish();var p={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:n.util.bytesToHex(c).toUpperCase()},body:f.output.getBytes()};return n.pem.encode(p)},a.decryptRsaPrivateKey=function(e,t){var r=null,i=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==i.type&&"PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type)throw(u=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=u,u;if(i.procType&&"ENCRYPTED"===i.procType.type){var o,c;switch(i.dekInfo.algorithm){case"DES-CBC":o=8,c=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,c=n.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,c=n.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,c=n.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,c=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,c=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":o=8,c=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":o=16,c=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:var u;throw(u=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".')).algorithm=i.dekInfo.algorithm,u}var l=n.util.hexToBytes(i.dekInfo.parameters),h=c(n.pbe.opensslDeriveBytes(t,l.substr(0,8),o));if(h.start(l),h.update(n.util.createBuffer(i.body)),!h.finish())return r;r=h.output.getBytes()}else r=i.body;return null!==(r="ENCRYPTED PRIVATE KEY"===i.type?a.decryptPrivateKeyInfo(s.fromDer(r),t):s.fromDer(r))&&(r=a.privateKeyFromAsn1(r)),r},a.pbe.generatePkcs12Key=function(e,t,r,i,s,a){var o,c;if(null==a){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');a=n.md.sha1.create()}var u=a.digestLength,l=a.blockLength,h=new n.util.ByteBuffer,f=new n.util.ByteBuffer;if(null!=e){for(c=0;c<e.length;c++)f.putInt16(e.charCodeAt(c));f.putInt16(0)}var p=f.length(),y=t.length(),d=new n.util.ByteBuffer;d.fillWithByte(r,l);var g=l*Math.ceil(y/l),m=new n.util.ByteBuffer;for(c=0;c<g;c++)m.putByte(t.at(c%y));var v=l*Math.ceil(p/l),A=new n.util.ByteBuffer;for(c=0;c<v;c++)A.putByte(f.at(c%p));var b=m;b.putBuffer(A);for(var w=Math.ceil(s/u),E=1;E<=w;E++){var S=new n.util.ByteBuffer;S.putBytes(d.bytes()),S.putBytes(b.bytes());for(var C=0;C<i;C++)a.start(),a.update(S.getBytes()),S=a.digest();var B=new n.util.ByteBuffer;for(c=0;c<l;c++)B.putByte(S.at(c%u));var I=Math.ceil(y/l)+Math.ceil(p/l),k=new n.util.ByteBuffer;for(o=0;o<I;o++){var T=new n.util.ByteBuffer(b.getBytes(l)),N=511;for(c=B.length()-1;c>=0;c--)N>>=8,N+=B.at(c)+T.at(c),T.setAt(c,255&N);k.putBuffer(T)}b=k,h.putBuffer(S)}return h.truncate(h.length()-s),h},a.pbe.getCipher=function(e,t,r){switch(e){case a.oids.pkcs5PBES2:return a.pbe.getCipherForPBES2(e,t,r);case a.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case a.oids["pbewithSHAAnd40BitRC2-CBC"]:return a.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},a.pbe.getCipherForPBES2=function(e,t,r){var i,o={},c=[];if(!s.validate(t,u,o,c))throw(i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=c,i;if((e=s.derToOid(o.kdfOid))!==a.oids.pkcs5PBKDF2)throw(i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,i.supportedOids=["pkcs5PBKDF2"],i;if((e=s.derToOid(o.encOid))!==a.oids["aes128-CBC"]&&e!==a.oids["aes192-CBC"]&&e!==a.oids["aes256-CBC"]&&e!==a.oids["des-EDE3-CBC"]&&e!==a.oids.desCBC)throw(i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i;var l,h,p=o.kdfSalt,y=n.util.createBuffer(o.kdfIterationCount);switch(y=y.getInt(y.length()<<3),a.oids[e]){case"aes128-CBC":l=16,h=n.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,h=n.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,h=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,h=n.des.createDecryptionCipher;break;case"desCBC":l=8,h=n.des.createDecryptionCipher}var d=f(o.prfOid),g=n.pkcs5.pbkdf2(r,p,y,l,d),m=o.encIv,v=h(g);return v.start(m),v},a.pbe.getCipherForPKCS12PBE=function(e,t,r){var i={},o=[];if(!s.validate(t,l,i,o))throw(d=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=o,d;var c,u,h,p=n.util.createBuffer(i.salt),y=n.util.createBuffer(i.iterations);switch(y=y.getInt(y.length()<<3),e){case a.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,h=n.des.startDecrypting;break;case a.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,h=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var d;throw(d=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,d}var g=f(i.prfOid),m=a.pbe.generatePkcs12Key(r,p,1,y,c,g);return g.start(),h(m,a.pbe.generatePkcs12Key(r,p,2,y,u,g))},a.pbe.opensslDeriveBytes=function(e,t,r,i){if(null==i){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');i=n.md.md5.create()}null===t&&(t="");for(var s=[h(i,e+t)],a=16,o=1;a<r;++o,a+=16)s.push(h(i,s[o-1]+e+t));return s.join("").substr(0,r)}},2746:(e,t,r)=>{var n=r(276);r(7619),r(6418);var i=e.exports=n.asn1=n.asn1||{};function s(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}function a(e,t,r,n){var o;s(e,t,2);var c=e.getByte();t--;var u=192&c,l=31&c;o=e.length();var h,f,p=function(e,t){var r=e.getByte();if(t--,128!==r){var n;if(128&r){var i=127&r;s(e,t,i),n=e.getInt(i<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}}(e,t);if(t-=o-e.length(),void 0!==p&&p>t){if(n.strict){var y=new Error("Too few bytes to read ASN.1 value.");throw y.available=e.length(),y.remaining=t,y.requested=p,y}p=t}var d=!(32&~c);if(d)if(h=[],void 0===p)for(;;){if(s(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}o=e.length(),h.push(a(e,t,r+1,n)),t-=o-e.length()}else for(;p>0;)o=e.length(),h.push(a(e,p,r+1,n)),t-=o-e.length(),p-=o-e.length();if(void 0===h&&u===i.Class.UNIVERSAL&&l===i.Type.BITSTRING&&(f=e.bytes(p)),void 0===h&&n.decodeBitStrings&&u===i.Class.UNIVERSAL&&l===i.Type.BITSTRING&&p>1){var g=e.read,m=t,v=0;if(l===i.Type.BITSTRING&&(s(e,t,1),v=e.getByte(),t--),0===v)try{o=e.length();var A=a(e,t,r+1,{strict:!0,decodeBitStrings:!0}),b=o-e.length();t-=b,l==i.Type.BITSTRING&&b++;var w=A.tagClass;b!==p||w!==i.Class.UNIVERSAL&&w!==i.Class.CONTEXT_SPECIFIC||(h=[A])}catch(e){}void 0===h&&(e.read=g,t=m)}if(void 0===h){if(void 0===p){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=t}if(l===i.Type.BMPSTRING)for(h="";p>0;p-=2)s(e,t,2),h+=String.fromCharCode(e.getInt16()),t-=2;else h=e.getBytes(p),t-=p}var E=void 0===f?null:{bitStringContents:f};return i.create(u,l,d,h,E)}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,r,s,a){if(n.util.isArray(s)){for(var o=[],c=0;c<s.length;++c)void 0!==s[c]&&o.push(s[c]);s=o}var u={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(s),value:s};return a&&"bitStringContents"in a&&(u.bitStringContents=a.bitStringContents,u.original=i.copy(u)),u},i.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var s=0;s<e.length;++s)r.push(i.copy(e[s],t));return r}return"string"==typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},i.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var s=0;s<e.length;++s)if(!i.equals(e[s],t[s]))return!1;return!0}if(typeof e!=typeof t)return!1;if("string"==typeof e)return e===t;var a=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return r&&r.includeBitStringContents&&(a=a&&e.bitStringContents===t.bitStringContents),a},i.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t},i.fromDer=function(e,t){void 0===t&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.length(),i=a(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var s=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw s.byteCount=r,s.remaining=e.length(),s}return i},i.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,s=n.util.createBuffer(),a=!1;if("bitStringContents"in e&&(a=!0,e.original&&(a=i.equals(e,e.original))),a)s.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:s.putByte(0);for(var o=0;o<e.value.length;++o)void 0!==e.value[o]&&s.putBuffer(i.toDer(e.value[o]))}else if(e.type===i.Type.BMPSTRING)for(o=0;o<e.value.length;++o)s.putInt16(e.value.charCodeAt(o));else!(e.type===i.Type.INTEGER&&e.value.length>1)||(0!==e.value.charCodeAt(0)||128&e.value.charCodeAt(1))&&(255!==e.value.charCodeAt(0)||128&~e.value.charCodeAt(1))?s.putBytes(e.value):s.putBytes(e.value.substr(1));if(t.putByte(r),s.length()<=127)t.putByte(127&s.length());else{var c=s.length(),u="";do{u+=String.fromCharCode(255&c),c>>>=8}while(c>0);for(t.putByte(128|u.length),o=u.length-1;o>=0;--o)t.putByte(u.charCodeAt(o))}return t.putBuffer(s),t},i.oidToDer=function(e){var t,r,i,s,a=e.split("."),o=n.util.createBuffer();o.putByte(40*parseInt(a[0],10)+parseInt(a[1],10));for(var c=2;c<a.length;++c){t=!0,r=[],i=parseInt(a[c],10);do{s=127&i,i>>>=7,t||(s|=128),r.push(s),t=!1}while(i>0);for(var u=r.length-1;u>=0;--u)o.putByte(r[u])}return o},i.derToOid=function(e){var t;"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var i=0;e.length()>0;)i<<=7,128&(r=e.getByte())?i+=127&r:(t+="."+(i+r),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var c=e.charAt(10),u=10;"+"!==c&&"-"!==c&&(o=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,0),u&&("+"===(c=e.charAt(u))||"-"===c)){var l=60*parseInt(e.substr(u+1,2),10)+parseInt(e.substr(u+4,2),10);l*=6e4,"+"===c?t.setTime(+t-l):t.setTime(+t+l)}return t},i.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),c=0,u=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var h=e.length-5,f=e.charAt(h);return"+"!==f&&"-"!==f||(u=60*parseInt(e.substr(h+1,2),10)+parseInt(e.substr(h+4,2),10),u*=6e4,"+"===f&&(u*=-1),l=!0),"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,c),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(s,a,o,c)),t},i.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+"Z"},i.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+"Z"},i.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},i.derToInteger=function(e){"string"==typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,r,s){var a=!1;if(e.tagClass!==t.tagClass&&void 0!==t.tagClass||e.type!==t.type&&void 0!==t.type)s&&(e.tagClass!==t.tagClass&&s.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&s.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||void 0===t.constructed){if(a=!0,t.value&&n.util.isArray(t.value))for(var o=0,c=0;a&&c<t.value.length;++c)a=t.value[c].optional||!1,e.value[o]&&((a=i.validate(e.value[o],t.value[c],r,s))?++o:t.value[c].optional&&(a=!0)),!a&&s&&s.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(a&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e))if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else s&&s.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return a};var o=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var s="";r=r||2,(t=t||0)>0&&(s+="\n");for(var a="",c=0;c<t*r;++c)a+=" ";switch(s+=a+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:s+="Universal:";break;case i.Class.APPLICATION:s+="Application:";break;case i.Class.CONTEXT_SPECIFIC:s+="Context-Specific:";break;case i.Class.PRIVATE:s+="Private:"}if(e.tagClass===i.Class.UNIVERSAL)switch(s+=e.type,e.type){case i.Type.NONE:s+=" (None)";break;case i.Type.BOOLEAN:s+=" (Boolean)";break;case i.Type.INTEGER:s+=" (Integer)";break;case i.Type.BITSTRING:s+=" (Bit string)";break;case i.Type.OCTETSTRING:s+=" (Octet string)";break;case i.Type.NULL:s+=" (Null)";break;case i.Type.OID:s+=" (Object Identifier)";break;case i.Type.ODESC:s+=" (Object Descriptor)";break;case i.Type.EXTERNAL:s+=" (External or Instance of)";break;case i.Type.REAL:s+=" (Real)";break;case i.Type.ENUMERATED:s+=" (Enumerated)";break;case i.Type.EMBEDDED:s+=" (Embedded PDV)";break;case i.Type.UTF8:s+=" (UTF8)";break;case i.Type.ROID:s+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:s+=" (Sequence)";break;case i.Type.SET:s+=" (Set)";break;case i.Type.PRINTABLESTRING:s+=" (Printable String)";break;case i.Type.IA5String:s+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:s+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:s+=" (Generalized time)";break;case i.Type.BMPSTRING:s+=" (BMP String)"}else s+=e.type;if(s+="\n",s+=a+"Constructed: "+e.constructed+"\n",e.composed){var u=0,l="";for(c=0;c<e.value.length;++c)void 0!==e.value[c]&&(u+=1,l+=i.prettyPrint(e.value[c],t+1,r),c+1<e.value.length&&(l+=","));s+=a+"Sub values: "+u+l}else{if(s+=a+"Value: ",e.type===i.Type.OID){var h=i.derToOid(e.value);s+=h,n.pki&&n.pki.oids&&h in n.pki.oids&&(s+=" ("+n.pki.oids[h]+") ")}if(e.type===i.Type.INTEGER)try{s+=i.derToInteger(e.value)}catch(t){s+="0x"+n.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?s+="0x"+n.util.bytesToHex(e.value.slice(1)):s+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);1==f?s+=" (1 unused bit shown)":f>1&&(s+=" ("+f+" unused bits shown)")}}else if(e.type===i.Type.OCTETSTRING)o.test(e.value)||(s+="("+e.value+") "),s+="0x"+n.util.bytesToHex(e.value);else if(e.type===i.Type.UTF8)try{s+=n.util.decodeUtf8(e.value)}catch(t){if("URI malformed"!==t.message)throw t;s+="0x"+n.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?s+=e.value:o.test(e.value)?s+="0x"+n.util.bytesToHex(e.value):0===e.value.length?s+="[null]":s+=e.value}return s}},2828:(e,t,r)=>{var n=r(8287).hp;const i=r(2096);var s=function(e){return n.from(e,"binary").toString("hex")},a=function(e){return n.from(e,"hex").toString("binary")},o=function(e){return i(e,16)};t.hexFromBinary=s,t.binaryFromHex=a,t.numberFromString=function(e){return o(s(e.toString()))},t.numberFromHex=o,t.stringFromNumber=function(e,t){let r=e.toString(16);for(;r.length<2*t;)r="0"+r;return a(r)}},2926:(e,t,r)=>{var n=r(2363).Buffer,i=r(276);r(3736),r(9356),r(2313),r(7619);var s=r(4309),a=s.publicKeyValidator,o=s.privateKeyValidator;if(void 0===c)var c=i.jsbn.BigInteger;var u=i.util.ByteBuffer,l=void 0===n?Uint8Array:n;i.pki=i.pki||{},e.exports=i.pki.ed25519=i.ed25519=i.ed25519||{};var h=i.ed25519;function f(e){var t=e.message;if(t instanceof Uint8Array||t instanceof l)return t;var r=e.encoding;if(void 0===t){if(!e.md)throw new TypeError('"options.message" or "options.md" not specified.');t=e.md.digest().getBytes(),r="binary"}if("string"==typeof t&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if("string"==typeof t){if(void 0!==n)return n.from(t,r);t=new u(t,r)}else if(!(t instanceof u))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new l(t.length()),s=0;s<i.length;++s)i[s]=t.at(s);return i}h.constants={},h.constants.PUBLIC_KEY_BYTE_LENGTH=32,h.constants.PRIVATE_KEY_BYTE_LENGTH=64,h.constants.SEED_BYTE_LENGTH=32,h.constants.SIGN_BYTE_LENGTH=64,h.constants.HASH_BYTE_LENGTH=64,h.generateKeyPair=function(e){var t=(e=e||{}).seed;if(void 0===t)t=i.random.getBytesSync(h.constants.SEED_BYTE_LENGTH);else if("string"==typeof t){if(t.length!==h.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+h.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=f({message:t,encoding:"binary"});for(var r=new l(h.constants.PUBLIC_KEY_BYTE_LENGTH),n=new l(h.constants.PRIVATE_KEY_BYTE_LENGTH),s=0;s<32;++s)n[s]=t[s];return function(e,t){var r,n=[_(),_(),_(),_()],i=w(t,32);for(i[0]&=248,i[31]&=127,i[31]|=64,D(n,i),I(e,n),r=0;r<32;++r)t[r+32]=e[r]}(r,n),{publicKey:r,privateKey:n}},h.privateKeyFromAsn1=function(e){var t={},r=[];if(!i.asn1.validate(e,o,t,r)){var n=new Error("Invalid Key.");throw n.errors=r,n}var s=i.asn1.derToOid(t.privateKeyOid),a=i.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=t.privateKey;return{privateKeyBytes:f({message:i.asn1.fromDer(c).value,encoding:"binary"})}},h.publicKeyFromAsn1=function(e){var t={},r=[];if(!i.asn1.validate(e,a,t,r)){var n=new Error("Invalid Key.");throw n.errors=r,n}var s=i.asn1.derToOid(t.publicKeyOid),o=i.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var c=t.ed25519PublicKey;if(c.length!==h.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return f({message:c,encoding:"binary"})},h.publicKeyFromPrivateKey=function(e){var t=f({message:(e=e||{}).privateKey,encoding:"binary"});if(t.length!==h.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+h.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new l(h.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=t[32+n];return r},h.sign=function(e){var t=f(e=e||{}),r=f({message:e.privateKey,encoding:"binary"});if(r.length===h.constants.SEED_BYTE_LENGTH)r=h.generateKeyPair({seed:r}).privateKey;else if(r.length!==h.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+h.constants.SEED_BYTE_LENGTH+" or "+h.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new l(h.constants.SIGN_BYTE_LENGTH+t.length);!function(e,t,r,n){var i,s,a=new Float64Array(64),o=[_(),_(),_(),_()],c=w(n,32);c[0]&=248,c[31]&=127,c[31]|=64;for(i=0;i<r;++i)e[64+i]=t[i];for(i=0;i<32;++i)e[32+i]=c[32+i];var u=w(e.subarray(32),r+32);for(S(u),D(o,u),I(e,o),i=32;i<64;++i)e[i]=n[i];var l=w(e,r+64);for(S(l),i=32;i<64;++i)a[i]=0;for(i=0;i<32;++i)a[i]=u[i];for(i=0;i<32;++i)for(s=0;s<32;s++)a[i+s]+=l[i]*c[s];E(e.subarray(32),a)}(n,t,t.length,r);for(var i=new l(h.constants.SIGN_BYTE_LENGTH),s=0;s<i.length;++s)i[s]=n[s];return i},h.verify=function(e){var t=f(e=e||{});if(void 0===e.signature)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=f({message:e.signature,encoding:"binary"});if(r.length!==h.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+h.constants.SIGN_BYTE_LENGTH);var n=f({message:e.publicKey,encoding:"binary"});if(n.length!==h.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+h.constants.PUBLIC_KEY_BYTE_LENGTH);var i,s=new l(h.constants.SIGN_BYTE_LENGTH+t.length),a=new l(h.constants.SIGN_BYTE_LENGTH+t.length);for(i=0;i<h.constants.SIGN_BYTE_LENGTH;++i)s[i]=r[i];for(i=0;i<t.length;++i)s[i+h.constants.SIGN_BYTE_LENGTH]=t[i];return function(e,t,r,n){var i,s=new l(32),a=[_(),_(),_(),_()],o=[_(),_(),_(),_()];if(r<64)return-1;if(function(e,t){var r=_(),n=_(),i=_(),s=_(),a=_(),o=_(),c=_();return R(e[2],y),function(e,t){var r;for(r=0;r<16;++r)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(e[1],t),M(i,e[1]),H(s,i,d),O(i,i,e[2]),K(s,e[2],s),M(a,s),M(o,a),H(c,o,a),H(r,c,i),H(r,r,s),function(e,t){var r,n=_();for(r=0;r<16;++r)n[r]=t[r];for(r=250;r>=0;--r)M(n,n),1!==r&&H(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}(r,r),H(r,r,i),H(r,r,s),H(r,r,s),H(e[0],r,s),M(n,e[0]),H(n,n,s),T(n,i)&&H(e[0],e[0],b),M(n,e[0]),H(n,n,s),T(n,i)?-1:(U(e[0])===t[31]>>7&&O(e[0],p,e[0]),H(e[3],e[0],e[1]),0)}(o,n))return-1;for(i=0;i<r;++i)e[i]=t[i];for(i=0;i<32;++i)e[i+32]=n[i];var c=w(e,r);if(S(c),x(a,o,c),D(o,t.subarray(32)),C(a,o),I(s,a),r-=64,N(t,0,s,0)){for(i=0;i<r;++i)e[i]=0;return-1}for(i=0;i<r;++i)e[i]=t[i+64];return r}(a,s,s.length,n)>=0};var p=_(),y=_([1]),d=_([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=_([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=_([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),v=_([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),b=_([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function w(e,t){var r=i.md.sha512.create(),s=new u(e);r.update(s.getBytes(t),"binary");var a=r.digest().getBytes();if(void 0!==n)return n.from(a,"binary");for(var o=new l(h.constants.HASH_BYTE_LENGTH),c=0;c<64;++c)o[c]=a.charCodeAt(c);return o}function E(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*A[i-(n-32)],r=t[i]+128>>8,t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;++i)t[i]+=r-(t[31]>>4)*A[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;++i)t[i]-=r*A[i];for(n=0;n<32;++n)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function S(e){for(var t=new Float64Array(64),r=0;r<64;++r)t[r]=e[r],e[r]=0;E(e,t)}function C(e,t){var r=_(),n=_(),i=_(),s=_(),a=_(),o=_(),c=_(),u=_(),l=_();O(r,e[1],e[0]),O(l,t[1],t[0]),H(r,r,l),K(n,e[0],e[1]),K(l,t[0],t[1]),H(n,n,l),H(i,e[3],t[3]),H(i,i,g),H(s,e[2],t[2]),K(s,s,s),O(a,n,r),O(o,s,i),K(c,s,i),K(u,n,r),H(e[0],a,o),H(e[1],u,c),H(e[2],c,o),H(e[3],a,u)}function B(e,t,r){for(var n=0;n<4;++n)L(e[n],t[n],r)}function I(e,t){var r=_(),n=_(),i=_();!function(e,t){var r,n=_();for(r=0;r<16;++r)n[r]=t[r];for(r=253;r>=0;--r)M(n,n),2!==r&&4!==r&&H(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}(i,t[2]),H(r,t[0],i),H(n,t[1],i),k(e,n),e[31]^=U(r)<<7}function k(e,t){var r,n,i,s=_(),a=_();for(r=0;r<16;++r)a[r]=t[r];for(P(a),P(a),P(a),n=0;n<2;++n){for(s[0]=a[0]-65517,r=1;r<15;++r)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,L(a,s,1-i)}for(r=0;r<16;r++)e[2*r]=255&a[r],e[2*r+1]=a[r]>>8}function T(e,t){var r=new l(32),n=new l(32);return k(r,e),k(n,t),N(r,0,n,0)}function N(e,t,r,n){return function(e,t,r,n){var i,s=0;for(i=0;i<32;++i)s|=e[t+i]^r[n+i];return(1&s-1>>>8)-1}(e,t,r,n)}function U(e){var t=new l(32);return k(t,e),1&t[0]}function x(e,t,r){var n,i;for(R(e[0],p),R(e[1],y),R(e[2],y),R(e[3],p),i=255;i>=0;--i)B(e,t,n=r[i/8|0]>>(7&i)&1),C(t,e),C(e,e),B(e,t,n)}function D(e,t){var r=[_(),_(),_(),_()];R(r[0],m),R(r[1],v),R(r[2],y),H(r[3],m,v),x(e,r,t)}function R(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function P(e){var t,r,n=1;for(t=0;t<16;++t)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function L(e,t,r){for(var n,i=~(r-1),s=0;s<16;++s)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function _(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;++t)r[t]=e[t];return r}function K(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]+r[n]}function O(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]-r[n]}function M(e,t){H(e,t,t)}function H(e,t,r){var n,i,s=0,a=0,o=0,c=0,u=0,l=0,h=0,f=0,p=0,y=0,d=0,g=0,m=0,v=0,A=0,b=0,w=0,E=0,S=0,C=0,B=0,I=0,k=0,T=0,N=0,U=0,x=0,D=0,R=0,P=0,L=0,_=r[0],K=r[1],O=r[2],M=r[3],H=r[4],V=r[5],F=r[6],j=r[7],Q=r[8],q=r[9],z=r[10],G=r[11],$=r[12],W=r[13],Y=r[14],J=r[15];s+=(n=t[0])*_,a+=n*K,o+=n*O,c+=n*M,u+=n*H,l+=n*V,h+=n*F,f+=n*j,p+=n*Q,y+=n*q,d+=n*z,g+=n*G,m+=n*$,v+=n*W,A+=n*Y,b+=n*J,a+=(n=t[1])*_,o+=n*K,c+=n*O,u+=n*M,l+=n*H,h+=n*V,f+=n*F,p+=n*j,y+=n*Q,d+=n*q,g+=n*z,m+=n*G,v+=n*$,A+=n*W,b+=n*Y,w+=n*J,o+=(n=t[2])*_,c+=n*K,u+=n*O,l+=n*M,h+=n*H,f+=n*V,p+=n*F,y+=n*j,d+=n*Q,g+=n*q,m+=n*z,v+=n*G,A+=n*$,b+=n*W,w+=n*Y,E+=n*J,c+=(n=t[3])*_,u+=n*K,l+=n*O,h+=n*M,f+=n*H,p+=n*V,y+=n*F,d+=n*j,g+=n*Q,m+=n*q,v+=n*z,A+=n*G,b+=n*$,w+=n*W,E+=n*Y,S+=n*J,u+=(n=t[4])*_,l+=n*K,h+=n*O,f+=n*M,p+=n*H,y+=n*V,d+=n*F,g+=n*j,m+=n*Q,v+=n*q,A+=n*z,b+=n*G,w+=n*$,E+=n*W,S+=n*Y,C+=n*J,l+=(n=t[5])*_,h+=n*K,f+=n*O,p+=n*M,y+=n*H,d+=n*V,g+=n*F,m+=n*j,v+=n*Q,A+=n*q,b+=n*z,w+=n*G,E+=n*$,S+=n*W,C+=n*Y,B+=n*J,h+=(n=t[6])*_,f+=n*K,p+=n*O,y+=n*M,d+=n*H,g+=n*V,m+=n*F,v+=n*j,A+=n*Q,b+=n*q,w+=n*z,E+=n*G,S+=n*$,C+=n*W,B+=n*Y,I+=n*J,f+=(n=t[7])*_,p+=n*K,y+=n*O,d+=n*M,g+=n*H,m+=n*V,v+=n*F,A+=n*j,b+=n*Q,w+=n*q,E+=n*z,S+=n*G,C+=n*$,B+=n*W,I+=n*Y,k+=n*J,p+=(n=t[8])*_,y+=n*K,d+=n*O,g+=n*M,m+=n*H,v+=n*V,A+=n*F,b+=n*j,w+=n*Q,E+=n*q,S+=n*z,C+=n*G,B+=n*$,I+=n*W,k+=n*Y,T+=n*J,y+=(n=t[9])*_,d+=n*K,g+=n*O,m+=n*M,v+=n*H,A+=n*V,b+=n*F,w+=n*j,E+=n*Q,S+=n*q,C+=n*z,B+=n*G,I+=n*$,k+=n*W,T+=n*Y,N+=n*J,d+=(n=t[10])*_,g+=n*K,m+=n*O,v+=n*M,A+=n*H,b+=n*V,w+=n*F,E+=n*j,S+=n*Q,C+=n*q,B+=n*z,I+=n*G,k+=n*$,T+=n*W,N+=n*Y,U+=n*J,g+=(n=t[11])*_,m+=n*K,v+=n*O,A+=n*M,b+=n*H,w+=n*V,E+=n*F,S+=n*j,C+=n*Q,B+=n*q,I+=n*z,k+=n*G,T+=n*$,N+=n*W,U+=n*Y,x+=n*J,m+=(n=t[12])*_,v+=n*K,A+=n*O,b+=n*M,w+=n*H,E+=n*V,S+=n*F,C+=n*j,B+=n*Q,I+=n*q,k+=n*z,T+=n*G,N+=n*$,U+=n*W,x+=n*Y,D+=n*J,v+=(n=t[13])*_,A+=n*K,b+=n*O,w+=n*M,E+=n*H,S+=n*V,C+=n*F,B+=n*j,I+=n*Q,k+=n*q,T+=n*z,N+=n*G,U+=n*$,x+=n*W,D+=n*Y,R+=n*J,A+=(n=t[14])*_,b+=n*K,w+=n*O,E+=n*M,S+=n*H,C+=n*V,B+=n*F,I+=n*j,k+=n*Q,T+=n*q,N+=n*z,U+=n*G,x+=n*$,D+=n*W,R+=n*Y,P+=n*J,b+=(n=t[15])*_,a+=38*(E+=n*O),o+=38*(S+=n*M),c+=38*(C+=n*H),u+=38*(B+=n*V),l+=38*(I+=n*F),h+=38*(k+=n*j),f+=38*(T+=n*Q),p+=38*(N+=n*q),y+=38*(U+=n*z),d+=38*(x+=n*G),g+=38*(D+=n*$),m+=38*(R+=n*W),v+=38*(P+=n*Y),A+=38*(L+=n*J),s=(n=(s+=38*(w+=n*K))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),A=(n=A+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),A=(n=A+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=a,e[2]=o,e[3]=c,e[4]=u,e[5]=l,e[6]=h,e[7]=f,e[8]=p,e[9]=y,e[10]=d,e[11]=g,e[12]=m,e[13]=v,e[14]=A,e[15]=b}},3254:(e,t,r)=>{var n=r(2363).Buffer,i=r(276);r(1696),r(8106),r(7619);var s,a=i.pkcs5=i.pkcs5||{};i.util.isNodejs&&!i.options.usePureJavaScript&&(s=r(310)),e.exports=i.pbkdf2=a.pbkdf2=function(e,t,r,a,o,c){if("function"==typeof o&&(c=o,o=null),i.util.isNodejs&&!i.options.usePureJavaScript&&s.pbkdf2&&(null===o||"object"!=typeof o)&&(s.pbkdf2Sync.length>4||!o||"sha1"===o))return"string"!=typeof o&&(o="sha1"),e=n.from(e,"binary"),t=n.from(t,"binary"),c?4===s.pbkdf2Sync.length?s.pbkdf2(e,t,r,a,(function(e,t){if(e)return c(e);c(null,t.toString("binary"))})):s.pbkdf2(e,t,r,a,o,(function(e,t){if(e)return c(e);c(null,t.toString("binary"))})):4===s.pbkdf2Sync.length?s.pbkdf2Sync(e,t,r,a).toString("binary"):s.pbkdf2Sync(e,t,r,a,o).toString("binary");if(null==o&&(o="sha1"),"string"==typeof o){if(!(o in i.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=i.md[o].create()}var u=o.digestLength;if(a>4294967295*u){var l=new Error("Derived key is too long.");if(c)return c(l);throw l}var h=Math.ceil(a/u),f=a-(h-1)*u,p=i.hmac.create();p.start(o,e);var y,d,g,m="";if(!c){for(var v=1;v<=h;++v){p.start(null,null),p.update(t),p.update(i.util.int32ToBytes(v)),y=g=p.digest().getBytes();for(var A=2;A<=r;++A)p.start(null,null),p.update(g),d=p.digest().getBytes(),y=i.util.xorBytes(y,d,u),g=d;m+=v<h?y:y.substr(0,f)}return m}function b(){if(v>h)return c(null,m);p.start(null,null),p.update(t),p.update(i.util.int32ToBytes(v)),y=g=p.digest().getBytes(),A=2,w()}function w(){if(A<=r)return p.start(null,null),p.update(g),d=p.digest().getBytes(),y=i.util.xorBytes(y,d,u),g=d,++A,i.util.setImmediate(w);m+=v<h?y:y.substr(0,f),++v,b()}v=1,b()}},3297:(e,t,r)=>{const n=r(761).b,i=r(5383).modulo,s=r(2096);var a=function(e,t){if(e.eq(0))return s(0);let r,n,a,o=s(1),c=s(0),u=i(e,t),l=t;for(;u.greater(1);)r=l.over(u),n=c.minus(o.multiply(r)),a=l.minus(u.multiply(r)),l=u,c=o,u=a,o=n;return i(o,t)},o=function(e){return new n(e.x,e.y,s(1))},c=function(e,t){var r=a(e.z,t);return new n(i(e.x.multiply(r.pow(2)),t),i(e.y.multiply(r.pow(3)),t))},u=function(e,t,r){if(0==e.y)return new n(s(0),s(0),s(0));let a=i(e.y.pow(2),r),o=i(e.x.multiply(a).multiply(4),r),c=i(e.x.pow(2).multiply(3).add(t.multiply(e.z.pow(4))),r),u=i(c.pow(2).minus(o.multiply(2)),r),l=i(c.multiply(o.minus(u)).minus(a.pow(2).multiply(8)),r),h=i(e.y.multiply(e.z).multiply(2),r);return new n(u,l,h)},l=function(e,t,r,a){if(0==e.y)return t;if(0==t.y)return e;let o=i(e.x.multiply(t.z.pow(2)),a),c=i(t.x.multiply(e.z.pow(2)),a),l=i(e.y.multiply(t.z.pow(3)),a),h=i(t.y.multiply(e.z.pow(3)),a);if(o.eq(c))return l.neq(h)?n(s(0),s(0),s(1)):u(e,r,a);let f=c.minus(o),p=h.minus(l),y=i(f.multiply(f),a),d=i(f.multiply(y),a),g=i(o.multiply(y),a),m=i(p.pow(2).minus(d).minus(g.multiply(2)),a),v=i(p.multiply(g.minus(m)).minus(l.multiply(d)),a),A=i(f.multiply(e.z).multiply(t.z),a);return new n(m,v,A)},h=function(e,t,r,a,o){if(e.y.eq(0)|t.eq(0))return new n(s(0),s(0),s(1));if(t.eq(1))return e;if(t.lesser(0)|t.greaterOrEquals(r))return h(e,i(t,r),r,a,o);if(i(t,2).eq(0))return u(h(e,t.over(2),r,a,o),a,o);if(i(t,2).eq(1))return l(u(h(e,t.over(2),r,a,o),a,o),e,a,o);throw new Error("logical failure: p: "+e+", n: "+t+", N: "+r+", A: "+a+", P: "+o)};t.multiply=function(e,t,r,n,i){return c(h(o(e),t,r,n,i),i)},t.add=function(e,t,r,n){return c(l(o(e),o(t),r,n),n)},t.inv=a},3432:(e,t,r)=>{var n=r(276);r(7619),r(9356),r(3736),e.exports=n.kem=n.kem||{};var i=n.jsbn.BigInteger;function s(e,t,r,i){e.generate=function(e,s){for(var a=new n.util.ByteBuffer,o=Math.ceil(s/i)+r,c=new n.util.ByteBuffer,u=r;u<o;++u){c.putInt32(u),t.start(),t.update(e+c.getBytes());var l=t.digest();a.putBytes(l.getBytes(i))}return a.truncate(a.length()-s),a.getBytes()}}n.kem.rsa={},n.kem.rsa.create=function(e,t){var r=(t=t||{}).prng||n.random;return{encrypt:function(t,s){var a,o=Math.ceil(t.n.bitLength()/8);do{a=new i(n.util.bytesToHex(r.getBytesSync(o)),16).mod(t.n)}while(a.compareTo(i.ONE)<=0);var c=o-(a=n.util.hexToBytes(a.toString(16))).length;return c>0&&(a=n.util.fillString(String.fromCharCode(0),c)+a),{encapsulation:t.encrypt(a,"NONE"),key:e.generate(a,s)}},decrypt:function(t,r,n){var i=t.decrypt(r,"NONE");return e.generate(i,n)}}},n.kem.kdf1=function(e,t){s(this,e,0,t||e.digestLength)},n.kem.kdf2=function(e,t){s(this,e,1,t||e.digestLength)}},3687:(e,t,r)=>{const n=r(1312),i=r(2096),s=r(3297),a=r(3765).Signature,o=r(2828),c=r(5383),u=c.between,l=c.modulo;t.sign=function(e,t,r=null,c=null){null==r&&(r=n);let h=r(e),f=o.numberFromHex(h),p=t.curve;null==c&&(c=u(i(1),p.N.minus(1)));let y=s.multiply(p.G,c,p.N,p.A,p.P),d=l(y.x,p.N),g=l(f.add(d.multiply(t.secret)).multiply(s.inv(c,p.N)),p.N);return new a(d,g)},t.verify=function(e,t,r,i=n){let a=i(e),c=o.numberFromHex(a),u=r.curve,h=t.r,f=t.s;if(h<1||h>=u.N)return!1;if(f<1||f>=u.N)return!1;let p=s.inv(f,u.N),y=s.multiply(u.G,l(c.multiply(p),u.N),u.N,u.A,u.P),d=s.multiply(r.point,l(h.multiply(p),u.N),u.N,u.A,u.P),g=s.add(y,d,u.A,u.P);return!g.isAtInfinity()&&g.x.mod(u.N).eq(h)}},3736:(e,t,r)=>{var n,i=r(276);function s(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function a(){return new s(null)}function o(e,t,r,n,i,s){for(var a=16383&t,o=t>>14;--s>=0;){var c=16383&this.data[e],u=this.data[e++]>>14,l=o*c+u*a;i=((c=a*c+((16383&l)<<14)+r.data[n]+i)>>28)+(l>>14)+o*u,r.data[n++]=268435455&c}return i}e.exports=i.jsbn=i.jsbn||{},i.jsbn.BigInteger=s,"undefined"==typeof navigator?(s.prototype.am=o,n=28):"Microsoft Internet Explorer"==navigator.appName?(s.prototype.am=function(e,t,r,n,i,s){for(var a=32767&t,o=t>>15;--s>=0;){var c=32767&this.data[e],u=this.data[e++]>>15,l=o*c+u*a;i=((c=a*c+((32767&l)<<15)+r.data[n]+(1073741823&i))>>>30)+(l>>>15)+o*u+(i>>>30),r.data[n++]=1073741823&c}return i},n=30):"Netscape"!=navigator.appName?(s.prototype.am=function(e,t,r,n,i,s){for(;--s>=0;){var a=t*this.data[e++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=67108863&a}return i},n=26):(s.prototype.am=o,n=28),s.prototype.DB=n,s.prototype.DM=(1<<n)-1,s.prototype.DV=1<<n,s.prototype.FV=Math.pow(2,52),s.prototype.F1=52-n,s.prototype.F2=2*n-52;var c,u,l=new Array;for(c="0".charCodeAt(0),u=0;u<=9;++u)l[c++]=u;for(c="a".charCodeAt(0),u=10;u<36;++u)l[c++]=u;for(c="A".charCodeAt(0),u=10;u<36;++u)l[c++]=u;function h(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function f(e,t){var r=l[e.charCodeAt(t)];return null==r?-1:r}function p(e){var t=a();return t.fromInt(e),t}function y(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function d(e){this.m=e}function g(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function m(e,t){return e&t}function v(e,t){return e|t}function A(e,t){return e^t}function b(e,t){return e&~t}function w(e){if(0==e)return-1;var t=0;return 65535&e||(e>>=16,t+=16),255&e||(e>>=8,t+=8),15&e||(e>>=4,t+=4),3&e||(e>>=2,t+=2),1&e||++t,t}function E(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function S(){}function C(e){return e}function B(e){this.r2=a(),this.q3=a(),s.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}d.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},d.prototype.revert=function(e){return e},d.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},d.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},d.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},g.prototype.convert=function(e){var t=a();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(s.ZERO)>0&&this.m.subTo(t,t),t},g.prototype.revert=function(e){var t=a();return e.copyTo(t),this.reduce(t),t},g.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},g.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},g.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},s.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},s.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},s.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,a=0;--n>=0;){var o=8==r?255&e[n]:f(e,n);o<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==a?this.data[this.t++]=o:a+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-a)-1)<<a,this.data[this.t++]=o>>this.DB-a):this.data[this.t-1]|=o<<a,(a+=r)>=this.DB&&(a-=this.DB))}8==r&&128&e[0]&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&s.ZERO.subTo(this,this)},s.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},s.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},s.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},s.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,s=(1<<i)-1,a=Math.floor(e/this.DB),o=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+a+1]=this.data[r]>>i|o,o=(this.data[r]&s)<<n;for(r=a-1;r>=0;--r)t.data[r]=0;t.data[a]=o,t.t=this.t+a+1,t.s=this.s,t.clamp()},s.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)t.data[a-r-1]|=(this.data[a]&s)<<i,t.data[a-r]=this.data[a]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}},s.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},s.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&s.ZERO.subTo(t,t)},s.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},s.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=a());var o=a(),c=this.s,u=e.s,l=this.DB-y(n.data[n.t-1]);l>0?(n.lShiftTo(l,o),i.lShiftTo(l,r)):(n.copyTo(o),i.copyTo(r));var h=o.t,f=o.data[h-1];if(0!=f){var p=f*(1<<this.F1)+(h>1?o.data[h-2]>>this.F2:0),d=this.FV/p,g=(1<<this.F1)/p,m=1<<this.F2,v=r.t,A=v-h,b=null==t?a():t;for(o.dlShiftTo(A,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),s.ONE.dlShiftTo(h,b),b.subTo(o,o);o.t<h;)o.data[o.t++]=0;for(;--A>=0;){var w=r.data[--v]==f?this.DM:Math.floor(r.data[v]*d+(r.data[v-1]+m)*g);if((r.data[v]+=o.am(0,w,r,A,0,h))<w)for(o.dlShiftTo(A,b),r.subTo(b,r);r.data[v]<--w;)r.subTo(b,r)}null!=t&&(r.drShiftTo(h,t),c!=u&&s.ZERO.subTo(t,t)),r.t=h,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&s.ZERO.subTo(r,r)}}},s.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(!(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},s.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},s.prototype.exp=function(e,t){if(e>4294967295||e<1)return s.ONE;var r=a(),n=a(),i=t.convert(this),o=y(e)-1;for(i.copyTo(r);--o>=0;)if(t.sqrTo(r,n),(e&1<<o)>0)t.mulTo(n,i,r);else{var c=r;r=n,n=c}return t.revert(r)},s.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(r=this.data[a]>>o)>0&&(i=!0,s=h(r));a>=0;)o<t?(r=(this.data[a]&(1<<o)-1)<<t-o,r|=this.data[--a]>>(o+=this.DB-t)):(r=this.data[a]>>(o-=t)&n,o<=0&&(o+=this.DB,--a)),r>0&&(i=!0),i&&(s+=h(r));return i?s:"0"},s.prototype.negate=function(){var e=a();return s.ZERO.subTo(this,e),e},s.prototype.abs=function(){return this.s<0?this.negate():this},s.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},s.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+y(this.data[this.t-1]^this.s&this.DM)},s.prototype.mod=function(e){var t=a();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(s.ZERO)>0&&e.subTo(t,t),t},s.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new d(t):new g(t),this.exp(e,r)},s.ZERO=p(0),s.ONE=p(1),S.prototype.convert=C,S.prototype.revert=C,S.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},S.prototype.sqrTo=function(e,t){e.squareTo(t)},B.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=a();return e.copyTo(t),this.reduce(t),t},B.prototype.revert=function(e){return e},B.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},B.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},B.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],k=(1<<26)/I[I.length-1];s.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},s.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=p(r),i=a(),s=a(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o},s.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,a=0,o=0,c=0;c<e.length;++c){var u=f(e,c);u<0?"-"==e.charAt(c)&&0==this.signum()&&(i=!0):(o=t*o+u,++a>=r&&(this.dMultiply(n),this.dAddOffset(o,0),a=0,o=0))}a>0&&(this.dMultiply(Math.pow(t,a)),this.dAddOffset(o,0)),i&&s.ZERO.subTo(this,this)},s.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(s.ONE.shiftLeft(e-1),v,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(s.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},s.prototype.bitwiseTo=function(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},s.prototype.changeBit=function(e,t){var r=s.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},s.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},s.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},s.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},s.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()},s.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},s.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},s.prototype.millerRabin=function(e){var t=this.subtract(s.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),a={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},o=0;o<e;++o){do{n=new s(this.bitLength(),a)}while(n.compareTo(s.ONE)<=0||n.compareTo(t)>=0);var c=n.modPow(i,this);if(0!=c.compareTo(s.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<r&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(s.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},s.prototype.clone=function(){var e=a();return this.copyTo(e),e},s.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},s.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},s.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},s.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},s.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),128&r&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},s.prototype.equals=function(e){return 0==this.compareTo(e)},s.prototype.min=function(e){return this.compareTo(e)<0?this:e},s.prototype.max=function(e){return this.compareTo(e)>0?this:e},s.prototype.and=function(e){var t=a();return this.bitwiseTo(e,m,t),t},s.prototype.or=function(e){var t=a();return this.bitwiseTo(e,v,t),t},s.prototype.xor=function(e){var t=a();return this.bitwiseTo(e,A,t),t},s.prototype.andNot=function(e){var t=a();return this.bitwiseTo(e,b,t),t},s.prototype.not=function(){for(var e=a(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},s.prototype.shiftLeft=function(e){var t=a();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},s.prototype.shiftRight=function(e){var t=a();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},s.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+w(this.data[e]);return this.s<0?this.t*this.DB:-1},s.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=E(this.data[r]^t);return e},s.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:!!(this.data[t]&1<<e%this.DB)},s.prototype.setBit=function(e){return this.changeBit(e,v)},s.prototype.clearBit=function(e){return this.changeBit(e,b)},s.prototype.flipBit=function(e){return this.changeBit(e,A)},s.prototype.add=function(e){var t=a();return this.addTo(e,t),t},s.prototype.subtract=function(e){var t=a();return this.subTo(e,t),t},s.prototype.multiply=function(e){var t=a();return this.multiplyTo(e,t),t},s.prototype.divide=function(e){var t=a();return this.divRemTo(e,t,null),t},s.prototype.remainder=function(e){var t=a();return this.divRemTo(e,null,t),t},s.prototype.divideAndRemainder=function(e){var t=a(),r=a();return this.divRemTo(e,t,r),new Array(t,r)},s.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),s=p(1);if(i<=0)return s;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new d(t):t.isEven()?new B(t):new g(t);var o=new Array,c=3,u=r-1,l=(1<<r)-1;if(o[1]=n.convert(this),r>1){var h=a();for(n.sqrTo(o[1],h);c<=l;)o[c]=a(),n.mulTo(h,o[c-2],o[c]),c+=2}var f,m,v=e.t-1,A=!0,b=a();for(i=y(e.data[v])-1;v>=0;){for(i>=u?f=e.data[v]>>i-u&l:(f=(e.data[v]&(1<<i+1)-1)<<u-i,v>0&&(f|=e.data[v-1]>>this.DB+i-u)),c=r;!(1&f);)f>>=1,--c;if((i-=c)<0&&(i+=this.DB,--v),A)o[f].copyTo(s),A=!1;else{for(;c>1;)n.sqrTo(s,b),n.sqrTo(b,s),c-=2;c>0?n.sqrTo(s,b):(m=s,s=b,b=m),n.mulTo(b,o[f],s)}for(;v>=0&&!(e.data[v]&1<<i);)n.sqrTo(s,b),m=s,s=b,b=m,--i<0&&(i=this.DB-1,--v)}return n.revert(s)},s.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return s.ZERO;for(var r=e.clone(),n=this.clone(),i=p(1),a=p(0),o=p(0),c=p(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&a.isEven()||(i.addTo(this,i),a.subTo(e,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),t?(o.isEven()&&c.isEven()||(o.addTo(this,o),c.subTo(e,c)),o.rShiftTo(1,o)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),a.subTo(c,a)):(n.subTo(r,n),t&&o.subTo(i,o),c.subTo(a,c))}return 0!=n.compareTo(s.ONE)?s.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},s.prototype.pow=function(e){return this.exp(e,new S)},s.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r},s.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=I[I.length-1]){for(t=0;t<I.length;++t)if(r.data[0]==I[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<I.length;){for(var n=I[t],i=t+1;i<I.length&&n<k;)n*=I[i++];for(n=r.modInt(n);t<i;)if(n%I[t++]==0)return!1}return r.millerRabin(e)}},3765:(e,t,r)=>{const n=r(2828),i=r(9360),s=r(2666);class a{constructor(e,t){this.r=e,this.s=t}toDer(){return s.encodeSequence(s.encodeInteger(this.r),s.encodeInteger(this.s))}toBase64(){return i.encode(this.toDer())}static fromDer(e){let t=s.removeSequence(e),r=t[0],i=t[1];if(i)throw new Error("trailing junk after DER signature: "+n.hexFromBinary(i));t=s.removeInteger(r);let o=t[0],c=t[1];t=s.removeInteger(c);let u=t[0];if(i=t[1],i)throw new Error("trailing junk after DER numbers: "+n.hexFromBinary(i));return new a(o,u)}static fromBase64(e){let t=i.decode(e);return this.fromDer(t)}}t.Signature=a},3878:(e,t,r)=>{var n=r(5606),i=r(276);r(7619);var s=null;!i.util.isNodejs||i.options.usePureJavaScript||n.versions["node-webkit"]||(s=r(310)),(e.exports=i.prng=i.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),a=0;a<32;++a)n[a]=r.create();function o(){if(t.pools[0].messageLength>=32)return c();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),c()}function c(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r===0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(i),t.generated=0}function u(e){var t=null,r=i.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var s=i.util.createBuffer();if(t)for(;s.length()<e;){var a=Math.max(1,Math.min(e-s.length(),65536)/4),o=new Uint32Array(Math.floor(a));try{t(o);for(var c=0;c<o.length;++c)s.putInt32(o[c])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(s.length()<e)for(var u,l,h,f=Math.floor(65536*Math.random());s.length()<e;)for(l=16807*(65535&f),l+=(32767&(u=16807*(f>>16)))<<16,f=4294967295&(l=(2147483647&(l+=u>>15))+(l>>31)),c=0;c<3;++c)h=f>>>(c<<3),h^=Math.floor(256*Math.random()),s.putByte(255&h);return s.getBytes(e)}return t.pools=n,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var n=t.plugin.cipher,s=t.plugin.increment,a=t.plugin.formatKey,o=t.plugin.formatSeed,u=i.util.createBuffer();t.key=null,function l(h){if(h)return r(h);if(u.length()>=e)return r(null,u.getBytes(e));if(t.generated>1048575&&(t.key=null),null===t.key)return i.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return c(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),c(),e()}))}(l)}));var f=n(t.key,t.seed);t.generated+=f.length,u.putBytes(f),t.key=a(n(t.key,s(t.seed))),t.seed=o(n(t.key,t.seed)),i.util.setImmediate(l)}()},t.generateSync=function(e){var r=t.plugin.cipher,n=t.plugin.increment,s=t.plugin.formatKey,a=t.plugin.formatSeed;t.key=null;for(var c=i.util.createBuffer();c.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&o();var u=r(t.key,t.seed);t.generated+=u.length,c.putBytes(u),t.key=s(r(t.key,n(t.seed))),t.seed=a(r(t.key,t.seed))}return c.getBytes(e)},s?(t.seedFile=function(e,t){s.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return s.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,u(e))}catch(e){t(e)}},t.seedFileSync=u),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",i=0;i<r;i+=8)n+=String.fromCharCode(e>>i&255);t.collect(n)},t.registerWorker=function(e){e===self?t.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})}:e.addEventListener("message",(function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))},t}},3900:(e,t,r)=>{var n=r(276);r(7619),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var i=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t)||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},3986:(e,t,r)=>{var n=r(276);r(2746),r(1696),r(1267),r(2385),r(9255),r(9356),r(1598),r(7619);var i=function(e,t,r,i){var s=n.util.createBuffer(),a=e.length>>1,o=a+(1&e.length),c=e.substr(0,o),u=e.substr(a,o),l=n.util.createBuffer(),h=n.hmac.create();r=t+r;var f=Math.ceil(i/16),p=Math.ceil(i/20);h.start("MD5",c);var y=n.util.createBuffer();l.putBytes(r);for(var d=0;d<f;++d)h.start(null,null),h.update(l.getBytes()),l.putBuffer(h.digest()),h.start(null,null),h.update(l.bytes()+r),y.putBuffer(h.digest());h.start("SHA1",u);var g=n.util.createBuffer();for(l.clear(),l.putBytes(r),d=0;d<p;++d)h.start(null,null),h.update(l.getBytes()),l.putBuffer(h.digest()),h.start(null,null),h.update(l.bytes()+r),g.putBuffer(h.digest());return s.putBytes(n.util.xorBytes(y.getBytes(),g.getBytes(),i)),s},s=function(e,t,r){var i=!1;try{var s=e.deflate(t.fragment.getBytes());t.fragment=n.util.createBuffer(s),t.length=s.length,i=!0}catch(e){}return i},a=function(e,t,r){var i=!1;try{var s=e.inflate(t.fragment.getBytes());t.fragment=n.util.createBuffer(s),t.length=s.length,i=!0}catch(e){}return i},o=function(e,t){var r=0;switch(t){case 1:r=e.getByte();break;case 2:r=e.getInt16();break;case 3:r=e.getInt24();break;case 4:r=e.getInt32()}return n.util.createBuffer(e.getBytes(r))},c=function(e,t,r){e.putInt(r.length(),t<<3),e.putBuffer(r)},u={Versions:{TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}}};u.SupportedVersions=[u.Versions.TLS_1_1,u.Versions.TLS_1_0],u.Version=u.SupportedVersions[0],u.MaxFragment=15360,u.ConnectionEnd={server:0,client:1},u.PRFAlgorithm={tls_prf_sha256:0},u.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},u.CipherType={stream:0,block:1,aead:2},u.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},u.CompressionMethod={none:0,deflate:1},u.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},u.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},u.Alert={},u.Alert.Level={warning:1,fatal:2},u.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},u.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},u.CipherSuites={},u.getCipherSuite=function(e){var t=null;for(var r in u.CipherSuites){var n=u.CipherSuites[r];if(n.id[0]===e.charCodeAt(0)&&n.id[1]===e.charCodeAt(1)){t=n;break}}return t},u.handleUnexpected=function(e,t){!e.open&&e.entity===u.ConnectionEnd.client||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unexpected_message}})},u.handleHelloRequest=function(e,t,r){!e.handshaking&&e.handshakes>0&&(u.queue(e,u.createAlert(e,{level:u.Alert.Level.warning,description:u.Alert.Description.no_renegotiation})),u.flush(e)),e.process()},u.parseHelloMessage=function(e,t,r){var i=null,s=e.entity===u.ConnectionEnd.client;if(r<38)e.error(e,{message:s?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});else{var a=t.fragment,c=a.length();if(i={version:{major:a.getByte(),minor:a.getByte()},random:n.util.createBuffer(a.getBytes(32)),session_id:o(a,1),extensions:[]},s?(i.cipher_suite=a.getBytes(2),i.compression_method=a.getByte()):(i.cipher_suites=o(a,2),i.compression_methods=o(a,1)),(c=r-(c-a.length()))>0){for(var l=o(a,2);l.length()>0;)i.extensions.push({type:[l.getByte(),l.getByte()],data:o(l,2)});if(!s)for(var h=0;h<i.extensions.length;++h){var f=i.extensions[h];if(0===f.type[0]&&0===f.type[1])for(var p=o(f.data,2);p.length()>0&&0===p.getByte();)e.session.extensions.server_name.serverNameList.push(o(p,2).getBytes())}}if(e.session.version&&(i.version.major!==e.session.version.major||i.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}});if(s)e.session.cipherSuite=u.getCipherSuite(i.cipher_suite);else for(var y=n.util.createBuffer(i.cipher_suites.bytes());y.length()>0&&(e.session.cipherSuite=u.getCipherSuite(y.getBytes(2)),null===e.session.cipherSuite););if(null===e.session.cipherSuite)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.handshake_failure},cipherSuite:n.util.bytesToHex(i.cipher_suite)});e.session.compressionMethod=s?i.compression_method:u.CompressionMethod.none}return i},u.createSecurityParameters=function(e,t){var r=e.entity===u.ConnectionEnd.client,n=t.random.bytes(),i=r?e.session.sp.client_random:n,s=r?n:u.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:u.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:s}},u.handleServerHello=function(e,t,r){var n=u.parseHelloMessage(e,t,r);if(!e.fail){if(!(n.version.minor<=e.version.minor))return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}});e.version.minor=n.version.minor,e.session.version=e.version;var i=n.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=y,e.session.resuming=!0,e.session.sp.server_random=n.random.bytes()):(e.expect=l,e.session.resuming=!1,u.createSecurityParameters(e,n)),e.session.id=i,e.process()}},u.handleClientHello=function(e,t,r){var i=u.parseHelloMessage(e,t,r);if(!e.fail){var s=i.session_id.bytes(),a=null;if(e.sessionCache&&(null===(a=e.sessionCache.getSession(s))?s="":(a.version.major!==i.version.major||a.version.minor>i.version.minor)&&(a=null,s="")),0===s.length&&(s=n.random.getBytes(32)),e.session.id=s,e.session.clientHelloVersion=i.version,e.session.sp={},a)e.version=e.session.version=a.version,e.session.sp=a.sp;else{for(var o,c=1;c<u.SupportedVersions.length&&!((o=u.SupportedVersions[c]).minor<=i.version.minor);++c);e.version={major:o.major,minor:o.minor},e.session.version=e.version}null!==a?(e.expect=w,e.session.resuming=!0,e.session.sp.client_random=i.random.bytes()):(e.expect=!1!==e.verifyClient?v:A,e.session.resuming=!1,u.createSecurityParameters(e,i)),e.open=!0,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerHello(e)})),e.session.resuming?(u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.pending=u.createConnectionState(e),e.state.current.write=e.state.pending.write,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)}))):(u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificate(e)})),e.fail||(u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerKeyExchange(e)})),!1!==e.verifyClient&&u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificateRequest(e)})),u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerHelloDone(e)})))),u.flush(e),e.process()}},u.handleCertificate=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var i,s,a=t.fragment,c={certificate_list:o(a,3)},l=[];try{for(;c.certificate_list.length()>0;)i=o(c.certificate_list,3),s=n.asn1.fromDer(i),i=n.pki.certificateFromAsn1(s,!0),l.push(i)}catch(t){return e.error(e,{message:"Could not parse certificate list.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate}})}var f=e.entity===u.ConnectionEnd.client;!f&&!0!==e.verifyClient||0!==l.length?0===l.length?e.expect=f?h:A:(f?e.session.serverCertificate=l[0]:e.session.clientCertificate=l[0],u.verifyCertificateChain(e,l)&&(e.expect=f?h:A)):e.error(e,{message:f?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}}),e.process()},u.handleServerKeyExchange=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unsupported_certificate}});e.expect=f,e.process()},u.handleClientKeyExchange=function(e,t,r){if(r<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unsupported_certificate}});var i=t.fragment,s={enc_pre_master_secret:o(i,2).getBytes()},a=null;if(e.getPrivateKey)try{a=e.getPrivateKey(e,e.session.serverCertificate),a=n.pki.privateKeyFromPem(a)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}})}if(null===a)return e.error(e,{message:"No private key set.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}});try{var c=e.session.sp;c.pre_master_secret=a.decrypt(s.enc_pre_master_secret);var l=e.session.clientHelloVersion;if(l.major!==c.pre_master_secret.charCodeAt(0)||l.minor!==c.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(e){c.pre_master_secret=n.random.getBytes(48)}e.expect=w,null!==e.session.clientCertificate&&(e.expect=b),e.process()},u.handleCertificateRequest=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var n=t.fragment,i={certificate_types:o(n,1),certificate_authorities:o(n,2)};e.session.certificateRequest=i,e.expect=p,e.process()},u.handleCertificateVerify=function(e,t,r){if(r<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var i=t.fragment;i.read-=4;var s=i.bytes();i.read+=4;var a={signature:o(i,2).getBytes()},c=n.util.createBuffer();c.putBuffer(e.session.md5.digest()),c.putBuffer(e.session.sha1.digest()),c=c.getBytes();try{if(!e.session.clientCertificate.publicKey.verify(c,a.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(s),e.session.sha1.update(s)}catch(t){return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.handshake_failure}})}e.expect=w,e.process()},u.handleServerHelloDone=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.record_overflow}});if(null===e.serverCertificate){var i={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.insufficient_security}},s=e.verify(e,i.alert.description,0,[]);if(!0!==s)return(s||0===s)&&("object"!=typeof s||n.util.isArray(s)?"number"==typeof s&&(i.alert.description=s):(s.message&&(i.message=s.message),s.alert&&(i.alert.description=s.alert))),e.error(e,i)}null!==e.session.certificateRequest&&(t=u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificate(e)}),u.queue(e,t)),t=u.createRecord(e,{type:u.ContentType.handshake,data:u.createClientKeyExchange(e)}),u.queue(e,t),e.expect=m;var a=function(e,t){null!==e.session.certificateRequest&&null!==e.session.clientCertificate&&u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificateVerify(e,t)})),u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.pending=u.createConnectionState(e),e.state.current.write=e.state.pending.write,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)})),e.expect=y,u.flush(e),e.process()};if(null===e.session.certificateRequest||null===e.session.clientCertificate)return a(e,null);u.getClientSignature(e,a)},u.handleChangeCipherSpec=function(e,t){if(1!==t.fragment.getByte())return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var r=e.entity===u.ConnectionEnd.client;(e.session.resuming&&r||!e.session.resuming&&!r)&&(e.state.pending=u.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&r||e.session.resuming&&!r)&&(e.state.pending=null),e.expect=r?d:E,e.process()},u.handleFinished=function(e,t,r){var s=t.fragment;s.read-=4;var a=s.bytes();s.read+=4;var o=t.fragment.getBytes();(s=n.util.createBuffer()).putBuffer(e.session.md5.digest()),s.putBuffer(e.session.sha1.digest());var c=e.entity===u.ConnectionEnd.client,l=c?"server finished":"client finished",h=e.session.sp;if((s=i(h.master_secret,l,s.getBytes(),12)).getBytes()!==o)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.decrypt_error}});e.session.md5.update(a),e.session.sha1.update(a),(e.session.resuming&&c||!e.session.resuming&&!c)&&(u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)}))),e.expect=c?g:S,e.handshaking=!1,++e.handshakes,e.peerCertificate=c?e.session.serverCertificate:e.session.clientCertificate,u.flush(e),e.isConnected=!0,e.connected(e),e.process()},u.handleAlert=function(e,t){var r,n=t.fragment,i={level:n.getByte(),description:n.getByte()};switch(i.description){case u.Alert.Description.close_notify:r="Connection closed.";break;case u.Alert.Description.unexpected_message:r="Unexpected message.";break;case u.Alert.Description.bad_record_mac:r="Bad record MAC.";break;case u.Alert.Description.decryption_failed:r="Decryption failed.";break;case u.Alert.Description.record_overflow:r="Record overflow.";break;case u.Alert.Description.decompression_failure:r="Decompression failed.";break;case u.Alert.Description.handshake_failure:r="Handshake failure.";break;case u.Alert.Description.bad_certificate:r="Bad certificate.";break;case u.Alert.Description.unsupported_certificate:r="Unsupported certificate.";break;case u.Alert.Description.certificate_revoked:r="Certificate revoked.";break;case u.Alert.Description.certificate_expired:r="Certificate expired.";break;case u.Alert.Description.certificate_unknown:r="Certificate unknown.";break;case u.Alert.Description.illegal_parameter:r="Illegal parameter.";break;case u.Alert.Description.unknown_ca:r="Unknown certificate authority.";break;case u.Alert.Description.access_denied:r="Access denied.";break;case u.Alert.Description.decode_error:r="Decode error.";break;case u.Alert.Description.decrypt_error:r="Decrypt error.";break;case u.Alert.Description.export_restriction:r="Export restriction.";break;case u.Alert.Description.protocol_version:r="Unsupported protocol version.";break;case u.Alert.Description.insufficient_security:r="Insufficient security.";break;case u.Alert.Description.internal_error:r="Internal error.";break;case u.Alert.Description.user_canceled:r="User canceled.";break;case u.Alert.Description.no_renegotiation:r="Renegotiation not supported.";break;default:r="Unknown error."}if(i.description===u.Alert.Description.close_notify)return e.close();e.error(e,{message:r,send:!1,origin:e.entity===u.ConnectionEnd.client?"server":"client",alert:i}),e.process()},u.handleHandshake=function(e,t){var r=t.fragment,i=r.getByte(),s=r.getInt24();if(s>r.length())return e.fragmented=t,t.fragment=n.util.createBuffer(),r.read-=4,e.process();e.fragmented=null,r.read-=4;var a=r.bytes(s+4);r.read+=4,i in O[e.entity][e.expect]?(e.entity!==u.ConnectionEnd.server||e.open||e.fail||(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:n.md.md5.create(),sha1:n.md.sha1.create()}),i!==u.HandshakeType.hello_request&&i!==u.HandshakeType.certificate_verify&&i!==u.HandshakeType.finished&&(e.session.md5.update(a),e.session.sha1.update(a)),O[e.entity][e.expect][i](e,t,s)):u.handleUnexpected(e,t)},u.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()},u.handleHeartbeat=function(e,t){var r=t.fragment,i=r.getByte(),s=r.getInt16(),a=r.getBytes(s);if(i===u.HeartbeatMessageType.heartbeat_request){if(e.handshaking||s>a.length)return e.process();u.queue(e,u.createRecord(e,{type:u.ContentType.heartbeat,data:u.createHeartbeat(u.HeartbeatMessageType.heartbeat_response,a)})),u.flush(e)}else if(i===u.HeartbeatMessageType.heartbeat_response){if(a!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,n.util.createBuffer(a))}e.process()};var l=1,h=2,f=3,p=4,y=5,d=6,g=7,m=8,v=1,A=2,b=3,w=4,E=5,S=6,C=u.handleUnexpected,B=u.handleChangeCipherSpec,I=u.handleAlert,k=u.handleHandshake,T=u.handleApplicationData,N=u.handleHeartbeat,U=[];U[u.ConnectionEnd.client]=[[C,I,k,C,N],[C,I,k,C,N],[C,I,k,C,N],[C,I,k,C,N],[C,I,k,C,N],[B,I,C,C,N],[C,I,k,C,N],[C,I,k,T,N],[C,I,k,C,N]],U[u.ConnectionEnd.server]=[[C,I,k,C,N],[C,I,k,C,N],[C,I,k,C,N],[C,I,k,C,N],[B,I,C,C,N],[C,I,k,C,N],[C,I,k,T,N],[C,I,k,C,N]];var x=u.handleHelloRequest,D=u.handleServerHello,R=u.handleCertificate,P=u.handleServerKeyExchange,L=u.handleCertificateRequest,_=u.handleServerHelloDone,K=u.handleFinished,O=[];O[u.ConnectionEnd.client]=[[C,C,D,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[x,C,C,C,C,C,C,C,C,C,C,R,P,L,_,C,C,C,C,C,C],[x,C,C,C,C,C,C,C,C,C,C,C,P,L,_,C,C,C,C,C,C],[x,C,C,C,C,C,C,C,C,C,C,C,C,L,_,C,C,C,C,C,C],[x,C,C,C,C,C,C,C,C,C,C,C,C,C,_,C,C,C,C,C,C],[x,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[x,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,K],[x,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[x,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]];var M=u.handleClientHello,H=u.handleClientKeyExchange,V=u.handleCertificateVerify;O[u.ConnectionEnd.server]=[[C,M,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,R,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,H,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,V,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,K],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],u.generateKeys=function(e,t){var r=i,n=t.client_random+t.server_random;e.session.resuming||(t.master_secret=r(t.pre_master_secret,"master secret",n,48).bytes(),t.pre_master_secret=null),n=t.server_random+t.client_random;var s=2*t.mac_key_length+2*t.enc_key_length,a=e.version.major===u.Versions.TLS_1_0.major&&e.version.minor===u.Versions.TLS_1_0.minor;a&&(s+=2*t.fixed_iv_length);var o=r(t.master_secret,"key expansion",n,s),c={client_write_MAC_key:o.getBytes(t.mac_key_length),server_write_MAC_key:o.getBytes(t.mac_key_length),client_write_key:o.getBytes(t.enc_key_length),server_write_key:o.getBytes(t.enc_key_length)};return a&&(c.client_write_IV=o.getBytes(t.fixed_iv_length),c.server_write_IV=o.getBytes(t.fixed_iv_length)),c},u.createConnectionState=function(e){var t=e.entity===u.ConnectionEnd.client,r=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(e){return!0},compressionState:null,compressFunction:function(e){return!0},updateSequenceNumber:function(){4294967295===e.sequenceNumber[1]?(e.sequenceNumber[1]=0,++e.sequenceNumber[0]):++e.sequenceNumber[1]}};return e},n={read:r(),write:r()};if(n.read.update=function(e,t){return n.read.cipherFunction(t,n.read)?n.read.compressFunction(e,t,n.read)||e.error(e,{message:"Could not decompress record.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.decompression_failure}}):e.error(e,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_record_mac}}),!e.fail},n.write.update=function(e,t){return n.write.compressFunction(e,t,n.write)?n.write.cipherFunction(t,n.write)||e.error(e,{message:"Could not encrypt record.",send:!1,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}):e.error(e,{message:"Could not compress record.",send:!1,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}),!e.fail},e.session){var i=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(i),i.keys=u.generateKeys(e,i),n.read.macKey=t?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,n.write.macKey=t?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(n,e,i),i.compression_algorithm){case u.CompressionMethod.none:break;case u.CompressionMethod.deflate:n.read.compressFunction=a,n.write.compressFunction=s;break;default:throw new Error("Unsupported compression algorithm.")}}return n},u.createRandom=function(){var e=new Date,t=+e+6e4*e.getTimezoneOffset(),r=n.util.createBuffer();return r.putInt32(t),r.putBytes(n.random.getBytes(28)),r},u.createRecord=function(e,t){return t.data?{type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data}:null},u.createAlert=function(e,t){var r=n.util.createBuffer();return r.putByte(t.level),r.putByte(t.description),u.createRecord(e,{type:u.ContentType.alert,data:r})},u.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=n.util.createBuffer(),r=0;r<e.cipherSuites.length;++r){var i=e.cipherSuites[r];t.putByte(i.id[0]),t.putByte(i.id[1])}var s=t.length(),a=n.util.createBuffer();a.putByte(u.CompressionMethod.none);var o=a.length(),l=n.util.createBuffer();if(e.virtualHost){var h=n.util.createBuffer();h.putByte(0),h.putByte(0);var f=n.util.createBuffer();f.putByte(0),c(f,2,n.util.createBuffer(e.virtualHost));var p=n.util.createBuffer();c(p,2,f),c(h,2,p),l.putBuffer(h)}var y=l.length();y>0&&(y+=2);var d=e.session.id,g=d.length+1+2+4+28+2+s+1+o+y,m=n.util.createBuffer();return m.putByte(u.HandshakeType.client_hello),m.putInt24(g),m.putByte(e.version.major),m.putByte(e.version.minor),m.putBytes(e.session.sp.client_random),c(m,1,n.util.createBuffer(d)),c(m,2,t),c(m,1,a),y>0&&c(m,2,l),m},u.createServerHello=function(e){var t=e.session.id,r=t.length+1+2+4+28+2+1,i=n.util.createBuffer();return i.putByte(u.HandshakeType.server_hello),i.putInt24(r),i.putByte(e.version.major),i.putByte(e.version.minor),i.putBytes(e.session.sp.server_random),c(i,1,n.util.createBuffer(t)),i.putByte(e.session.cipherSuite.id[0]),i.putByte(e.session.cipherSuite.id[1]),i.putByte(e.session.compressionMethod),i},u.createCertificate=function(e){var t,r=e.entity===u.ConnectionEnd.client,i=null;e.getCertificate&&(t=r?e.session.certificateRequest:e.session.extensions.server_name.serverNameList,i=e.getCertificate(e,t));var s=n.util.createBuffer();if(null!==i)try{n.util.isArray(i)||(i=[i]);for(var a=null,o=0;o<i.length;++o){var l=n.pem.decode(i[o])[0];if("CERTIFICATE"!==l.type&&"X509 CERTIFICATE"!==l.type&&"TRUSTED CERTIFICATE"!==l.type){var h=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw h.headerType=l.type,h}if(l.procType&&"ENCRYPTED"===l.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var f=n.util.createBuffer(l.body);null===a&&(a=n.asn1.fromDer(f.bytes(),!1));var p=n.util.createBuffer();c(p,3,f),s.putBuffer(p)}i=n.pki.certificateFromAsn1(a),r?e.session.clientCertificate=i:e.session.serverCertificate=i}catch(t){return e.error(e,{message:"Could not send certificate list.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate}})}var y=3+s.length(),d=n.util.createBuffer();return d.putByte(u.HandshakeType.certificate),d.putInt24(y),c(d,3,s),d},u.createClientKeyExchange=function(e){var t=n.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(n.random.getBytes(46));var r=e.session.sp;r.pre_master_secret=t.getBytes();var i=(t=e.session.serverCertificate.publicKey.encrypt(r.pre_master_secret)).length+2,s=n.util.createBuffer();return s.putByte(u.HandshakeType.client_key_exchange),s.putInt24(i),s.putInt16(t.length),s.putBytes(t),s},u.createServerKeyExchange=function(e){return n.util.createBuffer()},u.getClientSignature=function(e,t){var r=n.util.createBuffer();r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest()),r=r.getBytes(),e.getSignature=e.getSignature||function(e,t,r){var i=null;if(e.getPrivateKey)try{i=e.getPrivateKey(e,e.session.clientCertificate),i=n.pki.privateKeyFromPem(i)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}})}null===i?e.error(e,{message:"No private key set.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}):t=i.sign(t,null),r(e,t)},e.getSignature(e,r,t)},u.createCertificateVerify=function(e,t){var r=t.length+2,i=n.util.createBuffer();return i.putByte(u.HandshakeType.certificate_verify),i.putInt24(r),i.putInt16(t.length),i.putBytes(t),i},u.createCertificateRequest=function(e){var t=n.util.createBuffer();t.putByte(1);var r=n.util.createBuffer();for(var i in e.caStore.certs){var s=e.caStore.certs[i],a=n.pki.distinguishedNameToAsn1(s.subject),o=n.asn1.toDer(a);r.putInt16(o.length()),r.putBuffer(o)}var l=1+t.length()+2+r.length(),h=n.util.createBuffer();return h.putByte(u.HandshakeType.certificate_request),h.putInt24(l),c(h,1,t),c(h,2,r),h},u.createServerHelloDone=function(e){var t=n.util.createBuffer();return t.putByte(u.HandshakeType.server_hello_done),t.putInt24(0),t},u.createChangeCipherSpec=function(){var e=n.util.createBuffer();return e.putByte(1),e},u.createFinished=function(e){var t=n.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var r=e.entity===u.ConnectionEnd.client,s=e.session.sp,a=r?"client finished":"server finished";t=i(s.master_secret,a,t.getBytes(),12);var o=n.util.createBuffer();return o.putByte(u.HandshakeType.finished),o.putInt24(t.length()),o.putBuffer(t),o},u.createHeartbeat=function(e,t,r){void 0===r&&(r=t.length);var i=n.util.createBuffer();i.putByte(e),i.putInt16(r),i.putBytes(t);var s=i.length(),a=Math.max(16,s-r-3);return i.putBytes(n.random.getBytes(a)),i},u.queue=function(e,t){if(t&&(0!==t.fragment.length()||t.type!==u.ContentType.handshake&&t.type!==u.ContentType.alert&&t.type!==u.ContentType.change_cipher_spec)){if(t.type===u.ContentType.handshake){var r=t.fragment.bytes();e.session.md5.update(r),e.session.sha1.update(r),r=null}var i;if(t.fragment.length()<=u.MaxFragment)i=[t];else{i=[];for(var s=t.fragment.bytes();s.length>u.MaxFragment;)i.push(u.createRecord(e,{type:t.type,data:n.util.createBuffer(s.slice(0,u.MaxFragment))})),s=s.slice(u.MaxFragment);s.length>0&&i.push(u.createRecord(e,{type:t.type,data:n.util.createBuffer(s)}))}for(var a=0;a<i.length&&!e.fail;++a){var o=i[a];e.state.current.write.update(e,o)&&e.records.push(o)}}},u.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type),e.tlsData.putByte(r.version.major),e.tlsData.putByte(r.version.minor),e.tlsData.putInt16(r.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var F=function(e){switch(e){case!0:return!0;case n.pki.certificateError.bad_certificate:return u.Alert.Description.bad_certificate;case n.pki.certificateError.unsupported_certificate:return u.Alert.Description.unsupported_certificate;case n.pki.certificateError.certificate_revoked:return u.Alert.Description.certificate_revoked;case n.pki.certificateError.certificate_expired:return u.Alert.Description.certificate_expired;case n.pki.certificateError.certificate_unknown:return u.Alert.Description.certificate_unknown;case n.pki.certificateError.unknown_ca:return u.Alert.Description.unknown_ca;default:return u.Alert.Description.bad_certificate}};for(var j in u.verifyCertificateChain=function(e,t){try{var r={};for(var i in e.verifyOptions)r[i]=e.verifyOptions[i];r.verify=function(t,r,i){F(t);var s=e.verify(e,t,r,i);if(!0!==s){if("object"==typeof s&&!n.util.isArray(s)){var a=new Error("The application rejected the certificate.");throw a.send=!0,a.alert={level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate},s.message&&(a.message=s.message),s.alert&&(a.alert.description=s.alert),a}s!==t&&(s=function(e){switch(e){case!0:return!0;case u.Alert.Description.bad_certificate:return n.pki.certificateError.bad_certificate;case u.Alert.Description.unsupported_certificate:return n.pki.certificateError.unsupported_certificate;case u.Alert.Description.certificate_revoked:return n.pki.certificateError.certificate_revoked;case u.Alert.Description.certificate_expired:return n.pki.certificateError.certificate_expired;case u.Alert.Description.certificate_unknown:return n.pki.certificateError.certificate_unknown;case u.Alert.Description.unknown_ca:return n.pki.certificateError.unknown_ca;default:return n.pki.certificateError.bad_certificate}}(s))}return s},n.pki.verifyCertificateChain(e.caStore,t,r)}catch(t){var s=t;("object"!=typeof s||n.util.isArray(s))&&(s={send:!0,alert:{level:u.Alert.Level.fatal,description:F(t)}}),"send"in s||(s.send=!0),"alert"in s||(s.alert={level:u.Alert.Level.fatal,description:F(s.error)}),e.error(e,s)}return!e.fail},u.createSessionCache=function(e,t){var r=null;if(e&&e.getSession&&e.setSession&&e.order)r=e;else{for(var i in(r={}).cache=e||{},r.capacity=Math.max(t||100,1),r.order=[],e)r.order.length<=t?r.order.push(i):delete e[i];r.getSession=function(e){var t=null,i=null;if(e?i=n.util.bytesToHex(e):r.order.length>0&&(i=r.order[0]),null!==i&&i in r.cache)for(var s in t=r.cache[i],delete r.cache[i],r.order)if(r.order[s]===i){r.order.splice(s,1);break}return t},r.setSession=function(e,t){if(r.order.length===r.capacity){var i=r.order.shift();delete r.cache[i]}i=n.util.bytesToHex(e),r.order.push(i),r.cache[i]=t}}return r},u.createConnection=function(e){var t;t=e.caStore?n.util.isArray(e.caStore)?n.pki.createCaStore(e.caStore):e.caStore:n.pki.createCaStore();var r=e.cipherSuites||null;if(null===r)for(var i in r=[],u.CipherSuites)r.push(u.CipherSuites[i]);var s=e.server?u.ConnectionEnd.server:u.ConnectionEnd.client,a=e.sessionCache?u.createSessionCache(e.sessionCache):null,o={version:{major:u.Version.major,minor:u.Version.minor},entity:s,sessionId:e.sessionId,caStore:t,sessionCache:a,cipherSuites:r,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(e,t,r,n){return t},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:n.util.createBuffer(),tlsData:n.util.createBuffer(),data:n.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(t,r){r.origin=r.origin||(t.entity===u.ConnectionEnd.client?"client":"server"),r.send&&(u.queue(t,u.createAlert(t,r.alert)),u.flush(t));var n=!1!==r.fatal;n&&(t.fail=!0),e.error(t,r),n&&t.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null,reset:function(e){o.version={major:u.Version.major,minor:u.Version.minor},o.record=null,o.session=null,o.peerCertificate=null,o.state={pending:null,current:null},o.expect=(o.entity,u.ConnectionEnd.client,0),o.fragmented=null,o.records=[],o.open=!1,o.handshakes=0,o.handshaking=!1,o.isConnected=!1,o.fail=!(e||void 0===e),o.input.clear(),o.tlsData.clear(),o.data.clear(),o.state.current=u.createConnectionState(o)}};return o.reset(),o.handshake=function(e){if(o.entity!==u.ConnectionEnd.client)o.error(o,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(o.handshaking)o.error(o,{message:"Handshake already in progress.",fatal:!1});else{o.fail&&!o.open&&0===o.handshakes&&(o.fail=!1),o.handshaking=!0;var t=null;(e=e||"").length>0&&(o.sessionCache&&(t=o.sessionCache.getSession(e)),null===t&&(e="")),0===e.length&&o.sessionCache&&null!==(t=o.sessionCache.getSession())&&(e=t.id),o.session={id:e,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:n.md.md5.create(),sha1:n.md.sha1.create()},t&&(o.version=t.version,o.session.sp=t.sp),o.session.sp.client_random=u.createRandom().getBytes(),o.open=!0,u.queue(o,u.createRecord(o,{type:u.ContentType.handshake,data:u.createClientHello(o)})),u.flush(o)}},o.process=function(e){var t=0;return e&&o.input.putBytes(e),o.fail||(null!==o.record&&o.record.ready&&o.record.fragment.isEmpty()&&(o.record=null),null===o.record&&(t=function(e){var t=0,r=e.input,i=r.length();if(i<5)t=5-i;else{e.record={type:r.getByte(),version:{major:r.getByte(),minor:r.getByte()},length:r.getInt16(),fragment:n.util.createBuffer(),ready:!1};var s=e.record.version.major===e.version.major;s&&e.session&&e.session.version&&(s=e.record.version.minor===e.version.minor),s||e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}})}return t}(o)),o.fail||null===o.record||o.record.ready||(t=function(e){var t=0,r=e.input,n=r.length();return n<e.record.length?t=e.record.length-n:(e.record.fragment.putBytes(r.getBytes(e.record.length)),r.compact(),e.state.current.read.update(e,e.record)&&(null!==e.fragmented&&(e.fragmented.type===e.record.type?(e.fragmented.fragment.putBuffer(e.record.fragment),e.record=e.fragmented):e.error(e,{message:"Invalid fragmented record.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unexpected_message}})),e.record.ready=!0)),t}(o)),!o.fail&&null!==o.record&&o.record.ready&&function(e,t){var r=t.type-u.ContentType.change_cipher_spec,n=U[e.entity][e.expect];r in n?n[r](e,t):u.handleUnexpected(e,t)}(o,o.record)),t},o.prepare=function(e){return u.queue(o,u.createRecord(o,{type:u.ContentType.application_data,data:n.util.createBuffer(e)})),u.flush(o)},o.prepareHeartbeatRequest=function(e,t){return e instanceof n.util.ByteBuffer&&(e=e.bytes()),void 0===t&&(t=e.length),o.expectedHeartbeatPayload=e,u.queue(o,u.createRecord(o,{type:u.ContentType.heartbeat,data:u.createHeartbeat(u.HeartbeatMessageType.heartbeat_request,e,t)})),u.flush(o)},o.close=function(e){if(!o.fail&&o.sessionCache&&o.session){var t={id:o.session.id,version:o.session.version,sp:o.session.sp};t.sp.keys=null,o.sessionCache.setSession(t.id,t)}o.open&&(o.open=!1,o.input.clear(),(o.isConnected||o.handshaking)&&(o.isConnected=o.handshaking=!1,u.queue(o,u.createAlert(o,{level:u.Alert.Level.warning,description:u.Alert.Description.close_notify})),u.flush(o)),o.closed(o)),o.reset(e)},o},e.exports=n.tls=n.tls||{},u)"function"!=typeof u[j]&&(n.tls[j]=u[j]);n.tls.prf_tls1=i,n.tls.hmac_sha1=function(e,t,r){var i=n.hmac.create();i.start("SHA1",e);var s=n.util.createBuffer();return s.putInt32(t[0]),s.putInt32(t[1]),s.putByte(r.type),s.putByte(r.version.major),s.putByte(r.version.minor),s.putInt16(r.length),s.putBytes(r.fragment.bytes()),i.update(s.getBytes()),i.digest().getBytes()},n.tls.createSessionCache=u.createSessionCache,n.tls.createConnection=u.createConnection},4058:(e,t,r)=>{var n=r(2363).Buffer,i={};e.exports=i;var s={};i.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,s=t.length,a=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var c=0,u=e[i];c<o.length;++c)u+=o[c]<<8,o[c]=u%s,u=u/s|0;for(;u>0;)o.push(u%s),u=u/s|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=a;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var a=0,o=e.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%n,o=o/n|0;for(;o>0;)s.push(o%n),o=o/n|0}var c="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=t[s[r]];return c}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},i.decode=function(e,t){if("string"!=typeof e)throw new TypeError('"input" must be a string.');if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');var r=s[t];if(!r){r=s[t]=[];for(var i=0;i<t.length;++i)r[t.charCodeAt(i)]=i}e=e.replace(/\s/g,"");var a=t.length,o=t.charAt(0),c=[0];for(i=0;i<e.length;i++){var u=r[e.charCodeAt(i)];if(void 0===u)return;for(var l=0,h=u;l<c.length;++l)h+=c[l]*a,c[l]=255&h,h>>=8;for(;h>0;)c.push(255&h),h>>=8}for(var f=0;e[f]===o&&f<e.length-1;++f)c.push(0);return void 0!==n?n.from(c.reverse()):new Uint8Array(c.reverse())}},4309:(e,t,r)=>{var n=r(276);r(2746);var i=n.asn1;t.privateKeyValidator={name:"PrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},t.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}},5071:(e,t,r)=>{var n=r(276);r(2746),r(1696),r(6418),r(9954),r(2698),r(9356),r(5805),r(1598),r(7619),r(6011);var i=n.asn1,s=n.pki,a=e.exports=n.pkcs12=n.pkcs12||{},o={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},o,{name:"PFX.macData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},u={name:"SafeBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},l={name:"Attribute",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,capture:"values"}]},h={name:"CertBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:i.Class.UNIVERSAL,type:i.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function f(e,t,r,n){for(var i=[],s=0;s<e.length;s++)for(var a=0;a<e[s].safeBags.length;a++){var o=e[s].safeBags[a];void 0!==n&&o.type!==n||(null!==t?void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&i.push(o):i.push(o))}return i}function p(e){if(e.composed||e.constructed){for(var t=n.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function y(e,t){var r={},a=[];if(!i.validate(e,n.pkcs7.asn1.encryptedDataValidator,r,a))throw(o=new Error("Cannot read EncryptedContentInfo.")).errors=a,o;var o,c=i.derToOid(r.contentType);if(c!==s.oids.data)throw(o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=c,o;c=i.derToOid(r.encAlgorithm);var u=s.pbe.getCipher(c,r.encParameter,t),l=p(r.encryptedContentAsn1),h=n.util.createBuffer(l.value);if(u.update(h),!u.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return u.output.getBytes()}function d(e,t,r){if(!t&&0===e.length)return[];if((e=i.fromDer(e,t)).tagClass!==i.Class.UNIVERSAL||e.type!==i.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],a=0;a<e.value.length;a++){var o=e.value[a],c={},l=[];if(!i.validate(o,u,c,l))throw(m=new Error("Cannot read SafeBag.")).errors=l,m;var f,p,y={type:i.derToOid(c.bagId),attributes:g(c.bagAttributes)};n.push(y);var d=c.bagValue.value[0];switch(y.type){case s.oids.pkcs8ShroudedKeyBag:if(null===(d=s.decryptPrivateKeyInfo(d,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case s.oids.keyBag:try{y.key=s.privateKeyFromAsn1(d)}catch(e){y.key=null,y.asn1=d}continue;case s.oids.certBag:f=h,p=function(){if(i.derToOid(c.certId)!==s.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=i.derToOid(c.certId),e}var r=i.fromDer(c.cert,t);try{y.cert=s.certificateFromAsn1(r,!0)}catch(e){y.cert=null,y.asn1=r}};break;default:var m;throw(m=new Error("Unsupported PKCS#12 SafeBag type.")).oid=y.type,m}if(void 0!==f&&!i.validate(d,f,c,l))throw(m=new Error("Cannot read PKCS#12 "+f.name)).errors=l,m;p()}return n}function g(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},a=[];if(!i.validate(e[r],l,n,a)){var o=new Error("Cannot read PKCS#12 BagAttribute.");throw o.errors=a,o}var c=i.derToOid(n.oid);if(void 0!==s.oids[c]){t[s.oids[c]]=[];for(var u=0;u<n.values.length;++u)t[s.oids[c]].push(n.values[u].value)}}return t}a.pkcs12FromAsn1=function(e,t,r){"string"==typeof t?(r=t,t=!0):void 0===t&&(t=!0);var u={};if(!i.validate(e,c,u,[]))throw(l=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=l,l;var l,h={version:u.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=n.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=f(h.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=f(h.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=f(h.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return f(h.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return f(h.safeContents,"localKeyId",e,t)}};if(3!==u.version.charCodeAt(0))throw(l=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=u.version.charCodeAt(0),l;if(i.derToOid(u.contentType)!==s.oids.data)throw(l=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=i.derToOid(u.contentType),l;var g=u.content.value[0];if(g.tagClass!==i.Class.UNIVERSAL||g.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(g=p(g),u.mac){var m=null,v=0,A=i.derToOid(u.macAlgorithm);switch(A){case s.oids.sha1:m=n.md.sha1.create(),v=20;break;case s.oids.sha256:m=n.md.sha256.create(),v=32;break;case s.oids.sha384:m=n.md.sha384.create(),v=48;break;case s.oids.sha512:m=n.md.sha512.create(),v=64;break;case s.oids.md5:m=n.md.md5.create(),v=16}if(null===m)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+A);var b=new n.util.ByteBuffer(u.macSalt),w="macIterations"in u?parseInt(n.util.bytesToHex(u.macIterations),16):1,E=a.generateKey(r,b,3,w,v,m),S=n.hmac.create();if(S.start(m,E),S.update(g.value),S.getMac().getBytes()!==u.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,n){if((t=i.fromDer(t,r)).tagClass!==i.Class.UNIVERSAL||t.type!==i.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var a=0;a<t.value.length;a++){var c=t.value[a],u={},l=[];if(!i.validate(c,o,u,l))throw(m=new Error("Cannot read ContentInfo.")).errors=l,m;var h={encrypted:!1},f=null,g=u.content.value[0];switch(i.derToOid(u.contentType)){case s.oids.data:if(g.tagClass!==i.Class.UNIVERSAL||g.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");f=p(g).value;break;case s.oids.encryptedData:f=y(g,n),h.encrypted=!0;break;default:var m;throw(m=new Error("Unsupported PKCS#12 contentType.")).contentType=i.derToOid(u.contentType),m}h.safeBags=d(f,r,n),e.safeContents.push(h)}}(h,g.value,t,r),h},a.toPkcs12Asn1=function(e,t,r,o){(o=o||{}).saltSize=o.saltSize||8,o.count=o.count||2048,o.algorithm=o.algorithm||o.encAlgorithm||"aes128","useMac"in o||(o.useMac=!0),"localKeyId"in o||(o.localKeyId=null),"generateLocalKeyId"in o||(o.generateLocalKeyId=!0);var c,u=o.localKeyId;if(null!==u)u=n.util.hexToBytes(u);else if(o.generateLocalKeyId)if(t){var l=n.util.isArray(t)?t[0]:t;"string"==typeof l&&(l=s.certificateFromPem(l)),(k=n.md.sha1.create()).update(i.toDer(s.certificateToAsn1(l)).getBytes()),u=k.digest().getBytes()}else u=n.random.getBytes(20);var h=[];null!==u&&h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.localKeyId).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,u)])])),"friendlyName"in o&&h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.friendlyName).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.BMPSTRING,!1,o.friendlyName)])])),h.length>0&&(c=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,h));var f=[],p=[];null!==t&&(p=n.util.isArray(t)?t:[t]);for(var y=[],d=0;d<p.length;++d){"string"==typeof(t=p[d])&&(t=s.certificateFromPem(t));var g=0===d?c:void 0,m=s.certificateToAsn1(t),v=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.certBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.x509Certificate).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(m).getBytes())])])]),g]);y.push(v)}if(y.length>0){var A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,y),b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(A).getBytes())])]);f.push(b)}var w=null;if(null!==e){var E=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));w=null===r?i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.keyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[E]),c]):i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.pkcs8ShroudedKeyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[s.encryptPrivateKeyInfo(E,r,o)]),c]);var S=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[w]),C=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(S).getBytes())])]);f.push(C)}var B,I=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,f);if(o.useMac){var k=n.md.sha1.create(),T=new n.util.ByteBuffer(n.random.getBytes(o.saltSize)),N=o.count,U=(e=a.generateKey(r,T,3,N,20),n.hmac.create());U.start(k,e),U.update(i.toDer(I).getBytes());var x=U.getMac();B=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.sha1).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,x.getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,T.getBytes()),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(N).getBytes())])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(3).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(I).getBytes())])]),B])},a.generateKey=n.pbe.generatePkcs12Key},5124:(e,t,r)=>{var n=r(276);r(7619);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s=[1,2,3,5],a=function(e,t){return e<<t&65535|(65535&e)>>16-t},o=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"==typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,s=e,a=e.length(),o=t,c=Math.ceil(o/8),u=255>>(7&o);for(r=a;r<128;r++)s.putByte(i[s.at(r-1)+s.at(r-a)&255]);for(s.setAt(128-c,i[s.at(128-c)&u]),r=127-c;r>=0;r--)s.setAt(r,i[s.at(r+1)^s.at(r+c)]);return s};var c=function(e,t,r){var i,c,u,l,h=!1,f=null,p=null,y=null,d=[];for(e=n.rc2.expandKey(e,t),u=0;u<64;u++)d.push(e.getInt16Le());r?(i=function(e){for(u=0;u<4;u++)e[u]+=d[l]+(e[(u+3)%4]&e[(u+2)%4])+(~e[(u+3)%4]&e[(u+1)%4]),e[u]=a(e[u],s[u]),l++},c=function(e){for(u=0;u<4;u++)e[u]+=d[63&e[(u+3)%4]]}):(i=function(e){for(u=3;u>=0;u--)e[u]=o(e[u],s[u]),e[u]-=d[l]+(e[(u+3)%4]&e[(u+2)%4])+(~e[(u+3)%4]&e[(u+1)%4]),l--},c=function(e){for(u=3;u>=0;u--)e[u]-=d[63&e[(u+3)%4]]});var g=function(e){var t=[];for(u=0;u<4;u++){var n=f.getInt16Le();null!==y&&(r?n^=y.getInt16Le():y.putInt16Le(n)),t.push(65535&n)}l=r?0:63;for(var i=0;i<e.length;i++)for(var s=0;s<e[i][0];s++)e[i][1](t);for(u=0;u<4;u++)null!==y&&(r?y.putInt16Le(t[u]):t[u]^=y.getInt16Le()),p.putInt16Le(t[u])},m=null;return m={start:function(e,t){e&&"string"==typeof e&&(e=n.util.createBuffer(e)),h=!1,f=n.util.createBuffer(),p=t||new n.util.createBuffer,y=e,m.output=p},update:function(e){for(h||f.putBuffer(e);f.length()>=8;)g([[5,i],[1,c],[6,i],[1,c],[5,i]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,f,!r);else{var n=8===f.length()?8:8-f.length();f.fillWithByte(n,n)}if(t&&(h=!0,m.update()),!r&&(t=0===f.length()))if(e)t=e(8,p,!r);else{var i=p.length(),s=p.at(i-1);s>i?t=!1:p.truncate(s)}return t}}};n.rc2.startEncrypting=function(e,t,r){var i=n.rc2.createEncryptionCipher(e,128);return i.start(t,r),i},n.rc2.createEncryptionCipher=function(e,t){return c(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var i=n.rc2.createDecryptionCipher(e,128);return i.start(t,r),i},n.rc2.createDecryptionCipher=function(e,t){return c(e,t,!1)}},5250:(e,t,r)=>{var n=r(276);r(7619),n.mgf=n.mgf||{},(e.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{}).create=function(e){return{generate:function(t,r){for(var i=new n.util.ByteBuffer,s=Math.ceil(r/e.digestLength),a=0;a<s;a++){var o=new n.util.ByteBuffer;o.putInt32(a),e.start(),e.update(t+o.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-r),i.getBytes()}}}},5383:(e,t,r)=>{const n=r(2096),i=r(8416);t.between=function e(t,r){if(null==i||null==i.randomBytes)throw new Error("No suitable random number generator available. Ensure that your runtime is linked against OpenSSL (or an equivalent) correctly.");if(r.lesserOrEquals(t))throw new Error("The maximum value must be higher than the minimum value.");let s=r.minus(t),{bitsNeeded:a,bytesNeeded:o,mask:c}=function(e){let t=0,r=0,i=n(1);for(;e.greater(0);)t%8==0&&(r+=1),t+=1,i=i.shiftLeft(1).or(1),e=e.shiftRight(1);return{bitsNeeded:t,bytesNeeded:r,mask:i}}(s),u=i.randomBytes(o);var l=n(0);for(let e=n(0);e.lesser(o);e=e.add(1))l=l.or(n(u[e]).shiftLeft(n(8).multiply(e)));return(l=l.and(c)).lesserOrEquals(s)?t.add(l):e(t,r)},t.modulo=function(e,t){let r=e.divmod(t).remainder;return r.lesser(0)&&(r=r.add(t)),r}},5606:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var o,c=[],u=!1,l=-1;function h(){u&&o&&(u=!1,o.length?c=o.concat(c):l=-1,c.length&&f())}function f(){if(!u){var e=a(h);u=!0;for(var t=c.length;t;){for(o=c,c=[];++l<t;)o&&o[l].run();l=-1,t=c.length}o=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function y(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=y,n.addListener=y,n.once=y,n.off=y,n.removeListener=y,n.removeAllListeners=y,n.emit=y,n.prependListener=y,n.prependOnceListener=y,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},5805:(e,t,r)=>{var n=r(276);if(r(2746),r(3736),r(6418),r(7501),r(268),r(9356),r(7619),void 0===i)var i=n.jsbn.BigInteger;var s=n.util.isNodejs?r(310):null,a=n.asn1,o=n.util;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var c=n.pki,u=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},p=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},y={name:"DigestInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},d=function(e){var t;if(!(e.algorithm in c.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=c.oids[e.algorithm];var n=a.oidToDer(t).getBytes(),i=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]),s=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);s.value.push(a.create(a.Class.UNIVERSAL,a.Type.OID,!1,n)),s.value.push(a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,""));var o=a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(o),a.toDer(i).getBytes()},g=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var s;t.dP||(t.dP=t.d.mod(t.p.subtract(i.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(i.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{s=new i(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(s.compareTo(t.n)>=0||!s.gcd(t.n).equals(i.ONE));for(var a=(e=e.multiply(s.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),o=e.mod(t.q).modPow(t.dQ,t.q);a.compareTo(o)<0;)a=a.add(t.p);var c=a.subtract(o).multiply(t.qInv).mod(t.p).multiply(t.q).add(o);return c.multiply(s.modInverse(t.n)).mod(t.n)};function m(e,t,r){var i=n.util.createBuffer(),s=Math.ceil(t.n.bitLength()/8);if(e.length>s-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=e.length,a.max=s-11,a}i.putByte(0),i.putByte(r);var o,c=s-3-e.length;if(0===r||1===r){o=0===r?0:255;for(var u=0;u<c;++u)i.putByte(o)}else for(;c>0;){var l=0,h=n.random.getBytes(c);for(u=0;u<c;++u)0===(o=h.charCodeAt(u))?++l:i.putByte(o);c=l}return i.putByte(0),i.putBytes(e),i}function v(e,t,r,i){var s=Math.ceil(t.n.bitLength()/8),a=n.util.createBuffer(e),o=a.getByte(),c=a.getByte();if(0!==o||r&&0!==c&&1!==c||!r&&2!=c||r&&0===c&&void 0===i)throw new Error("Encryption block is invalid.");var u=0;if(0===c){u=s-3-i;for(var l=0;l<u;++l)if(0!==a.getByte())throw new Error("Encryption block is invalid.")}else if(1===c)for(u=0;a.length()>1;){if(255!==a.getByte()){--a.read;break}++u}else if(2===c)for(u=0;a.length()>1;){if(0===a.getByte()){--a.read;break}++u}if(0!==a.getByte()||u!==s-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function A(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return!(r.length>1)||(0!==r.charCodeAt(0)||128&r.charCodeAt(1))&&(255!==r.charCodeAt(0)||128&~r.charCodeAt(1))?r:r.substr(1)}function b(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function w(e){return n.util.isNodejs&&"function"==typeof s[e]}function E(e){return void 0!==o.globalScope&&"object"==typeof o.globalScope.crypto&&"object"==typeof o.globalScope.crypto.subtle&&"function"==typeof o.globalScope.crypto.subtle[e]}function S(e){return void 0!==o.globalScope&&"object"==typeof o.globalScope.msCrypto&&"object"==typeof o.globalScope.msCrypto.subtle&&"function"==typeof o.globalScope.msCrypto.subtle[e]}function C(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}c.rsa.encrypt=function(e,t,r){var s,a=r,o=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(a=2===r,s=m(e,t,r)):(s=n.util.createBuffer()).putBytes(e);for(var c=new i(s.toHex(),16),u=g(c,t,a).toString(16),l=n.util.createBuffer(),h=o-Math.ceil(u.length/2);h>0;)l.putByte(0),--h;return l.putBytes(n.util.hexToBytes(u)),l.getBytes()},c.rsa.decrypt=function(e,t,r,s){var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var o=new Error("Encrypted message length is invalid.");throw o.length=e.length,o.expected=a,o}var c=new i(n.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var u=g(c,t,r).toString(16),l=n.util.createBuffer(),h=a-Math.ceil(u.length/2);h>0;)l.putByte(0),--h;return l.putBytes(n.util.hexToBytes(u)),!1!==s?v(l.getBytes(),t,r):l.getBytes()},c.rsa.createKeyPairGenerationState=function(e,t,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var s,a=(r=r||{}).prng||n.random,o={nextBytes:function(e){for(var t=a.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},c=r.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return(s={algorithm:c,state:0,bits:e,rng:o,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(s.eInt),s},c.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new i(null);r.fromInt(30);for(var n,s=0,a=function(e,t){return e|t},o=+new Date,l=0;null===e.keys&&(t<=0||l<t);){if(0===e.state){var h=null===e.p?e.pBits:e.qBits,f=h-1;0===e.pqState?(e.num=new i(h,e.rng),e.num.testBit(f)||e.num.bitwiseTo(i.ONE.shiftLeft(f),a,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),s=0,++e.pqState):1===e.pqState?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(b(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(u[s++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(i.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var p=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,p,e.p,e.q,p.mod(e.p1),p.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)}}l+=(n=+new Date)-o,o=n}return null!==e.keys},c.rsa.generateKeyPair=function(e,t,r,u){if(1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(u=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(u=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,u=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(u=r,r=void 0):(u=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(u){if(w("generateKeyPair"))return s.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return u(e);u(null,{privateKey:c.privateKeyFromPem(r),publicKey:c.publicKeyFromPem(t)})}));if(E("generateKey")&&E("exportKey"))return o.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:C(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return o.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){u(e)})).then((function(e){if(e){var t=c.privateKeyFromAsn1(a.fromDer(n.util.createBuffer(e)));u(null,{privateKey:t,publicKey:c.setRsaPublicKey(t.n,t.e)})}}));if(S("generateKey")&&S("exportKey")){var l=o.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:C(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return l.oncomplete=function(e){var t=e.target.result,r=o.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=c.privateKeyFromAsn1(a.fromDer(n.util.createBuffer(t)));u(null,{privateKey:r,publicKey:c.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){u(e)}},void(l.onerror=function(e){u(e)})}}else if(w("generateKeyPairSync")){var h=s.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:c.privateKeyFromPem(h.privateKey),publicKey:c.publicKeyFromPem(h.publicKey)}}var f=c.rsa.createKeyPairGenerationState(e,t,r);if(!u)return c.rsa.stepKeyPairGenerationState(f,0),f.keys;!function(e,t,r){"function"==typeof t&&(r=t,t={});var s={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function a(){o(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?u(t,e.q):void o(e.qBits,u))}))}function o(e,t){n.prime.generateProbablePrime(e,s,t)}function u(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var s=e.p;e.p=e.q,e.q=s}if(0!==e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.p=null,void a();if(0!==e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.q=null,void o(e.qBits,u);if(e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(i.ONE))return e.p=e.q=null,void a();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void o(e.qBits,u);var l=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(s.prng=t.prng),a()}(f,r,u)},c.setRsaPublicKey=c.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,i){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return m(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"==typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var s=t.encode(e,r,!0);return c.rsa.encrypt(s,r,!0)},verify:function(e,t,i,s){"string"==typeof i?i=i.toUpperCase():void 0===i&&(i="RSASSA-PKCS1-V1_5"),void 0===s&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===i?i={verify:function(e,t){t=v(t,r,!0);var i=a.fromDer(t,{parseAllBytes:s._parseAllDigestBytes}),o={},c=[];if(!a.validate(i,y,o,c))throw(u=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.")).errors=c,u;var u,l=a.derToOid(o.algorithmIdentifier);if(l!==n.oids.md2&&l!==n.oids.md5&&l!==n.oids.sha1&&l!==n.oids.sha224&&l!==n.oids.sha256&&l!==n.oids.sha384&&l!==n.oids.sha512&&l!==n.oids["sha512-224"]&&l!==n.oids["sha512-256"])throw(u=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.")).oid=l,u;if((l===n.oids.md2||l===n.oids.md5)&&!("parameters"in o))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return e===o.digest}}:"NONE"!==i&&"NULL"!==i&&null!==i||(i={verify:function(e,t){return e===v(t,r,!0)}});var o=c.rsa.decrypt(t,r,!0,!1);return i.verify(e,o,r.n.bitLength())}};return r},c.setRsaPrivateKey=c.rsa.setPrivateKey=function(e,t,r,i,s,a,o,u){var l={n:e,e:t,d:r,p:i,q:s,dP:a,dQ:o,qInv:u,decrypt:function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var i=c.rsa.decrypt(e,l,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:v};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(i,l,!1)},sign:function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:d},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,l.n.bitLength());return c.rsa.encrypt(n,l,r)}};return l},c.wrapRsaPrivateKey=function(e){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(0).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(c.oids.rsaEncryption).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(e).getBytes())])},c.privateKeyFromAsn1=function(e){var t,r,s,o,u,f,p,y,d={},g=[];if(a.validate(e,l,d,g)&&(e=a.fromDer(n.util.createBuffer(d.privateKey))),d={},g=[],!a.validate(e,h,d,g)){var m=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw m.errors=g,m}return t=n.util.createBuffer(d.privateKeyModulus).toHex(),r=n.util.createBuffer(d.privateKeyPublicExponent).toHex(),s=n.util.createBuffer(d.privateKeyPrivateExponent).toHex(),o=n.util.createBuffer(d.privateKeyPrime1).toHex(),u=n.util.createBuffer(d.privateKeyPrime2).toHex(),f=n.util.createBuffer(d.privateKeyExponent1).toHex(),p=n.util.createBuffer(d.privateKeyExponent2).toHex(),y=n.util.createBuffer(d.privateKeyCoefficient).toHex(),c.setRsaPrivateKey(new i(t,16),new i(r,16),new i(s,16),new i(o,16),new i(u,16),new i(f,16),new i(p,16),new i(y,16))},c.privateKeyToAsn1=c.privateKeyToRSAPrivateKey=function(e){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(0).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.n)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.e)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.d)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.p)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.q)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.dP)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.dQ)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.qInv))])},c.publicKeyFromAsn1=function(e){var t={},r=[];if(a.validate(e,p,t,r)){var s,o=a.derToOid(t.publicKeyOid);if(o!==c.oids.rsaEncryption)throw(s=new Error("Cannot read public key. Unknown OID.")).oid=o,s;e=t.rsaPublicKey}if(r=[],!a.validate(e,f,t,r))throw(s=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,s;var u=n.util.createBuffer(t.publicKeyModulus).toHex(),l=n.util.createBuffer(t.publicKeyExponent).toHex();return c.setRsaPublicKey(new i(u,16),new i(l,16))},c.publicKeyToAsn1=c.publicKeyToSubjectPublicKeyInfo=function(e){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(c.oids.rsaEncryption).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,[c.publicKeyToRSAPublicKey(e)])])},c.publicKeyToRSAPublicKey=function(e){return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.n)),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,A(e.e))])}},5960:(e,t,r)=>{const n=r(2096),i=r(761).b,s=r(5383).modulo;class a{constructor(e,t,r,n,s,a,o,c,u=null){this.A=e,this.B=t,this.P=r,this.N=n,this.G=new i(s,a),this.name=o,this.nistName=u,this._oid=c}contains(e){return!(e.x<0||e.x>this.P.minus(1)||e.y<0||e.y>this.P.minus(1)||!s(e.y.pow(2).minus(e.x.pow(3).add(this.A.multiply(e.x)).add(this.B)),this.P).equals(0))}length(){return Math.floor((1+this.N.toString(16).length)/2)}get oid(){return this._oid.slice()}}let o=new a(n("0000000000000000000000000000000000000000000000000000000000000000",16),n("0000000000000000000000000000000000000000000000000000000000000007",16),n("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f",16),n("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16),n("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",16),n("483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",16),"secp256k1",[1,3,132,0,10]),c=new a(n("ffffffff00000001000000000000000000000000fffffffffffffffffffffffc",16),n("5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b",16),n("ffffffff00000001000000000000000000000000ffffffffffffffffffffffff",16),n("ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",16),n("6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296",16),n("4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5",16),"prime256v1",[1,2,840,10045,3,1,7],"P-256"),u=c,l=[o,c],h={};l.forEach((e=>{h[e.oid]=e})),t.CurveFp=a,t.curvesByOid=h,t.secp256k1=o,t.prime256v1=c,t.p256=u,t.supportedCurves=l},6011:(e,t,r)=>{var n=r(276);r(9504),r(2746),r(9095),r(8106),r(1373),r(6418),r(2385),r(1417),r(5805),r(7619);var i=n.asn1,s=e.exports=n.pki=n.pki||{},a=s.oids,o={};o.CN=a.commonName,o.commonName="CN",o.C=a.countryName,o.countryName="C",o.L=a.localityName,o.localityName="L",o.ST=a.stateOrProvinceName,o.stateOrProvinceName="ST",o.O=a.organizationName,o.organizationName="O",o.OU=a.organizationalUnitName,o.organizationalUnitName="OU",o.E=a.emailAddress,o.emailAddress="E";var c=n.pki.rsa.publicKeyValidator,u={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0}]}]}]},f={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function p(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,i=0;null===n&&i<e.attributes.length;++i)r=e.attributes[i],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(n=r);return n}s.RDNAttributesAsArray=function(e,t){for(var r,n,s,c=[],u=0;u<e.value.length;++u){r=e.value[u];for(var l=0;l<r.value.length;++l)s={},n=r.value[l],s.type=i.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in a&&(s.name=a[s.type],s.name in o&&(s.shortName=o[s.name])),t&&(t.update(s.type),t.update(s.value)),c.push(s)}return c},s.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],c=i.derToOid(n.value[0].value),u=n.value[1].value,l=0;l<u.length;++l){var h={};if(h.type=c,h.value=u[l].value,h.valueTagClass=u[l].type,h.type in a&&(h.name=a[h.type],h.name in o&&(h.shortName=o[h.name])),h.type===a.extensionRequest){h.extensions=[];for(var f=0;f<h.value.length;++f)h.extensions.push(s.certificateExtensionFromAsn1(h.value[f]))}t.push(h)}return t};var y=function(e,t,r){var n={};if(e!==a["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:a.sha1},mgf:{algorithmOid:a.mgf1,hash:{algorithmOid:a.sha1}},saltLength:20});var s={},o=[];if(!i.validate(t,l,s,o)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=o,c}return void 0!==s.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=i.derToOid(s.hashOid)),void 0!==s.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=i.derToOid(s.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=i.derToOid(s.maskGenHashOid)),void 0!==s.saltLength&&(n.saltLength=s.saltLength.charCodeAt(0)),n},d=function(e){switch(a[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return n.md.sha1.create();case"md5WithRSAEncryption":return n.md.md5.create();case"sha256WithRSAEncryption":case"RSASSA-PSS":return n.md.sha256.create();case"sha384WithRSAEncryption":return n.md.sha384.create();case"sha512WithRSAEncryption":return n.md.sha512.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},g=function(e){var t,r=e.certificate;switch(r.signatureOid){case a.sha1WithRSAEncryption:case a.sha1WithRSASignature:break;case a["RSASSA-PSS"]:var i,s,o;if(void 0===(i=a[r.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[i])throw(o=new Error("Unsupported MGF hash function.")).oid=r.signatureParameters.mgf.hash.algorithmOid,o.name=i,o;if(void 0===(s=a[r.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[s])throw(o=new Error("Unsupported MGF function.")).oid=r.signatureParameters.mgf.algorithmOid,o.name=s,o;if(s=n.mgf[s].create(n.md[i].create()),void 0===(i=a[r.signatureParameters.hash.algorithmOid])||void 0===n.md[i])throw(o=new Error("Unsupported RSASSA-PSS hash function.")).oid=r.signatureParameters.hash.algorithmOid,o.name=i,o;t=n.pss.create(n.md[i].create(),s,r.signatureParameters.saltLength)}return r.publicKey.verify(e.md.digest().getBytes(),e.signature,t)};function m(e){for(var t,r,s=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),a=e.attributes,o=0;o<a.length;++o){var c=(t=a[o]).value,u=i.Type.PRINTABLESTRING;"valueTagClass"in t&&(u=t.valueTagClass)===i.Type.UTF8&&(c=n.util.encodeUtf8(c)),r=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.type).getBytes()),i.create(i.Class.UNIVERSAL,u,!1,c)])]),s.value.push(r)}return s}function v(e){for(var t,r=0;r<e.length;++r){if(void 0===(t=e[r]).name&&(t.type&&t.type in s.oids?t.name=s.oids[t.type]:t.shortName&&t.shortName in o&&(t.name=s.oids[o[t.shortName]])),void 0===t.type){if(!t.name||!(t.name in s.oids))throw(c=new Error("Attribute type not specified.")).attribute=t,c;t.type=s.oids[t.name]}if(void 0===t.shortName&&t.name&&t.name in o&&(t.shortName=o[t.name]),t.type===a.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=i.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(s.certificateExtensionToAsn1(A(t.extensions[n])))}var c;if(void 0===t.value)throw(c=new Error("Attribute value not specified.")).attribute=t,c}}function A(e,t){if(t=t||{},void 0===e.name&&e.id&&e.id in s.oids&&(e.name=s.oids[e.id]),void 0===e.id){if(!e.name||!(e.name in s.oids))throw(w=new Error("Extension ID not specified.")).extension=e,w;e.id=s.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var r=0,o=0,c=0;e.digitalSignature&&(o|=128,r=7),e.nonRepudiation&&(o|=64,r=6),e.keyEncipherment&&(o|=32,r=5),e.dataEncipherment&&(o|=16,r=4),e.keyAgreement&&(o|=8,r=3),e.keyCertSign&&(o|=4,r=2),e.cRLSign&&(o|=2,r=1),e.encipherOnly&&(o|=1,r=0),e.decipherOnly&&(c|=128,r=7);var u=String.fromCharCode(r);0!==c?u+=String.fromCharCode(o)+String.fromCharCode(c):0!==o&&(u+=String.fromCharCode(o)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("basicConstraints"===e.name)e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);var l=e.value.value;for(var h in e)!0===e[h]&&(h in a?l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a[h]).getBytes())):-1!==h.indexOf(".")&&l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(h).getBytes())))}else if("nsCertType"===e.name)r=0,o=0,e.client&&(o|=128,r=7),e.server&&(o|=64,r=6),e.email&&(o|=32,r=5),e.objsign&&(o|=16,r=4),e.reserved&&(o|=8,r=3),e.sslCA&&(o|=4,r=2),e.emailCA&&(o|=2,r=1),e.objCA&&(o|=1,r=0),u=String.fromCharCode(r),0!==o&&(u+=String.fromCharCode(o)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u);else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);for(var f=0;f<e.altNames.length;++f){if(u=(v=e.altNames[f]).value,7===v.type&&v.ip){if(null===(u=n.util.bytesFromIP(v.ip)))throw(w=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,w}else 8===v.type&&(u=v.oid?i.oidToDer(i.oidToDer(v.oid)):i.oidToDer(u));e.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,v.type,!1,u))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=i.create(i.Class.UNIVERSAL,i.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var p=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=p.toHex(),e.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,p.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){if(e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),l=e.value.value,e.keyIdentifier){var y=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;l.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!1,y))}if(e.authorityCertIssuer){var d=[i.create(i.Class.CONTEXT_SPECIFIC,4,!0,[m(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];l.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,d))}if(e.serialNumber){var g=n.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);l.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if("cRLDistributionPoints"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),l=e.value.value;var v,A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),b=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(f=0;f<e.altNames.length;++f){if(u=(v=e.altNames[f]).value,7===v.type&&v.ip){if(null===(u=n.util.bytesFromIP(v.ip)))throw(w=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,w}else 8===v.type&&(u=v.oid?i.oidToDer(i.oidToDer(v.oid)):i.oidToDer(u));b.value.push(i.create(i.Class.CONTEXT_SPECIFIC,v.type,!1,u))}A.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[b])),l.push(A)}var w;if(void 0===e.value)throw(w=new Error("Extension value not specified.")).extension=e,w;return e}function b(e,t){if(e===a["RSASSA-PSS"]){var r=[];return void 0!==t.hash.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.saltLength).getBytes())])),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,r)}return i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")}function w(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,s=0;s<r.length;++s){var a=r[s],o=a.value,c=i.Type.UTF8;"valueTagClass"in a&&(c=a.valueTagClass),c===i.Type.UTF8&&(o=n.util.encodeUtf8(o));var u=!1;"valueConstructed"in a&&(u=a.valueConstructed);var l=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,c,u,o)])]);t.value.push(l)}return t}s.certificateFromPem=function(e,t,r){var a=n.pem.decode(e)[0];if("CERTIFICATE"!==a.type&&"X509 CERTIFICATE"!==a.type&&"TRUSTED CERTIFICATE"!==a.type){var o=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw o.headerType=a.type,o}if(a.procType&&"ENCRYPTED"===a.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=i.fromDer(a.body,r);return s.certificateFromAsn1(c,t)},s.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:i.toDer(s.certificateToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.publicKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var a=i.fromDer(t.body);return s.publicKeyFromAsn1(a)},s.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:i.toDer(s.publicKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:i.toDer(s.publicKeyToRSAPublicKey(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.getPublicKeyFingerprint=function(e,t){var r,a=(t=t||{}).md||n.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":r=i.toDer(s.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=i.toDer(s.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}a.start(),a.update(r);var o=a.digest();if("hex"===t.encoding){var c=o.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return o.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return o},s.certificationRequestFromPem=function(e,t,r){var a=n.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==a.type){var o=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw o.headerType=a.type,o}if(a.procType&&"ENCRYPTED"===a.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=i.fromDer(a.body,r);return s.certificationRequestFromAsn1(c,t)},s.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:i.toDer(s.certificationRequestToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return p(e.issuer,t)},e.issuer.addField=function(t){v([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return p(e.subject,t)},e.subject.addField=function(t){v([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){v(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){v(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)A(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,n=null,i=0;null===n&&i<e.extensions.length;++i)r=e.extensions[i],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(n=r);return n},e.sign=function(t,r){e.md=r||n.md.sha1.create();var o=a[e.md.algorithm+"WithRSAEncryption"];if(!o){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=o,e.tbsCertificate=s.getTBSCertificate(e);var u=i.toDer(e.tbsCertificate);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var n=t.issuer,a=e.subject,o=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw o.expectedIssuer=a.attributes,o.actualIssuer=n.attributes,o}var c=t.md;if(null===c){c=d({signatureOid:t.signatureOid,type:"certificate"});var u=t.tbsCertificate||s.getTBSCertificate(t),l=i.toDer(u);c.update(l.getBytes())}return null!==c&&(r=g({certificate:e,md:c,signature:t.signature})),r},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){var s,a;r=!0;for(var o=0;r&&o<n.attributes.length;++o)s=n.attributes[o],a=i.attributes[o],s.type===a.type&&s.value===a.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return s.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=a.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var i=e.extensions[r];if(i.id===t){var s=e.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(i.subjectKeyIdentifier)===s}}return!1},e},s.certificateFromAsn1=function(e,t){var r={},a=[];if(!i.validate(e,u,r,a)){var o=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw o.errors=a,o}if(i.derToOid(r.publicKeyOid)!==s.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=s.createCertificate();c.version=r.certVersion?r.certVersion.charCodeAt(0):0;var l=n.util.createBuffer(r.certSerialNumber);c.serialNumber=l.toHex(),c.signatureOid=n.asn1.derToOid(r.certSignatureOid),c.signatureParameters=y(c.signatureOid,r.certSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),c.siginfo.parameters=y(c.siginfo.algorithmOid,r.certinfoSignatureParams,!1),c.signature=r.certSignature;var h=[];if(void 0!==r.certValidity1UTCTime&&h.push(i.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&h.push(i.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&h.push(i.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&h.push(i.generalizedTimeToDate(r.certValidity4GeneralizedTime)),h.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(h.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(c.validity.notBefore=h[0],c.validity.notAfter=h[1],c.tbsCertificate=r.tbsCertificate,t){c.md=d({signatureOid:c.signatureOid,type:"certificate"});var f=i.toDer(c.tbsCertificate);c.md.update(f.getBytes())}var g=n.md.sha1.create(),m=i.toDer(r.certIssuer);g.update(m.getBytes()),c.issuer.getField=function(e){return p(c.issuer,e)},c.issuer.addField=function(e){v([e]),c.issuer.attributes.push(e)},c.issuer.attributes=s.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(c.issuer.uniqueId=r.certIssuerUniqueId),c.issuer.hash=g.digest().toHex();var A=n.md.sha1.create(),b=i.toDer(r.certSubject);return A.update(b.getBytes()),c.subject.getField=function(e){return p(c.subject,e)},c.subject.addField=function(e){v([e]),c.subject.attributes.push(e)},c.subject.attributes=s.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(c.subject.uniqueId=r.certSubjectUniqueId),c.subject.hash=A.digest().toHex(),r.certExtensions?c.extensions=s.certificateExtensionsFromAsn1(r.certExtensions):c.extensions=[],c.publicKey=s.publicKeyFromAsn1(r.subjectPublicKeyInfo),c},s.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push(s.certificateExtensionFromAsn1(n.value[i]));return t},s.certificateExtensionFromAsn1=function(e){var t={};if(t.id=i.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===i.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in a)if(t.name=a[t.id],"keyUsage"===t.name){var r=0,s=0;(c=i.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1),s=c.value.length>2?c.value.charCodeAt(2):0),t.digitalSignature=!(128&~r),t.nonRepudiation=!(64&~r),t.keyEncipherment=!(32&~r),t.dataEncipherment=!(16&~r),t.keyAgreement=!(8&~r),t.keyCertSign=!(4&~r),t.cRLSign=!(2&~r),t.encipherOnly=!(1&~r),t.decipherOnly=!(128&~s)}else if("basicConstraints"===t.name){(c=i.fromDer(t.value)).value.length>0&&c.value[0].type===i.Type.BOOLEAN?t.cA=0!==c.value[0].value.charCodeAt(0):t.cA=!1;var o=null;c.value.length>0&&c.value[0].type===i.Type.INTEGER?o=c.value[0].value:c.value.length>1&&(o=c.value[1].value),null!==o&&(t.pathLenConstraint=i.derToInteger(o))}else if("extKeyUsage"===t.name)for(var c=i.fromDer(t.value),u=0;u<c.value.length;++u){var l=i.derToOid(c.value[u].value);l in a?t[a[l]]=!0:t[l]=!0}else if("nsCertType"===t.name)r=0,(c=i.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1)),t.client=!(128&~r),t.server=!(64&~r),t.email=!(32&~r),t.objsign=!(16&~r),t.reserved=!(8&~r),t.sslCA=!(4&~r),t.emailCA=!(2&~r),t.objCA=!(1&~r);else if("subjectAltName"===t.name||"issuerAltName"===t.name){var h;t.altNames=[],c=i.fromDer(t.value);for(var f=0;f<c.value.length;++f){var p={type:(h=c.value[f]).type,value:h.value};switch(t.altNames.push(p),h.type){case 1:case 2:case 6:break;case 7:p.ip=n.util.bytesToIP(h.value);break;case 8:p.oid=i.derToOid(h.value)}}}else"subjectKeyIdentifier"===t.name&&(c=i.fromDer(t.value),t.subjectKeyIdentifier=n.util.bytesToHex(c.value));return t},s.certificationRequestFromAsn1=function(e,t){var r={},a=[];if(!i.validate(e,f,r,a)){var o=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw o.errors=a,o}if(i.derToOid(r.publicKeyOid)!==s.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=s.createCertificationRequest();if(c.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,c.signatureOid=n.asn1.derToOid(r.csrSignatureOid),c.signatureParameters=y(c.signatureOid,r.csrSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),c.siginfo.parameters=y(c.siginfo.algorithmOid,r.csrSignatureParams,!1),c.signature=r.csrSignature,c.certificationRequestInfo=r.certificationRequestInfo,t){c.md=d({signatureOid:c.signatureOid,type:"certification request"});var u=i.toDer(c.certificationRequestInfo);c.md.update(u.getBytes())}var l=n.md.sha1.create();return c.subject.getField=function(e){return p(c.subject,e)},c.subject.addField=function(e){v([e]),c.subject.attributes.push(e)},c.subject.attributes=s.RDNAttributesAsArray(r.certificationRequestInfoSubject,l),c.subject.hash=l.digest().toHex(),c.publicKey=s.publicKeyFromAsn1(r.subjectPublicKeyInfo),c.getAttribute=function(e){return p(c,e)},c.addAttribute=function(e){v([e]),c.attributes.push(e)},c.attributes=s.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),c},s.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return p(e.subject,t)},e.subject.addField=function(t){v([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return p(e,t)},e.addAttribute=function(t){v([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){v(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){v(t),e.attributes=t},e.sign=function(t,r){e.md=r||n.md.sha1.create();var o=a[e.md.algorithm+"WithRSAEncryption"];if(!o){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=o,e.certificationRequestInfo=s.getCertificationRequestInfo(e);var u=i.toDer(e.certificationRequestInfo);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){r=d({signatureOid:e.signatureOid,type:"certification request"});var n=e.certificationRequestInfo||s.getCertificationRequestInfo(e),a=i.toDer(n);r.update(a.getBytes())}return null!==r&&(t=g({certificate:e,md:r,signature:e.signature})),t},e};var E=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z");function C(e){return e>=E&&e<S?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(e))}s.getTBSCertificate=function(e){var t=C(e.validity.notBefore),r=C(e.validity.notAfter),a=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.siginfo.algorithmOid).getBytes()),b(e.siginfo.algorithmOid,e.siginfo.parameters)]),m(e.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,r]),m(e.subject),s.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&a.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&a.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&a.value.push(s.certificateExtensionsToAsn1(e.extensions)),a},s.getCertificationRequestInfo=function(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),m(e.subject),s.publicKeyToAsn1(e.publicKey),w(e)])},s.distinguishedNameToAsn1=function(e){return m(e)},s.certificateToAsn1=function(e){var t=e.tbsCertificate||s.getTBSCertificate(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),b(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},s.certificateExtensionsToAsn1=function(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,3,!0,[]),r=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(s.certificateExtensionToAsn1(e[n]));return t},s.certificateExtensionToAsn1=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.id).getBytes())),e.critical&&t.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!=typeof e.value&&(r=i.toDer(r).getBytes()),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)),t},s.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||s.getCertificationRequestInfo(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),b(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},s.createCaStore=function(e){var t={certs:{}};function r(e){return a(e),t.certs[e.hash]||null}function a(e){if(!e.hash){var t=n.md.sha1.create();e.attributes=s.RDNAttributesAsArray(m(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return r(e.issuer)},t.addCertificate=function(e){if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),a(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];n.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"==typeof e&&(e=n.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;n.util.isArray(t)||(t=[t]);for(var a=i.toDer(s.certificateToAsn1(e)).getBytes(),o=0;o<t.length;++o)if(a===i.toDer(s.certificateToAsn1(t[o])).getBytes())return!0;return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var i=t.certs[r];if(n.util.isArray(i))for(var s=0;s<i.length;++s)e.push(i[s]);else e.push(i)}return e},t.removeCertificate=function(e){var o;if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),a(e.subject),!t.hasCertificate(e))return null;var c=r(e.subject);if(!n.util.isArray(c))return o=t.certs[e.subject.hash],delete t.certs[e.subject.hash],o;for(var u=i.toDer(s.certificateToAsn1(e)).getBytes(),l=0;l<c.length;++l)u===i.toDer(s.certificateToAsn1(c[l])).getBytes()&&(o=c[l],c.splice(l,1));return 0===c.length&&delete t.certs[e.subject.hash],o},e)for(var o=0;o<e.length;++o){var c=e[o];t.addCertificate(c)}return t},s.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},s.verifyCertificateChain=function(e,t,r){"function"==typeof r&&(r={verify:r}),r=r||{};var i=(t=t.slice(0)).slice(0),a=r.validityCheckDate;void 0===a&&(a=new Date);var o=!0,c=null,u=0;do{var l=t.shift(),h=null,f=!1;if(a&&(a<l.validity.notBefore||a>l.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:s.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:a}),null===c){if(null===(h=t[0]||e.getIssuer(l))&&l.isIssuer(l)&&(f=!0,h=l),h){var p=h;n.util.isArray(p)||(p=[p]);for(var y=!1;!y&&p.length>0;){h=p.shift();try{y=h.verify(l)}catch(e){}}y||(c={message:"Certificate signature is invalid.",error:s.certificateError.bad_certificate})}null!==c||h&&!f||e.hasCertificate(l)||(c={message:"Certificate is not trusted.",error:s.certificateError.unknown_ca})}if(null===c&&h&&!l.isIssuer(h)&&(c={message:"Certificate issuer is invalid.",error:s.certificateError.bad_certificate}),null===c)for(var d={keyUsage:!0,basicConstraints:!0},g=0;null===c&&g<l.extensions.length;++g){var m=l.extensions[g];m.critical&&!(m.name in d)&&(c={message:"Certificate has an unsupported critical extension.",error:s.certificateError.unsupported_certificate})}if(null===c&&(!o||0===t.length&&(!h||f))){var v=l.getExtension("basicConstraints"),A=l.getExtension("keyUsage");null!==A&&(A.keyCertSign&&null!==v||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:s.certificateError.bad_certificate})),null!==c||null===v||v.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:s.certificateError.bad_certificate}),null===c&&null!==A&&"pathLenConstraint"in v&&u-1>v.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:s.certificateError.bad_certificate})}var b=null===c||c.error,w=r.verify?r.verify(b,u,i):b;if(!0!==w)throw!0===b&&(c={message:"The application rejected the certificate.",error:s.certificateError.bad_certificate}),(w||0===w)&&("object"!=typeof w||n.util.isArray(w)?"string"==typeof w&&(c.error=w):(w.message&&(c.message=w.message),w.error&&(c.error=w.error))),c;c=null,o=!1,++u}while(t.length>0);return!0}},6370:(e,t,r)=>{var n=r(276);r(7619),n.cipher=n.cipher||{};var i=e.exports=n.cipher.modes=n.cipher.modes||{};function s(e,t){if("string"==typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var r=e;e=n.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!n.util.isArray(e)){var s=[],a=t/4;for(i=0;i<a;++i)s.push(e.getInt32());e=s}return e}function a(e){e[e.length-1]=e[e.length-1]+1&4294967295}function o(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2||(e.truncate(n),0))},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2||(e.truncate(n),0))},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;for(s>0&&(s=this.blockSize-s),this._partialOutput.clear(),i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;for(s>0&&(s=this.blockSize-s),this._partialOutput.clear(),i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var s=(this.blockSize-n)%this.blockSize;for(s>0&&(s=this.blockSize-s),this._partialOutput.clear(),i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;for(s>0&&(s=this.blockSize-s),this._partialOutput.clear(),i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}a(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=r.length();if(12===i)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(o(8*i)))}this._inBlock=this._j0.slice(0),a(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=o(8*t.length());var s=t.length()%this.blockSize;for(s&&t.fillWithByte(0,this.blockSize-s),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;for(s>0&&(s=this.blockSize-s),this._partialOutput.clear(),i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),a(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),a(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var i=this._aDataLength.concat(o(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var s=[];this.cipher.encrypt(this._j0,s);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^s[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i)e[i/32|0]&1<<31-i%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n);return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,i=this._m[r][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),a=0;a<i;++a){var o=[0,0,0,0],c=(n-1-a%n)*t;o[a/n|0]=1<<t-1<<c,s[a]=this.generateSubHashTable(this.multiply(o,e),t)}return s},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var o=i[s],c=i[a];i[s+a]=[o[0]^c[0],o[1]^c[1],o[2]^c[2],o[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i}},6418:(e,t,r)=>{var n=r(276);n.pki=n.pki||{};var i=e.exports=n.pki.oids=n.oids=n.oids||{};function s(e,t){i[e]=t,i[t]=e}function a(e,t){i[e]=t}s("1.2.840.113549.1.1.1","rsaEncryption"),s("1.2.840.113549.1.1.4","md5WithRSAEncryption"),s("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),s("1.2.840.113549.1.1.7","RSAES-OAEP"),s("1.2.840.113549.1.1.8","mgf1"),s("1.2.840.113549.1.1.9","pSpecified"),s("1.2.840.113549.1.1.10","RSASSA-PSS"),s("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),s("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),s("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),s("1.3.101.112","EdDSA25519"),s("1.2.840.10040.4.3","dsa-with-sha1"),s("1.3.14.3.2.7","desCBC"),s("1.3.14.3.2.26","sha1"),s("1.3.14.3.2.29","sha1WithRSASignature"),s("2.16.840.1.101.3.4.2.1","sha256"),s("2.16.840.1.101.3.4.2.2","sha384"),s("2.16.840.1.101.3.4.2.3","sha512"),s("2.16.840.1.101.3.4.2.4","sha224"),s("2.16.840.1.101.3.4.2.5","sha512-224"),s("2.16.840.1.101.3.4.2.6","sha512-256"),s("1.2.840.113549.2.2","md2"),s("1.2.840.113549.2.5","md5"),s("1.2.840.113549.1.7.1","data"),s("1.2.840.113549.1.7.2","signedData"),s("1.2.840.113549.1.7.3","envelopedData"),s("1.2.840.113549.1.7.4","signedAndEnvelopedData"),s("1.2.840.113549.1.7.5","digestedData"),s("1.2.840.113549.1.7.6","encryptedData"),s("1.2.840.113549.1.9.1","emailAddress"),s("1.2.840.113549.1.9.2","unstructuredName"),s("1.2.840.113549.1.9.3","contentType"),s("1.2.840.113549.1.9.4","messageDigest"),s("1.2.840.113549.1.9.5","signingTime"),s("1.2.840.113549.1.9.6","counterSignature"),s("1.2.840.113549.1.9.7","challengePassword"),s("1.2.840.113549.1.9.8","unstructuredAddress"),s("1.2.840.113549.1.9.14","extensionRequest"),s("1.2.840.113549.1.9.20","friendlyName"),s("1.2.840.113549.1.9.21","localKeyId"),s("1.2.840.113549.1.9.22.1","x509Certificate"),s("1.2.840.113549.1.12.10.1.1","keyBag"),s("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),s("1.2.840.113549.1.12.10.1.3","certBag"),s("1.2.840.113549.1.12.10.1.4","crlBag"),s("1.2.840.113549.1.12.10.1.5","secretBag"),s("1.2.840.113549.1.12.10.1.6","safeContentsBag"),s("1.2.840.113549.1.5.13","pkcs5PBES2"),s("1.2.840.113549.1.5.12","pkcs5PBKDF2"),s("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),s("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),s("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),s("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),s("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),s("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),s("1.2.840.113549.2.7","hmacWithSHA1"),s("1.2.840.113549.2.8","hmacWithSHA224"),s("1.2.840.113549.2.9","hmacWithSHA256"),s("1.2.840.113549.2.10","hmacWithSHA384"),s("1.2.840.113549.2.11","hmacWithSHA512"),s("1.2.840.113549.3.7","des-EDE3-CBC"),s("2.16.840.1.101.3.4.1.2","aes128-CBC"),s("2.16.840.1.101.3.4.1.22","aes192-CBC"),s("2.16.840.1.101.3.4.1.42","aes256-CBC"),s("2.5.4.3","commonName"),s("2.5.4.4","surname"),s("2.5.4.5","serialNumber"),s("2.5.4.6","countryName"),s("2.5.4.7","localityName"),s("2.5.4.8","stateOrProvinceName"),s("2.5.4.9","streetAddress"),s("2.5.4.10","organizationName"),s("2.5.4.11","organizationalUnitName"),s("2.5.4.12","title"),s("2.5.4.13","description"),s("2.5.4.15","businessCategory"),s("2.5.4.17","postalCode"),s("2.5.4.42","givenName"),s("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),s("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),s("2.16.840.1.113730.1.1","nsCertType"),s("2.16.840.1.113730.1.13","nsComment"),a("2.5.29.1","authorityKeyIdentifier"),a("2.5.29.2","keyAttributes"),a("2.5.29.3","certificatePolicies"),a("2.5.29.4","keyUsageRestriction"),a("2.5.29.5","policyMapping"),a("2.5.29.6","subtreesConstraint"),a("2.5.29.7","subjectAltName"),a("2.5.29.8","issuerAltName"),a("2.5.29.9","subjectDirectoryAttributes"),a("2.5.29.10","basicConstraints"),a("2.5.29.11","nameConstraints"),a("2.5.29.12","policyConstraints"),a("2.5.29.13","basicConstraints"),s("2.5.29.14","subjectKeyIdentifier"),s("2.5.29.15","keyUsage"),a("2.5.29.16","privateKeyUsagePeriod"),s("2.5.29.17","subjectAltName"),s("2.5.29.18","issuerAltName"),s("2.5.29.19","basicConstraints"),a("2.5.29.20","cRLNumber"),a("2.5.29.21","cRLReason"),a("2.5.29.22","expirationDate"),a("2.5.29.23","instructionCode"),a("2.5.29.24","invalidityDate"),a("2.5.29.25","cRLDistributionPoints"),a("2.5.29.26","issuingDistributionPoint"),a("2.5.29.27","deltaCRLIndicator"),a("2.5.29.28","issuingDistributionPoint"),a("2.5.29.29","certificateIssuer"),a("2.5.29.30","nameConstraints"),s("2.5.29.31","cRLDistributionPoints"),s("2.5.29.32","certificatePolicies"),a("2.5.29.33","policyMappings"),a("2.5.29.34","policyConstraints"),s("2.5.29.35","authorityKeyIdentifier"),a("2.5.29.36","policyConstraints"),s("2.5.29.37","extKeyUsage"),a("2.5.29.46","freshestCRL"),a("2.5.29.54","inhibitAnyPolicy"),s("1.3.6.1.4.1.11129.2.4.2","timestampList"),s("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),s("1.3.6.1.5.5.7.3.1","serverAuth"),s("1.3.6.1.5.5.7.3.2","clientAuth"),s("1.3.6.1.5.5.7.3.3","codeSigning"),s("1.3.6.1.5.5.7.3.4","emailProtection"),s("1.3.6.1.5.5.7.3.8","timeStamping")},7439:(e,t,r)=>{const n=r(2828),i=r(5960),s=r(761).b,a=r(2666),o=r(3297);class c{constructor(e,t){this.point=e,this.curve=t}toString(e=!1){let t=n.stringFromNumber(this.point.x,this.curve.length()),r=n.stringFromNumber(this.point.y,this.curve.length());return e?"\0"+t+r:t+r}toDer(){let e=a.encodeSequence(a.encodeOid([1,2,840,10045,2,1]),a.encodeOid(this.curve.oid));return a.encodeSequence(e,a.encodeBitstring(this.toString(!0)))}toPem(){return a.toPem(this.toDer(),"PUBLIC KEY")}static fromPem(e){return this.fromDer(a.fromPem(e))}static fromDer(e){let t=a.removeSequence(e),r=t[0],s=t[1];if(s)throw new Error("trailing junk after DER public key: "+n.hexFromBinary(s));t=a.removeSequence(r);let o=t[0],c=t[1];t=a.removeObject(o);let u=t[1];t=a.removeObject(u);let l=t[0];if(s=t[1],s)throw new Error("trailing junk after DER public key objects: "+n.hexFromBinary(s));let h=i.curvesByOid[l];if(!h){let e=[];throw i.supportedCurves.forEach((t=>{e.push(t.name)})),new Error("Unknown curve with oid "+l+". Only the following are available: "+e)}t=a.removeBitString(c);let f=t[0];if(s=t[1],s)throw new Error("trailing junk after public key point-string: "+n.hexFromBinary(s));return this.fromString(f.slice(2),h)}static fromString(e,t=i.secp256k1,r=!0){let a=t.length(),u=e.slice(null,a),l=e.slice(a),h=new s(n.numberFromString(u),n.numberFromString(l)),f=new c(h,t);if(!r)return f;if(h.isAtInfinity())throw new Error("Public Key point is at infinity");if(!t.contains(h))throw new Error("point ("+h.x+","+h.y+") is not valid for curve "+t.name);if(!o.multiply(h,t.N,t.N,t.A,t.P).isAtInfinity())throw new Error("Point ("+h.x+","+h.y+" * "+t.name+".N is not at infinity");return f}}t.PublicKey=c},7501:(e,t,r)=>{var n=r(276);r(7619),r(9356),r(1598);var i=e.exports=n.pkcs1=n.pkcs1||{};function s(e,t,r){r||(r=n.md.sha1.create());for(var i="",s=Math.ceil(t/r.digestLength),a=0;a<s;++a){var o=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,255&a);r.start(),r.update(e+o),i+=r.digest().getBytes()}return i.substring(0,t)}i.encode_rsa_oaep=function(e,t,r){var i,a,o,c;"string"==typeof r?(i=r,a=arguments[3]||void 0,o=arguments[4]||void 0):r&&(i=r.label||void 0,a=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),o?o.start():o=n.md.sha1.create(),c||(c=o);var u=Math.ceil(e.n.bitLength()/8),l=u-2*o.digestLength-2;if(t.length>l)throw(g=new Error("RSAES-OAEP input message length is too long.")).length=t.length,g.maxLength=l,g;i||(i=""),o.update(i,"raw");for(var h=o.digest(),f="",p=l-t.length,y=0;y<p;y++)f+="\0";var d=h.getBytes()+f+""+t;if(a){if(a.length!==o.digestLength){var g;throw(g=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=a.length,g.digestLength=o.digestLength,g}}else a=n.random.getBytes(o.digestLength);var m=s(a,u-o.digestLength-1,c),v=n.util.xorBytes(d,m,d.length),A=s(v,o.digestLength,c);return"\0"+n.util.xorBytes(a,A,a.length)+v},i.decode_rsa_oaep=function(e,t,r){var i,a,o;"string"==typeof r?(i=r,a=arguments[3]||void 0):r&&(i=r.label||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(m=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,m.expectedLength=c,m;if(void 0===a?a=n.md.sha1.create():a.start(),o||(o=a),c<2*a.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),a.update(i,"raw");for(var u=a.digest().getBytes(),l=t.charAt(0),h=t.substring(1,a.digestLength+1),f=t.substring(1+a.digestLength),p=s(f,a.digestLength,o),y=s(n.util.xorBytes(h,p,h.length),c-a.digestLength-1,o),d=n.util.xorBytes(f,y,f.length),g=d.substring(0,a.digestLength),m="\0"!==l,v=0;v<a.digestLength;++v)m|=u.charAt(v)!==g.charAt(v);for(var A=1,b=a.digestLength,w=a.digestLength;w<d.length;w++){var E=d.charCodeAt(w);m|=E&(A?65534:0),b+=A&=1&E^1}if(m||1!==d.charCodeAt(b))throw new Error("Invalid RSAES-OAEP padding.");return d.substring(b+1)}},7526:(e,t)=>{"use strict";t.byteLength=function(e){var t=o(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=o(e),a=s[0],c=s[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,c)),l=0,h=c>0?a-4:a;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[l++]=255&t),1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],a=16383,o=0,u=n-i;o<u;o+=a)s.push(c(e,o,o+a>u?u:o+a));return 1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=s[a],n[s.charCodeAt(a)]=a;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var i,s,a=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},7619:(e,t,r)=>{var n=r(5606),i=r(2363).Buffer,s=r(276),a=r(4058),o=e.exports=s.util=s.util||{};function c(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function u(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(o.isArrayBuffer(e)||o.isArrayBufferView(e))if(void 0!==i&&e instanceof i)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof u||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if(void 0!==n&&n.nextTick&&!n.browser)return o.nextTick=n.nextTick,void("function"==typeof setImmediate?o.setImmediate=setImmediate:o.setImmediate=o.nextTick);if("function"==typeof setImmediate)return o.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(o.nextTick=function(e){return setImmediate(e)});if(o.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",t=[];o.setImmediate=function(r){t.push(r),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",(function(r){if(r.source===window&&r.data===e){r.stopPropagation();var n=t.slice();t.length=0,n.forEach((function(e){e()}))}}),!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),i=!0,s=document.createElement("div");t=[],new MutationObserver((function(){var e=t.slice();t.length=0,e.forEach((function(e){e()}))})).observe(s,{attributes:!0});var a=o.setImmediate;o.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),a(e)):(t.push(e),1===t.length&&s.setAttribute("a",i=!i))}}o.nextTick=o.setImmediate}(),o.isNodejs=void 0!==n&&n.versions&&n.versions.node,o.globalScope=o.isNodejs?r.g:"undefined"==typeof self?window:self,o.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},o.isArrayBufferView=function(e){return e&&o.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},o.ByteBuffer=u,o.ByteStringBuffer=u,o.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},o.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},o.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},o.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},o.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},o.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},o.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(o.encodeUtf8(e))},o.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},o.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},o.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},o.ByteStringBuffer.prototype.putInt=function(e,t){c(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},o.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},o.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},o.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},o.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},o.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},o.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},o.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},o.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},o.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},o.ByteStringBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},o.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},o.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},o.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},o.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},o.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},o.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},o.ByteStringBuffer.prototype.copy=function(){var e=o.createBuffer(this.data);return e.read=this.read,e},o.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},o.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},o.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},o.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},o.ByteStringBuffer.prototype.toString=function(){return o.decodeUtf8(this.bytes())},o.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=o.isArrayBuffer(e),n=o.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},o.DataBuffer.prototype.length=function(){return this.write-this.read},o.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},o.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},o.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},o.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},o.DataBuffer.prototype.putBytes=function(e,t){if(o.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(o.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof o.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&o.isArrayBufferView(e.data))return n=new Uint8Array(e.data.byteLength,e.read,e.length()),this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this;if(e instanceof o.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=o.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=o.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},o.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},o.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},o.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},o.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},o.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},o.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},o.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},o.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},o.DataBuffer.prototype.putInt=function(e,t){c(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},o.DataBuffer.prototype.putSignedInt=function(e,t){return c(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},o.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},o.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},o.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},o.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},o.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},o.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},o.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},o.DataBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},o.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},o.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},o.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},o.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},o.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},o.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},o.DataBuffer.prototype.copy=function(){return new o.DataBuffer(this)},o.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},o.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},o.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},o.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},o.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return o.binary.raw.encode(t);if("hex"===e)return o.binary.hex.encode(t);if("base64"===e)return o.binary.base64.encode(t);if("utf8"===e)return o.text.utf8.decode(t);if("utf16"===e)return o.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},o.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=o.encodeUtf8(e)),new o.ByteBuffer(e)},o.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},o.xorBytes=function(e,t,r){for(var n="",i="",s="",a=0,o=0;r>0;--r,++a)i=e.charCodeAt(a)^t.charCodeAt(a),o>=10&&(n+=s,s="",o=0),s+=String.fromCharCode(i),++o;return n+s},o.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},o.bytesToHex=function(e){return o.createBuffer(e).toHex()},o.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],f="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";o.encode64=function(e,t){for(var r,n,i,s="",a="",o=0;o<e.length;)r=e.charCodeAt(o++),n=e.charCodeAt(o++),i=e.charCodeAt(o++),s+=l.charAt(r>>2),s+=l.charAt((3&r)<<4|n>>4),isNaN(n)?s+="==":(s+=l.charAt((15&n)<<2|i>>6),s+=isNaN(i)?"=":l.charAt(63&i)),t&&s.length>t&&(a+=s.substr(0,t)+"\r\n",s=s.substr(t));return a+s},o.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,s="",a=0;a<e.length;)t=h[e.charCodeAt(a++)-43],r=h[e.charCodeAt(a++)-43],n=h[e.charCodeAt(a++)-43],i=h[e.charCodeAt(a++)-43],s+=String.fromCharCode(t<<2|r>>4),64!==n&&(s+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(s+=String.fromCharCode((3&n)<<6|i)));return s},o.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},o.decodeUtf8=function(e){return decodeURIComponent(escape(e))},o.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:a.encode,decode:a.decode}},o.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},o.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n},o.binary.hex.encode=o.bytesToHex,o.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var i=0,s=r=r||0;for(1&e.length&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n},o.binary.base64.encode=function(e,t){for(var r,n,i,s="",a="",o=0;o<e.byteLength;)r=e[o++],n=e[o++],i=e[o++],s+=l.charAt(r>>2),s+=l.charAt((3&r)<<4|n>>4),isNaN(n)?s+="==":(s+=l.charAt((15&n)<<2|i>>6),s+=isNaN(i)?"=":l.charAt(63&i)),t&&s.length>t&&(a+=s.substr(0,t)+"\r\n",s=s.substr(t));return a+s},o.binary.base64.decode=function(e,t,r){var n,i,s,a,o=t;o||(o=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var c=0,u=r=r||0;c<e.length;)n=h[e.charCodeAt(c++)-43],i=h[e.charCodeAt(c++)-43],s=h[e.charCodeAt(c++)-43],a=h[e.charCodeAt(c++)-43],o[u++]=n<<2|i>>4,64!==s&&(o[u++]=(15&i)<<4|s>>2,64!==a&&(o[u++]=(3&s)<<6|a));return t?u-r:o.subarray(0,u)},o.binary.base58.encode=function(e,t){return o.binary.baseN.encode(e,f,t)},o.binary.base58.decode=function(e,t){return o.binary.baseN.decode(e,f,t)},o.text={utf8:{},utf16:{}},o.text.utf8.encode=function(e,t,r){e=o.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n},o.text.utf8.decode=function(e){return o.decodeUtf8(String.fromCharCode.apply(null,e))},o.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var i=new Uint16Array(n.buffer),s=r=r||0,a=r,o=0;o<e.length;++o)i[a++]=e.charCodeAt(o),s+=2;return t?s-r:n},o.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},o.deflate=function(e,t,r){if(t=o.decode64(e.deflate(o.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},o.inflate=function(e,t,r){var n=e.inflate(o.encode64(t)).rval;return null===n?null:o.decode64(n)};var p=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=o.encode64(JSON.stringify(r)),n=e.setItem(t,r)),void 0!==n&&!0!==n.rval){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},y=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(o.decode64(r))),r},d=function(e,t,r,n){var i=y(e,t);null===i&&(i={}),i[r]=n,p(e,t,i)},g=function(e,t,r){var n=y(e,t);return null!==n&&(n=r in n?n[r]:null),n},m=function(e,t,r){var n=y(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),p(e,t,n)}},v=function(e,t){p(e,t,null)},A=function(e,t,r){var n,i=null;void 0===r&&(r=["web","flash"]);var s=!1,a=null;for(var o in r){n=r[o];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),s="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),s=!0)}catch(e){a=e}if(s)break}if(!s)throw a;return i};o.setItem=function(e,t,r,n,i){A(d,arguments,i)},o.getItem=function(e,t,r,n){return A(g,arguments,n)},o.removeItem=function(e,t,r,n){A(m,arguments,n)},o.clearItems=function(e,t,r){A(v,arguments,r)},o.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},o.format=function(e){for(var t,r,n=/%./g,i=0,s=[],a=0;t=n.exec(e);){(r=e.substring(a,n.lastIndex-2)).length>0&&s.push(r),a=n.lastIndex;var o=t[0][1];switch(o){case"s":case"o":i<arguments.length?s.push(arguments[1+i++]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(e.substring(a)),s.join("")},o.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,a=void 0===r?",":r,o=void 0===n?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+o:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(i-u).toFixed(s).slice(2):"")},o.formatSize=function(e){return e>=1073741824?o.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?o.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?o.formatNumber(e/1024,0)+" KiB":o.formatNumber(e,0)+" bytes"},o.bytesFromIP=function(e){return-1!==e.indexOf(".")?o.bytesFromIPv4(e):-1!==e.indexOf(":")?o.bytesFromIPv6(e):null},o.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=o.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},o.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}))).length+t),n=o.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var s=o.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}else n.fillWithByte(0,r),r=0;return n.getBytes()},o.bytesToIP=function(e){return 4===e.length?o.bytesToIPv4(e):16===e.length?o.bytesToIPv6(e):null},o.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},o.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=o.bytesToHex(e[i]+e[i+1]);"0"===s[0]&&"0"!==s;)s=s.substr(1);if("0"===s){var a=r[r.length-1],c=t.length;a&&c===a.end+1?(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:c,end:c})}t.push(s)}if(r.length>0){var u=r[n];u.end-u.start>0&&(t.splice(u.start,u.end-u.start+1,""),0===u.start&&t.unshift(""),7===u.end&&t.push(""))}return t.join(":")},o.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in o&&!e.update)return t(null,o.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return o.cores=navigator.hardwareConcurrency,t(null,o.cores);if("undefined"==typeof Worker)return o.cores=1,t(null,o.cores);if("undefined"==typeof Blob)return o.cores=2,t(null,o.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));!function e(n,i,s){if(0===i){var a=Math.floor(n.reduce((function(e,t){return e+t}),0)/n.length);return o.cores=Math.max(1,a),URL.revokeObjectURL(r),t(null,o.cores)}!function(e,t){for(var n=[],i=[],s=0;s<e;++s){var a=new Worker(r);a.addEventListener("message",(function(r){if(i.push(r.data),i.length===e){for(var s=0;s<e;++s)n[s].terminate();t(0,i)}})),n.push(a)}for(s=0;s<e;++s)n[s].postMessage(s)}(s,(function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],s=r[n]=[],a=0;a<e;++a)if(n!==a){var o=t[a];(i.st>o.st&&i.st<o.et||o.st>i.st&&o.st<i.et)&&s.push(a)}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}(s,r)),e(n,i-1,s)}))}([],5,16)}},8106:(e,t,r)=>{var n=r(276);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},8287:(e,t,r)=>{"use strict";const n=r(7526),i=r(251),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.hp=c,t.IS=50;const a=2147483647;function o(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|d(e,t);let n=o(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(W(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(W(e,ArrayBuffer)||e&&W(e.buffer,ArrayBuffer))return p(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(W(e,SharedArrayBuffer)||e&&W(e.buffer,SharedArrayBuffer)))return p(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);const i=function(e){if(c.isBuffer(e)){const t=0|y(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Y(e.length)?o(0):f(e):"Buffer"===e.type&&Array.isArray(e.data)?f(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return l(e),o(e<0?0:0|y(e))}function f(e){const t=e.length<0?0:0|y(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function p(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function y(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function d(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||W(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(i)return n?-1:z(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return U(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return N(this,t,r);case"base64":return B(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function m(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:A(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):A(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function A(e,t,r,n,i){let s,a=1,o=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,o/=2,c/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let n=-1;for(s=r;s<o;s++)if(u(e,s)===u(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*a}else-1!==n&&(s-=s-n),n=-1}else for(r+c>o&&(r=o-c),s=r;s>=0;s--){let r=!0;for(let n=0;n<c;n++)if(u(e,s+n)!==u(t,n)){r=!1;break}if(r)return s}return-1}function b(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let a;for(n>s/2&&(n=s/2),a=0;a<n;++a){const n=parseInt(t.substr(2*a,2),16);if(Y(n))return a;e[r+a]=n}return a}function w(e,t,r,n){return $(z(t,e.length-r),e,r,n)}function E(e,t,r,n){return $(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return $(G(t),e,r,n)}function C(e,t,r,n){return $(function(e,t){let r,n,i;const s=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function B(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=r){let r,n,o,c;switch(a){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(s=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[i+1],n=e[i+2],o=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&o,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(W(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),W(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=c.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(W(t,Uint8Array))i+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const r=t.IS;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if(W(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);const o=Math.min(s,a),u=this.slice(n,i),l=e.slice(t,r);for(let e=0;e<o;++e)if(u[e]!==l[e]){s=u[e],a=l[e];break}return s<a?-1:a<s?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":case"latin1":case"binary":return E(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function T(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function N(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function U(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=J[e[n]];return i}function x(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,i,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function P(e,t,r,n,i){F(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function L(e,t,r,n,i){F(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function _(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function K(e,t,r,n,s){return t=+t,r>>>=0,s||_(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function O(e,t,r,n,s){return t=+t,r>>>=0,s||_(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=X((function(e){j(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=X((function(e){j(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=X((function(e){j(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=X((function(e){j(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=X((function(e,t=0){return P(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=X((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,e,t,r,n-1,-n)}let i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s|0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,e,t,r,n-1,-n)}let i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s|0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=X((function(e,t=0){return P(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=X((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,r){return K(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return K(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return O(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return O(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=c.isBuffer(e)?e:c.from(e,n),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};const M={};function H(e,t,r){M[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function V(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function F(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new M.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){j(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||Q(t,e.length-(r+1))}(n,i,s)}function j(e,t){if("number"!=typeof e)throw new M.ERR_INVALID_ARG_TYPE(t,"number",e)}function Q(e,t,r){if(Math.floor(e)!==e)throw j(e,r),new M.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}H("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),H("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),H("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=V(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=V(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const q=/[^+/0-9A-Za-z-_]/g;function z(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function G(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function W(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function X(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},8416:()=>{},8630:(e,t,r)=>{var n;!function(e){!function(){var t="object"==typeof globalThis?globalThis:"object"==typeof r.g?r.g:"object"==typeof self?self:"object"==typeof this?this:function(){try{return Function("return this;")()}catch(e){}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch(e){}}(),n=i(e);function i(e,t){return function(r,n){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0!==t.Reflect&&(n=i(t.Reflect,n)),function(e,t){var r=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,o={__proto__:[]}instanceof Array,c=!a&&!o,u={create:a?function(){return F(Object.create(null))}:o?function(){return F({__proto__:null})}:function(){return F({})},has:c?function(e,t){return r.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return r.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),h="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,P(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,i)},t.prototype.entries=function(){return new r(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[s]=function(){return this.entries()},t.prototype._find=function(e,t){if(!P(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(P(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function i(e,t){return t}function a(e,t){return[e,t]}}(),f="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}(),p="function"==typeof WeakMap?WeakMap:function(){var e=u.create(),t=n();return function(){function e(){this._key=n()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&u.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?u.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=n()},e}();function n(){var t;do{t="@@WeakMap@@"+a()}while(u.has(e,t));return e[t]=!0,t}function i(e,n){if(!r.call(e,t)){if(!n)return;Object.defineProperty(e,t,{value:u.create()})}return e[t]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(){var e=function(e){if("function"==typeof Uint8Array){var t=new Uint8Array(e);return"undefined"!=typeof crypto?crypto.getRandomValues(t):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(t):s(t,e),t}return s(new Array(e),e)}(16);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var t="",r=0;r<16;++r){var n=e[r];4!==r&&6!==r&&8!==r||(t+="-"),n<16&&(t+="0"),t+=n.toString(16).toLowerCase()}return t}}(),y=n?Symbol.for("@reflect-metadata:registry"):void 0,d=function(){var e;return!B(y)&&k(t.Reflect)&&Object.isExtensible(t.Reflect)&&(e=t.Reflect[y]),B(e)&&(e=function(){var e,r,n,i;B(y)||void 0===t.Reflect||y in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(e=function(e){var t=e.defineMetadata,r=e.hasOwnMetadata,n=e.getOwnMetadata,i=e.getOwnMetadataKeys,s=e.deleteMetadata,a=new p;return{isProviderFor:function(e,t){var r=a.get(e);return!(B(r)||!r.has(t))||!!i(e,t).length&&(B(r)&&(r=new f,a.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:r,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:i,OrdinaryDeleteMetadata:s}}(t.Reflect));var s=new p,a={registerProvider:o,getProvider:u,setProvider:d};return a;function o(t){if(!Object.isExtensible(a))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===t:break;case B(r):r=t;break;case r===t:break;case B(n):n=t;break;case n===t:break;default:void 0===i&&(i=new f),i.add(t)}}function c(t,s){if(!B(r)){if(r.isProviderFor(t,s))return r;if(!B(n)){if(n.isProviderFor(t,s))return r;if(!B(i))for(var a=_(i);;){var o=O(a);if(!o)return;var c=K(o);if(c.isProviderFor(t,s))return M(a),c}}}if(!B(e)&&e.isProviderFor(t,s))return e}function u(e,t){var r,n=s.get(e);return B(n)||(r=n.get(t)),B(r)?(B(r=c(e,t))||(B(n)&&(n=new h,s.set(e,n)),n.set(t,r)),r):r}function l(e){if(B(e))throw new TypeError;return r===e||n===e||!B(i)&&i.has(e)}function d(e,t,r){if(!l(r))throw new Error("Metadata provider not registered.");var n=u(e,t);if(n!==r){if(!B(n))return!1;var i=s.get(e);B(i)&&(i=new h,s.set(e,i)),i.set(t,r)}return!0}}()),!B(y)&&k(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}(),g=function(e){var t=new p,r={isProviderFor:function(e,r){var n=t.get(e);return!B(n)&&n.has(r)},OrdinaryDefineOwnMetadata:function(e,t,r,i){n(r,i,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,r){var i=n(t,r,!1);return!B(i)&&N(i.has(e))},OrdinaryGetOwnMetadata:function(e,t,r){var i=n(t,r,!1);if(!B(i))return i.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var r=[],i=n(e,t,!1);if(B(i))return r;for(var s=_(i.keys()),a=0;;){var o=O(s);if(!o)return r.length=a,r;var c=K(o);try{r[a]=c}catch(e){try{M(s)}finally{throw e}}a++}},OrdinaryDeleteMetadata:function(e,r,i){var s=n(r,i,!1);if(B(s))return!1;if(!s.delete(e))return!1;if(0===s.size){var a=t.get(r);B(a)||(a.delete(i),0===a.size&&t.delete(a))}return!0}};return d.registerProvider(r),r;function n(n,i,s){var a=t.get(n),o=!1;if(B(a)){if(!s)return;a=new h,t.set(n,a),o=!0}var c=a.get(i);if(B(c)){if(!s)return;if(c=new h,a.set(i,c),!e.setProvider(n,i,r))throw a.delete(i),o&&t.delete(n),new Error("Wrong provider for target.")}return c}}(d);function m(e,t,r){if(v(e,t,r))return!0;var n=H(t);return!I(n)&&m(e,n,r)}function v(e,t,r){var n=V(t,r,!1);return!B(n)&&N(n.OrdinaryHasOwnMetadata(e,t,r))}function A(e,t,r){if(v(e,t,r))return b(e,t,r);var n=H(t);return I(n)?void 0:A(e,n,r)}function b(e,t,r){var n=V(t,r,!1);if(!B(n))return n.OrdinaryGetOwnMetadata(e,t,r)}function w(e,t,r,n){V(r,n,!0).OrdinaryDefineOwnMetadata(e,t,r,n)}function E(e,t){var r=S(e,t),n=H(e);if(null===n)return r;var i=E(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var s=new f,a=[],o=0,c=r;o<c.length;o++){var u=c[o];s.has(u)||(s.add(u),a.push(u))}for(var l=0,h=i;l<h.length;l++)u=h[l],s.has(u)||(s.add(u),a.push(u));return a}function S(e,t){var r=V(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function C(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function B(e){return void 0===e}function I(e){return null===e}function k(e){return"object"==typeof e?null!==e:"function"==typeof e}function T(e,t){switch(C(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",n=L(e,i);if(void 0!==n){var s=n.call(e,r);if(k(s))throw new TypeError;return s}return function(e,t){if("string"===t){var r=e.toString;if(D(r)&&!k(i=r.call(e)))return i;if(D(n=e.valueOf)&&!k(i=n.call(e)))return i}else{var n;if(D(n=e.valueOf)&&!k(i=n.call(e)))return i;var i,s=e.toString;if(D(s)&&!k(i=s.call(e)))return i}throw new TypeError}(e,"default"===r?"number":r)}function N(e){return!!e}function U(e){var t=T(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function x(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function D(e){return"function"==typeof e}function R(e){return"function"==typeof e}function P(e,t){return e===t||e!=e&&t!=t}function L(e,t){var r=e[t];if(null!=r){if(!D(r))throw new TypeError;return r}}function _(e){var t=L(e,s);if(!D(t))throw new TypeError;var r=t.call(e);if(!k(r))throw new TypeError;return r}function K(e){return e.value}function O(e){var t=e.next();return!t.done&&t}function M(e){var t=e.return;t&&t.call(e)}function H(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function V(e,t,r){var n=d.getProvider(e,t);if(!B(n))return n;if(r){if(d.setProvider(e,t,g))return g;throw new Error("Illegal state.")}}function F(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,r,n){if(B(r)){if(!x(e))throw new TypeError;if(!R(t))throw new TypeError;return function(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!B(n)&&!I(n)){if(!R(n))throw new TypeError;t=n}}return t}(e,t)}if(!x(e))throw new TypeError;if(!k(t))throw new TypeError;if(!k(n)&&!B(n)&&!I(n))throw new TypeError;return I(n)&&(n=void 0),function(e,t,r,n){for(var i=e.length-1;i>=0;--i){var s=(0,e[i])(t,r,n);if(!B(s)&&!I(s)){if(!k(s))throw new TypeError;n=s}}return n}(e,t,r=U(r),n)})),e("metadata",(function(e,t){return function(r,n){if(!k(r))throw new TypeError;if(!B(n)&&!function(e){switch(C(e)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;w(e,t,r,n)}})),e("defineMetadata",(function(e,t,r,n){if(!k(r))throw new TypeError;return B(n)||(n=U(n)),w(e,t,r,n)})),e("hasMetadata",(function(e,t,r){if(!k(t))throw new TypeError;return B(r)||(r=U(r)),m(e,t,r)})),e("hasOwnMetadata",(function(e,t,r){if(!k(t))throw new TypeError;return B(r)||(r=U(r)),v(e,t,r)})),e("getMetadata",(function(e,t,r){if(!k(t))throw new TypeError;return B(r)||(r=U(r)),A(e,t,r)})),e("getOwnMetadata",(function(e,t,r){if(!k(t))throw new TypeError;return B(r)||(r=U(r)),b(e,t,r)})),e("getMetadataKeys",(function(e,t){if(!k(e))throw new TypeError;return B(t)||(t=U(t)),E(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!k(e))throw new TypeError;return B(t)||(t=U(t)),S(e,t)})),e("deleteMetadata",(function(e,t,r){if(!k(t))throw new TypeError;if(B(r)||(r=U(r)),!k(t))throw new TypeError;B(r)||(r=U(r));var n=V(t,r,!1);return!B(n)&&n.OrdinaryDeleteMetadata(e,t,r)}))}(n,t),void 0===t.Reflect&&(t.Reflect=e)}()}(n||(n={}))},8678:(e,t,r)=>{var n=r(276);r(9504),r(3986);var i=e.exports=n.tls;function s(e,t,r){var s=t.entity===n.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:n.cipher.createDecipher("AES-CBC",s?r.keys.server_write_key:r.keys.client_write_key),iv:s?r.keys.server_write_IV:r.keys.client_write_IV},e.write.cipherState={init:!1,cipher:n.cipher.createCipher("AES-CBC",s?r.keys.client_write_key:r.keys.server_write_key),iv:s?r.keys.client_write_IV:r.keys.server_write_IV},e.read.cipherFunction=u,e.write.cipherFunction=a,e.read.macLength=e.write.macLength=r.mac_length,e.read.macFunction=e.write.macFunction=i.hmac_sha1}function a(e,t){var r,s=!1,a=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(a),t.updateSequenceNumber(),r=e.version.minor===i.Versions.TLS_1_0.minor?t.cipherState.init?null:t.cipherState.iv:n.random.getBytesSync(16),t.cipherState.init=!0;var c=t.cipherState.cipher;return c.start({iv:r}),e.version.minor>=i.Versions.TLS_1_1.minor&&c.output.putBytes(r),c.update(e.fragment),c.finish(o)&&(e.fragment=c.output,e.length=e.fragment.length(),s=!0),s}function o(e,t,r){if(!r){var n=e-t.length()%e;t.fillWithByte(n-1,n)}return!0}function c(e,t,r){var n=!0;if(r){for(var i=t.length(),s=t.last(),a=i-1-s;a<i-1;++a)n=n&&t.at(a)==s;n&&t.truncate(s+1)}return n}function u(e,t){var r,s=!1;r=e.version.minor===i.Versions.TLS_1_0.minor?t.cipherState.init?null:t.cipherState.iv:e.fragment.getBytes(16),t.cipherState.init=!0;var a=t.cipherState.cipher;a.start({iv:r}),a.update(e.fragment),s=a.finish(c);var o=t.macLength,u=n.random.getBytesSync(o),l=a.output.length();l>=o?(e.fragment=a.output.getBytes(l-o),u=a.output.getBytes(o)):e.fragment=a.output.getBytes(),e.fragment=n.util.createBuffer(e.fragment),e.length=e.fragment.length();var h=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),s=function(e,t,r){var i=n.hmac.create();return i.start("SHA1",e),i.update(t),t=i.digest().getBytes(),i.start(null,null),i.update(r),t===(r=i.digest().getBytes())}(t.macKey,u,h)&&s,s}i.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,e.cipher_type=i.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=i.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:s},i.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,e.cipher_type=i.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=i.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:s}},9095:(e,t,r)=>{var n=r(276);function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.des.Algorithm(e,t)}))}r(3900),r(6370),r(7619),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var i=y({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createEncryptionCipher=function(e,t){return y({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var i=y({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createDecryptionCipher=function(e,t){return y({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return p(r._keys,e,t,!1)},decrypt:function(e,t){return p(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,m=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],A=0,b=0;b<g;b++){var w=e.getInt32(),E=e.getInt32();w^=(t=252645135&(w>>>4^E))<<4,w^=t=65535&((E^=t)>>>-16^w),w^=(t=858993459&(w>>>2^(E^=t<<-16)))<<2,w^=t=65535&((E^=t)>>>-16^w),w^=(t=1431655765&(w>>>1^(E^=t<<-16)))<<1,w^=t=16711935&((E^=t)>>>8^w),t=(w^=(t=1431655765&(w>>>1^(E^=t<<8)))<<1)<<8|(E^=t)>>>20&240,w=E<<24|E<<8&16711680|E>>>8&65280|E>>>24&240,E=t;for(var S=0;S<v.length;++S){v[S]?(w=w<<2|w>>>26,E=E<<2|E>>>26):(w=w<<1|w>>>27,E=E<<1|E>>>27);var C=r[(w&=-15)>>>28]|n[w>>>24&15]|i[w>>>20&15]|s[w>>>16&15]|a[w>>>12&15]|o[w>>>8&15]|c[w>>>4&15],B=u[(E&=-15)>>>28]|l[E>>>24&15]|h[E>>>20&15]|f[E>>>16&15]|p[E>>>12&15]|y[E>>>8&15]|d[E>>>4&15];t=65535&(B>>>16^C),m[A++]=C^t,m[A++]=B^t<<16}}return m}(t),this._init=!0}},i("DES-ECB",n.cipher.modes.ecb),i("DES-CBC",n.cipher.modes.cbc),i("DES-CFB",n.cipher.modes.cfb),i("DES-OFB",n.cipher.modes.ofb),i("DES-CTR",n.cipher.modes.ctr),i("3DES-ECB",n.cipher.modes.ecb),i("3DES-CBC",n.cipher.modes.cbc),i("3DES-CFB",n.cipher.modes.cfb),i("3DES-OFB",n.cipher.modes.ofb),i("3DES-CTR",n.cipher.modes.ctr);var s=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],a=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],o=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function p(e,t,r,n){var i,p,y=32===e.length?3:9;i=3===y?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var d=t[0],g=t[1];d^=(p=252645135&(d>>>4^g))<<4,d^=(p=65535&(d>>>16^(g^=p)))<<16,d^=p=858993459&((g^=p)>>>2^d),d^=p=16711935&((g^=p<<2)>>>8^d),d=(d^=(p=1431655765&(d>>>1^(g^=p<<8)))<<1)<<1|d>>>31,g=(g^=p)<<1|g>>>31;for(var m=0;m<y;m+=3){for(var v=i[m+1],A=i[m+2],b=i[m];b!=v;b+=A){var w=g^e[b],E=(g>>>4|g<<28)^e[b+1];p=d,d=g,g=p^(a[w>>>24&63]|c[w>>>16&63]|l[w>>>8&63]|f[63&w]|s[E>>>24&63]|o[E>>>16&63]|u[E>>>8&63]|h[63&E])}p=d,d=g,g=p}g=g>>>1|g<<31,g^=p=1431655765&((d=d>>>1|d<<31)>>>1^g),g^=(p=16711935&(g>>>8^(d^=p<<1)))<<8,g^=(p=858993459&(g>>>2^(d^=p)))<<2,g^=p=65535&((d^=p)>>>16^g),g^=p=252645135&((d^=p<<16)>>>4^g),d^=p<<4,r[0]=d,r[1]=g}function y(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var s=null;r instanceof n.util.ByteBuffer&&(s=r,r={}),(r=r||{}).output=s,r.iv=e,i.call(t,r)},t}},9181:(e,t,r)=>{r(7439).PublicKey,r(5383),r(2828),r(5960),r(3297),r(2096),r(2666)},9255:(e,t,r)=>{var n=r(276);r(2746),r(6418),r(2698),r(2385),r(3254),r(5071),r(1417),r(5805),r(7619),r(6011);var i=n.asn1,s=e.exports=n.pki=n.pki||{};s.pemToDer=function(e){var t=n.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(t.body)},s.privateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var a=i.fromDer(t.body);return s.privateKeyFromAsn1(a)},s.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:i.toDer(s.privateKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:i.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})}},9343:(e,t,r)=>{var n=r(276);r(9504),r(2746),r(9095),r(6418),r(2385),r(9954),r(9356),r(7619),r(6011);var i=n.asn1,s=e.exports=n.pkcs7=n.pkcs7||{};function a(e){var t={},r=[];if(!i.validate(e,s.asn1.recipientInfoValidator,t,r)){var a=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw a.errors=r,a}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function o(e){for(var t,r=[],s=0;s<e.length;++s)r.push((t=e[s],i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:t.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(t.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function c(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[]),s=0;s<e.unauthenticatedAttributes.length;++s){var a=e.unauthenticatedAttributes[s];r.values.push(u(a))}t.value.push(r)}return t}function u(e){var t;if(e.type===n.pki.oids.contentType)t=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.value).getBytes());else if(e.type===n.pki.oids.messageDigest)t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===n.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),s=new Date("2050-01-01T00:00:00Z"),a=e.value;if("string"==typeof a){var o=Date.parse(a);a=isNaN(o)?13===a.length?i.utcTimeToDate(a):i.generalizedTimeToDate(a):new Date(o)}t=a>=r&&a<s?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(a)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(a))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[t])])}function l(e,t,r){var s={};if(!i.validate(t,r,s,[])){var a=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw a.errors=a,a}if(i.derToOid(s.contentType)!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(s.encryptedContent){var o="";if(n.util.isArray(s.encryptedContent))for(var c=0;c<s.encryptedContent.length;++c){if(s.encryptedContent[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=s.encryptedContent[c].value}else o=s.encryptedContent;e.encryptedContent={algorithm:i.derToOid(s.encAlgorithm),parameter:n.util.createBuffer(s.encParameter.value),content:n.util.createBuffer(o)}}if(s.content){if(o="",n.util.isArray(s.content))for(c=0;c<s.content.length;++c){if(s.content[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=s.content[c].value}else o=s.content;e.content=n.util.createBuffer(o)}return e.version=s.version.charCodeAt(0),e.rawCapture=s,s}function h(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:t=n.aes.createDecryptionCipher(e.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:t=n.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}s.messageFromPem=function(e){var t=n.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var a=i.fromDer(t.body);return s.messageFromAsn1(a)},s.messageToPem=function(e,t){var r={type:"PKCS7",body:i.toDer(e.toAsn1()).getBytes()};return n.pem.encode(r,{maxline:t})},s.messageFromAsn1=function(e){var t={},r=[];if(!i.validate(e,s.asn1.contentInfoValidator,t,r)){var a=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw a.errors=r,a}var o,c=i.derToOid(t.contentType);switch(c){case n.pki.oids.envelopedData:o=s.createEnvelopedData();break;case n.pki.oids.encryptedData:o=s.createEncryptedData();break;case n.pki.oids.signedData:o=s.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return o.fromAsn1(t.content.value[0]),o},s.createSignedData=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(l(e,t,s.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,i=0;i<r.length;++i)e.certificates.push(n.pki.certificateFromAsn1(r[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(n.pki.certificateToAsn1(e.certificates[r]));var s=[],a=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&a.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,t)),s.length>0&&a.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,s)),a.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.signerInfos)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),a])},addSigner:function(t){var r=t.issuer,i=t.serialNumber;if(t.certificate){var s=t.certificate;"string"==typeof s&&(s=n.pki.certificateFromPem(s)),r=s.issuer.attributes,i=s.serialNumber}var a=t.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof a&&(a=n.pki.privateKeyFromPem(a));var o=t.digestAlgorithm||n.pki.oids.sha1;switch(o){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+o)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var u=!1,l=!1,h=0;h<c.length;++h){var f=c[h];if(u||f.type!==n.pki.oids.contentType){if(l||f.type!==n.pki.oids.messageDigest);else if(l=!0,u)break}else if(u=!0,l)break}if(!u||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:a,version:1,issuer:r,serialNumber:i,digestAlgorithm:o,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(t){var r;t=t||{},("object"!=typeof e.content||null===e.contentInfo)&&(e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof n.util.ByteBuffer?r=e.content.bytes():"string"==typeof e.content&&(r=n.util.encodeUtf8(e.content)),t.detached?e.detachedContent=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r):e.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)])))),0!==e.signers.length&&function(t){var r;if(!(r=e.detachedContent?e.detachedContent:(r=e.contentInfo.value[1]).value[0]))throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=i.derToOid(e.contentInfo.value[0].value),a=i.toDer(r);for(var o in a.getByte(),i.getBerValueLength(a),a=a.getBytes(),t)t[o].start().update(a);for(var l=new Date,h=0;h<e.signers.length;++h){var f=e.signers[h];if(0===f.authenticatedAttributes.length){if(s!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var p=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),y=0;y<f.authenticatedAttributes.length;++y){var d=f.authenticatedAttributes[y];d.type===n.pki.oids.messageDigest?d.value=t[f.digestAlgorithm].digest():d.type===n.pki.oids.signingTime&&(d.value||(d.value=l)),p.value.push(u(d)),f.authenticatedAttributesAsn1.value.push(u(d))}a=i.toDer(p).getBytes(),f.md.start().update(a)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(c(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var s=e.signers[r];(a=s.digestAlgorithm)in t||(t[a]=n.md[n.pki.oids[a]].create()),0===s.authenticatedAttributes.length?s.md=t[a]:s.md=n.md[n.pki.oids[a]].create()}for(var a in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},s.createEncryptedData=function(){var e=null;return e={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){l(e,t,s.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),h(e)}}},s.createEnvelopedData=function(){var e=null;return e={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=l(e,t,s.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(a(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,o(e.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,(t=e.encryptedContent,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.algorithm).getBytes()),t.parameter?i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],s=i.issuer;if(i.serialNumber===t.serialNumber&&s.length===r.length){for(var a=!0,o=0;o<r.length;++o)if(s[o].type!==r[o].type||s[o].value!==r[o].value){a=!1;break}if(a)return i}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var i=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=n.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}h(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var i,s,a;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case n.pki.oids["aes128-CBC"]:i=16,s=16,a=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:i=24,s=16,a=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:i=32,s=16,a=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:i=24,s=8,a=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=n.util.createBuffer(n.random.getBytes(i));else if(t.length()!=i)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+i+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(s));var o=a(t);if(o.start(e.encryptedContent.parameter.copy()),o.update(e.content),!o.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=o.output}for(var c=0;c<e.recipients.length;++c){var u=e.recipients[c];if(void 0===u.encryptedContent.content){if(u.encryptedContent.algorithm!==n.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm);u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data)}}}}}},9356:(e,t,r)=>{var n=r(276);r(9504),r(172),r(3878),r(7619),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},i=new Array(4),s=n.util.createBuffer();function a(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,i,!1),s.putInt32(i[0]),s.putInt32(i[1]),s.putInt32(i[2]),s.putInt32(i[3]),s.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var o=a(),c=null,u=n.util.globalScope,l=u.crypto||u.msCrypto;if(l&&l.getRandomValues&&(c=function(e){return l.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!c){if("undefined"==typeof window||window.document,o.collectInt(+new Date,32),"undefined"!=typeof navigator){var h="";for(var f in navigator)try{"string"==typeof navigator[f]&&(h+=navigator[f])}catch(e){}o.collect(h),h=null}t&&(t().mousemove((function(e){o.collectInt(e.clientX,16),o.collectInt(e.clientY,16)})),t().keypress((function(e){o.collectInt(e.charCode,8)})))}if(n.random)for(var f in o)n.random[f]=o[f];else n.random=o;n.random.createInstance=a,e.exports=n.random}("undefined"!=typeof jQuery?jQuery:null)},9360:(e,t,r)=>{var n=r(8287).hp;t.decode=function(e){return n.from(e,"base64").toString("binary")},t.encode=function(e){return n.from(e,"binary").toString("base64")}},9504:(e,t,r)=>{var n=r(276);function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.aes.Algorithm(e,t)}))}r(3900),r(6370),r(7619),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},n.aes.createEncryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},n.aes.createDecryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){l||f();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return y(r._w,e,t,!1)},decrypt:function(e,t){return y(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var s=t.length();if(16===s||24===s||32===s)for(s>>>=2,i=0;i<s;++i)r.push(t.getInt32())}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var a=this.mode.name,o=-1!==["CFB","OFB","CTR","GCM"].indexOf(a);this._w=p(r,e.decrypt&&!o),this._init=!0}},n.aes._expandKey=function(e,t){return l||f(),p(e,t)},n.aes._updateBlock=y,i("AES-ECB",n.cipher.modes.ecb),i("AES-CBC",n.cipher.modes.cbc),i("AES-CFB",n.cipher.modes.cfb),i("AES-OFB",n.cipher.modes.ofb),i("AES-CTR",n.cipher.modes.ctr),i("AES-GCM",n.cipher.modes.gcm);var s,a,o,c,u,l=!1,h=4;function f(){l=!0,o=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;for(s=new Array(256),a=new Array(256),c=new Array(4),u=new Array(4),t=0;t<4;++t)c[t]=new Array(256),u[t]=new Array(256);var r,n,i,h,f,p,y,d=0,g=0;for(t=0;t<256;++t){h=(h=g^g<<1^g<<2^g<<3^g<<4)>>8^255&h^99,s[d]=h,a[h]=d,p=(f=e[h])<<24^h<<16^h<<8^h^f,y=((r=e[d])^(n=e[r])^(i=e[n]))<<24^(d^i)<<16^(d^n^i)<<8^d^r^i;for(var m=0;m<4;++m)c[m][d]=p,u[m][h]=y,p=p<<24|p>>>8,y=y<<24|y>>>8;0===d?d=g=1:(d=r^e[e[e[r^i]]],g^=e[e[g]])}}function p(e,t){for(var r,n=e.slice(0),i=1,a=n.length,c=h*(a+6+1),l=a;l<c;++l)r=n[l-1],l%a===0?(r=s[r>>>16&255]<<24^s[r>>>8&255]<<16^s[255&r]<<8^s[r>>>24]^o[i]<<24,i++):a>6&&l%a===4&&(r=s[r>>>24]<<24^s[r>>>16&255]<<16^s[r>>>8&255]<<8^s[255&r]),n[l]=n[l-a]^r;if(t){for(var f,p=u[0],y=u[1],d=u[2],g=u[3],m=n.slice(0),v=(l=0,(c=n.length)-h);l<c;l+=h,v-=h)if(0===l||l===c-h)m[l]=n[v],m[l+1]=n[v+3],m[l+2]=n[v+2],m[l+3]=n[v+1];else for(var A=0;A<h;++A)f=n[v+A],m[l+(3&-A)]=p[s[f>>>24]]^y[s[f>>>16&255]]^d[s[f>>>8&255]]^g[s[255&f]];n=m}return n}function y(e,t,r,n){var i,o,l,h,f,p,y,d,g,m,v,A,b=e.length/4-1;n?(i=u[0],o=u[1],l=u[2],h=u[3],f=a):(i=c[0],o=c[1],l=c[2],h=c[3],f=s),p=t[0]^e[0],y=t[n?3:1]^e[1],d=t[2]^e[2],g=t[n?1:3]^e[3];for(var w=3,E=1;E<b;++E)m=i[p>>>24]^o[y>>>16&255]^l[d>>>8&255]^h[255&g]^e[++w],v=i[y>>>24]^o[d>>>16&255]^l[g>>>8&255]^h[255&p]^e[++w],A=i[d>>>24]^o[g>>>16&255]^l[p>>>8&255]^h[255&y]^e[++w],g=i[g>>>24]^o[p>>>16&255]^l[y>>>8&255]^h[255&d]^e[++w],p=m,y=v,d=A;r[0]=f[p>>>24]<<24^f[y>>>16&255]<<16^f[d>>>8&255]<<8^f[255&g]^e[++w],r[n?3:1]=f[y>>>24]<<24^f[d>>>16&255]<<16^f[g>>>8&255]<<8^f[255&p]^e[++w],r[2]=f[d>>>24]<<24^f[g>>>16&255]<<16^f[p>>>8&255]<<8^f[255&y]^e[++w],r[n?1:3]=f[g>>>24]<<24^f[p>>>16&255]<<16^f[y>>>8&255]<<8^f[255&d]^e[++w]}function d(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var s=null;r instanceof n.util.ByteBuffer&&(s=r,r={}),(r=r||{}).output=s,r.iv=e,i.call(t,r)},t}},9547:(e,t,r)=>{e.exports=r(276),r(9504),r(8678),r(2746),r(3900),r(9095),r(2926),r(1696),r(3432),r(2045),r(1355),r(5250),r(3254),r(2385),r(7501),r(5071),r(9343),r(9255),r(268),r(3878),r(1417),r(9356),r(5124),r(149),r(3986),r(7619)},9954:(e,t,r)=>{var n=r(276);r(2746),r(7619);var i=n.asn1,s=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=s;var a={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};s.contentInfoValidator=a;var o={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};s.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(o)},s.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"}].concat(o)};var c={name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};s.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},a,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},s.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.amdO={},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};(()=>{"use strict";var e={};__webpack_require__.r(e),__webpack_require__.d(e,{Any:()=>Ay,BaseBlock:()=>Pf,BaseStringBlock:()=>_f,BitString:()=>Rp,BmpString:()=>ey,Boolean:()=>Np,CharacterString:()=>hy,Choice:()=>by,Constructed:()=>Cp,DATE:()=>yy,DateTime:()=>gy,Duration:()=>my,EndOfContent:()=>Ip,Enumerated:()=>Mp,GeneralString:()=>ly,GeneralizedTime:()=>py,GraphicString:()=>cy,HexBlock:()=>Tf,IA5String:()=>oy,Integer:()=>Op,Null:()=>kp,NumericString:()=>ny,ObjectIdentifier:()=>Fp,OctetString:()=>xp,Primitive:()=>bp,PrintableString:()=>iy,RawData:()=>Ey,RelativeObjectIdentifier:()=>qp,Repeated:()=>wy,Sequence:()=>zp,Set:()=>Gp,TIME:()=>vy,TeletexString:()=>sy,TimeOfDay:()=>dy,UTCTime:()=>fy,UniversalString:()=>ry,Utf8String:()=>Xp,ValueBlock:()=>Uf,VideotexString:()=>ay,ViewWriter:()=>uf,VisibleString:()=>uy,compareSchema:()=>Sy,fromBER:()=>Ep,verifySchema:()=>Cy});var t=__webpack_require__(9547),r=__webpack_require__(8287).hp;function n(){const e=document.getElementById("error"),t=document.getElementById("verificationStatus"),r=document.getElementById("verificationWarning");e.style.display="none",e.innerHTML="",t.innerHTML="",t.style.display="none",t.classList.remove("valid","invalid","unknown"),r.innerHTML="",r.style.display="none"}function i(){const e=document.getElementById("result"),t=document.getElementById("error"),r=document.getElementById("verificationStatus"),n=document.getElementById("verificationWarning");e.style.display="none",e.innerHTML="",t.style.display="none",t.innerHTML="",r.innerHTML="",r.style.display="none",r.classList.remove("valid","invalid","unknown"),n.innerHTML="",n.style.display="none"}var s=__webpack_require__(1237);const a="starkbank-ecdsa";const o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(r){if("default"!==r&&!(r in e)){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}))})),Object.freeze(e)}const u=Symbol("doneWritingPromise"),l=Symbol("doneWritingResolve"),h=Symbol("doneWritingReject"),f=Symbol("readingIndex");class p extends Array{constructor(){super(),Object.setPrototypeOf(this,p.prototype),this[u]=new Promise(((e,t)=>{this[l]=e,this[h]=t})),this[u].catch((()=>{}))}}function y(e){return e&&e.getReader&&Array.isArray(e)}function d(e){if(!y(e)){const t=e.getWriter(),r=t.releaseLock;return t.releaseLock=()=>{t.closed.catch((function(){})),r.call(t)},t}this.stream=e}function g(e){if(y(e))return"array";if(o.ReadableStream&&o.ReadableStream.prototype.isPrototypeOf(e))return"web";if(e&&!(o.ReadableStream&&e instanceof o.ReadableStream)&&"function"==typeof e._read&&"object"==typeof e._readableState)throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!e||!e.getReader)&&"web-like"}function m(e){return Uint8Array.prototype.isPrototypeOf(e)}function v(e){if(1===e.length)return e[0];let t=0;for(let r=0;r<e.length;r++){if(!m(e[r]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=e[r].length}const r=new Uint8Array(t);let n=0;return e.forEach((function(e){r.set(e,n),n+=e.length})),r}p.prototype.getReader=function(){return void 0===this[f]&&(this[f]=0),{read:async()=>(await this[u],this[f]===this.length?{value:void 0,done:!0}:{value:this[this[f]++],done:!1})}},p.prototype.readToEnd=async function(e){await this[u];const t=e(this.slice(this[f]));return this.length=0,t},p.prototype.clone=function(){const e=new p;return e[u]=this[u].then((()=>{e.push(...this)})),e},d.prototype.write=async function(e){this.stream.push(e)},d.prototype.close=async function(){this.stream[l]()},d.prototype.abort=async function(e){return this.stream[h](e),e},d.prototype.releaseLock=function(){},"object"==typeof o.process&&o.process.versions;const A=new WeakSet,b=Symbol("externalBuffer");function w(e){if(this.stream=e,e[b]&&(this[b]=e[b].slice()),y(e)){const t=e.getReader();return this._read=t.read.bind(t),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(g(e)){const t=e.getReader();return this._read=t.read.bind(t),this._releaseLock=()=>{t.closed.catch((function(){})),t.releaseLock()},void(this._cancel=t.cancel.bind(t))}let t=!1;this._read=async()=>t||A.has(e)?{value:void 0,done:!0}:(t=!0,{value:e,done:!1}),this._releaseLock=()=>{if(t)try{A.add(e)}catch(e){}}}function E(e){return g(e)?e:new ReadableStream({start(t){t.enqueue(e),t.close()}})}function S(e){if(g(e))return e;const t=new p;return(async()=>{const r=M(t);await r.write(e),await r.close()})(),t}function C(e){return e.some((e=>g(e)&&!y(e)))?function(e){e=e.map(E);const t=k((async function(e){await Promise.all(n.map((t=>_(t,e))))}));let r=Promise.resolve();const n=e.map(((n,i)=>N(n,((n,s)=>(r=r.then((()=>B(n,t.writable,{preventClose:i!==e.length-1}))),r)))));return t.readable}(e):e.some((e=>y(e)))?function(e){const t=new p;let r=Promise.resolve();return e.forEach(((n,i)=>(r=r.then((()=>B(n,t,{preventClose:i!==e.length-1}))),r))),t}(e):"string"==typeof e[0]?e.join(""):v(e)}async function B(e,t,{preventClose:r=!1,preventAbort:n=!1,preventCancel:i=!1}={}){if(g(e)&&!y(e)){e=E(e);try{if(e[b]){const r=M(t);for(let t=0;t<e[b].length;t++)await r.ready,await r.write(e[b][t]);r.releaseLock()}await e.pipeTo(t,{preventClose:r,preventAbort:n,preventCancel:i})}catch(e){}return}const s=O(e=S(e)),a=M(t);try{for(;;){await a.ready;const{done:e,value:t}=await s.read();if(e){r||await a.close();break}await a.write(t)}}catch(e){n||await a.abort(e)}finally{s.releaseLock(),a.releaseLock()}}function I(e,t){const r=new TransformStream(t);return B(e,r.writable),r.readable}function k(e){let t,r,n,i=!1,s=!1;return{readable:new ReadableStream({start(e){n=e},pull(){t?t():i=!0},async cancel(t){s=!0,e&&await e(t),r&&r(t)}},{highWaterMark:0}),writable:new WritableStream({write:async function(e){if(s)throw Error("Stream is cancelled");n.enqueue(e),i?i=!1:(await new Promise(((e,n)=>{t=e,r=n})),t=null,r=null)},close:n.close.bind(n),abort:n.error.bind(n)})}}function T(e,t=()=>{},r=()=>{}){if(y(e)){const n=new p;return(async()=>{const i=M(n);try{const n=await L(e),s=t(n),a=r();let o;o=void 0!==s&&void 0!==a?C([s,a]):void 0!==s?s:a,await i.write(o),await i.close()}catch(e){await i.abort(e)}})(),n}if(g(e))return I(e,{async transform(e,r){try{const n=await t(e);void 0!==n&&r.enqueue(n)}catch(e){r.error(e)}},async flush(e){try{const t=await r();void 0!==t&&e.enqueue(t)}catch(t){e.error(t)}}});const n=t(e),i=r();return void 0!==n&&void 0!==i?C([n,i]):void 0!==n?n:i}function N(e,t){if(g(e)&&!y(e)){let r;const n=new TransformStream({start(e){r=e}}),i=B(e,n.writable),s=k((async function(e){r.error(e),await i,await new Promise(setTimeout)}));return t(n.readable,s.writable),s.readable}e=S(e);const r=new p;return t(e,r),r}function U(e,t){let r;const n=N(e,((e,i)=>{const s=O(e);s.remainder=()=>(s.releaseLock(),B(e,i),n),r=t(s)}));return r}function x(e){if(y(e))return e.clone();if(g(e)){const t=function(e){if(y(e))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(g(e)){const t=E(e).tee();return t[0][b]=t[1][b]=e[b],t}return[P(e),P(e)]}(e);return R(e,t[0]),t[1]}return P(e)}function D(e){return y(e)?x(e):g(e)?new ReadableStream({start(t){const r=N(e,(async(e,r)=>{const n=O(e),i=M(r);try{for(;;){await i.ready;const{done:r,value:s}=await n.read();if(r){try{t.close()}catch(e){}return void await i.close()}try{t.enqueue(s)}catch(e){}await i.write(s)}}catch(e){t.error(e),await i.abort(e)}}));R(e,r)}}):P(e)}function R(e,t){Object.entries(Object.getOwnPropertyDescriptors(e.constructor.prototype)).forEach((([r,n])=>{"constructor"!==r&&(n.value?n.value=n.value.bind(t):n.get=n.get.bind(t),Object.defineProperty(e,r,n))}))}function P(e,t=0,r=1/0){if(y(e))throw Error("Not implemented");if(g(e)){if(t>=0&&r>=0){let n=0;return I(e,{transform(e,i){n<r?(n+e.length>=t&&i.enqueue(P(e,Math.max(t-n,0),r-n)),n+=e.length):i.terminate()}})}if(t<0&&(r<0||r===1/0)){let n=[];return T(e,(e=>{e.length>=-t?n=[e]:n.push(e)}),(()=>P(C(n),t,r)))}if(0===t&&r<0){let n;return T(e,(e=>{const i=n?C([n,e]):e;if(i.length>=-r)return n=P(i,r),P(i,t,r);n=i}))}return console.warn(`stream.slice(input, ${t}, ${r}) not implemented efficiently.`),K((async()=>P(await L(e),t,r)))}return e[b]&&(e=C(e[b].concat([e]))),m(e)?e.subarray(t,r===1/0?e.length:r):e.slice(t,r)}async function L(e,t=C){return y(e)?e.readToEnd(t):g(e)?O(e).readToEnd(t):e}async function _(e,t){if(g(e)){if(e.cancel){const r=await e.cancel(t);return await new Promise(setTimeout),r}if(e.destroy)return e.destroy(t),await new Promise(setTimeout),t}}function K(e){const t=new p;return(async()=>{const r=M(t);try{await r.write(await e()),await r.close()}catch(e){await r.abort(e)}})(),t}function O(e){return new w(e)}function M(e){return new d(e)}w.prototype.read=async function(){return this[b]&&this[b].length?{done:!1,value:this[b].shift()}:this._read()},w.prototype.releaseLock=function(){this[b]&&(this.stream[b]=this[b]),this._releaseLock()},w.prototype.cancel=function(e){return this._cancel(e)},w.prototype.readLine=async function(){let e,t=[];for(;!e;){let{done:r,value:n}=await this.read();if(n+="",r)return t.length?C(t):void 0;const i=n.indexOf("\n")+1;i&&(e=C(t.concat(n.substr(0,i))),t=[]),i!==n.length&&t.push(n.substr(i))}return this.unshift(...t),e},w.prototype.readByte=async function(){const{done:e,value:t}=await this.read();if(e)return;const r=t[0];return this.unshift(P(t,1)),r},w.prototype.readBytes=async function(e){const t=[];let r=0;for(;;){const{done:n,value:i}=await this.read();if(n)return t.length?C(t):void 0;if(t.push(i),r+=i.length,r>=e){const r=C(t);return this.unshift(P(r,e)),P(r,0,e)}}},w.prototype.peekBytes=async function(e){const t=await this.readBytes(e);return this.unshift(t),t},w.prototype.unshift=function(...e){this[b]||(this[b]=[]),1===e.length&&m(e[0])&&this[b].length&&e[0].length&&this[b][0].byteOffset>=e[0].length?this[b][0]=new Uint8Array(this[b][0].buffer,this[b][0].byteOffset-e[0].length,this[b][0].byteLength+e[0].length):this[b].unshift(...e.filter((e=>e&&e.length)))},w.prototype.readToEnd=async function(e=C){const t=[];for(;;){const{done:e,value:r}=await this.read();if(e)break;t.push(r)}return e(t)};const H=Symbol("byValue");var V={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(e,t){if("number"==typeof t&&(t=this.read(e,t)),void 0!==e[t])return e[t];throw Error("Invalid enum value.")},read:function(e,t){if(e[H]||(e[H]=[],Object.entries(e).forEach((([t,r])=>{e[H][r]=t}))),void 0!==e[H][t])return e[H][t];throw Error("Invalid enum value.")}},F={preferredHashAlgorithm:V.hash.sha512,preferredSymmetricAlgorithm:V.symmetric.aes256,preferredCompressionAlgorithm:V.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:V.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:V.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([V.symmetric.aes128,V.symmetric.aes192,V.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.1.1",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([V.hash.md5,V.hash.ripemd]),rejectMessageHashAlgorithms:new Set([V.hash.md5,V.hash.ripemd,V.hash.sha1]),rejectPublicKeyAlgorithms:new Set([V.publicKey.elgamal,V.publicKey.dsa]),rejectCurves:new Set([V.curve.secp256k1])};const j=(()=>{try{return!1}catch(e){}return!1})(),Q={isString:function(e){return"string"==typeof e||e instanceof String},nodeRequire:()=>{},isArray:function(e){return e instanceof Array},isUint8Array:m,isStream:g,getNobleCurve:async(e,t)=>{if(!F.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:r}=await Promise.resolve().then((function(){return El}));switch(e){case V.publicKey.ecdh:case V.publicKey.ecdsa:{const e=r.get(t);if(!e)throw Error("Unsupported curve");return e}case V.publicKey.x448:return r.get("x448");case V.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(e){let t=0;for(let r=0;r<e.length;r++)t+=256**r*e[e.length-1-r];return t},writeNumber:function(e,t){const r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e>>8*(t-n-1)&255;return r},readDate:function(e){const t=Q.readNumber(e);return new Date(1e3*t)},writeDate:function(e){const t=Math.floor(e.getTime()/1e3);return Q.writeNumber(t,4)},normalizeDate:function(e=Date.now()){return null===e||e===1/0?e:new Date(1e3*Math.floor(+e/1e3))},readMPI:function(e){const t=7+(e[0]<<8|e[1])>>>3;return Q.readExactSubarray(e,2,2+t)},readExactSubarray:function(e,t,r){if(e.length<r-t)throw Error("Input array too short");return e.subarray(t,r)},leftPad(e,t){if(e.length>t)throw Error("Input array too long");const r=new Uint8Array(t),n=t-e.length;return r.set(e,n),r},uint8ArrayToMPI:function(e){const t=Q.uint8ArrayBitLength(e);if(0===t)throw Error("Zero MPI");const r=e.subarray(e.length-Math.ceil(t/8)),n=new Uint8Array([(65280&t)>>8,255&t]);return Q.concatUint8Array([n,r])},uint8ArrayBitLength:function(e){let t;for(t=0;t<e.length&&0===e[t];t++);if(t===e.length)return 0;const r=e.subarray(t);return 8*(r.length-1)+Q.nbits(r[0])},hexToUint8Array:function(e){const t=new Uint8Array(e.length>>1);for(let r=0;r<e.length>>1;r++)t[r]=parseInt(e.substr(r<<1,2),16);return t},uint8ArrayToHex:function(e){const t="0123456789abcdef";let r="";return e.forEach((e=>{r+=t[e>>4]+t[15&e]})),r},stringToUint8Array:function(e){return T(e,(e=>{if(!Q.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}))},uint8ArrayToString:function(e){const t=[],r=16384,n=(e=new Uint8Array(e)).length;for(let i=0;i<n;i+=r)t.push(String.fromCharCode.apply(String,e.subarray(i,i+r<n?i+r:n)));return t.join("")},encodeUTF8:function(e){const t=new TextEncoder("utf-8");function r(e,r=!1){return t.encode(e,{stream:!r})}return T(e,r,(()=>r("",!0)))},decodeUTF8:function(e){const t=new TextDecoder("utf-8");function r(e,r=!1){return t.decode(e,{stream:!r})}return T(e,r,(()=>r(new Uint8Array,!0)))},concat:C,concatUint8Array:v,equalsUint8Array:function(e,t){if(!Q.isUint8Array(e)||!Q.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},writeChecksum:function(e){let t=0;for(let r=0;r<e.length;r++)t=t+e[r]&65535;return Q.writeNumber(t,2)},printDebug:function(e){j&&console.log("[OpenPGP.js debug]",e)},printDebugError:function(e){j&&console.error("[OpenPGP.js debug]",e)},nbits:function(e){let t=1,r=e>>>16;return 0!==r&&(e=r,t+=16),r=e>>8,0!==r&&(e=r,t+=8),r=e>>4,0!==r&&(e=r,t+=4),r=e>>2,0!==r&&(e=r,t+=2),r=e>>1,0!==r&&(e=r,t+=1),t},double:function(e){const t=new Uint8Array(e.length),r=e.length-1;for(let n=0;n<r;n++)t[n]=e[n]<<1^e[n+1]>>7;return t[r]=e[r]<<1^135*(e[0]>>7),t},shiftRight:function(e,t){if(t)for(let r=e.length-1;r>=0;r--)e[r]>>=t,r>0&&(e[r]|=e[r-1]<<8-t);return e},getWebCrypto:function(){const e=void 0!==o&&o.crypto&&o.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!e)throw Error("The WebCrypto API is not available");return e},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return"undefined"!=typeof navigator?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(e){return!!Q.isString(e)&&/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(e)},canonicalizeEOL:function(e){let t=!1;return T(e,(e=>{let r;t&&(e=Q.concatUint8Array([new Uint8Array([13]),e])),13===e[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;const n=[];for(let t=0;r=e.indexOf(10,t)+1,r;t=r)13!==e[r-2]&&n.push(r);if(!n.length)return e;const i=new Uint8Array(e.length+n.length);let s=0;for(let t=0;t<n.length;t++){const r=e.subarray(n[t-1]||0,n[t]);i.set(r,s),s+=r.length,i[s-1]=13,i[s]=10,s++}return i.set(e.subarray(n[n.length-1]||0),s),i}),(()=>t?new Uint8Array([13]):void 0))},nativeEOL:function(e){let t=!1;return T(e,(e=>{let r;13===(e=t&&10!==e[0]?Q.concatUint8Array([new Uint8Array([13]),e]):new Uint8Array(e))[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;let n=0;for(let t=0;t!==e.length;t=r){r=e.indexOf(13,t)+1,r||(r=e.length);const i=r-(10===e[r]?1:0);t&&e.copyWithin(n,t,i),n+=i-t}return e.subarray(0,n)}),(()=>t?new Uint8Array([13]):void 0))},removeTrailingSpaces:function(e){return e.split("\n").map((e=>{let t=e.length-1;for(;t>=0&&(" "===e[t]||"\t"===e[t]||"\r"===e[t]);t--);return e.substr(0,t+1)})).join("\n")},wrapError:function(e,t){if(!t)return Error(e);try{t.message=e+": "+t.message}catch(e){}return t},constructAllowedPackets:function(e){const t={};return e.forEach((e=>{if(!e.tag)throw Error("Invalid input: expected a packet class");t[e.tag]=e})),t},anyPromise:function(e){return new Promise((async(t,r)=>{let n;await Promise.all(e.map((async e=>{try{t(await e)}catch(e){n=e}}))),r(n)}))},selectUint8Array:function(e,t,r){const n=Math.max(t.length,r.length),i=new Uint8Array(n);let s=0;for(let n=0;n<i.length;n++)i[n]=t[n]&256-e|r[n]&255+e,s+=e&n<t.length|1-e&n<r.length;return i.subarray(0,s)},selectUint8:function(e,t,r){return t&256-e|r&255+e},isAES:function(e){return e===V.symmetric.aes128||e===V.symmetric.aes192||e===V.symmetric.aes256}},q=Q.getNodeBuffer();let z,G;function $(e){let t=new Uint8Array;return T(e,(e=>{t=Q.concatUint8Array([t,e]);const r=[],n=Math.floor(t.length/45),i=45*n,s=z(t.subarray(0,i));for(let e=0;e<n;e++)r.push(s.substr(60*e,60)),r.push("\n");return t=t.subarray(i),r.join("")}),(()=>t.length?z(t)+"\n":""))}function W(e){let t="";return T(e,(e=>{t+=e;let r=0;const n=[" ","\t","\r","\n"];for(let e=0;e<n.length;e++){const i=n[e];for(let e=t.indexOf(i);-1!==e;e=t.indexOf(i,e+1))r++}let i=t.length;for(;i>0&&(i-r)%4!=0;i--)n.includes(t[i])&&r--;const s=G(t.substr(0,i));return t=t.substr(i),s}),(()=>G(t)))}function Y(e){return W(e.replace(/-/g,"+").replace(/_/g,"/"))}function J(e,t){let r=$(e).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function X(e){const t=e.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?V.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?V.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?V.armor.signed:/MESSAGE/.test(t[1])?V.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?V.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?V.armor.privateKey:/SIGNATURE/.test(t[1])?V.armor.signature:void 0}function Z(e,t){let r="";return t.showVersion&&(r+="Version: "+t.versionString+"\n"),t.showComment&&(r+="Comment: "+t.commentString+"\n"),e&&(r+="Comment: "+e+"\n"),r+="\n",r}function ee(e){const t=function(e){let t=13501623;return T(e,(e=>{const r=re?Math.floor(e.length/4):0,n=new Uint32Array(e.buffer,e.byteOffset,r);for(let e=0;e<r;e++)t^=n[e],t=te[0][t>>24&255]^te[1][t>>16&255]^te[2][t>>8&255]^te[3][255&t];for(let n=4*r;n<e.length;n++)t=t>>8^te[0][255&t^e[n]]}),(()=>new Uint8Array([t,t>>8,t>>16])))}(e);return $(t)}q?(z=e=>q.from(e).toString("base64"),G=e=>{const t=q.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(z=e=>btoa(Q.uint8ArrayToString(e)),G=e=>Q.stringToUint8Array(atob(e)));const te=[Array(255),Array(255),Array(255),Array(255)];for(let e=0;e<=255;e++){let t=e<<16;for(let e=0;e<8;e++)t=t<<1^(8388608&t?8801531:0);te[0][e]=(16711680&t)>>16|65280&t|(255&t)<<16}for(let e=0;e<=255;e++)te[1][e]=te[0][e]>>8^te[0][255&te[0][e]];for(let e=0;e<=255;e++)te[2][e]=te[1][e]>>8^te[0][255&te[1][e]];for(let e=0;e<=255;e++)te[3][e]=te[2][e]>>8^te[0][255&te[2][e]];const re=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,255,!0),255===new Int16Array(e)[0]}();function ne(e){for(let t=0;t<e.length;t++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(e[t])||Q.printDebugError(Error("Improperly formatted armor header: "+e[t])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(e[t])||Q.printDebugError(Error("Unknown header: "+e[t]))}function ie(e){let t=e;const r=e.lastIndexOf("=");return r>=0&&r!==e.length-1&&(t=e.slice(0,r)),t}function se(e){return new Promise((async(t,r)=>{try{const n=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,u=a,l=[];const h=W(N(e,(async(e,f)=>{const p=O(e);try{for(;;){let e=await p.readLine();if(void 0===e)throw Error("Misformed armored text");if(e=Q.removeTrailingSpaces(e.replace(/[\r\n]/g,"")),s)if(o)c||s!==V.armor.signed||(n.test(e)?(l=l.join("\r\n"),c=!0,ne(u),u=[],o=!1):l.push(e.replace(/^- /,"")));else if(n.test(e)&&r(Error("Mandatory blank line missing between armor headers and armor data")),i.test(e)){if(ne(u),o=!0,c||s!==V.armor.signed){t({text:l,data:h,headers:a,type:s});break}}else u.push(e);else n.test(e)&&(s=X(e))}}catch(e){return void r(e)}const y=M(f);try{for(;;){await y.ready;const{done:e,value:t}=await p.read();if(e)throw Error("Misformed armored text");const r=t+"";if(-1!==r.indexOf("=")||-1!==r.indexOf("-")){let e=await p.readToEnd();e.length||(e=""),e=r+e,e=Q.removeTrailingSpaces(e.replace(/\r/g,""));const t=e.split(n);if(1===t.length)throw Error("Misformed armored text");const i=ie(t[0].slice(0,-1));await y.write(i);break}await y.write(r)}await y.ready,await y.close()}catch(e){await y.abort(e)}})))}catch(e){r(e)}})).then((async e=>(y(e.data)&&(e.data=await L(e.data)),e)))}function ae(e,t,r,n,i,s=!1,a=F){let o,c;e===V.armor.signed&&(o=t.text,c=t.hash,t=t.data);const u=s&&D(t),l=[];switch(e){case V.armor.multipartSection:l.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+n+"-----\n"),l.push(Z(i,a)),l.push($(t)),u&&l.push("=",ee(u)),l.push("-----END PGP MESSAGE, PART "+r+"/"+n+"-----\n");break;case V.armor.multipartLast:l.push("-----BEGIN PGP MESSAGE, PART "+r+"-----\n"),l.push(Z(i,a)),l.push($(t)),u&&l.push("=",ee(u)),l.push("-----END PGP MESSAGE, PART "+r+"-----\n");break;case V.armor.signed:l.push("-----BEGIN PGP SIGNED MESSAGE-----\n"),l.push(c?`Hash: ${c}\n\n`:"\n"),l.push(o.replace(/^-/gm,"- -")),l.push("\n-----BEGIN PGP SIGNATURE-----\n"),l.push(Z(i,a)),l.push($(t)),u&&l.push("=",ee(u)),l.push("-----END PGP SIGNATURE-----\n");break;case V.armor.message:l.push("-----BEGIN PGP MESSAGE-----\n"),l.push(Z(i,a)),l.push($(t)),u&&l.push("=",ee(u)),l.push("-----END PGP MESSAGE-----\n");break;case V.armor.publicKey:l.push("-----BEGIN PGP PUBLIC KEY BLOCK-----\n"),l.push(Z(i,a)),l.push($(t)),u&&l.push("=",ee(u)),l.push("-----END PGP PUBLIC KEY BLOCK-----\n");break;case V.armor.privateKey:l.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\n"),l.push(Z(i,a)),l.push($(t)),u&&l.push("=",ee(u)),l.push("-----END PGP PRIVATE KEY BLOCK-----\n");break;case V.armor.signature:l.push("-----BEGIN PGP SIGNATURE-----\n"),l.push(Z(i,a)),l.push($(t)),u&&l.push("=",ee(u)),l.push("-----END PGP SIGNATURE-----\n")}return Q.concat(l)}const oe=BigInt(0),ce=BigInt(1);function ue(e){const t="0123456789ABCDEF";let r="";return e.forEach((e=>{r+=t[e>>4]+t[15&e]})),BigInt("0x0"+r)}function le(e,t){const r=e%t;return r<oe?r+t:r}function he(e,t,r){if(r===oe)throw Error("Modulo cannot be zero");if(r===ce)return BigInt(0);if(t<oe)throw Error("Unsopported negative exponent");let n=t,i=e;i%=r;let s=BigInt(1);for(;n>oe;){const e=n&ce;n>>=ce,s=e?s*i%r:s,i=i*i%r}return s}function fe(e){return e>=oe?e:-e}function pe(e,t){const{gcd:r,x:n}=function(e,t){let r=BigInt(0),n=BigInt(1),i=BigInt(1),s=BigInt(0),a=fe(e),o=fe(t);const c=e<oe,u=t<oe;for(;o!==oe;){const e=a/o;let t=r;r=i-e*r,i=t,t=n,n=s-e*n,s=t,t=o,o=a%o,a=t}return{x:c?-i:i,y:u?-s:s,gcd:a}}(e,t);if(r!==ce)throw Error("Inverse does not exist");return le(n+t,t)}function ye(e){const t=Number(e);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}function de(e,t){return(e>>BigInt(t)&ce)===oe?0:1}function ge(e){const t=e<oe?BigInt(-1):oe;let r=1,n=e;for(;(n>>=ce)!==t;)r++;return r}function me(e){const t=e<oe?BigInt(-1):oe,r=BigInt(8);let n=1,i=e;for(;(i>>=r)!==t;)n++;return n}function ve(e,t="be",r){let n=e.toString(16);n.length%2==1&&(n="0"+n);const i=n.length/2,s=new Uint8Array(r||i),a=r?r-i:0;let o=0;for(;o<i;)s[o+a]=parseInt(n.slice(2*o,2*o+2),16),o++;return"be"!==t&&s.reverse(),s}const Ae=Q.getNodeCrypto();function be(e){const t="undefined"!=typeof crypto?crypto:Ae?.webcrypto;if(t?.getRandomValues){const r=new Uint8Array(e);return t.getRandomValues(r)}throw Error("No secure random number generator available.")}function we(e,t){if(t<e)throw Error("Illegal parameter value: max <= min");const r=t-e;return le(ue(be(me(r)+8)),r)+e}const Ee=BigInt(1);function Se(e,t,r){const n=BigInt(30),i=Ee<<BigInt(e-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2];let a=we(i,i<<Ee),o=ye(le(a,n));do{a+=BigInt(s[o]),o=(o+s[o])%s.length,ge(a)>e&&(a=le(a,i<<Ee),a+=i,o=ye(le(a,n)))}while(!Ce(a,t,r));return a}function Ce(e,t,r){return!(t&&function(e,t){let r=e,n=t;for(;n!==oe;){const e=n;n=r%n,r=e}return r}(e-Ee,t)!==Ee||!function(e){const t=BigInt(0);return Be.every((r=>le(e,r)!==t))}(e)||!function(e,t=BigInt(2)){return he(t,e-Ee,e)===Ee}(e)||!function(e,t){const r=ge(e);t||(t=Math.max(1,r/48|0));const n=e-Ee;let i=0;for(;!de(n,i);)i++;const s=e>>BigInt(i);for(;t>0;t--){let t,r=he(we(BigInt(2),n),s,e);if(r!==Ee&&r!==n){for(t=1;t<i;t++){if(r=le(r*r,e),r===Ee)return!1;if(r===n)break}if(t===i)return!1}}return!0}(e,r))}const Be=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map((e=>BigInt(e))),Ie=Q.getWebCrypto(),ke=Q.getNodeCrypto(),Te=ke&&ke.getHashes();function Ne(e){if(ke&&Te.includes(e))return async function(t){const r=ke.createHash(e);return T(t,(e=>{r.update(e)}),(()=>new Uint8Array(r.digest())))}}function Ue(e,t){const r=async()=>{const{nobleHashes:t}=await Promise.resolve().then((function(){return Gl})),r=t.get(e);if(!r)throw Error("Unsupported hash");return r};return async function(e){if(y(e)&&(e=await L(e)),Q.isStream(e)){const t=(await r()).create();return T(e,(e=>{t.update(e)}),(()=>t.digest()))}return Ie&&t?new Uint8Array(await Ie.digest(t,e)):(await r())(e)}}const xe=Ne("md5")||Ue("md5"),De=Ne("sha1")||Ue("sha1","SHA-1"),Re=Ne("sha224")||Ue("sha224"),Pe=Ne("sha256")||Ue("sha256","SHA-256"),Le=Ne("sha384")||Ue("sha384","SHA-384"),_e=Ne("sha512")||Ue("sha512","SHA-512"),Ke=Ne("ripemd160")||Ue("ripemd160"),Oe=Ne("sha3-256")||Ue("sha3_256"),Me=Ne("sha3-512")||Ue("sha3_512");function He(e,t){switch(e){case V.hash.md5:return xe(t);case V.hash.sha1:return De(t);case V.hash.ripemd:return Ke(t);case V.hash.sha256:return Pe(t);case V.hash.sha384:return Le(t);case V.hash.sha512:return _e(t);case V.hash.sha224:return Re(t);case V.hash.sha3_256:return Oe(t);case V.hash.sha3_512:return Me(t);default:throw Error("Unsupported hash function")}}function Ve(e){switch(e){case V.hash.md5:return 16;case V.hash.sha1:case V.hash.ripemd:return 20;case V.hash.sha256:return 32;case V.hash.sha384:return 48;case V.hash.sha512:return 64;case V.hash.sha224:return 28;case V.hash.sha3_256:return 32;case V.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}const Fe=[];function je(e,t){const r=e.length;if(r>t-11)throw Error("Message too long");const n=function(e){const t=new Uint8Array(e);let r=0;for(;r<e;){const n=be(e-r);for(let e=0;e<n.length;e++)0!==n[e]&&(t[r++]=n[e])}return t}(t-r-3),i=new Uint8Array(t);return i[1]=2,i.set(n,2),i.set(e,t-r),i}function Qe(e,t){let r=2,n=1;for(let t=r;t<e.length;t++)n&=0!==e[t],r+=n;const i=r-2,s=e.subarray(r+1),a=0===e[0]&2===e[1]&i>=8&!n;if(t)return Q.selectUint8Array(a,s,t);if(a)return s;throw Error("Decryption error")}function qe(e,t,r){let n;if(t.length!==Ve(e))throw Error("Invalid hash length");const i=new Uint8Array(Fe[e].length);for(n=0;n<Fe[e].length;n++)i[n]=Fe[e][n];const s=i.length+t.length;if(r<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(i,r-s),o.set(t,r-t.length),o}Fe[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Fe[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Fe[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Fe[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Fe[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Fe[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Fe[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];const ze=Q.getWebCrypto(),Ge=Q.getNodeCrypto(),$e=BigInt(1);async function We(e,t,r,n,i,s,a,o,c){if(Ve(e)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(t&&!Q.isStream(t))if(Q.getWebCrypto())try{return await async function(e,t,r,n,i,s,a,o){const c=await Je(r,n,i,s,a,o),u={name:"RSASSA-PKCS1-v1_5",hash:{name:e}},l=await ze.importKey("jwk",c,u,!1,["sign"]);return new Uint8Array(await ze.sign("RSASSA-PKCS1-v1_5",l,t))}(V.read(V.webHash,e),t,r,n,i,s,a,o)}catch(e){Q.printDebugError(e)}else if(Q.getNodeCrypto())return async function(e,t,r,n,i,s,a,o){const c=Ge.createSign(V.read(V.hash,e));c.write(t),c.end();const u=await Je(r,n,i,s,a,o);return new Uint8Array(c.sign({key:u,format:"jwk",type:"pkcs1"}))}(e,t,r,n,i,s,a,o);return async function(e,t,r,n){return t=ue(t),ve(he(ue(qe(e,n,me(t))),r=ue(r),t),"be",me(t))}(e,r,i,c)}async function Ye(e,t,r){return Q.getNodeCrypto()?async function(e,t,r){const n={key:Xe(t,r),format:"jwk",type:"pkcs1",padding:Ge.constants.RSA_PKCS1_PADDING};return new Uint8Array(Ge.publicEncrypt(n,e))}(e,t,r):async function(e,t,r){if(t=ue(t),e=ue(je(e,me(t))),r=ue(r),e>=t)throw Error("Message size cannot exceed modulus size");return ve(he(e,r,t),"be",me(t))}(e,t,r)}async function Je(e,t,r,n,i,s){const a=ue(n),o=ue(i),c=ue(r);let u=le(c,o-$e),l=le(c,a-$e);return l=ve(l),u=ve(u),{kty:"RSA",n:J(e),e:J(t),d:J(r),p:J(i),q:J(n),dp:J(u),dq:J(l),qi:J(s),ext:!0}}function Xe(e,t){return{kty:"RSA",n:J(e),e:J(t),ext:!0}}function Ze(e,t){return{n:Y(e.n),e:ve(t),d:Y(e.d),p:Y(e.q),q:Y(e.p),u:Y(e.qi)}}const et=BigInt(1),tt="object"==typeof o&&"crypto"in o?o.crypto:void 0,rt={};var nt=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},it=function(){throw Error("no PRNG")},st=new Uint8Array(32);st[0]=9;var at=nt(),ot=nt([1]),ct=nt([56129,1]),ut=nt([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),lt=nt([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),ht=nt([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),ft=nt([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),pt=nt([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function yt(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function dt(e,t,r,n){return function(e,t,r,n){var i,s=0;for(i=0;i<32;i++)s|=e[t+i]^r[n+i];return(1&s-1>>>8)-1}(e,t,r,n)}function gt(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function mt(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function vt(e,t,r){for(var n,i=~(r-1),s=0;s<16;s++)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function At(e,t){var r,n,i,s=nt(),a=nt();for(r=0;r<16;r++)a[r]=t[r];for(mt(a),mt(a),mt(a),n=0;n<2;n++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,vt(a,s,1-i)}for(r=0;r<16;r++)e[2*r]=255&a[r],e[2*r+1]=a[r]>>8}function bt(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return At(r,e),At(n,t),dt(r,0,n,0)}function wt(e){var t=new Uint8Array(32);return At(t,e),1&t[0]}function Et(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function St(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function Ct(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function Bt(e,t,r){var n,i,s=0,a=0,o=0,c=0,u=0,l=0,h=0,f=0,p=0,y=0,d=0,g=0,m=0,v=0,A=0,b=0,w=0,E=0,S=0,C=0,B=0,I=0,k=0,T=0,N=0,U=0,x=0,D=0,R=0,P=0,L=0,_=r[0],K=r[1],O=r[2],M=r[3],H=r[4],V=r[5],F=r[6],j=r[7],Q=r[8],q=r[9],z=r[10],G=r[11],$=r[12],W=r[13],Y=r[14],J=r[15];s+=(n=t[0])*_,a+=n*K,o+=n*O,c+=n*M,u+=n*H,l+=n*V,h+=n*F,f+=n*j,p+=n*Q,y+=n*q,d+=n*z,g+=n*G,m+=n*$,v+=n*W,A+=n*Y,b+=n*J,a+=(n=t[1])*_,o+=n*K,c+=n*O,u+=n*M,l+=n*H,h+=n*V,f+=n*F,p+=n*j,y+=n*Q,d+=n*q,g+=n*z,m+=n*G,v+=n*$,A+=n*W,b+=n*Y,w+=n*J,o+=(n=t[2])*_,c+=n*K,u+=n*O,l+=n*M,h+=n*H,f+=n*V,p+=n*F,y+=n*j,d+=n*Q,g+=n*q,m+=n*z,v+=n*G,A+=n*$,b+=n*W,w+=n*Y,E+=n*J,c+=(n=t[3])*_,u+=n*K,l+=n*O,h+=n*M,f+=n*H,p+=n*V,y+=n*F,d+=n*j,g+=n*Q,m+=n*q,v+=n*z,A+=n*G,b+=n*$,w+=n*W,E+=n*Y,S+=n*J,u+=(n=t[4])*_,l+=n*K,h+=n*O,f+=n*M,p+=n*H,y+=n*V,d+=n*F,g+=n*j,m+=n*Q,v+=n*q,A+=n*z,b+=n*G,w+=n*$,E+=n*W,S+=n*Y,C+=n*J,l+=(n=t[5])*_,h+=n*K,f+=n*O,p+=n*M,y+=n*H,d+=n*V,g+=n*F,m+=n*j,v+=n*Q,A+=n*q,b+=n*z,w+=n*G,E+=n*$,S+=n*W,C+=n*Y,B+=n*J,h+=(n=t[6])*_,f+=n*K,p+=n*O,y+=n*M,d+=n*H,g+=n*V,m+=n*F,v+=n*j,A+=n*Q,b+=n*q,w+=n*z,E+=n*G,S+=n*$,C+=n*W,B+=n*Y,I+=n*J,f+=(n=t[7])*_,p+=n*K,y+=n*O,d+=n*M,g+=n*H,m+=n*V,v+=n*F,A+=n*j,b+=n*Q,w+=n*q,E+=n*z,S+=n*G,C+=n*$,B+=n*W,I+=n*Y,k+=n*J,p+=(n=t[8])*_,y+=n*K,d+=n*O,g+=n*M,m+=n*H,v+=n*V,A+=n*F,b+=n*j,w+=n*Q,E+=n*q,S+=n*z,C+=n*G,B+=n*$,I+=n*W,k+=n*Y,T+=n*J,y+=(n=t[9])*_,d+=n*K,g+=n*O,m+=n*M,v+=n*H,A+=n*V,b+=n*F,w+=n*j,E+=n*Q,S+=n*q,C+=n*z,B+=n*G,I+=n*$,k+=n*W,T+=n*Y,N+=n*J,d+=(n=t[10])*_,g+=n*K,m+=n*O,v+=n*M,A+=n*H,b+=n*V,w+=n*F,E+=n*j,S+=n*Q,C+=n*q,B+=n*z,I+=n*G,k+=n*$,T+=n*W,N+=n*Y,U+=n*J,g+=(n=t[11])*_,m+=n*K,v+=n*O,A+=n*M,b+=n*H,w+=n*V,E+=n*F,S+=n*j,C+=n*Q,B+=n*q,I+=n*z,k+=n*G,T+=n*$,N+=n*W,U+=n*Y,x+=n*J,m+=(n=t[12])*_,v+=n*K,A+=n*O,b+=n*M,w+=n*H,E+=n*V,S+=n*F,C+=n*j,B+=n*Q,I+=n*q,k+=n*z,T+=n*G,N+=n*$,U+=n*W,x+=n*Y,D+=n*J,v+=(n=t[13])*_,A+=n*K,b+=n*O,w+=n*M,E+=n*H,S+=n*V,C+=n*F,B+=n*j,I+=n*Q,k+=n*q,T+=n*z,N+=n*G,U+=n*$,x+=n*W,D+=n*Y,R+=n*J,A+=(n=t[14])*_,b+=n*K,w+=n*O,E+=n*M,S+=n*H,C+=n*V,B+=n*F,I+=n*j,k+=n*Q,T+=n*q,N+=n*z,U+=n*G,x+=n*$,D+=n*W,R+=n*Y,P+=n*J,b+=(n=t[15])*_,a+=38*(E+=n*O),o+=38*(S+=n*M),c+=38*(C+=n*H),u+=38*(B+=n*V),l+=38*(I+=n*F),h+=38*(k+=n*j),f+=38*(T+=n*Q),p+=38*(N+=n*q),y+=38*(U+=n*z),d+=38*(x+=n*G),g+=38*(D+=n*$),m+=38*(R+=n*W),v+=38*(P+=n*Y),A+=38*(L+=n*J),s=(n=(s+=38*(w+=n*K))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),A=(n=A+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),A=(n=A+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=a,e[2]=o,e[3]=c,e[4]=u,e[5]=l,e[6]=h,e[7]=f,e[8]=p,e[9]=y,e[10]=d,e[11]=g,e[12]=m,e[13]=v,e[14]=A,e[15]=b}function It(e,t){Bt(e,t,t)}function kt(e,t){var r,n=nt();for(r=0;r<16;r++)n[r]=t[r];for(r=253;r>=0;r--)It(n,n),2!==r&&4!==r&&Bt(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}function Tt(e,t,r){var n,i,s=new Uint8Array(32),a=new Float64Array(80),o=nt(),c=nt(),u=nt(),l=nt(),h=nt(),f=nt();for(i=0;i<31;i++)s[i]=t[i];for(s[31]=127&t[31]|64,s[0]&=248,Et(a,r),i=0;i<16;i++)c[i]=a[i],l[i]=o[i]=u[i]=0;for(o[0]=l[0]=1,i=254;i>=0;--i)vt(o,c,n=s[i>>>3]>>>(7&i)&1),vt(u,l,n),St(h,o,u),Ct(o,o,u),St(u,c,l),Ct(c,c,l),It(l,h),It(f,o),Bt(o,u,o),Bt(u,c,h),St(h,o,u),Ct(o,o,u),It(c,o),Ct(u,l,f),Bt(o,u,ct),St(o,o,l),Bt(u,u,o),Bt(o,l,f),Bt(l,c,a),It(c,h),vt(o,c,n),vt(u,l,n);for(i=0;i<16;i++)a[i+16]=o[i],a[i+32]=u[i],a[i+48]=c[i],a[i+64]=l[i];var p=a.subarray(32),y=a.subarray(16);return kt(p,p),Bt(y,y,p),At(e,y),0}function Nt(e,t){return Tt(e,t,st)}var Ut=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function xt(e,t,r,n){for(var i,s,a,o,c,u,l,h,f,p,y,d,g,m,v,A,b,w,E,S,C,B,I,k,T,N,U=new Int32Array(16),x=new Int32Array(16),D=e[0],R=e[1],P=e[2],L=e[3],_=e[4],K=e[5],O=e[6],M=e[7],H=t[0],V=t[1],F=t[2],j=t[3],Q=t[4],q=t[5],z=t[6],G=t[7],$=0;n>=128;){for(E=0;E<16;E++)S=8*E+$,U[E]=r[S+0]<<24|r[S+1]<<16|r[S+2]<<8|r[S+3],x[E]=r[S+4]<<24|r[S+5]<<16|r[S+6]<<8|r[S+7];for(E=0;E<80;E++)if(i=D,s=R,a=P,o=L,c=_,u=K,l=O,f=H,p=V,y=F,d=j,g=Q,m=q,v=z,I=65535&(B=G),k=B>>>16,T=65535&(C=M),N=C>>>16,I+=65535&(B=(Q>>>14|_<<18)^(Q>>>18|_<<14)^(_>>>9|Q<<23)),k+=B>>>16,T+=65535&(C=(_>>>14|Q<<18)^(_>>>18|Q<<14)^(Q>>>9|_<<23)),N+=C>>>16,I+=65535&(B=Q&q^~Q&z),k+=B>>>16,T+=65535&(C=_&K^~_&O),N+=C>>>16,I+=65535&(B=Ut[2*E+1]),k+=B>>>16,T+=65535&(C=Ut[2*E]),N+=C>>>16,C=U[E%16],k+=(B=x[E%16])>>>16,T+=65535&C,N+=C>>>16,T+=(k+=(I+=65535&B)>>>16)>>>16,I=65535&(B=w=65535&I|k<<16),k=B>>>16,T=65535&(C=b=65535&T|(N+=T>>>16)<<16),N=C>>>16,I+=65535&(B=(H>>>28|D<<4)^(D>>>2|H<<30)^(D>>>7|H<<25)),k+=B>>>16,T+=65535&(C=(D>>>28|H<<4)^(H>>>2|D<<30)^(H>>>7|D<<25)),N+=C>>>16,k+=(B=H&V^H&F^V&F)>>>16,T+=65535&(C=D&R^D&P^R&P),N+=C>>>16,h=65535&(T+=(k+=(I+=65535&B)>>>16)>>>16)|(N+=T>>>16)<<16,A=65535&I|k<<16,I=65535&(B=d),k=B>>>16,T=65535&(C=o),N=C>>>16,k+=(B=w)>>>16,T+=65535&(C=b),N+=C>>>16,R=i,P=s,L=a,_=o=65535&(T+=(k+=(I+=65535&B)>>>16)>>>16)|(N+=T>>>16)<<16,K=c,O=u,M=l,D=h,V=f,F=p,j=y,Q=d=65535&I|k<<16,q=g,z=m,G=v,H=A,E%16==15)for(S=0;S<16;S++)C=U[S],I=65535&(B=x[S]),k=B>>>16,T=65535&C,N=C>>>16,C=U[(S+9)%16],I+=65535&(B=x[(S+9)%16]),k+=B>>>16,T+=65535&C,N+=C>>>16,b=U[(S+1)%16],I+=65535&(B=((w=x[(S+1)%16])>>>1|b<<31)^(w>>>8|b<<24)^(w>>>7|b<<25)),k+=B>>>16,T+=65535&(C=(b>>>1|w<<31)^(b>>>8|w<<24)^b>>>7),N+=C>>>16,b=U[(S+14)%16],k+=(B=((w=x[(S+14)%16])>>>19|b<<13)^(b>>>29|w<<3)^(w>>>6|b<<26))>>>16,T+=65535&(C=(b>>>19|w<<13)^(w>>>29|b<<3)^b>>>6),N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,U[S]=65535&T|N<<16,x[S]=65535&I|k<<16;I=65535&(B=H),k=B>>>16,T=65535&(C=D),N=C>>>16,C=e[0],k+=(B=t[0])>>>16,T+=65535&C,N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,e[0]=D=65535&T|N<<16,t[0]=H=65535&I|k<<16,I=65535&(B=V),k=B>>>16,T=65535&(C=R),N=C>>>16,C=e[1],k+=(B=t[1])>>>16,T+=65535&C,N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,e[1]=R=65535&T|N<<16,t[1]=V=65535&I|k<<16,I=65535&(B=F),k=B>>>16,T=65535&(C=P),N=C>>>16,C=e[2],k+=(B=t[2])>>>16,T+=65535&C,N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,e[2]=P=65535&T|N<<16,t[2]=F=65535&I|k<<16,I=65535&(B=j),k=B>>>16,T=65535&(C=L),N=C>>>16,C=e[3],k+=(B=t[3])>>>16,T+=65535&C,N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,e[3]=L=65535&T|N<<16,t[3]=j=65535&I|k<<16,I=65535&(B=Q),k=B>>>16,T=65535&(C=_),N=C>>>16,C=e[4],k+=(B=t[4])>>>16,T+=65535&C,N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,e[4]=_=65535&T|N<<16,t[4]=Q=65535&I|k<<16,I=65535&(B=q),k=B>>>16,T=65535&(C=K),N=C>>>16,C=e[5],k+=(B=t[5])>>>16,T+=65535&C,N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,e[5]=K=65535&T|N<<16,t[5]=q=65535&I|k<<16,I=65535&(B=z),k=B>>>16,T=65535&(C=O),N=C>>>16,C=e[6],k+=(B=t[6])>>>16,T+=65535&C,N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,e[6]=O=65535&T|N<<16,t[6]=z=65535&I|k<<16,I=65535&(B=G),k=B>>>16,T=65535&(C=M),N=C>>>16,C=e[7],k+=(B=t[7])>>>16,T+=65535&C,N+=C>>>16,N+=(T+=(k+=(I+=65535&B)>>>16)>>>16)>>>16,e[7]=M=65535&T|N<<16,t[7]=G=65535&I|k<<16,$+=128,n-=128}return n}function Dt(e,t,r){var n,i=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,xt(i,s,t,r),r%=128,n=0;n<r;n++)a[n]=t[o-r+n];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,yt(a,r-8,o/536870912|0,o<<3),xt(i,s,a,r),n=0;n<8;n++)yt(e,8*n,i[n],s[n]);return 0}function Rt(e,t){var r=nt(),n=nt(),i=nt(),s=nt(),a=nt(),o=nt(),c=nt(),u=nt(),l=nt();Ct(r,e[1],e[0]),Ct(l,t[1],t[0]),Bt(r,r,l),St(n,e[0],e[1]),St(l,t[0],t[1]),Bt(n,n,l),Bt(i,e[3],t[3]),Bt(i,i,lt),Bt(s,e[2],t[2]),St(s,s,s),Ct(a,n,r),Ct(o,s,i),St(c,s,i),St(u,n,r),Bt(e[0],a,o),Bt(e[1],u,c),Bt(e[2],c,o),Bt(e[3],a,u)}function Pt(e,t,r){var n;for(n=0;n<4;n++)vt(e[n],t[n],r)}function Lt(e,t){var r=nt(),n=nt(),i=nt();kt(i,t[2]),Bt(r,t[0],i),Bt(n,t[1],i),At(e,n),e[31]^=wt(r)<<7}function _t(e,t,r){var n,i;for(gt(e[0],at),gt(e[1],ot),gt(e[2],ot),gt(e[3],at),i=255;i>=0;--i)Pt(e,t,n=r[i/8|0]>>(7&i)&1),Rt(t,e),Rt(e,e),Pt(e,t,n)}function Kt(e,t){var r=[nt(),nt(),nt(),nt()];gt(r[0],ht),gt(r[1],ft),gt(r[2],ot),Bt(r[3],ht,ft),_t(e,r,t)}function Ot(e,t,r){var n,i=new Uint8Array(64),s=[nt(),nt(),nt(),nt()];for(r||it(t,32),Dt(i,t,32),i[0]&=248,i[31]&=127,i[31]|=64,Kt(s,i),Lt(e,s),n=0;n<32;n++)t[n+32]=e[n];return 0}var Mt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Ht(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*Mt[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*Mt[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*Mt[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function Vt(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;Ht(e,r)}var Ft=64;function jt(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}rt.scalarMult=function(e,t){if(jt(e,t),32!==e.length)throw Error("bad n size");if(32!==t.length)throw Error("bad p size");var r=new Uint8Array(32);return Tt(r,e,t),r},rt.box={},rt.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return function(e,t){it(t,32),Nt(e,t)}(e,t),{publicKey:e,secretKey:t}},rt.box.keyPair.fromSecretKey=function(e){if(jt(e),32!==e.length)throw Error("bad secret key size");var t=new Uint8Array(32);return Nt(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},rt.sign=function(e,t){if(jt(e,t),64!==t.length)throw Error("bad secret key size");var r=new Uint8Array(Ft+e.length);return function(e,t,r,n){var i,s,a=new Uint8Array(64),o=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),l=[nt(),nt(),nt(),nt()];for(Dt(a,n,32),a[0]&=248,a[31]&=127,a[31]|=64,i=0;i<r;i++)e[64+i]=t[i];for(i=0;i<32;i++)e[32+i]=a[32+i];for(Dt(c,e.subarray(32),r+32),Vt(c),Kt(l,c),Lt(e,l),i=32;i<64;i++)e[i]=n[i];for(Dt(o,e,r+64),Vt(o),i=0;i<64;i++)u[i]=0;for(i=0;i<32;i++)u[i]=c[i];for(i=0;i<32;i++)for(s=0;s<32;s++)u[i+s]+=o[i]*a[s];Ht(e.subarray(32),u)}(r,e,e.length,t),r},rt.sign.detached=function(e,t){for(var r=rt.sign(e,t),n=new Uint8Array(Ft),i=0;i<n.length;i++)n[i]=r[i];return n},rt.sign.detached.verify=function(e,t,r){if(jt(e,t,r),t.length!==Ft)throw Error("bad signature size");if(32!==r.length)throw Error("bad public key size");var n,i=new Uint8Array(Ft+e.length),s=new Uint8Array(Ft+e.length);for(n=0;n<Ft;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+Ft]=e[n];return function(e,t,r,n){var i,s=new Uint8Array(32),a=new Uint8Array(64),o=[nt(),nt(),nt(),nt()],c=[nt(),nt(),nt(),nt()];if(r<64)return-1;if(function(e,t){var r=nt(),n=nt(),i=nt(),s=nt(),a=nt(),o=nt(),c=nt();return gt(e[2],ot),Et(e[1],t),It(i,e[1]),Bt(s,i,ut),Ct(i,i,e[2]),St(s,e[2],s),It(a,s),It(o,a),Bt(c,o,a),Bt(r,c,i),Bt(r,r,s),function(e,t){var r,n=nt();for(r=0;r<16;r++)n[r]=t[r];for(r=250;r>=0;r--)It(n,n),1!==r&&Bt(n,n,t);for(r=0;r<16;r++)e[r]=n[r]}(r,r),Bt(r,r,i),Bt(r,r,s),Bt(r,r,s),Bt(e[0],r,s),It(n,e[0]),Bt(n,n,s),bt(n,i)&&Bt(e[0],e[0],pt),It(n,e[0]),Bt(n,n,s),bt(n,i)?-1:(wt(e[0])===t[31]>>7&&Ct(e[0],at,e[0]),Bt(e[3],e[0],e[1]),0)}(c,n))return-1;for(i=0;i<r;i++)e[i]=t[i];for(i=0;i<32;i++)e[i+32]=n[i];if(Dt(a,e,r),Vt(a),_t(o,c,a),Kt(c,t.subarray(32)),Rt(o,c),Lt(s,o),r-=64,dt(t,0,s,0)){for(i=0;i<r;i++)e[i]=0;return-1}for(i=0;i<r;i++)e[i]=t[i+64];return r}(s,i,i.length,r)>=0},rt.sign.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(64);return Ot(e,t),{publicKey:e,secretKey:t}},rt.sign.keyPair.fromSecretKey=function(e){if(jt(e),64!==e.length)throw Error("bad secret key size");for(var t=new Uint8Array(32),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},rt.sign.keyPair.fromSeed=function(e){if(jt(e),32!==e.length)throw Error("bad seed size");for(var t=new Uint8Array(32),r=new Uint8Array(64),n=0;n<32;n++)r[n]=e[n];return Ot(t,r,!0),{publicKey:t,secretKey:r}},rt.setPRNG=function(e){it=e},tt&&tt.getRandomValues&&rt.setPRNG((function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)tt.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];!function(e){for(var t=0;t<e.length;t++)e[t]=0}(n)}));const Qt={"2a8648ce3d030107":V.curve.nistP256,"2b81040022":V.curve.nistP384,"2b81040023":V.curve.nistP521,"2b8104000a":V.curve.secp256k1,"2b06010401da470f01":V.curve.ed25519Legacy,"2b060104019755010501":V.curve.curve25519Legacy,"2b2403030208010107":V.curve.brainpoolP256r1,"2b240303020801010b":V.curve.brainpoolP384r1,"2b240303020801010d":V.curve.brainpoolP512r1};class qt{constructor(e){if(e instanceof qt)this.oid=e.oid;else if(Q.isArray(e)||Q.isUint8Array(e)){if(6===(e=new Uint8Array(e))[0]){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.oid=e.subarray(1,1+t),1+this.oid.length}throw Error("Invalid oid")}write(){return Q.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return Q.uint8ArrayToHex(this.oid)}getName(){const e=Qt[this.toHex()];if(!e)throw Error("Unknown curve object identifier.");return e}}function zt(e){let t,r=0;const n=e[0];return n<192?([r]=e,t=1):n<255?(r=(e[0]-192<<8)+e[1]+192,t=2):255===n&&(r=Q.readNumber(e.subarray(1,5)),t=5),{len:r,offset:t}}function Gt(e){return e<192?new Uint8Array([e]):e>191&&e<8384?new Uint8Array([192+(e-192>>8),e-192&255]):Q.concatUint8Array([new Uint8Array([255]),Q.writeNumber(e,4)])}function $t(e){if(e<0||e>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+e])}function Wt(e){return new Uint8Array([192|e])}function Yt(e,t){return Q.concatUint8Array([Wt(e),Gt(t)])}function Jt(e){return[V.packet.literalData,V.packet.compressedData,V.packet.symmetricallyEncryptedData,V.packet.symEncryptedIntegrityProtectedData,V.packet.aeadEncryptedData].includes(e)}async function Xt(e,t){const r=O(e);let n,i;try{const s=await r.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await r.readByte();let o,c,u=-1,l=-1;l=0,64&a&&(l=1),l?u=63&a:(u=(63&a)>>2,c=3&a);const h=Jt(u);let f,y=null;if(h){if("array"===Q.isStream(e)){const e=new p;n=M(e),y=e}else{const e=new TransformStream;n=M(e.writable),y=e.readable}i=t({tag:u,packet:y})}else y=[];do{if(l){const e=await r.readByte();if(f=!1,e<192)o=e;else if(e>=192&&e<224)o=(e-192<<8)+await r.readByte()+192;else if(e>223&&e<255){if(o=1<<(31&e),f=!0,!h)throw new TypeError("This packet type does not support partial lengths.")}else o=await r.readByte()<<24|await r.readByte()<<16|await r.readByte()<<8|await r.readByte()}else switch(c){case 0:o=await r.readByte();break;case 1:o=await r.readByte()<<8|await r.readByte();break;case 2:o=await r.readByte()<<24|await r.readByte()<<16|await r.readByte()<<8|await r.readByte();break;default:o=1/0}if(o>0){let e=0;for(;;){n&&await n.ready;const{done:t,value:i}=await r.read();if(t){if(o===1/0)break;throw Error("Unexpected end of packet")}const s=o===1/0?i:i.subarray(0,o-e);if(n?await n.write(s):y.push(s),e+=i.length,e>=o){r.unshift(i.subarray(o-e+i.length));break}}}}while(f);const d=await r.peekBytes(h?1/0:2);return n?(await n.ready,await n.close()):(y=Q.concatUint8Array(y),await t({tag:u,packet:y})),!d||!d.length}catch(e){if(n)return await n.abort(e),!0;throw e}finally{n&&await i,r.releaseLock()}}class Zt extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Zt),this.name="UnsupportedError"}}class er extends Zt{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Zt),this.name="UnknownPacketError"}}class tr{constructor(e,t){this.tag=e,this.rawContent=t}write(){return this.rawContent}}async function rr(e){switch(e){case V.publicKey.ed25519:try{const e=Q.getWebCrypto(),t=await e.generateKey("Ed25519",!0,["sign","verify"]),r=await e.exportKey("jwk",t.privateKey),n=await e.exportKey("jwk",t.publicKey);return{A:new Uint8Array(Y(n.x)),seed:Y(r.d)}}catch(t){if("NotSupportedError"!==t.name&&"OperationError"!==t.name)throw t;const r=be(ar(e)),{publicKey:n}=rt.sign.keyPair.fromSeed(r);return{A:n,seed:r}}case V.publicKey.ed448:{const e=await Q.getNobleCurve(V.publicKey.ed448),t=e.utils.randomPrivateKey();return{A:e.getPublicKey(t),seed:t}}default:throw Error("Unsupported EdDSA algorithm")}}async function nr(e,t,r,n,i,s){if(Ve(t)<Ve(or(e)))throw Error("Hash algorithm too weak for EdDSA.");switch(e){case V.publicKey.ed25519:try{const t=Q.getWebCrypto(),r=ur(e,n,i),a=await t.importKey("jwk",r,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await t.sign("Ed25519",a,s))}}catch(e){if("NotSupportedError"!==e.name)throw e;const t=Q.concatUint8Array([i,n]);return{RS:rt.sign.detached(s,t)}}case V.publicKey.ed448:return{RS:(await Q.getNobleCurve(V.publicKey.ed448)).sign(s,i)};default:throw Error("Unsupported EdDSA algorithm")}}async function ir(e,t,{RS:r},n,i,s){if(Ve(t)<Ve(or(e)))throw Error("Hash algorithm too weak for EdDSA.");switch(e){case V.publicKey.ed25519:try{const t=Q.getWebCrypto(),n=cr(e,i),a=await t.importKey("jwk",n,"Ed25519",!1,["verify"]);return await t.verify("Ed25519",a,r,s)}catch(e){if("NotSupportedError"!==e.name)throw e;return rt.sign.detached.verify(s,r,i)}case V.publicKey.ed448:return(await Q.getNobleCurve(V.publicKey.ed448)).verify(r,s,i);default:throw Error("Unsupported EdDSA algorithm")}}async function sr(e,t,r){switch(e){case V.publicKey.ed25519:{const{publicKey:e}=rt.sign.keyPair.fromSeed(r);return Q.equalsUint8Array(t,e)}case V.publicKey.ed448:{const e=(await Q.getNobleCurve(V.publicKey.ed448)).getPublicKey(r);return Q.equalsUint8Array(t,e)}default:return!1}}function ar(e){switch(e){case V.publicKey.ed25519:return 32;case V.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function or(e){switch(e){case V.publicKey.ed25519:return V.hash.sha256;case V.publicKey.ed448:return V.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const cr=(e,t)=>{if(e===V.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:J(t),ext:!0};throw Error("Unsupported EdDSA algorithm")},ur=(e,t,r)=>{if(e===V.publicKey.ed25519){const n=cr(e,t);return n.d=J(r),n}throw Error("Unsupported EdDSA algorithm")};var lr=Object.freeze({__proto__:null,generate:rr,getPayloadSize:ar,getPreferredHashAlgo:or,sign:nr,validateParams:sr,verify:ir});function hr(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function fr(e,...t){if(!hr(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function pr(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function yr(e,t){fr(e);const r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}const dr=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength),gr=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),mr=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw Error("Non little-endian hardware is not supported");function vr(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!hr(e))throw Error("Uint8Array expected, got "+typeof e);e=Sr(e)}return e}function Ar(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}const br=(e,t)=>(Object.assign(t,e),t);function wr(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s);e.setUint32(t+0,a,n),e.setUint32(t+4,o,n)}function Er(e){return e.byteOffset%4==0}function Sr(e){return Uint8Array.from(e)}function Cr(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const Br=16,Ir=new Uint8Array(16),kr=gr(Ir),Tr=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;class Nr{constructor(e,t){this.blockLen=Br,this.outputLen=Br,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,fr(e=vr(e),16);const r=mr(e);let n=r.getUint32(0,!1),i=r.getUint32(4,!1),s=r.getUint32(8,!1),a=r.getUint32(12,!1);const o=[];for(let e=0;e<128;e++)o.push({s0:Tr(n),s1:Tr(i),s2:Tr(s),s3:Tr(a)}),({s0:n,s1:i,s2:s,s3:a}={s3:(l=s)<<31|(h=a)>>>1,s2:(u=i)<<31|l>>>1,s1:(c=n)<<31|u>>>1,s0:c>>>1^225<<24&-(1&h)});var c,u,l,h;const f=(e=>e>65536?8:e>1024?4:2)(t||1024);if(![1,2,4,8].includes(f))throw Error(`ghash: wrong window size=${f}, should be 2, 4 or 8`);this.W=f;const p=128/f,y=this.windowSize=2**f,d=[];for(let e=0;e<p;e++)for(let t=0;t<y;t++){let r=0,n=0,i=0,s=0;for(let a=0;a<f;a++){if(!(t>>>f-a-1&1))continue;const{s0:c,s1:u,s2:l,s3:h}=o[f*e+a];r^=c,n^=u,i^=l,s^=h}d.push({s0:r,s1:n,s2:i,s3:s})}this.t=d}_updateBlock(e,t,r,n){e^=this.s0,t^=this.s1,r^=this.s2,n^=this.s3;const{W:i,t:s,windowSize:a}=this;let o=0,c=0,u=0,l=0;const h=(1<<i)-1;let f=0;for(const p of[e,t,r,n])for(let e=0;e<4;e++){const t=p>>>8*e&255;for(let e=8/i-1;e>=0;e--){const r=t>>>i*e&h,{s0:n,s1:p,s2:y,s3:d}=s[f*a+r];o^=n,c^=p,u^=y,l^=d,f+=1}}this.s0=o,this.s1=c,this.s2=u,this.s3=l}update(e){e=vr(e),pr(this);const t=gr(e),r=Math.floor(e.length/Br),n=e.length%Br;for(let e=0;e<r;e++)this._updateBlock(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]);return n&&(Ir.set(e.subarray(r*Br)),this._updateBlock(kr[0],kr[1],kr[2],kr[3]),Cr(kr)),this}destroy(){const{t:e}=this;for(const t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){pr(this),yr(e,this),this.finished=!0;const{s0:t,s1:r,s2:n,s3:i}=this,s=gr(e);return s[0]=t,s[1]=r,s[2]=n,s[3]=i,e}digest(){const e=new Uint8Array(Br);return this.digestInto(e),this.destroy(),e}}class Ur extends Nr{constructor(e,t){const r=function(e){e.reverse();const t=1&e[15];let r=0;for(let t=0;t<e.length;t++){const n=e[t];e[t]=n>>>1|r,r=(1&n)<<7}return e[0]^=225&-t,e}(Sr(e=vr(e)));super(r,t),Cr(r)}update(e){e=vr(e),pr(this);const t=gr(e),r=e.length%Br,n=Math.floor(e.length/Br);for(let e=0;e<n;e++)this._updateBlock(Tr(t[4*e+3]),Tr(t[4*e+2]),Tr(t[4*e+1]),Tr(t[4*e+0]));return r&&(Ir.set(e.subarray(n*Br)),this._updateBlock(Tr(kr[3]),Tr(kr[2]),Tr(kr[1]),Tr(kr[0])),Cr(kr)),this}digestInto(e){pr(this),yr(e,this),this.finished=!0;const{s0:t,s1:r,s2:n,s3:i}=this,s=gr(e);return s[0]=t,s[1]=r,s[2]=n,s[3]=i,e.reverse()}}function xr(e){const t=(t,r)=>e(r,t.length).update(vr(t)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(t,r)=>e(t,r),t}const Dr=xr(((e,t)=>new Nr(e,t)));xr(((e,t)=>new Ur(e,t)));const Rr=16,Pr=new Uint8Array(Rr);function Lr(e){return e<<1^283&-(e>>7)}function _r(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(1&t),e=Lr(e);return r}const Kr=(()=>{const e=new Uint8Array(256);for(let t=0,r=1;t<256;t++,r^=Lr(r))e[t]=r;const t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=255&(n^n>>4^n>>5^n>>6^n>>7^99)}return Cr(e),t})(),Or=Kr.map(((e,t)=>Kr.indexOf(t))),Mr=e=>e<<24|e>>>8,Hr=e=>e<<8|e>>>24,Vr=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function Fr(e,t){if(256!==e.length)throw Error("Wrong sbox length");const r=new Uint32Array(256).map(((r,n)=>t(e[n]))),n=r.map(Hr),i=n.map(Hr),s=i.map(Hr),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let t=0;t<256;t++)for(let u=0;u<256;u++){const l=256*t+u;a[l]=r[t]^n[u],o[l]=i[t]^s[u],c[l]=e[t]<<8|e[u]}return{sbox:e,sbox2:c,T0:r,T1:n,T2:i,T3:s,T01:a,T23:o}}const jr=Fr(Kr,(e=>_r(e,3)<<24|e<<16|e<<8|_r(e,2))),Qr=Fr(Or,(e=>_r(e,11)<<24|_r(e,13)<<16|_r(e,9)<<8|_r(e,14))),qr=(()=>{const e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=Lr(r))e[t]=r;return e})();function zr(e){fr(e);const t=e.length;if(![16,24,32].includes(t))throw Error("aes: wrong key size: should be 16, 24 or 32, got: "+t);const{sbox2:r}=jr,n=[];Er(e)||n.push(e=Sr(e));const i=gr(e),s=i.length,a=e=>Wr(r,e,e,e,e),o=new Uint32Array(t+28);o.set(i);for(let e=s;e<o.length;e++){let t=o[e-1];e%s==0?t=a(Mr(t))^qr[e/s-1]:s>6&&e%s==4&&(t=a(t)),o[e]=o[e-s]^t}return Cr(...n),o}function Gr(e){const t=zr(e),r=t.slice(),n=t.length,{sbox2:i}=jr,{T0:s,T1:a,T2:o,T3:c}=Qr;for(let e=0;e<n;e+=4)for(let i=0;i<4;i++)r[e+i]=t[n-e-4+i];Cr(t);for(let e=4;e<n-4;e++){const t=r[e],n=Wr(i,t,t,t,t);r[e]=s[255&n]^a[n>>>8&255]^o[n>>>16&255]^c[n>>>24]}return r}function $r(e,t,r,n,i,s){return e[r<<8&65280|n>>>8&255]^t[i>>>8&65280|s>>>24&255]}function Wr(e,t,r,n,i){return e[255&t|65280&r]|e[n>>>16&255|i>>>16&65280]<<16}function Yr(e,t,r,n,i){const{sbox2:s,T01:a,T23:o}=jr;let c=0;t^=e[c++],r^=e[c++],n^=e[c++],i^=e[c++];const u=e.length/4-2;for(let s=0;s<u;s++){const s=e[c++]^$r(a,o,t,r,n,i),u=e[c++]^$r(a,o,r,n,i,t),l=e[c++]^$r(a,o,n,i,t,r),h=e[c++]^$r(a,o,i,t,r,n);t=s,r=u,n=l,i=h}return{s0:e[c++]^Wr(s,t,r,n,i),s1:e[c++]^Wr(s,r,n,i,t),s2:e[c++]^Wr(s,n,i,t,r),s3:e[c++]^Wr(s,i,t,r,n)}}function Jr(e,t,r,n,i){const{sbox2:s,T01:a,T23:o}=Qr;let c=0;t^=e[c++],r^=e[c++],n^=e[c++],i^=e[c++];const u=e.length/4-2;for(let s=0;s<u;s++){const s=e[c++]^$r(a,o,t,i,n,r),u=e[c++]^$r(a,o,r,t,i,n),l=e[c++]^$r(a,o,n,r,t,i),h=e[c++]^$r(a,o,i,n,r,t);t=s,r=u,n=l,i=h}return{s0:e[c++]^Wr(s,t,i,n,r),s1:e[c++]^Wr(s,r,t,i,n),s2:e[c++]^Wr(s,n,r,t,i),s3:e[c++]^Wr(s,i,n,r,t)}}function Xr(e,t){if(void 0===t)return new Uint8Array(e);if(fr(t),t.length<e)throw Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);if(!Er(t))throw Error("unaligned dst");return t}function Zr(e,t,r,n){fr(t,Rr),fr(r);const i=r.length;n=Xr(i,n);const s=t,a=gr(s);let{s0:o,s1:c,s2:u,s3:l}=Yr(e,a[0],a[1],a[2],a[3]);const h=gr(r),f=gr(n);for(let t=0;t+4<=h.length;t+=4){f[t+0]=h[t+0]^o,f[t+1]=h[t+1]^c,f[t+2]=h[t+2]^u,f[t+3]=h[t+3]^l;let r=1;for(let e=s.length-1;e>=0;e--)r=r+(255&s[e])|0,s[e]=255&r,r>>>=8;({s0:o,s1:c,s2:u,s3:l}=Yr(e,a[0],a[1],a[2],a[3]))}const p=Rr*Math.floor(h.length/4);if(p<i){const e=new Uint32Array([o,c,u,l]),t=dr(e);for(let e=p,s=0;e<i;e++,s++)n[e]=r[e]^t[s];Cr(e)}return n}function en(e,t,r,n,i){fr(r,Rr),fr(n),i=Xr(n.length,i);const s=r,a=gr(s),o=mr(s),c=gr(n),u=gr(i),l=t?0:12,h=n.length;let f=o.getUint32(l,t),{s0:p,s1:y,s2:d,s3:g}=Yr(e,a[0],a[1],a[2],a[3]);for(let r=0;r+4<=c.length;r+=4)u[r+0]=c[r+0]^p,u[r+1]=c[r+1]^y,u[r+2]=c[r+2]^d,u[r+3]=c[r+3]^g,f=f+1>>>0,o.setUint32(l,f,t),({s0:p,s1:y,s2:d,s3:g}=Yr(e,a[0],a[1],a[2],a[3]));const m=Rr*Math.floor(c.length/4);if(m<h){const e=new Uint32Array([p,y,d,g]),t=dr(e);for(let e=m,r=0;e<h;e++,r++)i[e]=n[e]^t[r];Cr(e)}return i}const tn=br({blockSize:16,nonceLength:16},(function(e,t){function r(r,n){if(fr(r),void 0!==n&&(fr(n),!Er(n)))throw Error("unaligned destination");const i=zr(e),s=Sr(t),a=[i,s];Er(r)||a.push(r=Sr(r));const o=Zr(i,s,r,n);return Cr(...a),o}return fr(e),fr(t,Rr),{encrypt:(e,t)=>r(e,t),decrypt:(e,t)=>r(e,t)}})),rn=br({blockSize:16,nonceLength:16},(function(e,t,r={}){fr(e),fr(t,16);const n=!r.disablePadding;return{encrypt(r,i){const s=zr(e),{b:a,o,out:c}=function(e,t,r){fr(e);let n=e.length;const i=n%Rr;if(!t&&0!==i)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");Er(e)||(e=Sr(e));const s=gr(e);if(t){let e=Rr-i;e||(e=Rr),n+=e}const a=Xr(n,r);return{b:s,o:gr(a),out:a}}(r,n,i);let u=t;const l=[s];Er(u)||l.push(u=Sr(u));const h=gr(u);let f=h[0],p=h[1],y=h[2],d=h[3],g=0;for(;g+4<=a.length;)f^=a[g+0],p^=a[g+1],y^=a[g+2],d^=a[g+3],({s0:f,s1:p,s2:y,s3:d}=Yr(s,f,p,y,d)),o[g++]=f,o[g++]=p,o[g++]=y,o[g++]=d;if(n){const e=function(e){const t=new Uint8Array(16),r=gr(t);t.set(e);const n=Rr-e.length;for(let e=Rr-n;e<Rr;e++)t[e]=n;return r}(r.subarray(4*g));f^=e[0],p^=e[1],y^=e[2],d^=e[3],({s0:f,s1:p,s2:y,s3:d}=Yr(s,f,p,y,d)),o[g++]=f,o[g++]=p,o[g++]=y,o[g++]=d}return Cr(...l),c},decrypt(r,i){!function(e){if(fr(e),e.length%Rr!=0)throw Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}(r);const s=Gr(e);let a=t;const o=[s];Er(a)||o.push(a=Sr(a));const c=gr(a),u=Xr(r.length,i);Er(r)||o.push(r=Sr(r));const l=gr(r),h=gr(u);let f=c[0],p=c[1],y=c[2],d=c[3];for(let e=0;e+4<=l.length;){const t=f,r=p,n=y,i=d;f=l[e+0],p=l[e+1],y=l[e+2],d=l[e+3];const{s0:a,s1:o,s2:c,s3:u}=Jr(s,f,p,y,d);h[e++]=a^t,h[e++]=o^r,h[e++]=c^n,h[e++]=u^i}return Cr(...o),function(e,t){if(!t)return e;const r=e.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");const n=e[r-1];if(n<=0||n>16)throw Error("aes/pcks5: wrong padding");const i=e.subarray(0,-n);for(let t=0;t<n;t++)if(e[r-t-1]!==n)throw Error("aes/pcks5: wrong padding");return i}(u,n)}}})),nn=br({blockSize:16,nonceLength:16},(function(e,t){function r(r,n,i){fr(r);const s=r.length;i=Xr(s,i);const a=zr(e);let o=t;const c=[a];Er(o)||c.push(o=Sr(o)),Er(r)||c.push(r=Sr(r));const u=gr(r),l=gr(i),h=n?l:u,f=gr(o);let p=f[0],y=f[1],d=f[2],g=f[3];for(let e=0;e+4<=u.length;){const{s0:t,s1:r,s2:n,s3:i}=Yr(a,p,y,d,g);l[e+0]=u[e+0]^t,l[e+1]=u[e+1]^r,l[e+2]=u[e+2]^n,l[e+3]=u[e+3]^i,p=h[e++],y=h[e++],d=h[e++],g=h[e++]}const m=Rr*Math.floor(u.length/4);if(m<s){({s0:p,s1:y,s2:d,s3:g}=Yr(a,p,y,d,g));const e=dr(new Uint32Array([p,y,d,g]));for(let t=m,n=0;t<s;t++,n++)i[t]=r[t]^e[n];Cr(e)}return Cr(...c),i}return fr(e),fr(t,16),{encrypt:(e,t)=>r(e,!0,t),decrypt:(e,t)=>r(e,!1,t)}})),sn=br({blockSize:16,nonceLength:12,tagLength:16},(function(e,t,r){if(fr(e),fr(t),void 0!==r&&fr(r),t.length<8)throw Error("aes/gcm: invalid nonce length");function n(e,t,n){const i=function(e,t,r,n,i){const s=null==i?0:i.length,a=e.create(r,n.length+s);i&&a.update(i),a.update(n);const o=new Uint8Array(16),c=mr(o);i&&wr(c,0,BigInt(8*s),t),wr(c,8,BigInt(8*n.length),t),a.update(o);const u=a.digest();return Cr(o),u}(Dr,!1,e,n,r);for(let e=0;e<t.length;e++)i[e]^=t[e];return i}function i(){const r=zr(e),n=Pr.slice(),i=Pr.slice();if(en(r,!1,i,i,n),12===t.length)i.set(t);else{const e=Pr.slice();wr(mr(e),8,BigInt(8*t.length),!1);const r=Dr.create(n).update(t).update(e);r.digestInto(i),r.destroy()}return{xk:r,authKey:n,counter:i,tagMask:en(r,!1,i,Pr)}}return{encrypt(e){fr(e);const{xk:t,authKey:r,counter:s,tagMask:a}=i(),o=new Uint8Array(e.length+16),c=[t,r,s,a];Er(e)||c.push(e=Sr(e)),en(t,!1,s,e,o);const u=n(r,a,o.subarray(0,o.length-16));return c.push(u),o.set(u,e.length),Cr(...c),o},decrypt(e){if(fr(e),e.length<16)throw Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:t,authKey:r,counter:s,tagMask:a}=i(),o=[t,r,a,s];Er(e)||o.push(e=Sr(e));const c=e.subarray(0,-16),u=e.subarray(-16),l=n(r,a,c);if(o.push(l),!Ar(l,u))throw Error("aes/gcm: invalid ghash tag");const h=en(t,!1,s,c);return Cr(...o),h}}}));function an(e){return null!=e&&"object"==typeof e&&(e instanceof Uint32Array||"Uint32Array"===e.constructor.name)}function on(e,t){if(fr(t,16),!an(e))throw Error("_encryptBlock accepts result of expandKeyLE");const r=gr(t);let{s0:n,s1:i,s2:s,s3:a}=Yr(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=i,r[2]=s,r[3]=a,t}function cn(e,t){if(fr(t,16),!an(e))throw Error("_decryptBlock accepts result of expandKeyLE");const r=gr(t);let{s0:n,s1:i,s2:s,s3:a}=Jr(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=i,r[2]=s,r[3]=a,t}const un={encrypt(e,t){if(t.length>=2**32)throw Error("plaintext should be less than 4gb");const r=zr(e);if(16===t.length)on(r,t);else{const e=gr(t);let n=e[0],i=e[1];for(let t=0,s=1;t<6;t++)for(let t=2;t<e.length;t+=2,s++){const{s0:a,s1:o,s2:c,s3:u}=Yr(r,n,i,e[t],e[t+1]);n=a,i=o^Vr(s),e[t]=c,e[t+1]=u}e[0]=n,e[1]=i}r.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const r=Gr(e),n=t.length/8-1;if(1===n)cn(r,t);else{const e=gr(t);let i=e[0],s=e[1];for(let t=0,a=6*n;t<6;t++)for(let t=2*n;t>=1;t-=2,a--){s^=Vr(a);const{s0:n,s1:o,s2:c,s3:u}=Jr(r,i,s,e[t],e[t+1]);i=n,s=o,e[t]=c,e[t+1]=u}e[0]=i,e[1]=s}r.fill(0)}},ln=new Uint8Array(8).fill(166),hn=br({blockSize:8},(e=>({encrypt(t){if(fr(t),!t.length||t.length%8!=0)throw Error("invalid plaintext length");if(8===t.length)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];fr(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}(ln,t);return un.encrypt(e,r),r},decrypt(t){if(fr(t),t.length%8!=0||t.length<24)throw Error("invalid ciphertext length");const r=Sr(t);if(un.decrypt(e,r),!Ar(r.subarray(0,8),ln))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}}))),fn={expandKeyLE:zr,expandKeyDecLE:Gr,encrypt:Yr,decrypt:Jr,encryptBlock:on,decryptBlock:cn,ctrCounter:Zr,ctr32:en};async function pn(e){switch(e){case V.symmetric.aes128:case V.symmetric.aes192:case V.symmetric.aes256:throw Error("Not a legacy cipher");case V.symmetric.cast5:case V.symmetric.blowfish:case V.symmetric.twofish:case V.symmetric.tripledes:{const{legacyCiphers:t}=await Promise.resolve().then((function(){return ch})),r=V.read(V.symmetric,e),n=t.get(r);if(!n)throw Error("Unsupported cipher algorithm");return n}default:throw Error("Unsupported cipher algorithm")}}function yn(e){switch(e){case V.symmetric.aes128:case V.symmetric.aes192:case V.symmetric.aes256:case V.symmetric.twofish:return 16;case V.symmetric.blowfish:case V.symmetric.cast5:case V.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function dn(e){switch(e){case V.symmetric.aes128:case V.symmetric.blowfish:case V.symmetric.cast5:return 16;case V.symmetric.aes192:case V.symmetric.tripledes:return 24;case V.symmetric.aes256:case V.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function gn(e){return{keySize:dn(e),blockSize:yn(e)}}const mn=Q.getWebCrypto();async function vn(e,t,r){const{keySize:n}=gn(e);if(!Q.isAES(e)||t.length!==n)throw Error("Unexpected algorithm or key size");try{const e=await mn.importKey("raw",t,{name:"AES-KW"},!1,["wrapKey"]),n=await mn.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),i=await mn.wrapKey("raw",n,e,{name:"AES-KW"});return new Uint8Array(i)}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;Q.printDebugError("Browser did not support operation: "+e.message)}return hn(t).encrypt(r)}async function An(e,t,r){const{keySize:n}=gn(e);if(!Q.isAES(e)||t.length!==n)throw Error("Unexpected algorithm or key size");let i;try{i=await mn.importKey("raw",t,{name:"AES-KW"},!1,["unwrapKey"])}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;return Q.printDebugError("Browser did not support operation: "+e.message),hn(t).decrypt(r)}try{const e=await mn.unwrapKey("raw",r,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await mn.exportKey("raw",e))}catch(e){if("OperationError"===e.name)throw Error("Key Data Integrity failed");throw e}}const bn=Q.getWebCrypto();async function wn(e,t,r,n,i){const s=V.read(V.webHash,e);if(!s)throw Error("Hash algo not supported with HKDF");const a=await bn.importKey("raw",t,"HKDF",!1,["deriveBits"]),o=await bn.deriveBits({name:"HKDF",hash:s,salt:r,info:n},a,8*i);return new Uint8Array(o)}const En={x25519:Q.encodeUTF8("OpenPGP X25519"),x448:Q.encodeUTF8("OpenPGP X448")};async function Sn(e){switch(e){case V.publicKey.x25519:{const e=be(32),{publicKey:t}=rt.box.keyPair.fromSecretKey(e);return{A:t,k:e}}case V.publicKey.x448:{const e=await Q.getNobleCurve(V.publicKey.x448),t=e.utils.randomPrivateKey();return{A:e.getPublicKey(t),k:t}}default:throw Error("Unsupported ECDH algorithm")}}async function Cn(e,t,r){switch(e){case V.publicKey.x25519:{const{publicKey:e}=rt.box.keyPair.fromSecretKey(r);return Q.equalsUint8Array(t,e)}case V.publicKey.x448:{const e=(await Q.getNobleCurve(V.publicKey.x448)).getPublicKey(r);return Q.equalsUint8Array(t,e)}default:return!1}}async function Bn(e,t,r){const{ephemeralPublicKey:n,sharedSecret:i}=await Tn(e,r),s=Q.concatUint8Array([n,r,i]);switch(e){case V.publicKey.x25519:{const e=V.symmetric.aes128,{keySize:r}=gn(e),i=await wn(V.hash.sha256,s,new Uint8Array,En.x25519,r);return{ephemeralPublicKey:n,wrappedKey:await vn(e,i,t)}}case V.publicKey.x448:{const e=V.symmetric.aes256,{keySize:r}=gn(V.symmetric.aes256),i=await wn(V.hash.sha512,s,new Uint8Array,En.x448,r);return{ephemeralPublicKey:n,wrappedKey:await vn(e,i,t)}}default:throw Error("Unsupported ECDH algorithm")}}async function In(e,t,r,n,i){const s=await Nn(e,t,0,i),a=Q.concatUint8Array([t,n,s]);switch(e){case V.publicKey.x25519:{const e=V.symmetric.aes128,{keySize:t}=gn(e);return An(e,await wn(V.hash.sha256,a,new Uint8Array,En.x25519,t),r)}case V.publicKey.x448:{const e=V.symmetric.aes256,{keySize:t}=gn(V.symmetric.aes256);return An(e,await wn(V.hash.sha512,a,new Uint8Array,En.x448,t),r)}default:throw Error("Unsupported ECDH algorithm")}}function kn(e){switch(e){case V.publicKey.x25519:return 32;case V.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function Tn(e,t){switch(e){case V.publicKey.x25519:{const r=be(kn(e)),n=rt.scalarMult(r,t);Un(n);const{publicKey:i}=rt.box.keyPair.fromSecretKey(r);return{ephemeralPublicKey:i,sharedSecret:n}}case V.publicKey.x448:{const e=await Q.getNobleCurve(V.publicKey.x448),r=e.utils.randomPrivateKey(),n=e.getSharedSecret(r,t);return Un(n),{ephemeralPublicKey:e.getPublicKey(r),sharedSecret:n}}default:throw Error("Unsupported ECDH algorithm")}}async function Nn(e,t,r,n){switch(e){case V.publicKey.x25519:{const e=rt.scalarMult(n,t);return Un(e),e}case V.publicKey.x448:{const e=(await Q.getNobleCurve(V.publicKey.x448)).getSharedSecret(n,t);return Un(e),e}default:throw Error("Unsupported ECDH algorithm")}}function Un(e){let t=0;for(let r=0;r<e.length;r++)t|=e[r];if(0===t)throw Error("Unexpected low order point")}var xn=Object.freeze({__proto__:null,decrypt:In,encrypt:Bn,generate:Sn,generateEphemeralEncryptionMaterial:Tn,getPayloadSize:kn,recomputeSharedSecret:Nn,validateParams:Cn});const Dn=Q.getWebCrypto(),Rn=Q.getNodeCrypto(),Pn={[V.curve.nistP256]:"P-256",[V.curve.nistP384]:"P-384",[V.curve.nistP521]:"P-521"},Ln=Rn?Rn.getCurves():[],_n=Rn?{[V.curve.secp256k1]:Ln.includes("secp256k1")?"secp256k1":void 0,[V.curve.nistP256]:Ln.includes("prime256v1")?"prime256v1":void 0,[V.curve.nistP384]:Ln.includes("secp384r1")?"secp384r1":void 0,[V.curve.nistP521]:Ln.includes("secp521r1")?"secp521r1":void 0,[V.curve.ed25519Legacy]:Ln.includes("ED25519")?"ED25519":void 0,[V.curve.curve25519Legacy]:Ln.includes("X25519")?"X25519":void 0,[V.curve.brainpoolP256r1]:Ln.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[V.curve.brainpoolP384r1]:Ln.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[V.curve.brainpoolP512r1]:Ln.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},Kn={[V.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:V.publicKey.ecdsa,hash:V.hash.sha256,cipher:V.symmetric.aes128,node:_n[V.curve.nistP256],web:Pn[V.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[V.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:V.publicKey.ecdsa,hash:V.hash.sha384,cipher:V.symmetric.aes192,node:_n[V.curve.nistP384],web:Pn[V.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[V.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:V.publicKey.ecdsa,hash:V.hash.sha512,cipher:V.symmetric.aes256,node:_n[V.curve.nistP521],web:Pn[V.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[V.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:V.publicKey.ecdsa,hash:V.hash.sha256,cipher:V.symmetric.aes128,node:_n[V.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[V.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:V.publicKey.eddsaLegacy,hash:V.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[V.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:V.publicKey.ecdh,hash:V.hash.sha256,cipher:V.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[V.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:V.publicKey.ecdsa,hash:V.hash.sha256,cipher:V.symmetric.aes128,node:_n[V.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[V.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:V.publicKey.ecdsa,hash:V.hash.sha384,cipher:V.symmetric.aes192,node:_n[V.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[V.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:V.publicKey.ecdsa,hash:V.hash.sha512,cipher:V.symmetric.aes256,node:_n[V.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class On{constructor(e){try{this.name=e instanceof qt?e.getName():V.write(V.curve,e)}catch(e){throw new Zt("Unknown curve")}const t=Kn[this.name];this.keyType=t.keyType,this.oid=t.oid,this.hash=t.hash,this.cipher=t.cipher,this.node=t.node,this.web=t.web,this.payloadSize=t.payloadSize,this.sharedSize=t.sharedSize,this.wireFormatLeadingByte=t.wireFormatLeadingByte,this.web&&Q.getWebCrypto()?this.type="web":this.node&&Q.getNodeCrypto()?this.type="node":this.name===V.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===V.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(e,t){const r=await Dn.generateKey({name:"ECDSA",namedCurve:Pn[e]},!0,["sign","verify"]),n=await Dn.exportKey("jwk",r.privateKey);return{publicKey:Qn(await Dn.exportKey("jwk",r.publicKey),t),privateKey:Y(n.d)}}(this.name,this.wireFormatLeadingByte)}catch(e){return Q.printDebugError("Browser did not support generating ec key "+e.message),jn(this.name)}case"node":return async function(e){const t=Rn.createECDH(_n[e]);return await t.generateKeys(),{publicKey:new Uint8Array(t.getPublicKey()),privateKey:new Uint8Array(t.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:e,A:t}=await Sn(V.publicKey.x25519),r=e.slice().reverse();return r[0]=127&r[0]|64,r[31]&=248,{publicKey:Q.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),t]),privateKey:r}}case"ed25519Legacy":{const{seed:e,A:t}=await rr(V.publicKey.ed25519);return{publicKey:Q.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),t]),privateKey:e}}default:return jn(this.name)}}}async function Mn(e){const t=new On(e),{oid:r,hash:n,cipher:i}=t,s=await t.genKeyPair();return{oid:r,Q:s.publicKey,secret:Q.leftPad(s.privateKey,t.payloadSize),hash:n,cipher:i}}function Hn(e){return Kn[e.getName()].hash}async function Vn(e,t,r,n){const i={[V.curve.nistP256]:!0,[V.curve.nistP384]:!0,[V.curve.nistP521]:!0,[V.curve.secp256k1]:!0,[V.curve.curve25519Legacy]:e===V.publicKey.ecdh,[V.curve.brainpoolP256r1]:!0,[V.curve.brainpoolP384r1]:!0,[V.curve.brainpoolP512r1]:!0},s=t.getName();if(!i[s])return!1;if(s===V.curve.curve25519Legacy){n=n.slice().reverse();const{publicKey:e}=rt.box.keyPair.fromSecretKey(n);r=new Uint8Array(r);const t=new Uint8Array([64,...e]);return!!Q.equalsUint8Array(t,r)}const a=(await Q.getNobleCurve(V.publicKey.ecdsa,s)).getPublicKey(n,!1);return!!Q.equalsUint8Array(a,r)}function Fn(e,t){const{payloadSize:r,wireFormatLeadingByte:n,name:i}=e,s=i===V.curve.curve25519Legacy||i===V.curve.ed25519Legacy?r:2*r;if(t[0]!==n||t.length!==s+1)throw Error("Invalid point encoding")}async function jn(e){const t=await Q.getNobleCurve(V.publicKey.ecdsa,e),r=t.utils.randomPrivateKey();return{publicKey:t.getPublicKey(r,!1),privateKey:r}}function Qn(e,t){const r=Y(e.x),n=Y(e.y),i=new Uint8Array(r.length+n.length+1);return i[0]=t,i.set(r,1),i.set(n,r.length+1),i}function qn(e,t,r){const n=e,i=r.slice(1,n+1),s=r.slice(n+1,2*n+1);return{kty:"EC",crv:t,x:J(i),y:J(s),ext:!0}}function zn(e,t,r,n){const i=qn(e,t,r);return i.d=J(n),i}const Gn=Q.getWebCrypto(),$n=Q.getNodeCrypto();async function Wn(e,t,r,n,i,s){const a=new On(e);if(Fn(a,n),r&&!Q.isStream(r)){const s={publicKey:n,privateKey:i};switch(a.type){case"web":try{return await async function(e,t,r,n){const i=e.payloadSize,s=zn(e.payloadSize,Pn[e.name],n.publicKey,n.privateKey),a=await Gn.importKey("jwk",s,{name:"ECDSA",namedCurve:Pn[e.name],hash:{name:V.read(V.webHash,e.hash)}},!1,["sign"]),o=new Uint8Array(await Gn.sign({name:"ECDSA",namedCurve:Pn[e.name],hash:{name:V.read(V.webHash,t)}},a,r));return{r:o.slice(0,i),s:o.slice(i,i<<1)}}(a,t,r,s)}catch(e){if("nistP521"!==a.name&&("DataError"===e.name||"OperationError"===e.name))throw e;Q.printDebugError("Browser did not support signing: "+e.message)}break;case"node":return async function(e,t,r,n){const i=Q.nodeRequire("eckey-utils"),s=Q.getNodeBuffer(),{privateKey:a}=i.generateDer({curveName:_n[e.name],privateKey:s.from(n)}),o=$n.createSign(V.read(V.hash,t));o.write(r),o.end();const c=new Uint8Array(o.sign({key:a,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),u=e.payloadSize;return{r:c.subarray(0,u),s:c.subarray(u,u<<1)}}(a,t,r,i)}}const o=(await Q.getNobleCurve(V.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:ve(o.r,"be",a.payloadSize),s:ve(o.s,"be",a.payloadSize)}}async function Yn(e,t,r,n,i,s){const a=new On(e);Fn(a,i);const o=async()=>0===s[0]&&Jn(a,r,s.subarray(1),i);if(n&&!Q.isStream(n))switch(a.type){case"web":try{const e=await async function(e,t,{r,s:n},i,s){const a=qn(e.payloadSize,Pn[e.name],s),o=await Gn.importKey("jwk",a,{name:"ECDSA",namedCurve:Pn[e.name],hash:{name:V.read(V.webHash,e.hash)}},!1,["verify"]),c=Q.concatUint8Array([r,n]).buffer;return Gn.verify({name:"ECDSA",namedCurve:Pn[e.name],hash:{name:V.read(V.webHash,t)}},o,c,i)}(a,t,r,n,i);return e||o()}catch(e){if("nistP521"!==a.name&&("DataError"===e.name||"OperationError"===e.name))throw e;Q.printDebugError("Browser did not support verifying: "+e.message)}break;case"node":{const e=await async function(e,t,{r,s:n},i,s){const a=Q.nodeRequire("eckey-utils"),o=Q.getNodeBuffer(),{publicKey:c}=a.generateDer({curveName:_n[e.name],publicKey:o.from(s)}),u=$n.createVerify(V.read(V.hash,t));u.write(i),u.end();const l=Q.concatUint8Array([r,n]);try{return u.verify({key:c,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},l)}catch(e){return!1}}(a,t,r,n,i);return e||o()}}return await Jn(a,r,s,i)||o()}async function Jn(e,t,r,n){return(await Q.getNobleCurve(V.publicKey.ecdsa,e.name)).verify(Q.concatUint8Array([t.r,t.s]),r,n,{lowS:!1})}var Xn=Object.freeze({__proto__:null,sign:Wn,validateParams:async function(e,t,r){const n=new On(e);if(n.keyType!==V.publicKey.ecdsa)return!1;switch(n.type){case"web":case"node":{const n=be(8),i=V.hash.sha256,s=await He(i,n);try{const a=await Wn(e,i,n,t,r,s);return await Yn(e,i,a,n,t,s)}catch(e){return!1}}default:return Vn(V.publicKey.ecdsa,e,t,r)}},verify:Yn});async function Zn(e,t,r,n,i,s){if(Fn(new On(e),n),Ve(t)<Ve(V.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await nr(V.publicKey.ed25519,t,0,n.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}}async function ei(e,t,{r,s:n},i,s,a){if(Fn(new On(e),s),Ve(t)<Ve(V.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=Q.concatUint8Array([r,n]);return ir(V.publicKey.ed25519,t,{RS:o},0,s.subarray(1),a)}async function ti(e,t,r){if(e.getName()!==V.curve.ed25519Legacy)return!1;const{publicKey:n}=rt.sign.keyPair.fromSeed(r),i=new Uint8Array([64,...n]);return Q.equalsUint8Array(t,i)}var ri=Object.freeze({__proto__:null,sign:Zn,validateParams:ti,verify:ei});function ni(e){const t=e.length;if(t>0){const r=e[t-1];if(r>=1){const n=e.subarray(t-r),i=new Uint8Array(r).fill(r);if(Q.equalsUint8Array(n,i))return e.subarray(0,t-r)}}throw Error("Invalid padding")}const ii=Q.getWebCrypto(),si=Q.getNodeCrypto();function ai(e,t,r,n){return Q.concatUint8Array([t.write(),new Uint8Array([e]),r.write(),Q.stringToUint8Array("Anonymous Sender    "),n])}async function oi(e,t,r,n,i=!1,s=!1){let a;if(i){for(a=0;a<t.length&&0===t[a];a++);t=t.subarray(a)}if(s){for(a=t.length-1;a>=0&&0===t[a];a--);t=t.subarray(0,a+1)}return(await He(e,Q.concatUint8Array([new Uint8Array([0,0,0,1]),t,n]))).subarray(0,r)}async function ci(e,t,r,n,i){const s=function(e){const t=8-e.length%8,r=new Uint8Array(e.length+t).fill(t);return r.set(e),r}(r),a=new On(e);Fn(a,n);const{publicKey:o,sharedKey:c}=await async function(e,t){switch(e.type){case"curve25519Legacy":{const{sharedSecret:r,ephemeralPublicKey:n}=await Tn(V.publicKey.x25519,t.subarray(1));return{publicKey:Q.concatUint8Array([new Uint8Array([e.wireFormatLeadingByte]),n]),sharedKey:r}}case"web":if(e.web&&Q.getWebCrypto())try{return await async function(e,t){const r=qn(e.payloadSize,e.web,t);let n=ii.generateKey({name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]),i=ii.importKey("jwk",r,{name:"ECDH",namedCurve:e.web},!1,[]);[n,i]=await Promise.all([n,i]);let s=ii.deriveBits({name:"ECDH",namedCurve:e.web,public:i},n.privateKey,e.sharedSize),a=ii.exportKey("jwk",n.publicKey);[s,a]=await Promise.all([s,a]);const o=new Uint8Array(s);return{publicKey:new Uint8Array(Qn(a,e.wireFormatLeadingByte)),sharedKey:o}}(e,t)}catch(r){return Q.printDebugError(r),hi(e,t)}break;case"node":return async function(e,t){const r=si.createECDH(e.node);r.generateKeys();const n=new Uint8Array(r.computeSecret(t));return{publicKey:new Uint8Array(r.getPublicKey()),sharedKey:n}}(e,t);default:return hi(e,t)}}(a,n),u=ai(V.publicKey.ecdh,e,t,i),{keySize:l}=gn(t.cipher),h=await oi(t.hash,c,l,u);return{publicKey:o,wrappedKey:await vn(t.cipher,h,s)}}async function ui(e,t,r,n,i,s,a){const o=new On(e);Fn(o,i),Fn(o,r);const{sharedKey:c}=await async function(e,t,r,n){if(n.length!==e.payloadSize){const t=new Uint8Array(e.payloadSize);t.set(n,e.payloadSize-n.length),n=t}switch(e.type){case"curve25519Legacy":{const e=n.slice().reverse();return{secretKey:e,sharedKey:await Nn(V.publicKey.x25519,t.subarray(1),r.subarray(1),e)}}case"web":if(e.web&&Q.getWebCrypto())try{return await async function(e,t,r,n){const i=zn(e.payloadSize,e.web,r,n);let s=ii.importKey("jwk",i,{name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]);const a=qn(e.payloadSize,e.web,t);let o=ii.importKey("jwk",a,{name:"ECDH",namedCurve:e.web},!0,[]);[s,o]=await Promise.all([s,o]);let c=ii.deriveBits({name:"ECDH",namedCurve:e.web,public:o},s,e.sharedSize),u=ii.exportKey("jwk",s);[c,u]=await Promise.all([c,u]);const l=new Uint8Array(c);return{secretKey:Y(u.d),sharedKey:l}}(e,t,r,n)}catch(r){return Q.printDebugError(r),li(e,t,n)}break;case"node":return async function(e,t,r){const n=si.createECDH(e.node);n.setPrivateKey(r);const i=new Uint8Array(n.computeSecret(t));return{secretKey:new Uint8Array(n.getPrivateKey()),sharedKey:i}}(e,t,n);default:return li(e,t,n)}}(o,r,i,s),u=ai(V.publicKey.ecdh,e,t,a),{keySize:l}=gn(t.cipher);let h;for(let r=0;r<3;r++)try{const e=await oi(t.hash,c,l,u,1===r,2===r);return ni(await An(t.cipher,e,n))}catch(e){h=e}throw h}async function li(e,t,r){return{secretKey:r,sharedKey:(await Q.getNobleCurve(V.publicKey.ecdh,e.name)).getSharedSecret(r,t).subarray(1)}}async function hi(e,t){const r=await Q.getNobleCurve(V.publicKey.ecdh,e.name),{publicKey:n,privateKey:i}=await e.genKeyPair();return{publicKey:n,sharedKey:r.getSharedSecret(i,t).subarray(1)}}var fi=Object.freeze({__proto__:null,CurveWithOID:On,ecdh:Object.freeze({__proto__:null,decrypt:ui,encrypt:ci,validateParams:async function(e,t,r){return Vn(V.publicKey.ecdh,e,t,r)}}),ecdhX:xn,ecdsa:Xn,eddsa:lr,eddsaLegacy:ri,generate:Mn,getPreferredHashAlgo:Hn});const pi=BigInt(0),yi=BigInt(1);class di{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.data=e.subarray(1,1+t),1+this.data.length}throw Error("Invalid symmetric key")}write(){return Q.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class gi{constructor(e){if(e){const{hash:t,cipher:r}=e;this.hash=t,this.cipher=r}else this.hash=null,this.cipher=null}read(e){if(e.length<4||3!==e[0]||1!==e[1])throw new Zt("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class mi{static fromObject({wrappedKey:e,algorithm:t}){const r=new mi;return r.wrappedKey=e,r.algorithm=t,r}read(e){let t=0,r=e[t++];this.algorithm=r%2?e[t++]:null,r-=r%2,this.wrappedKey=Q.readExactSubarray(e,t,t+r),t+=r}write(){return Q.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}function vi(e,t,r){let n=0;switch(e){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:case V.publicKey.rsaSign:{const e=Q.readMPI(t.subarray(n));n+=e.length+2;const r=Q.readMPI(t.subarray(n));n+=r.length+2;const i=Q.readMPI(t.subarray(n));n+=i.length+2;const s=Q.readMPI(t.subarray(n));return n+=s.length+2,{read:n,privateParams:{d:e,p:r,q:i,u:s}}}case V.publicKey.dsa:case V.publicKey.elgamal:{const e=Q.readMPI(t.subarray(n));return n+=e.length+2,{read:n,privateParams:{x:e}}}case V.publicKey.ecdsa:case V.publicKey.ecdh:{const i=Ei(e,r.oid);let s=Q.readMPI(t.subarray(n));return n+=s.length+2,s=Q.leftPad(s,i),{read:n,privateParams:{d:s}}}case V.publicKey.eddsaLegacy:{const i=Ei(e,r.oid);if(r.oid.getName()!==V.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=Q.readMPI(t.subarray(n));return n+=s.length+2,s=Q.leftPad(s,i),{read:n,privateParams:{seed:s}}}case V.publicKey.ed25519:case V.publicKey.ed448:{const r=Ei(e),i=Q.readExactSubarray(t,n,n+r);return n+=i.length,{read:n,privateParams:{seed:i}}}case V.publicKey.x25519:case V.publicKey.x448:{const r=Ei(e),i=Q.readExactSubarray(t,n,n+r);return n+=i.length,{read:n,privateParams:{k:i}}}default:throw new Zt("Unknown public key encryption algorithm.")}}function Ai(e,t){const r=new Set([V.publicKey.ed25519,V.publicKey.x25519,V.publicKey.ed448,V.publicKey.x448]),n=Object.keys(t).map((n=>{const i=t[n];return Q.isUint8Array(i)?r.has(e)?i:Q.uint8ArrayToMPI(i):i.write()}));return Q.concatUint8Array(n)}function bi(e){const{keySize:t}=gn(e);return be(t)}function wi(e){try{e.getName()}catch(e){throw new Zt("Unknown curve OID")}}function Ei(e,t){switch(e){case V.publicKey.ecdsa:case V.publicKey.ecdh:case V.publicKey.eddsaLegacy:return new On(t).payloadSize;case V.publicKey.ed25519:case V.publicKey.ed448:return ar(e);case V.publicKey.x25519:case V.publicKey.x448:return kn(e);default:throw Error("Unknown elliptic algo")}}const Si=Q.getWebCrypto(),Ci=Q.getNodeCrypto(),Bi=Ci?Ci.getCiphers():[],Ii={idea:Bi.includes("idea-cfb")?"idea-cfb":void 0,tripledes:Bi.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:Bi.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:Bi.includes("bf-cfb")?"bf-cfb":void 0,aes128:Bi.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:Bi.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:Bi.includes("aes-256-cfb")?"aes-256-cfb":void 0};async function ki(e,t,r,n,i){const s=V.read(V.symmetric,e);if(Q.getNodeCrypto()&&Ii[s])return function(e,t,r,n){const i=V.read(V.symmetric,e),s=new Ci.createCipheriv(Ii[i],t,n);return T(r,(e=>new Uint8Array(s.update(e))))}(e,t,r,n);if(Q.isAES(e))return async function(e,t,r,n){if(Si&&await Ni.isSupported(e)){const i=new Ni(e,t,n);return Q.isStream(r)?T(r,(e=>i.encryptChunk(e)),(()=>i.finish())):i.encrypt(r)}if(Q.isStream(r)){const i=new Ui(!0,e,t,n);return T(r,(e=>i.processChunk(e)),(()=>i.finish()))}return nn(t,n).encrypt(r)}(e,t,r,n);const a=new(await pn(e))(t),o=a.blockSize,c=n.slice();let u=new Uint8Array;const l=e=>{e&&(u=Q.concatUint8Array([u,e]));const t=new Uint8Array(u.length);let r,n=0;for(;e?u.length>=o:u.length;){const e=a.encrypt(c);for(r=0;r<o;r++)c[r]=u[r]^e[r],t[n++]=c[r];u=u.subarray(o)}return t.subarray(0,n)};return T(r,l,l)}async function Ti(e,t,r,n){const i=V.read(V.symmetric,e);if(Ci&&Ii[i])return function(e,t,r,n){const i=V.read(V.symmetric,e),s=new Ci.createDecipheriv(Ii[i],t,n);return T(r,(e=>new Uint8Array(s.update(e))))}(e,t,r,n);if(Q.isAES(e))return async function(e,t,r,n){if(Q.isStream(r)){const i=new Ui(!1,e,t,n);return T(r,(e=>i.processChunk(e)),(()=>i.finish()))}return nn(t,n).decrypt(r)}(e,t,r,n);const s=new(await pn(e))(t),a=s.blockSize;let o=n,c=new Uint8Array;const u=e=>{e&&(c=Q.concatUint8Array([c,e]));const t=new Uint8Array(c.length);let r,n=0;for(;e?c.length>=a:c.length;){const e=s.encrypt(o);for(o=c.subarray(0,a),r=0;r<a;r++)t[n++]=o[r]^e[r];c=c.subarray(a)}return t.subarray(0,n)};return T(r,u,u)}class Ni{constructor(e,t,r){const{blockSize:n}=gn(e);this.key=t,this.prevBlock=r,this.nextBlock=new Uint8Array(n),this.i=0,this.blockSize=n,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(e){const{keySize:t}=gn(e);return Si.importKey("raw",new Uint8Array(t),"aes-cbc",!1,["encrypt"]).then((()=>!0),(()=>!1))}async _runCBC(e,t){const r="AES-CBC";this.keyRef=this.keyRef||await Si.importKey("raw",this.key,r,!1,["encrypt"]);const n=await Si.encrypt({name:r,iv:t||this.zeroBlock},this.keyRef,e);return new Uint8Array(n).subarray(0,e.length)}async encryptChunk(e){const t=this.nextBlock.length-this.i,r=e.subarray(0,t);if(this.nextBlock.set(r,this.i),this.i+e.length>=2*this.blockSize){const r=(e.length-t)%this.blockSize,n=Q.concatUint8Array([this.nextBlock,e.subarray(t,e.length-r)]),i=Q.concatUint8Array([this.prevBlock,n.subarray(0,n.length-this.blockSize)]),s=await this._runCBC(i);return xi(s,n),this.prevBlock=s.slice(-this.blockSize),r>0&&this.nextBlock.set(e.subarray(-r)),this.i=r,s}let n;if(this.i+=r.length,this.i===this.nextBlock.length){const t=this.nextBlock;n=await this._runCBC(this.prevBlock),xi(n,t),this.prevBlock=n.slice(),this.i=0;const i=e.subarray(r.length);this.nextBlock.set(i,this.i),this.i+=i.length}else n=new Uint8Array;return n}async finish(){let e;if(0===this.i)e=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const t=this.nextBlock,r=await this._runCBC(this.prevBlock);xi(r,t),e=r.subarray(0,t.length)}return this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(e){const t=(await this._runCBC(Q.concatUint8Array([new Uint8Array(this.blockSize),e]),this.iv)).subarray(0,e.length);return xi(t,e),this.clearSensitiveData(),t}}class Ui{constructor(e,t,r,n){this.forEncryption=e;const{blockSize:i}=gn(t);this.key=fn.expandKeyLE(r),n.byteOffset%4!=0&&(n=n.slice()),this.prevBlock=Di(n),this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i}_runCFB(e){const t=Di(e),r=new Uint8Array(e.length),n=Di(r);for(let e=0;e+4<=n.length;e+=4){const{s0:r,s1:i,s2:s,s3:a}=fn.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);n[e+0]=t[e+0]^r,n[e+1]=t[e+1]^i,n[e+2]=t[e+2]^s,n[e+3]=t[e+3]^a,this.prevBlock=(this.forEncryption?n:t).slice(e,e+4)}return r}async processChunk(e){const t=this.nextBlock.length-this.i,r=e.subarray(0,t);if(this.nextBlock.set(r,this.i),this.i+e.length>=2*this.blockSize){const r=(e.length-t)%this.blockSize,n=Q.concatUint8Array([this.nextBlock,e.subarray(t,e.length-r)]),i=this._runCFB(n);return r>0&&this.nextBlock.set(e.subarray(-r)),this.i=r,i}let n;if(this.i+=r.length,this.i===this.nextBlock.length){n=this._runCFB(this.nextBlock),this.i=0;const t=e.subarray(r.length);this.nextBlock.set(t,this.i),this.i+=t.length}else n=new Uint8Array;return n}async finish(){let e;return e=0===this.i?new Uint8Array:this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function xi(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++)e[n]=e[n]^t[n]}const Di=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ri=Q.getWebCrypto(),Pi=Q.getNodeCrypto(),Li=16;function _i(e,t){const r=e.length-Li;for(let n=0;n<Li;n++)e[n+r]^=t[n];return e}const Ki=new Uint8Array(Li);const Oi=Q.getWebCrypto(),Mi=Q.getNodeCrypto(),Hi=Q.getNodeBuffer(),Vi=new Uint8Array(16),Fi=new Uint8Array(16);Fi[15]=1;const ji=new Uint8Array(16);async function Qi(e){const t=await async function(e){const t=await async function(e){if(Q.getNodeCrypto())return async function(t){const r=new Pi.createCipheriv("aes-"+8*e.length+"-cbc",e,Ki).update(t);return new Uint8Array(r)};if(Q.getWebCrypto())try{return e=await Ri.importKey("raw",e,{name:"AES-CBC",length:8*e.length},!1,["encrypt"]),async function(t){const r=await Ri.encrypt({name:"AES-CBC",iv:Ki,length:128},e,t);return new Uint8Array(r).subarray(0,r.byteLength-Li)}}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;Q.printDebugError("Browser did not support operation: "+t.message)}return async function(t){return rn(e,Ki,{disablePadding:!0}).encrypt(t)}}(e),r=Q.double(await t(Ki)),n=Q.double(r);return async function(e){return(await t(function(e,t,r){if(e.length&&e.length%Li==0)return _i(e,t);const n=new Uint8Array(e.length+(Li-e.length%Li));return n.set(e),n[e.length]=128,_i(n,r)}(e,r,n))).subarray(-16)}}(e);return function(e,r){return t(Q.concatUint8Array([e,r]))}}async function qi(e){if(Q.getNodeCrypto())return async function(t,r){const n=new Mi.createCipheriv("aes-"+8*e.length+"-ctr",e,r),i=Hi.concat([n.update(t),n.final()]);return new Uint8Array(i)};if(Q.getWebCrypto())try{const t=await Oi.importKey("raw",e,{name:"AES-CTR",length:8*e.length},!1,["encrypt"]);return async function(e,r){const n=await Oi.encrypt({name:"AES-CTR",counter:r,length:128},t,e);return new Uint8Array(n)}}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;Q.printDebugError("Browser did not support operation: "+t.message)}return async function(t,r){return tn(e,r).encrypt(t)}}async function zi(e,t){if(e!==V.symmetric.aes128&&e!==V.symmetric.aes192&&e!==V.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,n]=await Promise.all([Qi(t),qi(t)]);return{encrypt:async function(e,t,i){const[s,a]=await Promise.all([r(Vi,t),r(Fi,i)]),o=await n(e,s),c=await r(ji,o);for(let e=0;e<16;e++)c[e]^=a[e]^s[e];return Q.concatUint8Array([o,c])},decrypt:async function(e,t,i){if(e.length<16)throw Error("Invalid EAX ciphertext");const s=e.subarray(0,-16),a=e.subarray(-16),[o,c,u]=await Promise.all([r(Vi,t),r(Fi,i),r(ji,s)]),l=u;for(let e=0;e<16;e++)l[e]^=c[e]^o[e];if(!Q.equalsUint8Array(a,l))throw Error("Authentication tag mismatch");return await n(s,o)}}}ji[15]=2,zi.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[8+e]^=t[e];return r},zi.blockLength=16,zi.ivLength=16,zi.tagLength=16;const Gi=16;function $i(e){let t=0;for(let r=1;!(e&r);r<<=1)t++;return t}function Wi(e,t){for(let r=0;r<e.length;r++)e[r]^=t[r];return e}function Yi(e,t){return Wi(e.slice(),t)}const Ji=new Uint8Array(Gi),Xi=new Uint8Array([1]);async function Zi(e,t){const{keySize:r}=gn(e);if(!Q.isAES(e)||t.length!==r)throw Error("Unexpected algorithm or key size");let n=0;const i=rn(t,Ji,{disablePadding:!0}),s=e=>i.encrypt(e),a=e=>i.decrypt(e);let o;function c(e,t,r,i){const a=t.length/Gi|0;!function(e,t){const r=Q.nbits(Math.max(e.length,t.length)/Gi|0)-1;for(let e=n+1;e<=r;e++)o[e]=Q.double(o[e-1]);n=r}(t,i);const c=Q.concatUint8Array([Ji.subarray(0,15-r.length),Xi,r]),u=63&c[15];c[15]&=192;const l=s(c),h=Q.concatUint8Array([l,Yi(l.subarray(0,8),l.subarray(1,9))]),f=Q.shiftRight(h.subarray(0+(u>>3),17+(u>>3)),8-(7&u)).subarray(1),p=new Uint8Array(Gi),y=new Uint8Array(t.length+16);let d,g=0;for(d=0;d<a;d++)Wi(f,o[$i(d+1)]),y.set(Wi(e(Yi(f,t)),f),g),Wi(p,e===s?t:y.subarray(g)),t=t.subarray(Gi),g+=Gi;if(t.length){Wi(f,o.x);const r=s(f);y.set(Yi(t,r),g);const n=new Uint8Array(Gi);n.set(e===s?t:y.subarray(g,-16),0),n[t.length]=128,Wi(p,n),g+=t.length}const m=Wi(s(Wi(Wi(p,f),o.$)),function(e){if(!e.length)return Ji;const t=e.length/Gi|0,r=new Uint8Array(Gi),n=new Uint8Array(Gi);for(let i=0;i<t;i++)Wi(r,o[$i(i+1)]),Wi(n,s(Yi(r,e))),e=e.subarray(Gi);if(e.length){Wi(r,o.x);const t=new Uint8Array(Gi);t.set(e,0),t[e.length]=128,Wi(t,r),Wi(n,s(t))}return n}(i));return y.set(m,g),y}return function(){const e=s(Ji),t=Q.double(e);o=[],o[0]=Q.double(t),o.x=e,o.$=t}(),{encrypt:async function(e,t,r){return c(s,e,t,r)},decrypt:async function(e,t,r){if(e.length<16)throw Error("Invalid OCB ciphertext");const n=e.subarray(-16);e=e.subarray(0,-16);const i=c(a,e,t,r);if(Q.equalsUint8Array(n,i.subarray(-16)))return i.subarray(0,-16);throw Error("Authentication tag mismatch")}}}Zi.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[7+e]^=t[e];return r},Zi.blockLength=Gi,Zi.ivLength=15,Zi.tagLength=16;const es=Q.getWebCrypto(),ts=Q.getNodeCrypto(),rs=Q.getNodeBuffer(),ns="AES-GCM";async function is(e,t){if(e!==V.symmetric.aes128&&e!==V.symmetric.aes192&&e!==V.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(Q.getNodeCrypto())return{encrypt:async function(e,r,n=new Uint8Array){const i=new ts.createCipheriv("aes-"+8*t.length+"-gcm",t,r);i.setAAD(n);const s=rs.concat([i.update(e),i.final(),i.getAuthTag()]);return new Uint8Array(s)},decrypt:async function(e,r,n=new Uint8Array){const i=new ts.createDecipheriv("aes-"+8*t.length+"-gcm",t,r);i.setAAD(n),i.setAuthTag(e.slice(e.length-16,e.length));const s=rs.concat([i.update(e.slice(0,e.length-16)),i.final()]);return new Uint8Array(s)}};if(Q.getWebCrypto())try{const e=await es.importKey("raw",t,{name:ns},!1,["encrypt","decrypt"]),r=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(n,i,s=new Uint8Array){if(r&&!n.length)return sn(t,i,s).encrypt(n);const a=await es.encrypt({name:ns,iv:i,additionalData:s,tagLength:128},e,n);return new Uint8Array(a)},decrypt:async function(n,i,s=new Uint8Array){if(r&&16===n.length)return sn(t,i,s).decrypt(n);try{const t=await es.decrypt({name:ns,iv:i,additionalData:s,tagLength:128},e,n);return new Uint8Array(t)}catch(e){if("OperationError"===e.name)throw Error("Authentication tag mismatch")}}}}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;Q.printDebugError("Browser did not support operation: "+e.message)}return{encrypt:async function(e,r,n){return sn(t,r,n).encrypt(e)},decrypt:async function(e,r,n){return sn(t,r,n).decrypt(e)}}}function ss(e,t=!1){switch(e){case V.aead.eax:return zi;case V.aead.ocb:return Zi;case V.aead.gcm:return is;case V.aead.experimentalGCM:if(!t)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return is;default:throw Error("Unsupported AEAD mode")}}is.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[4+e]^=t[e];return r},is.blockLength=16,is.ivLength=12,is.tagLength=16;class as extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,as),this.name="Argon2OutOfMemoryError"}}let os,cs;class us{constructor(e=F){const{passes:t,parallelism:r,memoryExponent:n}=e.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=t,this.p=r,this.encodedM=n}generateSalt(){this.salt=be(16)}read(e){let t=0;return this.salt=e.subarray(t,t+16),t+=16,this.t=e[t++],this.p=e[t++],this.encodedM=e[t++],t}write(){const e=[new Uint8Array([V.write(V.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return Q.concatUint8Array(e)}async produceKey(e,t){const r=2<<this.encodedM-1;try{os=os||(await Promise.resolve().then((function(){return Uh}))).default,cs=cs||os();const n=(await cs)({version:19,type:2,password:Q.encodeUTF8(e),salt:this.salt,tagLength:t,memorySize:r,parallelism:this.p,passes:this.t});return r>1048576&&(cs=os(),cs.catch((()=>{}))),n}catch(e){throw e.message&&(e.message.includes("Unable to grow instance memory")||e.message.includes("failed to grow memory")||e.message.includes("WebAssembly.Memory.grow")||e.message.includes("Out of memory"))?new as("Could not allocate required memory for Argon2"):e}}}class ls{constructor(e,t=F){this.algorithm=V.hash.sha256,this.type=V.read(V.s2k,e),this.c=t.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=be(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let t=0;switch(this.algorithm=e[t++],this.type){case"simple":break;case"salted":this.salt=e.subarray(t,t+8),t+=8;break;case"iterated":this.salt=e.subarray(t,t+8),t+=8,this.c=e[t++];break;case"gnu":if("GNU"!==Q.uint8ArrayToString(e.subarray(t,t+3)))throw new Zt("Unknown s2k type.");if(t+=3,1001!==1e3+e[t++])throw new Zt("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new Zt("Unknown s2k type.")}return t}write(){if("gnu-dummy"===this.type)return new Uint8Array([101,0,...Q.stringToUint8Array("GNU"),1]);const e=[new Uint8Array([V.write(V.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return Q.concatUint8Array(e)}async produceKey(e,t){e=Q.encodeUTF8(e);const r=[];let n=0,i=0;for(;n<t;){let t;switch(this.type){case"simple":t=Q.concatUint8Array([new Uint8Array(i),e]);break;case"salted":t=Q.concatUint8Array([new Uint8Array(i),this.salt,e]);break;case"iterated":{const r=Q.concatUint8Array([this.salt,e]);let n=r.length;const s=Math.max(this.getCount(),n);t=new Uint8Array(i+s),t.set(r,i);for(let e=i+n;e<s;e+=n,n*=2)t.copyWithin(e,i,e);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const s=await He(this.algorithm,t);r.push(s),n+=s.length,i++}return Q.concatUint8Array(r).subarray(0,t)}}const hs=new Set([V.s2k.argon2,V.s2k.iterated]);function fs(e,t=F){switch(e){case V.s2k.argon2:return new us(t);case V.s2k.iterated:case V.s2k.gnu:case V.s2k.salted:case V.s2k.simple:return new ls(e,t);default:throw new Zt("Unsupported S2K type")}}function ps(e){const{s2kType:t}=e;if(!hs.has(t))throw Error("The provided `config.s2kType` value is not allowed");return fs(t,e)}var ys=Uint8Array,ds=Uint16Array,gs=Uint32Array,ms=new ys([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vs=new ys([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),As=new ys([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bs=function(e,t){for(var r=new ds(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var i=new gs(r[30]);for(n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},ws=bs(ms,2),Es=ws[0],Ss=ws[1];Es[28]=258,Ss[258]=28;for(var Cs=bs(vs,0),Bs=Cs[0],Is=Cs[1],ks=new ds(32768),Ts=0;Ts<32768;++Ts){var Ns=(43690&Ts)>>>1|(21845&Ts)<<1;Ns=(61680&(Ns=(52428&Ns)>>>2|(13107&Ns)<<2))>>>4|(3855&Ns)<<4,ks[Ts]=((65280&Ns)>>>8|(255&Ns)<<8)>>>1}var Us=function(e,t,r){for(var n=e.length,i=0,s=new ds(t);i<n;++i)e[i]&&++s[e[i]-1];var a,o=new ds(t);for(i=0;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;if(r){a=new ds(1<<t);var c=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],l=t-e[i],h=o[e[i]-1]++<<l,f=h|(1<<l)-1;h<=f;++h)a[ks[h]>>>c]=u}else for(a=new ds(n),i=0;i<n;++i)e[i]&&(a[i]=ks[o[e[i]-1]++]>>>15-e[i]);return a},xs=new ys(288);for(Ts=0;Ts<144;++Ts)xs[Ts]=8;for(Ts=144;Ts<256;++Ts)xs[Ts]=9;for(Ts=256;Ts<280;++Ts)xs[Ts]=7;for(Ts=280;Ts<288;++Ts)xs[Ts]=8;var Ds=new ys(32);for(Ts=0;Ts<32;++Ts)Ds[Ts]=5;var Rs=Us(xs,9,0),Ps=Us(xs,9,1),Ls=Us(Ds,5,0),_s=Us(Ds,5,1),Ks=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Os=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},Ms=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},Hs=function(e){return(e+7)/8|0},Vs=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(2==e.BYTES_PER_ELEMENT?ds:4==e.BYTES_PER_ELEMENT?gs:ys)(r-t);return n.set(e.subarray(t,r)),n},Fs=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],js=function(e,t,r){var n=Error(t||Fs[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,js),!r)throw n;return n},Qs=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8},qs=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},zs=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return[Zs,0];if(1==i){var a=new ys(r[0].s+1);return a[r[0].s]=1,[a,1]}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,l=1,h=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};l!=i-1;)o=r[r[u].f<r[h].f?u++:h++],c=r[u!=l&&r[u].f<r[h].f?u++:h++],r[l++]={s:-1,f:o.f+c.f,l:o,r:c};var f=s[0].s;for(n=1;n<i;++n)s[n].s>f&&(f=s[n].s);var p=new ds(f+1),y=Gs(r[l-1],p,0);if(y>t){n=0;var d=0,g=y-t,m=1<<g;for(s.sort((function(e,t){return p[t.s]-p[e.s]||e.f-t.f}));n<i;++n){var v=s[n].s;if(!(p[v]>t))break;d+=m-(1<<y-p[v]),p[v]=t}for(d>>>=g;d>0;){var A=s[n].s;p[A]<t?d-=1<<t-p[A]++-1:++n}for(;n>=0&&d;--n){var b=s[n].s;p[b]==t&&(--p[b],++d)}y=t}return[new ys(p),y]},Gs=function(e,t,r){return-1==e.s?Math.max(Gs(e.l,t,r+1),Gs(e.r,t,r+1)):t[e.s]=r},$s=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ds(++t),n=0,i=e[0],s=1,a=function(e){r[n++]=e},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=e[o]}return[r.subarray(0,n),t]},Ws=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},Ys=function(e,t,r){var n=r.length,i=Hs(t+2);e[i]=255&n,e[i+1]=n>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<n;++s)e[i+s+4]=r[s];return 8*(i+4+n)},Js=function(e,t,r,n,i,s,a,o,c,u,l){Qs(t,l++,r),++i[256];for(var h=zs(i,15),f=h[0],p=h[1],y=zs(s,15),d=y[0],g=y[1],m=$s(f),v=m[0],A=m[1],b=$s(d),w=b[0],E=b[1],S=new ds(19),C=0;C<v.length;++C)S[31&v[C]]++;for(C=0;C<w.length;++C)S[31&w[C]]++;for(var B=zs(S,7),I=B[0],k=B[1],T=19;T>4&&!I[As[T-1]];--T);var N,U,x,D,R=u+5<<3,P=Ws(i,xs)+Ws(s,Ds)+a,L=Ws(i,f)+Ws(s,d)+a+14+3*T+Ws(S,I)+(2*S[16]+3*S[17]+7*S[18]);if(R<=P&&R<=L)return Ys(t,l,e.subarray(c,c+u));if(Qs(t,l,1+(L<P)),l+=2,L<P){N=Us(f,p,0),U=f,x=Us(d,g,0),D=d;var _=Us(I,k,0);for(Qs(t,l,A-257),Qs(t,l+5,E-1),Qs(t,l+10,T-4),l+=14,C=0;C<T;++C)Qs(t,l+3*C,I[As[C]]);l+=3*T;for(var K=[v,w],O=0;O<2;++O){var M=K[O];for(C=0;C<M.length;++C){var H=31&M[C];Qs(t,l,_[H]),l+=I[H],H>15&&(Qs(t,l,M[C]>>>5&127),l+=M[C]>>>12)}}}else N=Rs,U=xs,x=Ls,D=Ds;for(C=0;C<o;++C)if(n[C]>255){H=n[C]>>>18&31,qs(t,l,N[H+257]),l+=U[H+257],H>7&&(Qs(t,l,n[C]>>>23&31),l+=ms[H]);var V=31&n[C];qs(t,l,x[V]),l+=D[V],V>3&&(qs(t,l,n[C]>>>5&8191),l+=vs[V])}else qs(t,l,N[n[C]]),l+=U[n[C]];return qs(t,l,N[256]),l+U[256]},Xs=new gs([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Zs=new ys(0),ea=function(e,t,r,n,i){return function(e,t,r,n,i,s){var a=e.length,o=new ys(n+a+5*(1+Math.ceil(a/7e3))+i),c=o.subarray(n,o.length-i),u=0;if(!t||a<8)for(var l=0;l<=a;l+=65535){var h=l+65535;h>=a&&(c[u>>3]=s),u=Ys(c,u+1,e.subarray(l,h))}else{for(var f=Xs[t-1],p=f>>>13,y=8191&f,d=(1<<r)-1,g=new ds(32768),m=new ds(d+1),v=Math.ceil(r/3),A=2*v,b=function(t){return(e[t]^e[t+1]<<v^e[t+2]<<A)&d},w=new gs(25e3),E=new ds(288),S=new ds(32),C=0,B=0,I=(l=0,0),k=0,T=0;l<a;++l){var N=b(l),U=32767&l,x=m[N];if(g[U]=x,m[N]=U,k<=l){var D=a-l;if((C>7e3||I>24576)&&D>423){u=Js(e,c,0,w,E,S,B,I,T,l-T,u),I=C=B=0,T=l;for(var R=0;R<286;++R)E[R]=0;for(R=0;R<30;++R)S[R]=0}var P=2,L=0,_=y,K=U-x&32767;if(D>2&&N==b(l-K))for(var O=Math.min(p,D)-1,M=Math.min(32767,l),H=Math.min(258,D);K<=M&&--_&&U!=x;){if(e[l+P]==e[l+P-K]){for(var V=0;V<H&&e[l+V]==e[l+V-K];++V);if(V>P){if(P=V,L=K,V>O)break;var F=Math.min(K,V-2),j=0;for(R=0;R<F;++R){var Q=l-K+R+32768&32767,q=Q-g[Q]+32768&32767;q>j&&(j=q,x=Q)}}}K+=(U=x)-(x=g[U])+32768&32767}if(L){w[I++]=268435456|Ss[P]<<18|Is[L];var z=31&Ss[P],G=31&Is[L];B+=ms[z]+vs[G],++E[257+z],++S[G],k=l+P,++C}else w[I++]=e[l],++E[e[l]]}}u=Js(e,c,s,w,E,S,B,I,T,l-T,u),!s&&7&u&&(u=Ys(c,u+1,Zs))}return Vs(o,0,n+Hs(u)+i)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,r,n,!i)},ta=function(){function e(e,t){t||"function"!=typeof e||(t=e,e={}),this.ondata=t,this.o=e||{}}return e.prototype.p=function(e,t){this.ondata(ea(e,this.o,0,0,!t),t)},e.prototype.push=function(e,t){this.ondata||js(5),this.d&&js(4),this.d=t,this.p(e,t||!1)},e}(),ra=function(){function e(e){this.s={},this.p=new ys(0),this.ondata=e}return e.prototype.e=function(e){this.ondata||js(5),this.d&&js(4);var t=this.p.length,r=new ys(t+e.length);r.set(this.p),r.set(e,t),this.p=r},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,r=function(e,t,r){var n=e.length;if(!n||r&&r.f&&!r.l)return t||new ys(0);var i=!t||r,s=!r||r.i;r||(r={}),t||(t=new ys(3*n));var a=function(e){var r=t.length;if(e>r){var n=new ys(Math.max(2*r,e));n.set(t),t=n}},o=r.f||0,c=r.p||0,u=r.b||0,l=r.l,h=r.d,f=r.m,p=r.n,y=8*n;do{if(!l){o=Os(e,c,1);var d=Os(e,c+1,3);if(c+=3,!d){var g=e[(k=Hs(c)+4)-4]|e[k-3]<<8,m=k+g;if(m>n){s&&js(0);break}i&&a(u+g),t.set(e.subarray(k,m),u),r.b=u+=g,r.p=c=8*m,r.f=o;continue}if(1==d)l=Ps,h=_s,f=9,p=5;else if(2==d){var v=Os(e,c,31)+257,A=Os(e,c+10,15)+4,b=v+Os(e,c+5,31)+1;c+=14;for(var w=new ys(b),E=new ys(19),S=0;S<A;++S)E[As[S]]=Os(e,c+3*S,7);c+=3*A;var C=Ks(E),B=(1<<C)-1,I=Us(E,C,1);for(S=0;S<b;){var k,T=I[Os(e,c,B)];if(c+=15&T,(k=T>>>4)<16)w[S++]=k;else{var N=0,U=0;for(16==k?(U=3+Os(e,c,3),c+=2,N=w[S-1]):17==k?(U=3+Os(e,c,7),c+=3):18==k&&(U=11+Os(e,c,127),c+=7);U--;)w[S++]=N}}var x=w.subarray(0,v),D=w.subarray(v);f=Ks(x),p=Ks(D),l=Us(x,f,1),h=Us(D,p,1)}else js(1);if(c>y){s&&js(0);break}}i&&a(u+131072);for(var R=(1<<f)-1,P=(1<<p)-1,L=c;;L=c){var _=(N=l[Ms(e,c)&R])>>>4;if((c+=15&N)>y){s&&js(0);break}if(N||js(2),_<256)t[u++]=_;else{if(256==_){L=c,l=null;break}var K=_-254;if(_>264){var O=ms[S=_-257];K=Os(e,c,(1<<O)-1)+Es[S],c+=O}var M=h[Ms(e,c)&P],H=M>>>4;if(M||js(3),c+=15&M,D=Bs[H],H>3&&(O=vs[H],D+=Ms(e,c)&(1<<O)-1,c+=O),c>y){s&&js(0);break}i&&a(u+131072);for(var V=u+K;u<V;u+=4)t[u]=t[u-D],t[u+1]=t[u+1-D],t[u+2]=t[u+2-D],t[u+3]=t[u+3-D];u=V}}r.l=l,r.p=L,r.b=u,r.f=o,l&&(o=1,r.m=f,r.d=h,r.n=p)}while(!o);return u==t.length?t:Vs(t,0,u)}(this.p,this.o,this.s);this.ondata(Vs(r,t,this.s.b),this.d),this.o=Vs(r,this.s.b-32768),this.s.b=this.o.length,this.p=Vs(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),na=function(){function e(e,t){var r,n;this.c=(r=1,n=0,{p:function(e){for(var t=r,i=n,s=0|e.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=t+=e[a];t=(65535&t)+15*(t>>16),i=(65535&i)+15*(i>>16)}r=t,n=i},d:function(){return(255&(r%=65521))<<24|r>>>8<<16|(255&(n%=65521))<<8|n>>>8}}),this.v=1,ta.call(this,e,t)}return e.prototype.push=function(e,t){ta.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e);var r=ea(e,this.o,this.v&&2,t&&4,!t);this.v&&(function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)}(r,this.o),this.v=0),t&&function(e,t,r){for(;r;++t)e[t]=r,r>>>=8}(r,r.length-4,this.c.d()),this.ondata(r,t)},e}(),ia=function(){function e(e){this.v=1,ra.call(this,e)}return e.prototype.push=function(e,t){if(ra.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}t&&(this.p.length<4&&js(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),ra.prototype.c.call(this,t)},e}(),sa="undefined"!=typeof TextDecoder&&new TextDecoder;try{sa.decode(Zs,{stream:!0})}catch(o){}class aa{static get tag(){return V.packet.literalData}constructor(e=new Date){this.format=V.literal.utf8,this.date=Q.normalizeDate(e),this.text=null,this.data=null,this.filename=""}setText(e,t=V.literal.utf8){this.format=t,this.text=e,this.data=null}getText(e=!1){return(null===this.text||Q.isStream(this.text))&&(this.text=Q.decodeUTF8(Q.nativeEOL(this.getBytes(e)))),this.text}setBytes(e,t){this.format=t,this.data=e,this.text=null}getBytes(e=!1){return null===this.data&&(this.data=Q.canonicalizeEOL(Q.encodeUTF8(this.text))),e?D(this.data):this.data}setFilename(e){this.filename=e}getFilename(){return this.filename}async read(e){await U(e,(async e=>{const t=await e.readByte(),r=await e.readByte();this.filename=Q.decodeUTF8(await e.readBytes(r)),this.date=Q.readDate(await e.readBytes(4));let n=e.remainder();y(n)&&(n=await L(n)),this.setBytes(n,t)}))}writeHeader(){const e=Q.encodeUTF8(this.filename),t=new Uint8Array([e.length]),r=new Uint8Array([this.format]),n=Q.writeDate(this.date);return Q.concatUint8Array([r,t,e,n])}write(){const e=this.writeHeader(),t=this.getBytes();return Q.concat([e,t])}}class oa{constructor(){this.bytes=""}read(e){return this.bytes=Q.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return Q.stringToUint8Array(this.bytes)}toHex(){return Q.uint8ArrayToHex(Q.stringToUint8Array(this.bytes))}equals(e,t=!1){return t&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return""===this.bytes}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){const t=new oa;return t.read(Q.hexToUint8Array(e)),t}static wildcard(){const e=new oa;return e.read(new Uint8Array(8)),e}}const ca=Symbol("verified"),ua="salt@notations.openpgpjs.org",la=new Set([V.signatureSubpacket.issuerKeyID,V.signatureSubpacket.issuerFingerprint,V.signatureSubpacket.embeddedSignature]);class ha{static get tag(){return V.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new oa,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[ca]=null}read(e,t=F){let r=0;if(this.version=e[r++],5===this.version&&!t.enableParsingV5Entities)throw new Zt("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4!==this.version&&5!==this.version&&6!==this.version)throw new Zt(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[r++],this.publicKeyAlgorithm=e[r++],this.hashAlgorithm=e[r++],r+=this.readSubPackets(e.subarray(r,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=e.subarray(0,r),r+=this.readSubPackets(e.subarray(r,e.length),!1),this.signedHashValue=e.subarray(r,r+2),r+=2,6===this.version){const t=e[r++];this.salt=e.subarray(r,r+t),r+=t}const n=e.subarray(r,e.length),{read:i,signatureParams:s}=function(e,t){let r=0;switch(e){case V.publicKey.rsaEncryptSign:case V.publicKey.rsaEncrypt:case V.publicKey.rsaSign:{const e=Q.readMPI(t.subarray(r));return r+=e.length+2,{read:r,signatureParams:{s:e}}}case V.publicKey.dsa:case V.publicKey.ecdsa:{const e=Q.readMPI(t.subarray(r));r+=e.length+2;const n=Q.readMPI(t.subarray(r));return r+=n.length+2,{read:r,signatureParams:{r:e,s:n}}}case V.publicKey.eddsaLegacy:{const e=Q.readMPI(t.subarray(r));r+=e.length+2;const n=Q.readMPI(t.subarray(r));return r+=n.length+2,{read:r,signatureParams:{r:e,s:n}}}case V.publicKey.ed25519:case V.publicKey.ed448:{const n=2*ar(e),i=Q.readExactSubarray(t,r,r+n);return r+=i.length,{read:r,signatureParams:{RS:i}}}default:throw new Zt("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,n);if(i<n.length)throw Error("Error reading MPIs");this.params=s}writeParams(){return this.params instanceof Promise?K((async()=>Ai(this.publicKeyAlgorithm,await this.params))):Ai(this.publicKeyAlgorithm,this.params)}write(){const e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),6===this.version&&(e.push(new Uint8Array([this.salt.length])),e.push(this.salt)),e.push(this.writeParams()),Q.concat(e)}async sign(e,t,r=new Date,n=!1,i){this.version=e.version,this.created=Q.normalizeDate(r),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID();const s=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(6===this.version){const e=pa(this.hashAlgorithm);if(null===this.salt)this.salt=be(e);else if(e!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(i.nonDeterministicSignaturesViaNotation){if(0!==this.rawNotations.filter((({name:e})=>e===ua)).length)throw Error("Unexpected existing salt notation");{const e=be(pa(this.hashAlgorithm));this.rawNotations.push({name:ua,value:e,humanReadable:!1,critical:!1})}}s.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=Q.concat(s);const a=this.toHash(this.signatureType,t,n),o=await this.hash(this.signatureType,t,a,n);this.signedHashValue=P(x(o),0,2);const c=async()=>async function(e,t,r,n,i,s){if(!r||!n)throw Error("Missing key parameters");switch(e){case V.publicKey.rsaEncryptSign:case V.publicKey.rsaEncrypt:case V.publicKey.rsaSign:{const{n:e,e:a}=r,{d:o,p:c,q:u,u:l}=n;return{s:await We(t,i,e,a,o,c,u,l,s)}}case V.publicKey.dsa:{const{g:e,p:t,q:i}=r,{x:a}=n;return async function(e,t,r,n,i,s){const a=BigInt(0);let o,c,u,l;n=ue(n),i=ue(i),r=ue(r),s=ue(s),r=le(r,n),s=le(s,i);const h=le(ue(t.subarray(0,me(i))),i);for(;;){if(o=we(yi,i),c=le(he(r,o,n),i),c===a)continue;const e=le(s*c,i);if(l=le(h+e,i),u=le(pe(o,i)*l,i),u!==a)break}return{r:ve(c,"be",me(n)),s:ve(u,"be",me(n))}}(0,s,e,t,i,a)}case V.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case V.publicKey.ecdsa:{const{oid:e,Q:a}=r,{d:o}=n;return Wn(e,t,i,a,o,s)}case V.publicKey.eddsaLegacy:{const{oid:e,Q:i}=r,{seed:a}=n;return Zn(e,t,0,i,a,s)}case V.publicKey.ed25519:case V.publicKey.ed448:{const{A:i}=r,{seed:a}=n;return nr(e,t,0,i,a,s)}default:throw Error("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,a,await L(o));Q.isStream(o)?this.params=c():(this.params=await c(),this[ca]=!0)}writeHashedSubPackets(){const e=V.signatureSubpacket,t=[];let r;if(null===this.created)throw Error("Missing signature creation time");t.push(fa(e.signatureCreationTime,!0,Q.writeDate(this.created))),null!==this.signatureExpirationTime&&t.push(fa(e.signatureExpirationTime,!0,Q.writeNumber(this.signatureExpirationTime,4))),null!==this.exportable&&t.push(fa(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),null!==this.trustLevel&&(r=new Uint8Array([this.trustLevel,this.trustAmount]),t.push(fa(e.trustSignature,!0,r))),null!==this.regularExpression&&t.push(fa(e.regularExpression,!0,this.regularExpression)),null!==this.revocable&&t.push(fa(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),null!==this.keyExpirationTime&&t.push(fa(e.keyExpirationTime,!0,Q.writeNumber(this.keyExpirationTime,4))),null!==this.preferredSymmetricAlgorithms&&(r=Q.stringToUint8Array(Q.uint8ArrayToString(this.preferredSymmetricAlgorithms)),t.push(fa(e.preferredSymmetricAlgorithms,!1,r))),null!==this.revocationKeyClass&&(r=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),r=Q.concat([r,this.revocationKeyFingerprint]),t.push(fa(e.revocationKey,!1,r))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&t.push(fa(e.issuerKeyID,!0,this.issuerKeyID.write())),this.rawNotations.forEach((({name:n,value:i,humanReadable:s,critical:a})=>{r=[new Uint8Array([s?128:0,0,0,0])];const o=Q.encodeUTF8(n);r.push(Q.writeNumber(o.length,2)),r.push(Q.writeNumber(i.length,2)),r.push(o),r.push(i),r=Q.concat(r),t.push(fa(e.notationData,a,r))})),null!==this.preferredHashAlgorithms&&(r=Q.stringToUint8Array(Q.uint8ArrayToString(this.preferredHashAlgorithms)),t.push(fa(e.preferredHashAlgorithms,!1,r))),null!==this.preferredCompressionAlgorithms&&(r=Q.stringToUint8Array(Q.uint8ArrayToString(this.preferredCompressionAlgorithms)),t.push(fa(e.preferredCompressionAlgorithms,!1,r))),null!==this.keyServerPreferences&&(r=Q.stringToUint8Array(Q.uint8ArrayToString(this.keyServerPreferences)),t.push(fa(e.keyServerPreferences,!1,r))),null!==this.preferredKeyServer&&t.push(fa(e.preferredKeyServer,!1,Q.encodeUTF8(this.preferredKeyServer))),null!==this.isPrimaryUserID&&t.push(fa(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),null!==this.policyURI&&t.push(fa(e.policyURI,!1,Q.encodeUTF8(this.policyURI))),null!==this.keyFlags&&(r=Q.stringToUint8Array(Q.uint8ArrayToString(this.keyFlags)),t.push(fa(e.keyFlags,!0,r))),null!==this.signersUserID&&t.push(fa(e.signersUserID,!1,Q.encodeUTF8(this.signersUserID))),null!==this.reasonForRevocationFlag&&(r=Q.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),t.push(fa(e.reasonForRevocation,!0,r))),null!==this.features&&(r=Q.stringToUint8Array(Q.uint8ArrayToString(this.features)),t.push(fa(e.features,!1,r))),null!==this.signatureTargetPublicKeyAlgorithm&&(r=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],r.push(Q.stringToUint8Array(this.signatureTargetHash)),r=Q.concat(r),t.push(fa(e.signatureTarget,!0,r))),null!==this.embeddedSignature&&t.push(fa(e.embeddedSignature,!0,this.embeddedSignature.write())),null!==this.issuerFingerprint&&(r=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],r=Q.concat(r),t.push(fa(e.issuerFingerprint,this.version>=5,r))),null!==this.preferredAEADAlgorithms&&(r=Q.stringToUint8Array(Q.uint8ArrayToString(this.preferredAEADAlgorithms)),t.push(fa(e.preferredAEADAlgorithms,!1,r))),null!==this.preferredCipherSuites&&(r=new Uint8Array([].concat(...this.preferredCipherSuites)),t.push(fa(e.preferredCipherSuites,!1,r)));const n=Q.concat(t),i=Q.writeNumber(n.length,6===this.version?4:2);return Q.concat([i,n])}writeUnhashedSubPackets(){const e=this.unhashedSubpackets.map((({type:e,critical:t,body:r})=>fa(e,t,r))),t=Q.concat(e),r=Q.writeNumber(t.length,6===this.version?4:2);return Q.concat([r,t])}readSubPacket(e,t=!0){let r=0;const n=!!(128&e[r]),i=127&e[r];if(r++,t||(this.unhashedSubpackets.push({type:i,critical:n,body:e.subarray(r,e.length)}),la.has(i)))switch(i){case V.signatureSubpacket.signatureCreationTime:this.created=Q.readDate(e.subarray(r,e.length));break;case V.signatureSubpacket.signatureExpirationTime:{const t=Q.readNumber(e.subarray(r,e.length));this.signatureNeverExpires=0===t,this.signatureExpirationTime=t;break}case V.signatureSubpacket.exportableCertification:this.exportable=1===e[r++];break;case V.signatureSubpacket.trustSignature:this.trustLevel=e[r++],this.trustAmount=e[r++];break;case V.signatureSubpacket.regularExpression:this.regularExpression=e[r];break;case V.signatureSubpacket.revocable:this.revocable=1===e[r++];break;case V.signatureSubpacket.keyExpirationTime:{const t=Q.readNumber(e.subarray(r,e.length));this.keyExpirationTime=t,this.keyNeverExpires=0===t;break}case V.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(r,e.length)];break;case V.signatureSubpacket.revocationKey:this.revocationKeyClass=e[r++],this.revocationKeyAlgorithm=e[r++],this.revocationKeyFingerprint=e.subarray(r,r+20);break;case V.signatureSubpacket.issuerKeyID:if(4===this.version)this.issuerKeyID.read(e.subarray(r,e.length));else if(t)throw Error("Unexpected Issuer Key ID subpacket");break;case V.signatureSubpacket.notationData:{const t=!!(128&e[r]);r+=4;const i=Q.readNumber(e.subarray(r,r+2));r+=2;const s=Q.readNumber(e.subarray(r,r+2));r+=2;const a=Q.decodeUTF8(e.subarray(r,r+i)),o=e.subarray(r+i,r+i+s);this.rawNotations.push({name:a,humanReadable:t,value:o,critical:n}),t&&(this.notations[a]=Q.decodeUTF8(o));break}case V.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(r,e.length)];break;case V.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(r,e.length)];break;case V.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(r,e.length)];break;case V.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=Q.decodeUTF8(e.subarray(r,e.length));break;case V.signatureSubpacket.primaryUserID:this.isPrimaryUserID=0!==e[r++];break;case V.signatureSubpacket.policyURI:this.policyURI=Q.decodeUTF8(e.subarray(r,e.length));break;case V.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(r,e.length)];break;case V.signatureSubpacket.signersUserID:this.signersUserID=Q.decodeUTF8(e.subarray(r,e.length));break;case V.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[r++],this.reasonForRevocationString=Q.decodeUTF8(e.subarray(r,e.length));break;case V.signatureSubpacket.features:this.features=[...e.subarray(r,e.length)];break;case V.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[r++],this.signatureTargetHashAlgorithm=e[r++];const t=Ve(this.signatureTargetHashAlgorithm);this.signatureTargetHash=Q.uint8ArrayToString(e.subarray(r,r+t));break}case V.signatureSubpacket.embeddedSignature:this.embeddedSignature=new ha,this.embeddedSignature.read(e.subarray(r,e.length));break;case V.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[r++],this.issuerFingerprint=e.subarray(r,e.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case V.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(r,e.length)];break;case V.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let t=r;t<e.length;t+=2)this.preferredCipherSuites.push([e[t],e[t+1]]);break;default:this.unknownSubpackets.push({type:i,critical:n,body:e.subarray(r,e.length)})}}readSubPackets(e,t=!0,r){const n=6===this.version?4:2,i=Q.readNumber(e.subarray(0,n));let s=n;for(;s<2+i;){const n=zt(e.subarray(s,e.length));s+=n.offset,this.readSubPacket(e.subarray(s,s+n.len),t,r),s+=n.len}return s}toSign(e,t){const r=V.signature;switch(e){case r.binary:return null!==t.text?Q.encodeUTF8(t.getText(!0)):t.getBytes(!0);case r.text:{const e=t.getBytes(!0);return Q.canonicalizeEOL(e)}case r.standalone:return new Uint8Array(0);case r.certGeneric:case r.certPersona:case r.certCasual:case r.certPositive:case r.certRevocation:{let e,n;if(t.userID)n=180,e=t.userID;else{if(!t.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");n=209,e=t.userAttribute}const i=e.write();return Q.concat([this.toSign(r.key,t),new Uint8Array([n]),Q.writeNumber(i.length,4),i])}case r.subkeyBinding:case r.subkeyRevocation:case r.keyBinding:return Q.concat([this.toSign(r.key,t),this.toSign(r.key,{key:t.bind})]);case r.key:if(void 0===t.key)throw Error("Key packet is required for this signature.");return t.key.writeForHash(this.version);case r.keyRevocation:return this.toSign(r.key,t);case r.timestamp:return new Uint8Array(0);case r.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,t){let r=0;return T(x(this.signatureData),(e=>{r+=e.length}),(()=>{const n=[];return 5!==this.version||this.signatureType!==V.signature.binary&&this.signatureType!==V.signature.text||(t?n.push(new Uint8Array(6)):n.push(e.writeHeader())),n.push(new Uint8Array([this.version,255])),5===this.version&&n.push(new Uint8Array(4)),n.push(Q.writeNumber(r,4)),Q.concat(n)}))}toHash(e,t,r=!1){const n=this.toSign(e,t);return Q.concat([this.salt||new Uint8Array,n,this.signatureData,this.calculateTrailer(t,r)])}async hash(e,t,r,n=!1){if(6===this.version&&this.salt.length!==pa(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return r||(r=this.toHash(e,t,n)),He(this.hashAlgorithm,r)}async verify(e,t,r,n=new Date,i=!1,s=F){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const a=t===V.signature.binary||t===V.signature.text;if(!this[ca]||a){let n,s;if(this.hashed?s=await this.hashed:(n=this.toHash(t,r,i),s=await this.hash(t,r,n)),s=await L(s),this.signedHashValue[0]!==s[0]||this.signedHashValue[1]!==s[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[ca]=await async function(e,t,r,n,i,s){switch(e){case V.publicKey.rsaEncryptSign:case V.publicKey.rsaEncrypt:case V.publicKey.rsaSign:{const{n:e,e:a}=n;return async function(e,t,r,n,i,s){if(t&&!Q.isStream(t))if(Q.getWebCrypto())try{return await async function(e,t,r,n,i){const s=Xe(n,i),a=await ze.importKey("jwk",s,{name:"RSASSA-PKCS1-v1_5",hash:{name:e}},!1,["verify"]);return ze.verify("RSASSA-PKCS1-v1_5",a,r,t)}(V.read(V.webHash,e),t,r,n,i)}catch(e){Q.printDebugError(e)}else if(Q.getNodeCrypto())return async function(e,t,r,n,i){const s={key:Xe(n,i),format:"jwk",type:"pkcs1"},a=Ge.createVerify(V.read(V.hash,e));a.write(t),a.end();try{return a.verify(s,r)}catch(e){return!1}}(e,t,r,n,i);return async function(e,t,r,n,i){if(r=ue(r),t=ue(t),n=ue(n),t>=r)throw Error("Signature size cannot exceed modulus size");const s=ve(he(t,n,r),"be",me(r)),a=qe(e,i,me(r));return Q.equalsUint8Array(s,a)}(e,r,n,i,s)}(t,i,Q.leftPad(r.s,e.length),e,a,s)}case V.publicKey.dsa:{const{g:e,p:t,q:i,y:a}=n,{r:o,s:c}=r;return async function(e,t,r,n,i,s,a,o){if(t=ue(t),r=ue(r),s=ue(s),a=ue(a),i=ue(i),o=ue(o),t<=pi||t>=a||r<=pi||r>=a)return Q.printDebug("invalid DSA Signature"),!1;const c=le(ue(n.subarray(0,me(a))),a),u=pe(r,a);if(u===pi)return Q.printDebug("invalid DSA Signature"),!1;i=le(i,s),o=le(o,s);const l=le(c*u,a),h=le(t*u,a);return le(le(he(i,l,s)*he(o,h,s),s),a)===t}(0,o,c,s,e,t,i,a)}case V.publicKey.ecdsa:{const{oid:e,Q:a}=n,o=new On(e).payloadSize;return Yn(e,t,{r:Q.leftPad(r.r,o),s:Q.leftPad(r.s,o)},i,a,s)}case V.publicKey.eddsaLegacy:{const{oid:e,Q:i}=n,a=new On(e).payloadSize;return ei(e,t,{r:Q.leftPad(r.r,a),s:Q.leftPad(r.s,a)},0,i,s)}case V.publicKey.ed25519:case V.publicKey.ed448:{const{A:i}=n;return ir(e,t,r,0,i,s)}default:throw Error("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,n,s),!this[ca])throw Error("Signature verification failed")}const o=Q.normalizeDate(n);if(o&&this.created>o)throw Error("Signature creation time is in the future");if(o&&o>=this.getExpirationTime())throw Error("Signature is expired");if(s.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+V.read(V.hash,this.hashAlgorithm).toUpperCase());if(s.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[V.signature.binary,V.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+V.read(V.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach((({type:e,critical:t})=>{if(t)throw Error("Unknown critical signature subpacket type "+e)})),this.rawNotations.forEach((({name:e,critical:t})=>{if(t&&s.knownNotations.indexOf(e)<0)throw Error("Unknown critical notation: "+e)})),null!==this.revocationKeyClass)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(e=new Date){const t=Q.normalizeDate(e);return null!==t&&!(this.created<=t&&t<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function fa(e,t,r){const n=[];return n.push(Gt(r.length+1)),n.push(new Uint8Array([(t?128:0)|e])),n.push(r),Q.concat(n)}function pa(e){switch(e){case V.hash.sha256:return 16;case V.hash.sha384:return 24;case V.hash.sha512:return 32;case V.hash.sha224:case V.hash.sha3_256:return 16;case V.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class ya{static get tag(){return V.packet.onePassSignature}static fromSignaturePacket(e,t){const r=new ya;return r.version=6===e.version?6:3,r.signatureType=e.signatureType,r.hashAlgorithm=e.hashAlgorithm,r.publicKeyAlgorithm=e.publicKeyAlgorithm,r.issuerKeyID=e.issuerKeyID,r.salt=e.salt,r.issuerFingerprint=e.issuerFingerprint,r.flags=t?1:0,r}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(e){let t=0;if(this.version=e[t++],3!==this.version&&6!==this.version)throw new Zt(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=e[t++],this.hashAlgorithm=e[t++],this.publicKeyAlgorithm=e[t++],6===this.version){const r=e[t++];this.salt=e.subarray(t,t+r),t+=r,this.issuerFingerprint=e.subarray(t,t+32),t+=32,this.issuerKeyID=new oa,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new oa,this.issuerKeyID.read(e.subarray(t,t+8)),t+=8;return this.flags=e[t++],this}write(){const e=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return 6===this.version?e.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):e.push(this.issuerKeyID.write()),e.push(new Uint8Array([this.flags])),Q.concatUint8Array(e)}calculateTrailer(...e){return K((async()=>ha.prototype.calculateTrailer.apply(await this.correspondingSig,e)))}async verify(){const e=await this.correspondingSig;if(!e||e.constructor.tag!==V.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID)||3===this.version&&6===e.version||6===this.version&&6!==e.version||6===this.version&&!Q.equalsUint8Array(e.issuerFingerprint,this.issuerFingerprint)||6===this.version&&!Q.equalsUint8Array(e.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)}}function da(e,t){if(!t[e]){let r;try{r=V.read(V.packet,e)}catch(t){throw new er("Unknown packet type with tag: "+e)}throw Error("Packet not allowed in this context: "+r)}return new t[e]}ya.prototype.hash=ha.prototype.hash,ya.prototype.toHash=ha.prototype.toHash,ya.prototype.toSign=ha.prototype.toSign;class ga extends Array{static async fromBinary(e,t,r=F){const n=new ga;return await n.read(e,t,r),n}async read(e,t,r=F){r.additionalAllowedPackets.length&&(t={...t,...Q.constructAllowedPackets(r.additionalAllowedPackets)}),this.stream=N(e,(async(e,n)=>{const i=M(n);try{for(;;)if(await i.ready,await Xt(e,(async e=>{try{if(e.tag===V.packet.marker||e.tag===V.packet.trust||e.tag===V.packet.padding)return;const n=da(e.tag,t);n.packets=new ga,n.fromStream=Q.isStream(e.packet),await n.read(e.packet,r),await i.write(n)}catch(t){if(t instanceof er){if(!(e.tag<=39))return;await i.abort(t)}const n=!r.ignoreUnsupportedPackets&&t instanceof Zt,s=!(r.ignoreMalformedPackets||t instanceof Zt);if(n||s||Jt(e.tag))await i.abort(t);else{const t=new tr(e.tag,e.packet);await i.write(t)}Q.printDebugError(t)}})))return await i.ready,void await i.close()}catch(e){await i.abort(e)}}));const n=O(this.stream);for(;;){const{done:e,value:t}=await n.read();if(e?this.stream=null:this.push(t),e||Jt(t.constructor.tag))break}n.releaseLock()}write(){const e=[];for(let t=0;t<this.length;t++){const r=this[t]instanceof tr?this[t].tag:this[t].constructor.tag,n=this[t].write();if(Q.isStream(n)&&Jt(this[t].constructor.tag)){let t=[],i=0;const s=512;e.push(Wt(r)),e.push(T(n,(e=>{if(t.push(e),i+=e.length,i>=s){const e=Math.min(Math.log(i)/Math.LN2|0,30),r=2**e,n=Q.concat([$t(e)].concat(t));return t=[n.subarray(1+r)],i=t[0].length,n.subarray(0,1+r)}}),(()=>Q.concat([Gt(i)].concat(t)))))}else{if(Q.isStream(n)){let t=0;e.push(T(x(n),(e=>{t+=e.length}),(()=>Yt(r,t))))}else e.push(Yt(r,n.length));e.push(n)}}return Q.concat(e)}filterByTag(...e){const t=new ga,r=e=>t=>e===t;for(let n=0;n<this.length;n++)e.some(r(this[n].constructor.tag))&&t.push(this[n]);return t}findPacket(e){return this.find((t=>t.constructor.tag===e))}indexOfTag(...e){const t=[],r=this,n=e=>t=>e===t;for(let i=0;i<this.length;i++)e.some(n(r[i].constructor.tag))&&t.push(i);return t}}const ma=Q.constructAllowedPackets([aa,ya,ha]);class va{static get tag(){return V.packet.compressedData}constructor(e=F){this.packets=null,this.algorithm=e.preferredCompressionAlgorithm,this.compressed=null}async read(e,t=F){await U(e,(async e=>{this.algorithm=await e.readByte(),this.compressed=e.remainder(),await this.decompress(t)}))}write(){return null===this.compressed&&this.compress(),Q.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(e=F){const t=V.read(V.compression,this.algorithm),r=Sa[t];if(!r)throw Error(t+" decompression not supported");this.packets=await ga.fromBinary(await r(this.compressed),ma,e)}compress(){const e=V.read(V.compression,this.algorithm),t=Ea[e];if(!t)throw Error(e+" compression not supported");this.compressed=t(this.packets.write())}}function Aa(e,t){return r=>{if(!Q.isStream(r)||y(r))return K((()=>L(r).then((e=>new Promise(((r,n)=>{const i=new t;i.ondata=e=>{r(e)};try{i.push(e,!0)}catch(e){n(e)}}))))));if(e)try{const t=e();return r.pipeThrough(t)}catch(e){if("TypeError"!==e.name)throw e}const n=r.getReader(),i=new t;return new ReadableStream({async start(e){for(i.ondata=async(t,r)=>{e.enqueue(t),r&&e.close()};;){const{done:e,value:t}=await n.read();if(e)return void i.push(new Uint8Array,!0);t.length&&i.push(t)}}})}}function ba(){return async function(e){const{decode:t}=await Promise.resolve().then((function(){return Wh}));return K((async()=>t(await L(e))))}}const wa=e=>({compressor:"undefined"!=typeof CompressionStream&&(()=>new CompressionStream(e)),decompressor:"undefined"!=typeof DecompressionStream&&(()=>new DecompressionStream(e))}),Ea={zip:Aa(wa("deflate-raw").compressor,ta),zlib:Aa(wa("deflate").compressor,na)},Sa={uncompressed:e=>e,zip:Aa(wa("deflate-raw").decompressor,ra),zlib:Aa(wa("deflate").decompressor,ia),bzip2:ba()},Ca=Q.constructAllowedPackets([aa,va,ya,ha]);class Ba{static get tag(){return V.packet.symEncryptedIntegrityProtectedData}static fromObject({version:e,aeadAlgorithm:t}){if(1!==e&&2!==e)throw Error("Unsupported SEIPD version");const r=new Ba;return r.version=e,2===e&&(r.aeadAlgorithm=t),r}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(e){await U(e,(async e=>{if(this.version=await e.readByte(),1!==this.version&&2!==this.version)throw new Zt(`Version ${this.version} of the SEIP packet is unsupported.`);2===this.version&&(this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte(),this.salt=await e.readBytes(32)),this.encrypted=e.remainder()}))}write(){return 2===this.version?Q.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):Q.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(e,t,r=F){const{blockSize:n,keySize:i}=gn(e);if(t.length!==i)throw Error("Unexpected session key size");let s=this.packets.write();if(y(s)&&(s=await L(s)),2===this.version)this.cipherAlgorithm=e,this.salt=be(32),this.chunkSizeByte=r.aeadChunkSizeByte,this.encrypted=await Ia(this,"encrypt",t,s);else{const r=await async function(e){const{blockSize:t}=gn(e),r=await be(t),n=new Uint8Array([r[r.length-2],r[r.length-1]]);return Q.concat([r,n])}(e),i=new Uint8Array([211,20]),a=Q.concat([r,s,i]),o=await He(V.hash.sha1,D(a)),c=Q.concat([a,o]);this.encrypted=await ki(e,t,c,new Uint8Array(n))}return!0}async decrypt(e,t,r=F){if(t.length!==gn(e).keySize)throw Error("Unexpected session key size");let n,i=x(this.encrypted);if(y(i)&&(i=await L(i)),2===this.version){if(this.cipherAlgorithm!==e)throw Error("Unexpected session key algorithm");n=await Ia(this,"decrypt",t,i)}else{const{blockSize:s}=gn(e),a=await Ti(e,t,i,new Uint8Array(s)),o=P(D(a),-20),c=P(a,0,-20),u=Promise.all([L(await He(V.hash.sha1,D(c))),L(o)]).then((([e,t])=>{if(!Q.equalsUint8Array(e,t))throw Error("Modification detected.");return new Uint8Array})),l=P(c,s+2);n=P(l,0,-2),n=C([n,K((()=>u))]),Q.isStream(i)&&r.allowUnauthenticatedStream||(n=await L(n))}return this.packets=await ga.fromBinary(n,Ca,r),!0}}async function Ia(e,t,r,n){const i=e instanceof Ba&&2===e.version,s=!i&&e.constructor.tag===V.packet.aeadEncryptedData;if(!i&&!s)throw Error("Unexpected packet type");const a=ss(e.aeadAlgorithm,s),o="decrypt"===t?a.tagLength:0,c="encrypt"===t?a.tagLength:0,u=2**(e.chunkSizeByte+6)+o,l=s?8:0,h=new ArrayBuffer(13+l),f=new Uint8Array(h,0,5+l),p=new Uint8Array(h),y=new DataView(h),d=new Uint8Array(h,5,8);f.set([192|e.constructor.tag,e.version,e.cipherAlgorithm,e.aeadAlgorithm,e.chunkSizeByte],0);let g,m,v=0,A=Promise.resolve(),b=0,w=0;if(i){const{keySize:t}=gn(e.cipherAlgorithm),{ivLength:n}=a,i=new Uint8Array(h,0,5),s=await wn(V.hash.sha256,r,e.salt,i,t+n);r=s.subarray(0,t),g=s.subarray(t),g.fill(0,g.length-8),m=new DataView(g.buffer,g.byteOffset,g.byteLength)}else g=e.iv;const E=await a(e.cipherAlgorithm,r);return N(n,(async(r,n)=>{if("array"!==Q.isStream(r)){const t=new TransformStream({},{highWaterMark:Q.getHardwareConcurrency()*2**(e.chunkSizeByte+6),size:e=>e.length});B(t.readable,n),n=t.writable}const s=O(r),a=M(n);try{for(;;){let e=await s.readBytes(u+o)||new Uint8Array;const r=e.subarray(e.length-o);let n,h,S;if(e=e.subarray(0,e.length-o),i)S=g;else{S=g.slice();for(let e=0;e<8;e++)S[g.length-8+e]^=d[e]}if(!v||e.length?(s.unshift(r),n=E[t](e,S,f),n.catch((()=>{})),w+=e.length-o+c):(y.setInt32(5+l+4,b),n=E[t](r,S,p),n.catch((()=>{})),w+=c,h=!0),b+=e.length-o,A=A.then((()=>n)).then((async e=>{await a.ready,await a.write(e),w-=e.length})).catch((e=>a.abort(e))),(h||w>a.desiredSize)&&await A,h){await a.close();break}i?m.setInt32(g.length-4,++v):y.setInt32(9,++v)}}catch(e){await a.ready.catch((()=>{})),await a.abort(e)}}))}class ka{static get tag(){return V.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new oa,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:e,encryptionKeyPacket:t,anonymousRecipient:r,sessionKey:n,sessionKeyAlgorithm:i}){const s=new ka;if(3!==e&&6!==e)throw Error("Unsupported PKESK version");return s.version=e,6===e&&(s.publicKeyVersion=r?null:t.version,s.publicKeyFingerprint=r?null:t.getFingerprintBytes()),s.publicKeyID=r?oa.wildcard():t.getKeyID(),s.publicKeyAlgorithm=t.algorithm,s.sessionKey=n,s.sessionKeyAlgorithm=i,s}read(e){let t=0;if(this.version=e[t++],3!==this.version&&6!==this.version)throw new Zt(`Version ${this.version} of the PKESK packet is unsupported.`);if(6===this.version){const r=e[t++];if(r){this.publicKeyVersion=e[t++];const n=r-1;this.publicKeyFingerprint=e.subarray(t,t+n),t+=n,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=oa.wildcard()}else t+=this.publicKeyID.read(e.subarray(t,t+8));if(this.publicKeyAlgorithm=e[t++],this.encrypted=function(e,t){let r=0;switch(e){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:return{c:Q.readMPI(t.subarray(r))};case V.publicKey.elgamal:{const e=Q.readMPI(t.subarray(r));return r+=e.length+2,{c1:e,c2:Q.readMPI(t.subarray(r))}}case V.publicKey.ecdh:{const e=Q.readMPI(t.subarray(r));r+=e.length+2;const n=new di;return n.read(t.subarray(r)),{V:e,C:n}}case V.publicKey.x25519:case V.publicKey.x448:{const n=Ei(e),i=Q.readExactSubarray(t,r,r+n);r+=i.length;const s=new mi;return s.read(t.subarray(r)),{ephemeralPublicKey:i,C:s}}default:throw new Zt("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,e.subarray(t)),this.publicKeyAlgorithm===V.publicKey.x25519||this.publicKeyAlgorithm===V.publicKey.x448)if(3===this.version)this.sessionKeyAlgorithm=V.write(V.symmetric,this.encrypted.C.algorithm);else if(null!==this.encrypted.C.algorithm)throw Error("Unexpected cleartext symmetric algorithm")}write(){const e=[new Uint8Array([this.version])];return 6===this.version?null!==this.publicKeyFingerprint?(e.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),e.push(this.publicKeyFingerprint)):e.push(new Uint8Array([0])):e.push(this.publicKeyID.write()),e.push(new Uint8Array([this.publicKeyAlgorithm]),Ai(this.publicKeyAlgorithm,this.encrypted)),Q.concatUint8Array(e)}async encrypt(e){const t=V.write(V.publicKey,this.publicKeyAlgorithm),r=3===this.version?this.sessionKeyAlgorithm:null,n=5===e.version?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),i=Ta(this.version,t,r,this.sessionKey);this.encrypted=await async function(e,t,r,n,i){switch(e){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:{const{n:e,e:t}=r;return{c:await Ye(n,e,t)}}case V.publicKey.elgamal:{const{p:e,g:t,y:i}=r;return async function(e,t,r,n){t=ue(t),r=ue(r),n=ue(n);const i=ue(je(e,me(t))),s=we(et,t-et);return{c1:ve(he(r,s,t)),c2:ve(le(he(n,s,t)*i,t))}}(n,e,t,i)}case V.publicKey.ecdh:{const{oid:e,Q:t,kdfParams:s}=r,{publicKey:a,wrappedKey:o}=await ci(e,s,n,t,i);return{V:a,C:new di(o)}}case V.publicKey.x25519:case V.publicKey.x448:{if(t&&!Q.isAES(t))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:i}=r,{ephemeralPublicKey:s,wrappedKey:a}=await Bn(e,n,i);return{ephemeralPublicKey:s,C:mi.fromObject({algorithm:t,wrappedKey:a})}}default:return[]}}(t,r,e.publicParams,i,n)}async decrypt(e,t){if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Decryption error");const r=t?Ta(this.version,this.publicKeyAlgorithm,t.sessionKeyAlgorithm,t.sessionKey):null,n=5===e.version?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),i=await async function(e,t,r,n,i,s){switch(e){case V.publicKey.rsaEncryptSign:case V.publicKey.rsaEncrypt:{const{c:e}=n,{n:i,e:a}=t,{d:o,p:c,q:u,u:l}=r;return async function(e,t,r,n,i,s,a,o){if(Q.getNodeCrypto()&&!o)try{return await async function(e,t,r,n,i,s,a){const o={key:await Je(t,r,n,i,s,a),format:"jwk",type:"pkcs1",padding:Ge.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Ge.privateDecrypt(o,e))}catch(e){throw Error("Decryption error")}}(e,t,r,n,i,s,a)}catch(e){Q.printDebugError(e)}return async function(e,t,r,n,i,s,a,o){if(e=ue(e),t=ue(t),r=ue(r),n=ue(n),i=ue(i),s=ue(s),a=ue(a),e>=t)throw Error("Data too large.");const c=le(n,s-$e),u=le(n,i-$e),l=we(BigInt(2),t),h=he(pe(l,t),r,t),f=he(e=le(e*h,t),u,i);let p=le(a*(he(e,c,s)-f),s)*i+f;return p=le(p*l,t),Qe(ve(p,"be",me(t)),o)}(e,t,r,n,i,s,a,o)}(e,i,a,o,c,u,l,s)}case V.publicKey.elgamal:{const{c1:e,c2:i}=n;return async function(e,t,r,n,i){return e=ue(e),t=ue(t),r=ue(r),Qe(ve(le(pe(he(e,n=ue(n),r),r)*t,r),"be",me(r)),i)}(e,i,t.p,r.x,s)}case V.publicKey.ecdh:{const{oid:e,Q:s,kdfParams:a}=t,{d:o}=r,{V:c,C:u}=n;return ui(e,a,c,u.data,s,o,i)}case V.publicKey.x25519:case V.publicKey.x448:{const{A:i}=t,{k:s}=r,{ephemeralPublicKey:a,C:o}=n;if(null!==o.algorithm&&!Q.isAES(o.algorithm))throw Error("AES session key expected");return In(e,a,o.wrappedKey,i,s)}default:throw Error("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,e.publicParams,e.privateParams,this.encrypted,n,r),{sessionKey:s,sessionKeyAlgorithm:a}=function(e,t,r,n){switch(t){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:case V.publicKey.elgamal:case V.publicKey.ecdh:{const t=r.subarray(0,r.length-2),i=r.subarray(r.length-2),s=Q.writeChecksum(t.subarray(t.length%8)),a=s[0]===i[0]&s[1]===i[1],o=6===e?{sessionKeyAlgorithm:null,sessionKey:t}:{sessionKeyAlgorithm:t[0],sessionKey:t.subarray(1)};if(n){const t=a&o.sessionKeyAlgorithm===n.sessionKeyAlgorithm&o.sessionKey.length===n.sessionKey.length;return{sessionKey:Q.selectUint8Array(t,o.sessionKey,n.sessionKey),sessionKeyAlgorithm:6===e?null:Q.selectUint8(t,o.sessionKeyAlgorithm,n.sessionKeyAlgorithm)}}if(a&&(6===e||V.read(V.symmetric,o.sessionKeyAlgorithm)))return o;throw Error("Decryption error")}case V.publicKey.x25519:case V.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:r};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,i,t);if(3===this.version){const e=this.publicKeyAlgorithm!==V.publicKey.x25519&&this.publicKeyAlgorithm!==V.publicKey.x448;if(this.sessionKeyAlgorithm=e?a:this.sessionKeyAlgorithm,s.length!==gn(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=s}}function Ta(e,t,r,n){switch(t){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:case V.publicKey.elgamal:case V.publicKey.ecdh:return Q.concatUint8Array([new Uint8Array(6===e?[]:[r]),n,Q.writeChecksum(n.subarray(n.length%8))]);case V.publicKey.x25519:case V.publicKey.x448:return n;default:throw Error("Unsupported public key algorithm")}}class Na{static get tag(){return V.packet.symEncryptedSessionKey}constructor(e=F){this.version=e.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=V.write(V.aead,e.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(e){let t=0;if(this.version=e[t++],4!==this.version&&5!==this.version&&6!==this.version)throw new Zt(`Version ${this.version} of the SKESK packet is unsupported.`);6===this.version&&t++;const r=e[t++];this.version>=5&&(this.aeadAlgorithm=e[t++],6===this.version&&t++);const n=e[t++];if(this.s2k=fs(n),t+=this.s2k.read(e.subarray(t,e.length)),this.version>=5){const r=ss(this.aeadAlgorithm,!0);this.iv=e.subarray(t,t+=r.ivLength)}this.version>=5||t<e.length?(this.encrypted=e.subarray(t,e.length),this.sessionKeyEncryptionAlgorithm=r):this.sessionKeyAlgorithm=r}write(){const e=null===this.encrypted?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let t;const r=this.s2k.write();if(6===this.version){const n=r.length,i=3+n+this.iv.length;t=Q.concatUint8Array([new Uint8Array([this.version,i,e,this.aeadAlgorithm,n]),r,this.iv,this.encrypted])}else 5===this.version?t=Q.concatUint8Array([new Uint8Array([this.version,e,this.aeadAlgorithm]),r,this.iv,this.encrypted]):(t=Q.concatUint8Array([new Uint8Array([this.version,e]),r]),null!==this.encrypted&&(t=Q.concatUint8Array([t,this.encrypted])));return t}async decrypt(e){const t=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:r,keySize:n}=gn(t),i=await this.s2k.produceKey(e,n);if(this.version>=5){const e=ss(this.aeadAlgorithm,!0),r=new Uint8Array([192|Na.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),s=6===this.version?await wn(V.hash.sha256,i,new Uint8Array,r,n):i,a=await e(t,s);this.sessionKey=await a.decrypt(this.encrypted,this.iv,r)}else if(null!==this.encrypted){const e=await Ti(t,i,this.encrypted,new Uint8Array(r));if(this.sessionKeyAlgorithm=V.write(V.symmetric,e[0]),this.sessionKey=e.subarray(1,e.length),this.sessionKey.length!==gn(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=i}async encrypt(e,t=F){const r=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=r,this.s2k=ps(t),this.s2k.generateSalt();const{blockSize:n,keySize:i}=gn(r),s=await this.s2k.produceKey(e,i);if(null===this.sessionKey&&(this.sessionKey=bi(this.sessionKeyAlgorithm)),this.version>=5){const e=ss(this.aeadAlgorithm);this.iv=be(e.ivLength);const t=new Uint8Array([192|Na.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),n=6===this.version?await wn(V.hash.sha256,s,new Uint8Array,t,i):s,a=await e(r,n);this.encrypted=await a.encrypt(this.sessionKey,this.iv,t)}else{const e=Q.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await ki(r,s,e,new Uint8Array(n))}}}class Ua{static get tag(){return V.packet.publicKey}constructor(e=new Date,t=F){this.version=t.v6Keys?6:4,this.created=Q.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){const t=new Ua,{version:r,created:n,algorithm:i,publicParams:s,keyID:a,fingerprint:o}=e;return t.version=r,t.created=n,t.algorithm=i,t.publicParams=s,t.keyID=a,t.fingerprint=o,t}async read(e,t=F){let r=0;if(this.version=e[r++],5===this.version&&!t.enableParsingV5Entities)throw new Zt("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4===this.version||5===this.version||6===this.version){this.created=Q.readDate(e.subarray(r,r+4)),r+=4,this.algorithm=e[r++],this.version>=5&&(r+=4);const{read:t,publicParams:n}=function(e,t){let r=0;switch(e){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:case V.publicKey.rsaSign:{const e=Q.readMPI(t.subarray(r));r+=e.length+2;const n=Q.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{n:e,e:n}}}case V.publicKey.dsa:{const e=Q.readMPI(t.subarray(r));r+=e.length+2;const n=Q.readMPI(t.subarray(r));r+=n.length+2;const i=Q.readMPI(t.subarray(r));r+=i.length+2;const s=Q.readMPI(t.subarray(r));return r+=s.length+2,{read:r,publicParams:{p:e,q:n,g:i,y:s}}}case V.publicKey.elgamal:{const e=Q.readMPI(t.subarray(r));r+=e.length+2;const n=Q.readMPI(t.subarray(r));r+=n.length+2;const i=Q.readMPI(t.subarray(r));return r+=i.length+2,{read:r,publicParams:{p:e,g:n,y:i}}}case V.publicKey.ecdsa:{const e=new qt;r+=e.read(t),wi(e);const n=Q.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{oid:e,Q:n}}}case V.publicKey.eddsaLegacy:{const e=new qt;if(r+=e.read(t),wi(e),e.getName()!==V.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let n=Q.readMPI(t.subarray(r));return r+=n.length+2,n=Q.leftPad(n,33),{read:r,publicParams:{oid:e,Q:n}}}case V.publicKey.ecdh:{const e=new qt;r+=e.read(t),wi(e);const n=Q.readMPI(t.subarray(r));r+=n.length+2;const i=new gi;return r+=i.read(t.subarray(r)),{read:r,publicParams:{oid:e,Q:n,kdfParams:i}}}case V.publicKey.ed25519:case V.publicKey.ed448:case V.publicKey.x25519:case V.publicKey.x448:{const n=Q.readExactSubarray(t,r,r+Ei(e));return r+=n.length,{read:r,publicParams:{A:n}}}default:throw new Zt("Unknown public key encryption algorithm.")}}(this.algorithm,e.subarray(r));if(6===this.version&&n.oid&&(n.oid.getName()===V.curve.curve25519Legacy||n.oid.getName()===V.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=n,r+=t,await this.computeFingerprintAndKeyID(),r}throw new Zt(`Version ${this.version} of the key packet is unsupported.`)}write(){const e=[];e.push(new Uint8Array([this.version])),e.push(Q.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));const t=Ai(this.algorithm,this.publicParams);return this.version>=5&&e.push(Q.writeNumber(t.length,4)),e.push(t),Q.concatUint8Array(e)}writeForHash(e){const t=this.writePublicKey(),r=149+e,n=e>=5?4:2;return Q.concatUint8Array([new Uint8Array([r]),Q.writeNumber(t.length,n),t])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new oa,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(4!==this.version)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const e=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await He(V.hash.sha256,e);else{if(4!==this.version)throw Error("Unsupported key version");this.fingerprint=await He(V.hash.sha1,e)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return Q.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&Q.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){const e={};e.algorithm=V.read(V.publicKey,this.algorithm);const t=this.publicParams.n||this.publicParams.p;return t?e.bits=Q.uint8ArrayBitLength(t):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}}Ua.prototype.readPublicKey=Ua.prototype.read,Ua.prototype.writePublicKey=Ua.prototype.write;class xa extends Ua{static get tag(){return V.packet.publicSubkey}constructor(e,t){super(e,t)}static fromSecretSubkeyPacket(e){const t=new xa,{version:r,created:n,algorithm:i,publicParams:s,keyID:a,fingerprint:o}=e;return t.version=r,t.created=n,t.algorithm=i,t.publicParams=s,t.keyID=a,t.fingerprint=o,t}}class Da{static get tag(){return V.packet.userAttribute}constructor(){this.attributes=[]}read(e){let t=0;for(;t<e.length;){const r=zt(e.subarray(t,e.length));t+=r.offset,this.attributes.push(Q.uint8ArrayToString(e.subarray(t,t+r.len))),t+=r.len}}write(){const e=[];for(let t=0;t<this.attributes.length;t++)e.push(Gt(this.attributes[t].length)),e.push(Q.stringToUint8Array(this.attributes[t]));return Q.concatUint8Array(e)}equals(e){return!!(e&&e instanceof Da)&&this.attributes.every((function(t,r){return t===e.attributes[r]}))}}class Ra extends Ua{static get tag(){return V.packet.secretKey}constructor(e=new Date,t=F){super(e,t),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}async read(e,t=F){let r=await this.readPublicKey(e,t);const n=r;this.s2kUsage=e[r++],5===this.version&&r++,6===this.version&&this.s2kUsage&&r++;try{if(255===this.s2kUsage||254===this.s2kUsage||253===this.s2kUsage){this.symmetric=e[r++],253===this.s2kUsage&&(this.aead=e[r++]),6===this.version&&r++;const t=e[r++];if(this.s2k=fs(t),r+=this.s2k.read(e.subarray(r,e.length)),"gnu-dummy"===this.s2k.type)return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=253===this.s2kUsage&&(5===this.version||4===this.version&&t.parseAEADEncryptedV4KeysAsLegacy),253!==this.s2kUsage||this.isLegacyAEAD?(this.iv=e.subarray(r,r+gn(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=e.subarray(r,r+ss(this.aead).ivLength),this.usedModernAEAD=!0),r+=this.iv.length)}catch(t){if(!this.s2kUsage)throw t;this.unparseableKeyMaterial=e.subarray(n),this.isEncrypted=!0}if(5===this.version&&(r+=4),this.keyMaterial=e.subarray(r),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let t;if(6===this.version)t=this.keyMaterial;else if(t=this.keyMaterial.subarray(0,-2),!Q.equalsUint8Array(Q.writeChecksum(t),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{read:e,privateParams:r}=vi(this.algorithm,t,this.publicParams);if(e<t.length)throw Error("Error reading MPIs");this.privateParams=r}catch(e){if(e instanceof Zt)throw e;throw Error("Error reading MPIs")}}}write(){const e=this.writePublicKey();if(this.unparseableKeyMaterial)return Q.concatUint8Array([e,this.unparseableKeyMaterial]);const t=[e];t.push(new Uint8Array([this.s2kUsage]));const r=[];if(255===this.s2kUsage||254===this.s2kUsage||253===this.s2kUsage){r.push(this.symmetric),253===this.s2kUsage&&r.push(this.aead);const e=this.s2k.write();6===this.version&&r.push(e.length),r.push(...e)}return this.s2kUsage&&"gnu-dummy"!==this.s2k.type&&r.push(...this.iv),(5===this.version||6===this.version&&this.s2kUsage)&&t.push(new Uint8Array([r.length])),t.push(new Uint8Array(r)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=Ai(this.algorithm,this.privateParams)),5===this.version&&t.push(Q.writeNumber(this.keyMaterial.length,4)),t.push(this.keyMaterial),this.s2kUsage||6===this.version||t.push(Q.writeChecksum(this.keyMaterial))),Q.concatUint8Array(t)}isDecrypted(){return!1===this.isEncrypted}isMissingSecretKeyMaterial(){return void 0!==this.unparseableKeyMaterial||this.isDummy()}isDummy(){return!(!this.s2k||"gnu-dummy"!==this.s2k.type)}makeDummy(e=F){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=fs(V.s2k.gnu,e),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=V.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}async encrypt(e,t=F){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!e)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=ps(t),this.s2k.generateSalt();const r=Ai(this.algorithm,this.privateParams);this.symmetric=V.symmetric.aes256;const{blockSize:n}=gn(this.symmetric);if(t.aeadProtect){this.s2kUsage=253,this.aead=t.preferredAEADAlgorithm;const i=ss(this.aead);this.isLegacyAEAD=5===this.version,this.usedModernAEAD=!this.isLegacyAEAD;const s=Wt(this.constructor.tag),a=await Pa(this.version,this.s2k,e,this.symmetric,this.aead,s,this.isLegacyAEAD),o=await i(this.symmetric,a);this.iv=this.isLegacyAEAD?be(n):be(i.ivLength);const c=this.isLegacyAEAD?new Uint8Array:Q.concatUint8Array([s,this.writePublicKey()]);this.keyMaterial=await o.encrypt(r,this.iv.subarray(0,i.ivLength),c)}else{this.s2kUsage=254,this.usedModernAEAD=!1;const t=await Pa(this.version,this.s2k,e,this.symmetric);this.iv=be(n),this.keyMaterial=await ki(this.symmetric,t,Q.concatUint8Array([r,await He(V.hash.sha1,r)]),this.iv)}}async decrypt(e){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let t;const r=Wt(this.constructor.tag);if(254!==this.s2kUsage&&253!==this.s2kUsage)throw 255===this.s2kUsage?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");let n;if(t=await Pa(this.version,this.s2k,e,this.symmetric,this.aead,r,this.isLegacyAEAD),253===this.s2kUsage){const i=ss(this.aead,!0),s=await i(this.symmetric,t);try{const e=this.isLegacyAEAD?new Uint8Array:Q.concatUint8Array([r,this.writePublicKey()]);n=await s.decrypt(this.keyMaterial,this.iv.subarray(0,i.ivLength),e)}catch(e){if("Authentication tag mismatch"===e.message)throw Error("Incorrect key passphrase: "+e.message);throw e}}else{const e=await Ti(this.symmetric,t,this.keyMaterial,this.iv);n=e.subarray(0,-20);const r=await He(V.hash.sha1,n);if(!Q.equalsUint8Array(r,e.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:e}=vi(this.algorithm,n,this.publicParams);this.privateParams=e}catch(e){throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");if(this.usedModernAEAD)return;let e;try{e=await async function(e,t,r){if(!t||!r)throw Error("Missing key parameters");switch(e){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:case V.publicKey.rsaSign:{const{n:e,e:n}=t,{d:i,p:s,q:a,u:o}=r;return async function(e,t,r,n,i,s){if(e=ue(e),(n=ue(n))*(i=ue(i))!==e)return!1;const a=BigInt(2);if(le(n*(s=ue(s)),i)!==BigInt(1))return!1;t=ue(t),r=ue(r);const o=we(a,a<<BigInt(Math.floor(ge(e)/3))),c=o*r*t;return!(le(c,n-$e)!==o||le(c,i-$e)!==o)}(e,n,i,s,a,o)}case V.publicKey.dsa:{const{p:e,q:n,g:i,y:s}=t,{x:a}=r;return async function(e,t,r,n,i){if(e=ue(e),t=ue(t),r=ue(r),n=ue(n),r<=yi||r>=e)return!1;if(le(e-yi,t)!==pi)return!1;if(he(r,t,e)!==yi)return!1;const s=BigInt(ge(t));if(s<BigInt(150)||!Ce(t,null,32))return!1;i=ue(i);const a=BigInt(2);return n===he(r,t*we(a<<s-yi,a<<s)+i,e)}(e,n,i,s,a)}case V.publicKey.elgamal:{const{p:e,g:n,y:i}=t,{x:s}=r;return async function(e,t,r,n){if(e=ue(e),t=ue(t),r=ue(r),t<=et||t>=e)return!1;const i=BigInt(ge(e));if(i<BigInt(1023))return!1;if(he(t,e-et,e)!==et)return!1;let s=t,a=BigInt(1);const o=BigInt(2),c=o<<BigInt(17);for(;a<c;){if(s=le(s*t,e),s===et)return!1;a++}n=ue(n);const u=we(o<<i-et,o<<i);return r===he(t,(e-et)*u+n,e)}(e,n,i,s)}case V.publicKey.ecdsa:case V.publicKey.ecdh:{const n=fi[V.read(V.publicKey,e)],{oid:i,Q:s}=t,{d:a}=r;return n.validateParams(i,s,a)}case V.publicKey.eddsaLegacy:{const{Q:e,oid:n}=t,{seed:i}=r;return ti(n,e,i)}case V.publicKey.ed25519:case V.publicKey.ed448:{const{A:n}=t,{seed:i}=r;return sr(e,n,i)}case V.publicKey.x25519:case V.publicKey.x448:{const{A:n}=t,{k:i}=r;return Cn(e,n,i)}default:throw Error("Unknown public key algorithm.")}}(this.algorithm,this.publicParams,this.privateParams)}catch(t){e=!1}if(!e)throw Error("Key is invalid")}async generate(e,t){if(6===this.version&&(this.algorithm===V.publicKey.ecdh&&t===V.curve.curve25519Legacy||this.algorithm===V.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${t}. Generate a key of type 'curve25519' instead`);const{privateParams:r,publicParams:n}=await function(e,t,r){switch(e){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:case V.publicKey.rsaSign:return async function(e,t){if(t=BigInt(t),Q.getWebCrypto()){const r={name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:ve(t),hash:{name:"SHA-1"}},n=await ze.generateKey(r,!0,["sign","verify"]);return Ze(await ze.exportKey("jwk",n.privateKey),t)}if(Q.getNodeCrypto()){const r={modulusLength:e,publicExponent:ye(t),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},n=await new Promise(((e,t)=>{Ge.generateKeyPair("rsa",r,((r,n,i)=>{r?t(r):e(i)}))}));return Ze(n,t)}let r,n,i;do{n=Se(e-(e>>1),t,40),r=Se(e>>1,t,40),i=r*n}while(ge(i)!==e);const s=(r-$e)*(n-$e);return n<r&&([r,n]=[n,r]),{n:ve(i),e:ve(t),d:ve(pe(t,s)),p:ve(r),q:ve(n),u:ve(pe(r,n))}}(t,65537).then((({n:e,e:t,d:r,p:n,q:i,u:s})=>({privateParams:{d:r,p:n,q:i,u:s},publicParams:{n:e,e:t}})));case V.publicKey.ecdsa:return Mn(r).then((({oid:e,Q:t,secret:r})=>({privateParams:{d:r},publicParams:{oid:new qt(e),Q:t}})));case V.publicKey.eddsaLegacy:return Mn(r).then((({oid:e,Q:t,secret:r})=>({privateParams:{seed:r},publicParams:{oid:new qt(e),Q:t}})));case V.publicKey.ecdh:return Mn(r).then((({oid:e,Q:t,secret:r,hash:n,cipher:i})=>({privateParams:{d:r},publicParams:{oid:new qt(e),Q:t,kdfParams:new gi({hash:n,cipher:i})}})));case V.publicKey.ed25519:case V.publicKey.ed448:return rr(e).then((({A:e,seed:t})=>({privateParams:{seed:t},publicParams:{A:e}})));case V.publicKey.x25519:case V.publicKey.x448:return Sn(e).then((({A:e,k:t})=>({privateParams:{k:t},publicParams:{A:e}})));case V.publicKey.dsa:case V.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}}(this.algorithm,e,t);this.privateParams=r,this.publicParams=n,this.isEncrypted=!1}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach((e=>{this.privateParams[e].fill(0),delete this.privateParams[e]})),this.privateParams=null,this.isEncrypted=!0)}}async function Pa(e,t,r,n,i,s,a){if("argon2"===t.type&&!i)throw Error("Using Argon2 S2K without AEAD is not allowed");if("simple"===t.type&&6===e)throw Error("Using Simple S2K with version 6 keys is not allowed");const{keySize:o}=gn(n),c=await t.produceKey(r,o);if(!i||5===e||a)return c;const u=Q.concatUint8Array([s,new Uint8Array([e,n,i])]);return wn(V.hash.sha256,c,new Uint8Array,u,o)}class La{static get tag(){return V.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(e){if(Q.isString(e)||e.name&&!Q.isString(e.name)||e.email&&!Q.isEmailAddress(e.email)||e.comment&&!Q.isString(e.comment))throw Error("Invalid user ID format");const t=new La;Object.assign(t,e);const r=[];return t.name&&r.push(t.name),t.comment&&r.push(`(${t.comment})`),t.email&&r.push(`<${t.email}>`),t.userID=r.join(" "),t}read(e,t=F){const r=Q.decodeUTF8(e);if(r.length>t.maxUserIDLength)throw Error("User ID string is too long");const n=/^(?<name>[^()]+\s+)?(?<comment>\([^()]+\)\s+)?(?<email><\S+@\S+>)$/.exec(r);if(null!==n){const{name:e,comment:t,email:r}=n.groups;this.comment=t?.replace(/^\(|\)|\s$/g,"").trim()||"",this.name=e?.trim()||"",this.email=r.substring(1,r.length-1)}else/^[^\s@]+@[^\s@]+$/.test(r)&&(this.email=r);this.userID=r}write(){return Q.encodeUTF8(this.userID)}equals(e){return e&&e.userID===this.userID}}class _a extends Ra{static get tag(){return V.packet.secretSubkey}constructor(e=new Date,t=F){super(e,t)}}const Ka=Q.constructAllowedPackets([ha]);class Oa{constructor(e){this.packets=e||new ga}write(){return this.packets.write()}armor(e=F){const t=this.packets.some((e=>e.constructor.tag===ha.tag&&6!==e.version));return ae(V.armor.signature,this.write(),void 0,void 0,void 0,t,e)}getSigningKeyIDs(){return this.packets.map((e=>e.issuerKeyID))}}async function Ma({armoredSignature:e,binarySignature:t,config:r,...n}){r={...F,...r};let i=e||t;if(!i)throw Error("readSignature: must pass options object containing `armoredSignature` or `binarySignature`");if(e&&!Q.isString(e))throw Error("readSignature: options.armoredSignature must be a string");if(t&&!Q.isUint8Array(t))throw Error("readSignature: options.binarySignature must be a Uint8Array");const s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));if(e){const{type:e,data:t}=await se(i);if(e!==V.armor.signature)throw Error("Armored text not of type signature");i=t}const a=await ga.fromBinary(i,Ka,r);return new Oa(a)}async function Ha(e,t,r,n,i=new Date,s){let a,o;for(let c=e.length-1;c>=0;c--)try{(!a||e[c].created>=a.created)&&(await e[c].verify(t,r,n,i,void 0,s),a=e[c])}catch(e){o=e}if(!a)throw Q.wrapError(`Could not find valid ${V.read(V.signature,r)} signature in key ${t.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,((e,t,r)=>t+" "+r.toLowerCase())),o);return a}function Va(e,t,r=new Date){const n=Q.normalizeDate(r);if(null!==n){const r=qa(e,t);return!(e.created<=n&&n<r)}return!1}async function Fa(e,t,r,n,i,s,a=[],o=!1,c){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const u=new ha;return Object.assign(u,n),u.publicKeyAlgorithm=r.algorithm,u.hashAlgorithm=await async function(e,t,r=new Date,n=[],i){const s=V.hash.sha256,a=i.preferredHashAlgorithm,o=await Promise.all(e.map((async(e,t)=>(await e.getPrimarySelfSignature(r,n[t],i)).preferredHashAlgorithms||[]))),c=new Map;for(const e of o)for(const t of e)try{const e=V.write(V.hash,t);c.set(e,c.has(e)?c.get(e)+1:1)}catch{}const u=t=>0===e.length||c.get(t)===e.length||t===s,l=()=>{if(0===c.size)return s;const e=Array.from(c.keys()).filter((e=>u(e))).sort(((e,t)=>Ve(e)-Ve(t)))[0];return Ve(e)>=Ve(s)?e:s};if(new Set([V.publicKey.ecdsa,V.publicKey.eddsaLegacy,V.publicKey.ed25519,V.publicKey.ed448]).has(t.algorithm)){const e=function(e,t){switch(e){case V.publicKey.ecdsa:case V.publicKey.eddsaLegacy:return Hn(t);case V.publicKey.ed25519:case V.publicKey.ed448:return or(e);default:throw Error("Unknown elliptic signing algo")}}(t.algorithm,t.publicParams.oid),r=u(a),n=Ve(a)>=Ve(e);if(r&&n)return a;{const t=l();return Ve(t)>=Ve(e)?t:e}}return u(a)?a:l()}(t,r,i,s,c),u.rawNotations=[...a],await u.sign(r,e,i,o,c),u}async function ja(e,t,r,n=new Date,i){(e=e[r])&&(t[r].length?await Promise.all(e.map((async function(e){e.isExpired(n)||i&&!await i(e)||t[r].some((function(t){return Q.equalsUint8Array(t.writeParams(),e.writeParams())}))||t[r].push(e)}))):t[r]=e)}async function Qa(e,t,r,n,i,s,a=new Date,o){s=s||e;const c=[];return await Promise.all(n.map((async function(e){try{if(!i||e.issuerKeyID.equals(i.issuerKeyID)){const n=![V.reasonForRevocation.keyRetired,V.reasonForRevocation.keySuperseded,V.reasonForRevocation.userIDInvalid].includes(e.reasonForRevocationFlag);await e.verify(s,t,r,n?null:a,!1,o),c.push(e.issuerKeyID)}}catch(e){}}))),i?(i.revoked=!!c.some((e=>e.equals(i.issuerKeyID)))||i.revoked||!1,i.revoked):c.length>0}function qa(e,t){let r;return!1===t.keyNeverExpires&&(r=e.created.getTime()+1e3*t.keyExpirationTime),r?new Date(r):1/0}function za(e,t,r){switch(e.algorithm){case V.publicKey.rsaEncryptSign:case V.publicKey.rsaSign:case V.publicKey.dsa:case V.publicKey.ecdsa:case V.publicKey.eddsaLegacy:case V.publicKey.ed25519:case V.publicKey.ed448:if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&V.keyFlags.signData);default:return!1}}function Ga(e,t,r){switch(e.algorithm){case V.publicKey.rsaEncryptSign:case V.publicKey.rsaEncrypt:case V.publicKey.elgamal:case V.publicKey.ecdh:case V.publicKey.x25519:case V.publicKey.x448:if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&V.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&V.keyFlags.encryptStorage);default:return!1}}function $a(e,t,r){if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(e.algorithm){case V.publicKey.rsaEncryptSign:case V.publicKey.rsaEncrypt:case V.publicKey.elgamal:case V.publicKey.ecdh:case V.publicKey.x25519:case V.publicKey.x448:return!((t.keyFlags&&!(t.keyFlags[0]&V.keyFlags.signData)||!r.allowInsecureDecryptionWithSigningKeys)&&t.keyFlags&&!(t.keyFlags[0]&V.keyFlags.encryptCommunication)&&!(t.keyFlags[0]&V.keyFlags.encryptStorage));default:return!1}}function Wa(e,t){const r=V.write(V.publicKey,e.algorithm),n=e.getAlgorithmInfo();if(t.rejectPublicKeyAlgorithms.has(r))throw Error(n.algorithm+" keys are considered too weak.");switch(r){case V.publicKey.rsaEncryptSign:case V.publicKey.rsaSign:case V.publicKey.rsaEncrypt:if(n.bits<t.minRSABits)throw Error(`RSA keys shorter than ${t.minRSABits} bits are considered too weak.`);break;case V.publicKey.ecdsa:case V.publicKey.eddsaLegacy:case V.publicKey.ecdh:if(t.rejectCurves.has(n.curve))throw Error(`Support for ${n.algorithm} keys using curve ${n.curve} is disabled.`)}}class Ya{constructor(e,t){this.userID=e.constructor.tag===V.packet.userID?e:null,this.userAttribute=e.constructor.tag===V.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new ga;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){const e=new Ya(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}async certify(e,t,r){const n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n},s=new Ya(i.userID||i.userAttribute,this.mainKey);return s.otherCertifications=await Promise.all(e.map((async function(e){if(!e.isPrivate())throw Error("Need private key for signing");if(e.hasSameFingerprintAs(n))throw Error("The user's own key can only be used for self-certifications");const s=await e.getSigningKey(void 0,t,void 0,r);return Fa(i,[e],s.keyPacket,{signatureType:V.signature.certGeneric,keyFlags:[V.keyFlags.certifyKeys|V.keyFlags.signData]},t,void 0,void 0,void 0,r)}))),await s.update(this,t,r),s}async isRevoked(e,t,r=new Date,n=F){const i=this.mainKey.keyPacket;return Qa(i,V.signature.certRevocation,{key:i,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,t,r,n)}async verifyCertificate(e,t,r=new Date,n){const i=this,s=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:s},{issuerKeyID:o}=e,c=t.filter((e=>e.getKeys(o).length>0));return 0===c.length?null:(await Promise.all(c.map((async t=>{const s=await t.getSigningKey(o,e.created,void 0,n);if(e.revoked||await i.isRevoked(e,s.keyPacket,r,n))throw Error("User certificate is revoked");try{await e.verify(s.keyPacket,V.signature.certGeneric,a,r,void 0,n)}catch(e){throw Q.wrapError("User certificate is invalid",e)}}))),!0)}async verifyAllCertifications(e,t=new Date,r){const n=this,i=this.selfCertifications.concat(this.otherCertifications);return Promise.all(i.map((async i=>({keyID:i.issuerKeyID,valid:await n.verifyCertificate(i,e,t,r).catch((()=>!1))}))))}async verify(e=new Date,t){if(!this.selfCertifications.length)throw Error("No self-certifications found");const r=this,n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n};let s;for(let a=this.selfCertifications.length-1;a>=0;a--)try{const s=this.selfCertifications[a];if(s.revoked||await r.isRevoked(s,void 0,e,t))throw Error("Self-certification is revoked");try{await s.verify(n,V.signature.certGeneric,i,e,void 0,t)}catch(e){throw Q.wrapError("Self-certification is invalid",e)}return!0}catch(e){s=e}throw s}async update(e,t,r){const n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n};await ja(e,this,"selfCertifications",t,(async function(e){try{return await e.verify(n,V.signature.certGeneric,i,t,!1,r),!0}catch(e){return!1}})),await ja(e,this,"otherCertifications",t),await ja(e,this,"revocationSignatures",t,(function(e){return Qa(n,V.signature.certRevocation,i,[e],void 0,void 0,t,r)}))}async revoke(e,{flag:t=V.reasonForRevocation.noReason,string:r=""}={},n=new Date,i=F){const s={userID:this.userID,userAttribute:this.userAttribute,key:e},a=new Ya(s.userID||s.userAttribute,this.mainKey);return a.revocationSignatures.push(await Fa(s,[],e,{signatureType:V.signature.certRevocation,reasonForRevocationFlag:V.write(V.reasonForRevocation,t),reasonForRevocationString:r},n,void 0,void 0,!1,i)),await a.update(this),a}}class Ja{constructor(e,t){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new ga;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){const e=new Ja(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}async isRevoked(e,t,r=new Date,n=F){const i=this.mainKey.keyPacket;return Qa(i,V.signature.subkeyRevocation,{key:i,bind:this.keyPacket},this.revocationSignatures,e,t,r,n)}async verify(e=new Date,t=F){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket},i=await Ha(this.bindingSignatures,r,V.signature.subkeyBinding,n,e,t);if(i.revoked||await this.isRevoked(i,null,e,t))throw Error("Subkey is revoked");if(Va(this.keyPacket,i,e))throw Error("Subkey is expired");return i}async getExpirationTime(e=new Date,t=F){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket};let i;try{i=await Ha(this.bindingSignatures,r,V.signature.subkeyBinding,n,e,t)}catch(e){return null}const s=qa(this.keyPacket,i),a=i.getExpirationTime();return s<a?s:a}async update(e,t=new Date,r=F){const n=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===V.packet.publicSubkey&&e.keyPacket.constructor.tag===V.packet.secretSubkey&&(this.keyPacket=e.keyPacket);const i=this,s={key:n,bind:i.keyPacket};await ja(e,this,"bindingSignatures",t,(async function(e){for(let t=0;t<i.bindingSignatures.length;t++)if(i.bindingSignatures[t].issuerKeyID.equals(e.issuerKeyID))return e.created>i.bindingSignatures[t].created&&(i.bindingSignatures[t]=e),!1;try{return await e.verify(n,V.signature.subkeyBinding,s,t,void 0,r),!0}catch(e){return!1}})),await ja(e,this,"revocationSignatures",t,(function(e){return Qa(n,V.signature.subkeyRevocation,s,[e],void 0,void 0,t,r)}))}async revoke(e,{flag:t=V.reasonForRevocation.noReason,string:r=""}={},n=new Date,i=F){const s={key:e,bind:this.keyPacket},a=new Ja(this.keyPacket,this.mainKey);return a.revocationSignatures.push(await Fa(s,[],e,{signatureType:V.signature.subkeyRevocation,reasonForRevocationFlag:V.write(V.reasonForRevocation,t),reasonForRevocationString:r},n,void 0,void 0,!1,i)),await a.update(this),a}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach((e=>{Ja.prototype[e]=function(){return this.keyPacket[e]()}}));const Xa=Q.constructAllowedPackets([ha]),Za=new Set([V.packet.publicKey,V.packet.privateKey]),eo=new Set([V.packet.publicKey,V.packet.privateKey,V.packet.publicSubkey,V.packet.privateSubkey]);class to{packetListToStructure(e,t=new Set){let r,n,i,s;for(const a of e){if(a instanceof tr){eo.has(a.tag)&&!s&&(s=Za.has(a.tag)?Za:eo);continue}const e=a.constructor.tag;if(s){if(!s.has(e))continue;s=null}if(t.has(e))throw Error("Unexpected packet type: "+e);switch(e){case V.packet.publicKey:case V.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=a,n=this.getKeyID(),!n)throw Error("Missing Key ID");break;case V.packet.userID:case V.packet.userAttribute:r=new Ya(a,this),this.users.push(r);break;case V.packet.publicSubkey:case V.packet.secretSubkey:r=null,i=new Ja(a,this),this.subkeys.push(i);break;case V.packet.signature:switch(a.signatureType){case V.signature.certGeneric:case V.signature.certPersona:case V.signature.certCasual:case V.signature.certPositive:if(!r){Q.printDebug("Dropping certification signatures without preceding user packet");continue}a.issuerKeyID.equals(n)?r.selfCertifications.push(a):r.otherCertifications.push(a);break;case V.signature.certRevocation:r?r.revocationSignatures.push(a):this.directSignatures.push(a);break;case V.signature.key:this.directSignatures.push(a);break;case V.signature.subkeyBinding:if(!i){Q.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}i.bindingSignatures.push(a);break;case V.signature.keyRevocation:this.revocationSignatures.push(a);break;case V.signature.subkeyRevocation:if(!i){Q.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}i.revocationSignatures.push(a)}}}}toPacketList(){const e=new ga;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map((t=>e.push(...t.toPacketList()))),this.subkeys.map((t=>e.push(...t.toPacketList()))),e}clone(e=!1){const t=new this.constructor(this.toPacketList());return e&&t.getKeys().forEach((e=>{if(e.keyPacket=Object.create(Object.getPrototypeOf(e.keyPacket),Object.getOwnPropertyDescriptors(e.keyPacket)),!e.keyPacket.isDecrypted())return;const t={};Object.keys(e.keyPacket.privateParams).forEach((r=>{t[r]=new Uint8Array(e.keyPacket.privateParams[r])})),e.keyPacket.privateParams=t})),t}getSubkeys(e=null){return this.subkeys.filter((t=>!e||t.getKeyID().equals(e,!0)))}getKeys(e=null){const t=[];return e&&!this.getKeyID().equals(e,!0)||t.push(this),t.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map((e=>e.getKeyID()))}getUserIDs(){return this.users.map((e=>e.userID?e.userID.userID:null)).filter((e=>null!==e))}write(){return this.toPacketList().write()}async getSigningKey(e=null,t=new Date,r={},n=F){await this.verifyPrimaryKey(t,r,n);const i=this.keyPacket;try{Wa(i,n)}catch(e){throw Q.wrapError("Could not verify primary key",e)}const s=this.subkeys.slice().sort(((e,t)=>t.keyPacket.created-e.keyPacket.created));let a;for(const r of s)if(!e||r.getKeyID().equals(e))try{await r.verify(t,n);const e={key:i,bind:r.keyPacket},s=await Ha(r.bindingSignatures,i,V.signature.subkeyBinding,e,t,n);if(!za(r.keyPacket,s,n))continue;if(!s.embeddedSignature)throw Error("Missing embedded signature");return await Ha([s.embeddedSignature],r.keyPacket,V.signature.keyBinding,e,t,n),Wa(r.keyPacket,n),r}catch(e){a=e}try{const s=await this.getPrimarySelfSignature(t,r,n);if((!e||i.getKeyID().equals(e))&&za(i,s,n))return Wa(i,n),this}catch(e){a=e}throw Q.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),a)}async getEncryptionKey(e,t=new Date,r={},n=F){await this.verifyPrimaryKey(t,r,n);const i=this.keyPacket;try{Wa(i,n)}catch(e){throw Q.wrapError("Could not verify primary key",e)}const s=this.subkeys.slice().sort(((e,t)=>t.keyPacket.created-e.keyPacket.created));let a;for(const r of s)if(!e||r.getKeyID().equals(e))try{await r.verify(t,n);const e={key:i,bind:r.keyPacket},s=await Ha(r.bindingSignatures,i,V.signature.subkeyBinding,e,t,n);if(Ga(r.keyPacket,s,n))return Wa(r.keyPacket,n),r}catch(e){a=e}try{const s=await this.getPrimarySelfSignature(t,r,n);if((!e||i.getKeyID().equals(e))&&Ga(i,s,n))return Wa(i,n),this}catch(e){a=e}throw Q.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),a)}async isRevoked(e,t,r=new Date,n=F){return Qa(this.keyPacket,V.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,t,r,n)}async verifyPrimaryKey(e=new Date,t={},r=F){const n=this.keyPacket;if(await this.isRevoked(null,null,e,r))throw Error("Primary key is revoked");if(Va(n,await this.getPrimarySelfSignature(e,t,r),e))throw Error("Primary key is expired");if(6!==n.version){const t=await Ha(this.directSignatures,n,V.signature.key,{key:n},e,r).catch((()=>{}));if(t&&Va(n,t,e))throw Error("Primary key is expired")}}async getExpirationTime(e,t=F){let r;try{const n=await this.getPrimarySelfSignature(null,e,t),i=qa(this.keyPacket,n),s=n.getExpirationTime(),a=6!==this.keyPacket.version&&await Ha(this.directSignatures,this.keyPacket,V.signature.key,{key:this.keyPacket},null,t).catch((()=>{}));if(a){const e=qa(this.keyPacket,a);r=Math.min(i,s,e)}else r=i<s?i:s}catch(e){r=null}return Q.normalizeDate(r)}async getPrimarySelfSignature(e=new Date,t={},r=F){const n=this.keyPacket;if(6===n.version)return Ha(this.directSignatures,n,V.signature.key,{key:n},e,r);const{selfCertification:i}=await this.getPrimaryUser(e,t,r);return i}async getPrimaryUser(e=new Date,t={},r=F){const n=this.keyPacket,i=[];let s;for(let a=0;a<this.users.length;a++)try{const s=this.users[a];if(!s.userID)continue;if(void 0!==t.name&&s.userID.name!==t.name||void 0!==t.email&&s.userID.email!==t.email||void 0!==t.comment&&s.userID.comment!==t.comment)throw Error("Could not find user that matches that user ID");const o={userID:s.userID,key:n},c=await Ha(s.selfCertifications,n,V.signature.certGeneric,o,e,r);i.push({index:a,user:s,selfCertification:c})}catch(e){s=e}if(!i.length)throw s||Error("Could not find primary user");await Promise.all(i.map((async function(t){return t.selfCertification.revoked||t.user.isRevoked(t.selfCertification,null,e,r)})));const a=i.sort((function(e,t){const r=e.selfCertification,n=t.selfCertification;return n.revoked-r.revoked||r.isPrimaryUserID-n.isPrimaryUserID||r.created-n.created})).pop(),{user:o,selfCertification:c}=a;if(c.revoked||await o.isRevoked(c,null,e,r))throw Error("Primary user is revoked");return a}async update(e,t=new Date,r=F){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(this.subkeys.length!==e.subkeys.length||!this.subkeys.every((t=>e.subkeys.some((e=>t.hasSameFingerprintAs(e))))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,r)}const n=this.clone();return await ja(e,n,"revocationSignatures",t,(i=>Qa(n.keyPacket,V.signature.keyRevocation,n,[i],null,e.keyPacket,t,r))),await ja(e,n,"directSignatures",t),await Promise.all(e.users.map((async e=>{const i=n.users.filter((t=>e.userID&&e.userID.equals(t.userID)||e.userAttribute&&e.userAttribute.equals(t.userAttribute)));if(i.length>0)await Promise.all(i.map((n=>n.update(e,t,r))));else{const t=e.clone();t.mainKey=n,n.users.push(t)}}))),await Promise.all(e.subkeys.map((async e=>{const i=n.subkeys.filter((t=>t.hasSameFingerprintAs(e)));if(i.length>0)await Promise.all(i.map((n=>n.update(e,t,r))));else{const t=e.clone();t.mainKey=n,n.subkeys.push(t)}}))),n}async getRevocationCertificate(e=new Date,t=F){const r={key:this.keyPacket},n=await Ha(this.revocationSignatures,this.keyPacket,V.signature.keyRevocation,r,e,t),i=new ga;i.push(n);const s=6!==this.keyPacket.version;return ae(V.armor.publicKey,i.write(),null,null,"This is a revocation certificate",s,t)}async applyRevocationCertificate(e,t=new Date,r=F){const n=await se(e),i=(await ga.fromBinary(n.data,Xa,r)).findPacket(V.packet.signature);if(!i||i.signatureType!==V.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!i.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await i.verify(this.keyPacket,V.signature.keyRevocation,{key:this.keyPacket},t,void 0,r)}catch(e){throw Q.wrapError("Could not verify revocation signature",e)}const s=this.clone();return s.revocationSignatures.push(i),s}async signPrimaryUser(e,t,r,n=F){const{index:i,user:s}=await this.getPrimaryUser(t,r,n),a=await s.certify(e,t,n),o=this.clone();return o.users[i]=a,o}async signAllUsers(e,t=new Date,r=F){const n=this.clone();return n.users=await Promise.all(this.users.map((function(n){return n.certify(e,t,r)}))),n}async verifyPrimaryUser(e,t=new Date,r,n=F){const i=this.keyPacket,{user:s}=await this.getPrimaryUser(t,r,n);return e?await s.verifyAllCertifications(e,t,n):[{keyID:i.getKeyID(),valid:await s.verify(t,n).catch((()=>!1))}]}async verifyAllUsers(e,t=new Date,r=F){const n=this.keyPacket,i=[];return await Promise.all(this.users.map((async s=>{const a=e?await s.verifyAllCertifications(e,t,r):[{keyID:n.getKeyID(),valid:await s.verify(t,r).catch((()=>!1))}];i.push(...a.map((e=>({userID:s.userID?s.userID.userID:null,userAttribute:s.userAttribute,keyID:e.keyID,valid:e.valid}))))}))),i}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach((e=>{to.prototype[e]=Ja.prototype[e]}));class ro extends to{constructor(e){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],e&&(this.packetListToStructure(e,new Set([V.packet.secretKey,V.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(e=F){const t=6!==this.keyPacket.version;return ae(V.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,t,e)}}class no extends ro{constructor(e){if(super(),this.packetListToStructure(e,new Set([V.packet.publicKey,V.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const e=new ga,t=this.toPacketList();for(const r of t)switch(r.constructor.tag){case V.packet.secretKey:{const t=Ua.fromSecretKeyPacket(r);e.push(t);break}case V.packet.secretSubkey:{const t=xa.fromSecretSubkeyPacket(r);e.push(t);break}default:e.push(r)}return new ro(e)}armor(e=F){const t=6!==this.keyPacket.version;return ae(V.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,t,e)}async getDecryptionKeys(e,t=new Date,r={},n=F){const i=this.keyPacket,s=[];let a=null;for(let r=0;r<this.subkeys.length;r++)if(!e||this.subkeys[r].getKeyID().equals(e,!0)){if(this.subkeys[r].keyPacket.isDummy()){a=a||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{const e={key:i,bind:this.subkeys[r].keyPacket},a=await Ha(this.subkeys[r].bindingSignatures,i,V.signature.subkeyBinding,e,t,n);$a(this.subkeys[r].keyPacket,a,n)&&s.push(this.subkeys[r])}catch(e){a=e}}const o=await this.getPrimarySelfSignature(t,r,n);if(e&&!i.getKeyID().equals(e,!0)||!$a(i,o,n)||(i.isDummy()?a=a||Error("Gnu-dummy key packets cannot be used for decryption"):s.push(this)),0===s.length)throw a||Error("No decryption key packets found");return s}isDecrypted(){return this.getKeys().some((({keyPacket:e})=>e.isDecrypted()))}async validate(e=F){if(!this.isPrivate())throw Error("Cannot validate a public key");let t;if(this.keyPacket.isDummy()){const r=await this.getSigningKey(null,null,void 0,{...e,rejectPublicKeyAlgorithms:new Set,minRSABits:0});r&&!r.keyPacket.isDummy()&&(t=r.keyPacket)}else t=this.keyPacket;if(t)return t.validate();{const e=this.getKeys();if(e.map((e=>e.keyPacket.isDummy())).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(e.map((async e=>e.keyPacket.validate())))}}clearPrivateParams(){this.getKeys().forEach((({keyPacket:e})=>{e.isDecrypted()&&e.clearPrivateParams()}))}async revoke({flag:e=V.reasonForRevocation.noReason,string:t=""}={},r=new Date,n=F){if(!this.isPrivate())throw Error("Need private key for revoking");const i={key:this.keyPacket},s=this.clone();return s.revocationSignatures.push(await Fa(i,[],this.keyPacket,{signatureType:V.signature.keyRevocation,reasonForRevocationFlag:V.write(V.reasonForRevocation,e),reasonForRevocationString:t},r,void 0,void 0,void 0,n)),s}async addSubkey(e={}){const t={...F,...e.config};if(e.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(e.rsaBits<t.minRSABits)throw Error(`rsaBits should be at least ${t.minRSABits}, got: ${e.rsaBits}`);const r=this.keyPacket;if(r.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!r.isDecrypted())throw Error("Key is not decrypted");const n=r.getAlgorithmInfo();n.type=function(e){switch(V.write(V.publicKey,e)){case V.publicKey.rsaEncrypt:case V.publicKey.rsaEncryptSign:case V.publicKey.rsaSign:case V.publicKey.dsa:return"rsa";case V.publicKey.ecdsa:case V.publicKey.eddsaLegacy:return"ecc";case V.publicKey.ed25519:return"curve25519";case V.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}}(n.algorithm),n.rsaBits=n.bits||4096,n.curve=n.curve||"curve25519Legacy",e=function(e,t={}){switch(e.type=e.type||t.type,e.curve=e.curve||t.curve,e.rsaBits=e.rsaBits||t.rsaBits,e.keyExpirationTime=void 0!==e.keyExpirationTime?e.keyExpirationTime:t.keyExpirationTime,e.passphrase=Q.isString(e.passphrase)?e.passphrase:t.passphrase,e.date=e.date||t.date,e.sign=e.sign||!1,e.type){case"ecc":try{e.curve=V.write(V.curve,e.curve)}catch(e){throw Error("Unknown curve")}e.curve!==V.curve.ed25519Legacy&&e.curve!==V.curve.curve25519Legacy&&"ed25519"!==e.curve&&"curve25519"!==e.curve||(e.curve=e.sign?V.curve.ed25519Legacy:V.curve.curve25519Legacy),e.sign?e.algorithm=e.curve===V.curve.ed25519Legacy?V.publicKey.eddsaLegacy:V.publicKey.ecdsa:e.algorithm=V.publicKey.ecdh;break;case"curve25519":e.algorithm=e.sign?V.publicKey.ed25519:V.publicKey.x25519;break;case"curve448":e.algorithm=e.sign?V.publicKey.ed448:V.publicKey.x448;break;case"rsa":e.algorithm=V.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+e.type)}return e}(e,n);const i=await async function(e,t){const r=new _a(e.date,t);return r.packets=null,r.algorithm=V.write(V.publicKey,e.algorithm),await r.generate(e.rsaBits,e.curve),await r.computeFingerprintAndKeyID(),r}(e,{...t,v6Keys:6===this.keyPacket.version});Wa(i,t);const s=await async function(e,t,r,n){const i={};i.key=t,i.bind=e;const s={signatureType:V.signature.subkeyBinding};return r.sign?(s.keyFlags=[V.keyFlags.signData],s.embeddedSignature=await Fa(i,[],e,{signatureType:V.signature.keyBinding},r.date,void 0,void 0,void 0,n)):s.keyFlags=[V.keyFlags.encryptCommunication|V.keyFlags.encryptStorage],r.keyExpirationTime>0&&(s.keyExpirationTime=r.keyExpirationTime,s.keyNeverExpires=!1),await Fa(i,[],t,s,r.date,void 0,void 0,void 0,n)}(i,r,e,t),a=this.toPacketList();return a.push(i,s),new no(a)}}const io=Q.constructAllowedPackets([Ua,xa,Ra,_a,La,Da,ha]);const so=Q.constructAllowedPackets([Na]),ao=Q.constructAllowedPackets([ha]);class oo{constructor(e){this.packets=e||new ga}getEncryptionKeyIDs(){const e=[];return this.packets.filterByTag(V.packet.publicKeyEncryptedSessionKey).forEach((function(t){e.push(t.publicKeyID)})),e}getSigningKeyIDs(){const e=this.unwrapCompressed(),t=e.packets.filterByTag(V.packet.onePassSignature);return t.length>0?t.map((e=>e.issuerKeyID)):e.packets.filterByTag(V.packet.signature).map((e=>e.issuerKeyID))}async decrypt(e,t,r,n=new Date,i=F){const s=this.packets.filterByTag(V.packet.symmetricallyEncryptedData,V.packet.symEncryptedIntegrityProtectedData,V.packet.aeadEncryptedData);if(0===s.length)throw Error("No encrypted data found");const a=s[0],o=a.cipherAlgorithm,c=r||await this.decryptSessionKeys(e,t,o,n,i);let u=null;const l=Promise.all(c.map((async({algorithm:e,data:t})=>{if(!Q.isUint8Array(t)||!a.cipherAlgorithm&&!Q.isString(e))throw Error("Invalid session key for decryption.");try{const r=a.cipherAlgorithm||V.write(V.symmetric,e);await a.decrypt(r,t,i)}catch(e){Q.printDebugError(e),u=e}})));if(_(a.encrypted),a.encrypted=null,await l,!a.packets||!a.packets.length)throw u||Error("Decryption failed.");const h=new oo(a.packets);return a.packets=new ga,h}async decryptSessionKeys(e,t,r,n=new Date,i=F){let s,a=[];if(t){const e=this.packets.filterByTag(V.packet.symEncryptedSessionKey);if(0===e.length)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(t.map((async function(t,r){let n;n=r?await ga.fromBinary(e.write(),so,i):e,await Promise.all(n.map((async function(e){try{await e.decrypt(t),a.push(e)}catch(e){Q.printDebugError(e),e instanceof as&&(s=e)}})))})))}else{if(!e)throw Error("No key or password specified.");{const t=this.packets.filterByTag(V.packet.publicKeyEncryptedSessionKey);if(0===t.length)throw Error("No public key encrypted session key packet found.");await Promise.all(t.map((async function(t){await Promise.all(e.map((async function(e){let o;try{o=(await e.getDecryptionKeys(t.publicKeyID,null,void 0,i)).map((e=>e.keyPacket))}catch(e){return void(s=e)}let c=[V.symmetric.aes256,V.symmetric.aes128,V.symmetric.tripledes,V.symmetric.cast5];try{const t=await e.getPrimarySelfSignature(n,void 0,i);t.preferredSymmetricAlgorithms&&(c=c.concat(t.preferredSymmetricAlgorithms))}catch(e){}await Promise.all(o.map((async function(e){if(!e.isDecrypted())throw Error("Decryption key is not decrypted.");if(!i.constantTimePKCS1Decryption||t.publicKeyAlgorithm!==V.publicKey.rsaEncrypt&&t.publicKeyAlgorithm!==V.publicKey.rsaEncryptSign&&t.publicKeyAlgorithm!==V.publicKey.rsaSign&&t.publicKeyAlgorithm!==V.publicKey.elgamal)try{await t.decrypt(e);const n=r||t.sessionKeyAlgorithm;if(n&&!c.includes(V.write(V.symmetric,n)))throw Error("A non-preferred symmetric algorithm was used.");a.push(t)}catch(e){Q.printDebugError(e),s=e}else{const n=t.write();await Promise.all((r?[r]:Array.from(i.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map((async t=>{const r=new ka;r.read(n);const i={sessionKeyAlgorithm:t,sessionKey:bi(t)};try{await r.decrypt(e,i),a.push(r)}catch(e){Q.printDebugError(e),s=e}})))}})))}))),_(t.encrypted),t.encrypted=null})))}}if(a.length>0){if(a.length>1){const e=new Set;a=a.filter((t=>{const r=t.sessionKeyAlgorithm+Q.uint8ArrayToString(t.sessionKey);return!e.has(r)&&(e.add(r),!0)}))}return a.map((e=>({data:e.sessionKey,algorithm:e.sessionKeyAlgorithm&&V.read(V.symmetric,e.sessionKeyAlgorithm)})))}throw s||Error("Session key decryption failed.")}getLiteralData(){const e=this.unwrapCompressed().packets.findPacket(V.packet.literalData);return e&&e.getBytes()||null}getFilename(){const e=this.unwrapCompressed().packets.findPacket(V.packet.literalData);return e&&e.getFilename()||null}getText(){const e=this.unwrapCompressed().packets.findPacket(V.packet.literalData);return e?e.getText():null}static async generateSessionKey(e=[],t=new Date,r=[],n=F){const{symmetricAlgo:i,aeadAlgo:s}=await async function(e=[],t=new Date,r=[],n=F){const i=await Promise.all(e.map(((e,i)=>e.getPrimarySelfSignature(t,r[i],n))));if(e.length?i.every((e=>e.features&&e.features[0]&V.features.seipdv2)):n.aeadProtect){const e={symmetricAlgo:V.symmetric.aes128,aeadAlgo:V.aead.ocb},t=[{symmetricAlgo:n.preferredSymmetricAlgorithm,aeadAlgo:n.preferredAEADAlgorithm},{symmetricAlgo:n.preferredSymmetricAlgorithm,aeadAlgo:V.aead.ocb},{symmetricAlgo:V.symmetric.aes128,aeadAlgo:n.preferredAEADAlgorithm}];for(const e of t)if(i.every((t=>t.preferredCipherSuites&&t.preferredCipherSuites.some((t=>t[0]===e.symmetricAlgo&&t[1]===e.aeadAlgo)))))return e;return e}const s=V.symmetric.aes128,a=n.preferredSymmetricAlgorithm;return{symmetricAlgo:i.every((e=>e.preferredSymmetricAlgorithms&&e.preferredSymmetricAlgorithms.includes(a)))?a:s,aeadAlgo:void 0}}(e,t,r,n),a=V.read(V.symmetric,i),o=s?V.read(V.aead,s):void 0;return await Promise.all(e.map((e=>e.getEncryptionKey().catch((()=>null)).then((e=>{if(e&&(e.keyPacket.algorithm===V.publicKey.x25519||e.keyPacket.algorithm===V.publicKey.x448)&&!o&&!Q.isAES(i))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))))),{data:bi(i),algorithm:a,aeadAlgorithm:o}}async encrypt(e,t,r,n=!1,i=[],s=new Date,a=[],o=F){if(r){if(!Q.isUint8Array(r.data)||!Q.isString(r.algorithm))throw Error("Invalid session key for encryption.")}else if(e&&e.length)r=await oo.generateSessionKey(e,s,a,o);else{if(!t||!t.length)throw Error("No keys, passwords, or session key provided.");r=await oo.generateSessionKey(void 0,void 0,void 0,o)}const{data:c,algorithm:u,aeadAlgorithm:l}=r,h=await oo.encryptSessionKey(c,u,l,e,t,n,i,s,a,o),f=Ba.fromObject({version:l?2:1,aeadAlgorithm:l?V.write(V.aead,l):null});f.packets=this.packets;const p=V.write(V.symmetric,u);return await f.encrypt(p,c,o),h.packets.push(f),f.packets=new ga,h}static async encryptSessionKey(e,t,r,n,i,s=!1,a=[],o=new Date,c=[],u=F){const l=new ga,h=V.write(V.symmetric,t),f=r&&V.write(V.aead,r);if(n){const t=await Promise.all(n.map((async function(t,r){const n=await t.getEncryptionKey(a[r],o,c,u),i=ka.fromObject({version:f?6:3,encryptionKeyPacket:n.keyPacket,anonymousRecipient:s,sessionKey:e,sessionKeyAlgorithm:h});return await i.encrypt(n.keyPacket),delete i.sessionKey,i})));l.push(...t)}if(i){const t=async function(e,t){try{return await e.decrypt(t),1}catch(e){return 0}},r=(e,t)=>e+t,n=async function(e,s,a,o){const c=new Na(u);return c.sessionKey=e,c.sessionKeyAlgorithm=s,a&&(c.aeadAlgorithm=a),await c.encrypt(o,u),u.passwordCollisionCheck&&1!==(await Promise.all(i.map((e=>t(c,e))))).reduce(r)?n(e,s,o):(delete c.sessionKey,c)},s=await Promise.all(i.map((t=>n(e,h,f,t))));l.push(...s)}return new oo(l)}async sign(e=[],t=[],r=null,n=[],i=new Date,s=[],a=[],o=[],c=F){const u=new ga,l=this.packets.findPacket(V.packet.literalData);if(!l)throw Error("No literal data packet to sign.");const h=await co(l,e,t,r,n,i,s,a,o,!1,c),f=h.map(((e,t)=>ya.fromSignaturePacket(e,0===t))).reverse();return u.push(...f),u.push(l),u.push(...h),new oo(u)}compress(e,t=F){if(e===V.compression.uncompressed)return this;const r=new va(t);r.algorithm=e,r.packets=this.packets;const n=new ga;return n.push(r),new oo(n)}async signDetached(e=[],t=[],r=null,n=[],i=[],s=new Date,a=[],o=[],c=F){const u=this.packets.findPacket(V.packet.literalData);if(!u)throw Error("No literal data packet to sign.");return new Oa(await co(u,e,t,r,n,i,s,a,o,!0,c))}async verify(e,t=new Date,r=F){const n=this.unwrapCompressed(),i=n.packets.filterByTag(V.packet.literalData);if(1!==i.length)throw Error("Can only verify message with one literal data packet.");let s=n.packets;y(s.stream)&&(s=s.concat(await L(s.stream,(e=>e||[]))));const a=s.filterByTag(V.packet.onePassSignature).reverse(),o=s.filterByTag(V.packet.signature);return a.length&&!o.length&&Q.isStream(s.stream)&&!y(s.stream)?(await Promise.all(a.map((async e=>{e.correspondingSig=new Promise(((t,r)=>{e.correspondingSigResolve=t,e.correspondingSigReject=r})),e.signatureData=K((async()=>(await e.correspondingSig).signatureData)),e.hashed=L(await e.hash(e.signatureType,i[0],void 0,!1)),e.hashed.catch((()=>{}))}))),s.stream=N(s.stream,(async(e,t)=>{const r=O(e),n=M(t);try{for(let e=0;e<a.length;e++){const{value:t}=await r.read();a[e].correspondingSigResolve(t)}await r.readToEnd(),await n.ready,await n.close()}catch(e){a.forEach((t=>{t.correspondingSigReject(e)})),await n.abort(e)}})),uo(a,i,e,t,!1,r)):uo(o,i,e,t,!1,r)}verifyDetached(e,t,r=new Date,n=F){const i=this.unwrapCompressed().packets.filterByTag(V.packet.literalData);if(1!==i.length)throw Error("Can only verify message with one literal data packet.");return uo(e.packets.filterByTag(V.packet.signature),i,t,r,!0,n)}unwrapCompressed(){const e=this.packets.filterByTag(V.packet.compressedData);return e.length?new oo(e[0].packets):this}async appendSignature(e,t=F){await this.packets.read(Q.isUint8Array(e)?e:(await se(e)).data,ao,t)}write(){return this.packets.write()}armor(e=F){const t=this.packets[this.packets.length-1],r=t.constructor.tag===Ba.tag?2!==t.version:this.packets.some((e=>e.constructor.tag===ha.tag&&6!==e.version));return ae(V.armor.message,this.write(),null,null,null,r,e)}}async function co(e,t,r=[],n=null,i=[],s=new Date,a=[],o=[],c=[],u=!1,l=F){const h=new ga,f=null===e.text?V.signature.binary:V.signature.text;if(await Promise.all(t.map((async(t,n)=>{const h=a[n];if(!t.isPrivate())throw Error("Need private key for signing");const p=await t.getSigningKey(i[n],s,h,l);return Fa(e,r.length?r:[t],p.keyPacket,{signatureType:f},s,o,c,u,l)}))).then((e=>{h.push(...e)})),n){const e=n.packets.filterByTag(V.packet.signature);h.push(...e)}return h}async function uo(e,t,r,n=new Date,i=!1,s=F){return Promise.all(e.filter((function(e){return["text","binary"].includes(V.read(V.signature,e.signatureType))})).map((async function(e){return async function(e,t,r,n=new Date,i=!1,s=F){let a,o;for(const t of r){const r=t.getKeys(e.issuerKeyID);if(r.length>0){a=t,o=r[0];break}}const c=e instanceof ya?e.correspondingSig:e,u={keyID:e.issuerKeyID,verified:(async()=>{if(!o)throw Error("Could not find signing key with key ID "+e.issuerKeyID.toHex());await e.verify(o.keyPacket,e.signatureType,t[0],n,i,s);const r=await c;if(o.getCreationTime()>r.created)throw Error("Key is newer than the signature");try{await a.getSigningKey(o.getKeyID(),r.created,void 0,s)}catch(e){if(!s.allowInsecureVerificationWithReformattedKeys||!e.message.match(/Signature creation time is in the future/))throw e;await a.getSigningKey(o.getKeyID(),n,void 0,s)}return!0})(),signature:(async()=>{const e=await c,t=new ga;return e&&t.push(e),new Oa(t)})()};return u.signature.catch((()=>{})),u.verified.catch((()=>{})),u}(e,t,r,n,i,s)})))}class lo{constructor(e,t){if(this.text=Q.removeTrailingSpaces(e).replace(/\r?\n/g,"\r\n"),t&&!(t instanceof Oa))throw Error("Invalid signature input");this.signature=t||new Oa(new ga)}getSigningKeyIDs(){const e=[];return this.signature.packets.forEach((function(t){e.push(t.issuerKeyID)})),e}async sign(e,t=[],r=null,n=[],i=new Date,s=[],a=[],o=[],c=F){const u=new aa;u.setText(this.text);const l=new Oa(await co(u,e,t,r,n,i,s,a,o,!0,c));return new lo(this.text,l)}verify(e,t=new Date,r=F){const n=this.signature.packets.filterByTag(V.packet.signature),i=new aa;return i.setText(this.text),uo(n,[i],e,t,!0,r)}getText(){return this.text.replace(/\r\n/g,"\n")}armor(e=F){const t=this.signature.packets.some((e=>6!==e.version)),r={hash:t?Array.from(new Set(this.signature.packets.map((e=>V.read(V.hash,e.hashAlgorithm).toUpperCase())))).join():null,text:this.text,data:this.signature.packets.write()};return ae(V.armor.signed,r,void 0,void 0,void 0,t,e)}}async function ho({message:e,verificationKeys:t,expectSigned:r=!1,format:n="utf8",signature:i=null,date:s=new Date,config:a,...o}){if(function(e){const t=Object.keys(e);if(t.length!==fo)for(const e of t)if(void 0===F[e])throw Error("Unknown config property: "+e)}(a={...F,...a}),function(e){if(!(e instanceof lo||e instanceof oo))throw Error("Parameter [message] needs to be of type Message or CleartextMessage")}(e),t=function(e){return e&&!Q.isArray(e)&&(e=[e]),e}(t),o.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.verify, pass `verificationKeys` instead");const c=Object.keys(o);if(c.length>0)throw Error("Unknown option: "+c.join(", "));if(e instanceof lo&&"binary"===n)throw Error("Can't return cleartext message data as binary");if(e instanceof lo&&i)throw Error("Can't verify detached cleartext signature");try{const o={};if(o.signatures=i?await e.verifyDetached(i,t,s,a):await e.verify(t,s,a),o.data="binary"===n?e.getLiteralData():e.getText(),e.fromStream&&!i&&function(e,t){e.data=N(t.packets.stream,(async(t,r)=>{await B(e.data,r,{preventClose:!0});const n=M(r);try{await L(t,(e=>e)),await n.close()}catch(e){await n.abort(e)}}))}(o,e),r){if(0===o.signatures.length)throw Error("Message is not signed");o.data=C([o.data,K((async()=>(await Q.anyPromise(o.signatures.map((e=>e.verified))),"binary"===n?new Uint8Array:"")))])}return o.data=await async function(e){return"array"===Q.isStream(e)?L(e):e}(o.data),o}catch(e){throw Q.wrapError("Error verifying signed message",e)}}const fo=Object.keys(F).length;function po(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, not "+e)}function yo(e,...t){if(!((r=e)instanceof Uint8Array||null!=r&&"object"==typeof r&&"Uint8Array"===r.constructor.name))throw Error("Uint8Array expected");var r;if(t.length>0&&!t.includes(e.length))throw Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function go(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function mo(e,t){yo(e);const r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}const vo="object"==typeof o&&"crypto"in o?o.crypto:void 0,Ao=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),bo=(e,t)=>e<<32-t|e>>>t,wo=(e,t)=>e<<t|e>>>32-t>>>0,Eo=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function So(e){for(let r=0;r<e.length;r++)e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;var t}function Co(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function Bo(e){return"string"==typeof e&&(e=Co(e)),yo(e),e}function Io(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];yo(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}class ko{clone(){return this._cloneInto()}}function To(e){const t=t=>e().update(Bo(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function No(e=32){if(vo&&"function"==typeof vo.getRandomValues)return vo.getRandomValues(new Uint8Array(e));if(vo&&"function"==typeof vo.randomBytes)return vo.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}const Uo=(e,t,r)=>e&t^~e&r,xo=(e,t,r)=>e&t^e&r^t&r;class Do extends ko{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ao(this.buffer)}update(e){go(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=Bo(e)).length;for(let s=0;s<i;){const a=Math.min(n-this.pos,i-s);if(a!==n)r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===n&&(this.process(t,0),this.pos=0);else{const t=Ao(e);for(;n<=i-s;s+=n)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){go(this),mo(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>n-s&&(this.process(r,0),s=0);for(let e=s;e<n;e++)t[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,a,n),e.setUint32(t+u,o,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const a=Ao(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,u=this.get();if(c>u.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)a.setUint32(4*e,u[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:a}=this;return e.length=n,e.pos=a,e.finished=i,e.destroyed=s,n%t&&e.buffer.set(r),e}}const Ro=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Po=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Lo=new Uint32Array(64);class _o extends Do{constructor(){super(64,32,8,!1),this.A=0|Po[0],this.B=0|Po[1],this.C=0|Po[2],this.D=0|Po[3],this.E=0|Po[4],this.F=0|Po[5],this.G=0|Po[6],this.H=0|Po[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:a,H:o}=this;return[e,t,r,n,i,s,a,o]}set(e,t,r,n,i,s,a,o){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|a,this.H=0|o}process(e,t){for(let r=0;r<16;r++,t+=4)Lo[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Lo[e-15],r=Lo[e-2],n=bo(t,7)^bo(t,18)^t>>>3,i=bo(r,17)^bo(r,19)^r>>>10;Lo[e]=i+Lo[e-7]+n+Lo[e-16]|0}let{A:r,B:n,C:i,D:s,E:a,F:o,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(bo(a,6)^bo(a,11)^bo(a,25))+Uo(a,o,c)+Ro[e]+Lo[e]|0,l=(bo(r,2)^bo(r,13)^bo(r,22))+xo(r,n,i)|0;u=c,c=o,o=a,a=s+t|0,s=i,i=n,n=r,r=t+l|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,s,a,o,c,u)}roundClean(){Lo.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Ko extends _o{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Oo=To((()=>new _o)),Mo=To((()=>new Ko));class Ho extends ko{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");po(e.outputLen),po(e.blockLen)}(e);const r=Bo(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return go(this),this.iHash.update(e),this}digestInto(e){go(this),yo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:a}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Vo=(e,t,r)=>new Ho(e,t).update(r).digest();Vo.create=(e,t)=>new Ho(e,t);const Fo=BigInt(0),jo=BigInt(1),Qo=BigInt(2);function qo(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function zo(e){if(!qo(e))throw Error("Uint8Array expected")}function Go(e,t){if("boolean"!=typeof t)throw Error(`${e} must be valid boolean, got "${t}".`)}const $o=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Wo(e){zo(e);let t="";for(let r=0;r<e.length;r++)t+=$o[e[r]];return t}function Yo(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function Jo(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":"0x"+e)}function Xo(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function Zo(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=Xo(e.charCodeAt(i)),s=Xo(e.charCodeAt(i+1));if(void 0===r||void 0===s){const t=e[i]+e[i+1];throw Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+s}return n}function ec(e){return Jo(Wo(e))}function tc(e){return zo(e),Jo(Wo(Uint8Array.from(e).reverse()))}function rc(e,t){return Zo(e.toString(16).padStart(2*t,"0"))}function nc(e,t){return rc(e,t).reverse()}function ic(e,t,r){let n;if("string"==typeof t)try{n=Zo(t)}catch(r){throw Error(`${e} must be valid hex string, got "${t}". Cause: ${r}`)}else{if(!qo(t))throw Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw Error(`${e} expected ${r} bytes, got ${i}`);return n}function sc(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];zo(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}const ac=e=>"bigint"==typeof e&&Fo<=e;function oc(e,t,r){return ac(e)&&ac(t)&&ac(r)&&t<=e&&e<r}function cc(e,t,r,n){if(!oc(t,r,n))throw Error(`expected valid ${e}: ${r} <= n < ${n}, got ${typeof t} ${t}`)}function uc(e){let t;for(t=0;e>Fo;e>>=jo,t+=1);return t}const lc=e=>(Qo<<BigInt(e-1))-jo,hc=e=>new Uint8Array(e),fc=e=>Uint8Array.from(e);function pc(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=hc(e),i=hc(e),s=0;const a=()=>{n.fill(1),i.fill(0),s=0},o=(...e)=>r(i,n,...e),c=(e=hc())=>{i=o(fc([0]),e),n=o(),0!==e.length&&(i=o(fc([1]),e),n=o())},u=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){n=o();const t=n.slice();r.push(t),e+=n.length}return sc(...r)};return(e,t)=>{let r;for(a(),c(e);!(r=t(u()));)c();return a(),r}}const yc={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||qo(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function dc(e,t,r={}){const n=(t,r,n)=>{const i=yc[r];if("function"!=typeof i)throw Error(`Invalid validator "${r}", expected function`);const s=e[t];if(!(n&&void 0===s||i(s,e)))throw Error(`Invalid param ${t+""}=${s} (${typeof s}), expected ${r}`)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e}function gc(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}}var mc=Object.freeze({__proto__:null,aInRange:cc,abool:Go,abytes:zo,bitGet:function(e,t){return e>>BigInt(t)&jo},bitLen:uc,bitMask:lc,bitSet:function(e,t,r){return e|(r?jo:Fo)<<BigInt(t)},bytesToHex:Wo,bytesToNumberBE:ec,bytesToNumberLE:tc,concatBytes:sc,createHmacDrbg:pc,ensureBytes:ic,equalBytes:function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},hexToBytes:Zo,hexToNumber:Jo,inRange:oc,isBytes:qo,memoized:gc,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:rc,numberToBytesLE:nc,numberToHexUnpadded:Yo,numberToVarBytesBE:function(e){return Zo(Yo(e))},utf8ToBytes:function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))},validateObject:dc});const vc=BigInt(0),Ac=BigInt(1),bc=BigInt(2),wc=BigInt(3),Ec=BigInt(4),Sc=BigInt(5),Cc=BigInt(8);function Bc(e,t){const r=e%t;return r>=vc?r:t+r}function Ic(e,t,r){if(r<=vc||t<vc)throw Error("Expected power/modulo > 0");if(r===Ac)return vc;let n=Ac;for(;t>vc;)t&Ac&&(n=n*e%r),e=e*e%r,t>>=Ac;return n}function kc(e,t,r){let n=e;for(;t-- >vc;)n*=n,n%=r;return n}function Tc(e,t){if(e===vc||t<=vc)throw Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=Bc(e,t),n=t,i=vc,s=Ac;for(;r!==vc;){const e=n%r,t=i-s*(n/r);n=r,r=e,i=s,s=t}if(n!==Ac)throw Error("invert: does not exist");return Bc(i,t)}BigInt(9),BigInt(16);const Nc=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Uc(e,t){const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function xc(e,t,r=!1,n={}){if(e<=vc)throw Error("Expected Field ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=Uc(e,t);if(s>2048)throw Error("Field lengths over 2048 bytes are not supported");const a=function(e){if(e%Ec===wc){const t=(e+Ac)/Ec;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw Error("Cannot find square root");return n}}if(e%Cc===Sc){const t=(e-Sc)/Cc;return function(e,r){const n=e.mul(r,bc),i=e.pow(n,t),s=e.mul(r,i),a=e.mul(e.mul(s,bc),i),o=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),r))throw Error("Cannot find square root");return o}}return function(e){const t=(e-Ac)/bc;let r,n,i;for(r=e-Ac,n=0;r%bc===vc;r/=bc,n++);for(i=bc;i<e&&Ic(i,t,e)!==e-Ac;i++);if(1===n){const t=(e+Ac)/Ec;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw Error("Cannot find square root");return n}}const s=(r+Ac)/bc;return function(e,a){if(e.pow(a,t)===e.neg(e.ONE))throw Error("Cannot find square root");let o=n,c=e.pow(e.mul(e.ONE,i),r),u=e.pow(a,s),l=e.pow(a,r);for(;!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(l);t<o&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const r=e.pow(c,Ac<<BigInt(o-t-1));c=e.sqr(r),u=e.mul(u,r),l=e.mul(l,c),o=t}return u}}(e)}(e),o=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:lc(i),ZERO:vc,ONE:Ac,create:t=>Bc(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("Invalid field element: expected bigint, got "+typeof t);return vc<=t&&t<e},is0:e=>e===vc,isOdd:e=>(e&Ac)===Ac,neg:t=>Bc(-t,e),eql:(e,t)=>e===t,sqr:t=>Bc(t*t,e),add:(t,r)=>Bc(t+r,e),sub:(t,r)=>Bc(t-r,e),mul:(t,r)=>Bc(t*r,e),pow:(e,t)=>function(e,t,r){if(r<vc)throw Error("Expected power > 0");if(r===vc)return e.ONE;if(r===Ac)return t;let n=e.ONE,i=t;for(;r>vc;)r&Ac&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Ac;return n}(o,e,t),div:(t,r)=>Bc(t*Tc(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Tc(t,e),sqrt:n.sqrt||(e=>a(o,e)),invertBatch:e=>function(e,t){const r=Array(t.length),n=t.reduce(((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n))),e.ONE),i=e.inv(n);return t.reduceRight(((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))),i),r}(o,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?nc(e,s):rc(e,s),fromBytes:e=>{if(e.length!==s)throw Error(`Fp.fromBytes: expected ${s}, got ${e.length}`);return r?tc(e):ec(e)}});return Object.freeze(o)}function Dc(e){if("bigint"!=typeof e)throw Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Rc(e){const t=Dc(e);return t+Math.ceil(t/2)}const Pc=BigInt(0),Lc=BigInt(1),_c=new WeakMap,Kc=new WeakMap;function Oc(e,t){const r=(e,t)=>{const r=t.negate();return e?r:t},n=e=>{if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error(`Wrong window size=${e}, should be [1..${t}]`)},i=e=>(n(e),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:r,unsafeLadder(t,r){let n=e.ZERO,i=t;for(;r>Pc;)r&Lc&&(n=n.add(i)),i=i.double(),r>>=Lc;return n},precomputeWindow(e,t){const{windows:r,windowSize:n}=i(t),s=[];let a=e,o=a;for(let e=0;e<r;e++){o=a,s.push(o);for(let e=1;e<n;e++)o=o.add(a),s.push(o);a=o.double()}return s},wNAF(t,n,s){const{windows:a,windowSize:o}=i(t);let c=e.ZERO,u=e.BASE;const l=BigInt(2**t-1),h=2**t,f=BigInt(t);for(let e=0;e<a;e++){const t=e*o;let i=Number(s&l);s>>=f,i>o&&(i-=h,s+=Lc);const a=t,p=t+Math.abs(i)-1,y=e%2!=0,d=i<0;0===i?u=u.add(r(y,n[a])):c=c.add(r(d,n[p]))}return{p:c,f:u}},wNAFCached(e,t,r){const n=Kc.get(e)||1;let i=_c.get(e);return i||(i=this.precomputeWindow(e,n),1!==n&&_c.set(e,r(i))),this.wNAF(n,i,t)},setWindowSize(e,t){n(t),Kc.set(e,t),_c.delete(e)}}}function Mc(e,t,r,n){if(!Array.isArray(r)||!Array.isArray(n)||n.length!==r.length)throw Error("arrays of points and scalars must have equal length");n.forEach(((e,r)=>{if(!t.isValid(e))throw Error("wrong scalar at index "+r)})),r.forEach(((t,r)=>{if(!(t instanceof e))throw Error("wrong point at index "+r)}));const i=uc(BigInt(r.length)),s=i>12?i-3:i>4?i-2:i?2:1,a=(1<<s)-1,o=Array(a+1).fill(e.ZERO),c=Math.floor((t.BITS-1)/s)*s;let u=e.ZERO;for(let t=c;t>=0;t-=s){o.fill(e.ZERO);for(let e=0;e<n.length;e++){const i=n[e],s=Number(i>>BigInt(t)&BigInt(a));o[s]=o[s].add(r[e])}let i=e.ZERO;for(let t=o.length-1,r=e.ZERO;t>0;t--)r=r.add(o[t]),i=i.add(r);if(u=u.add(i),0!==t)for(let e=0;e<s;e++)u=u.double()}return u}function Hc(e){return dc(e.Fp,Nc.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),dc(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Uc(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function Vc(e){void 0!==e.lowS&&Go("lowS",e.lowS),void 0!==e.prehash&&Go("prehash",e.prehash)}const{bytesToNumberBE:Fc,hexToBytes:jc}=mc,Qc={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{const{Err:r}=Qc;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=Yo(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?Yo(i.length/2|128):"";return`${Yo(e)}${s}${i}${t}`},decode(e,t){const{Err:r}=Qc;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let s=0;if(128&i){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const a=t.subarray(n,n+e);if(a.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===a[0])throw new r("tlv.decode(long): zero leftmost byte");for(const e of a)s=s<<8|e;if(n+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const a=t.subarray(n,n+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+s)}}},_int:{encode(e){const{Err:t}=Qc;if(e<qc)throw new t("integer: negative integers are not allowed");let r=Yo(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected assertion");return r},decode(e){const{Err:t}=Qc;if(128&e[0])throw new t("Invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("Invalid signature integer: unnecessary leading zero");return Fc(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=Qc,i="string"==typeof e?jc(e):e;zo(i);const{v:s,l:a}=n.decode(48,i);if(a.length)throw new t("Invalid signature: left bytes after parsing");const{v:o,l:c}=n.decode(2,s),{v:u,l}=n.decode(2,c);if(l.length)throw new t("Invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(u)}},hexFromSig(e){const{_tlv:t,_int:r}=Qc,n=`${t.encode(2,r.encode(e.r))}${t.encode(2,r.encode(e.s))}`;return t.encode(48,n)}},qc=BigInt(0),zc=BigInt(1);BigInt(2);const Gc=BigInt(3);function $c(e){return{hash:e,hmac:(t,...r)=>Vo(e,t,Io(...r)),randomBytes:No}}function Wc(e,t){const r=t=>function(e){const t=function(e){const t=Hc(e);return dc(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function a(e){return Bc(e,n)}function o(e){return Tc(e,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=function(e){const t=function(e){const t=Hc(e);dc(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:r}=t,n=xc(t.n,t.nBitLength),i=t.toBytes||((e,t,n)=>{const i=t.toAffine();return sc(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),s=t.fromBytes||(e=>{const t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function a(e){const{a:n,b:i}=t,s=r.sqr(e),a=r.mul(s,e);return r.add(r.add(a,r.mul(e,n)),i)}if(!r.eql(r.sqr(t.Gy),a(t.Gx)))throw Error("bad generator point: equation left != right");function o(e){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:s}=t;if(r&&"bigint"!=typeof e){if(qo(e)&&(e=Wo(e)),"string"!=typeof e||!r.includes(e.length))throw Error("Invalid key");e=e.padStart(2*n,"0")}let a;try{a="bigint"==typeof e?e:ec(ic("private key",e,n))}catch(t){throw Error(`private key must be ${n} bytes, hex or bigint, not ${typeof e}`)}return i&&(a=Bc(a,s)),cc("private key",a,zc,s),a}function c(e){if(!(e instanceof h))throw Error("ProjectivePoint expected")}const u=gc(((e,t)=>{const{px:n,py:i,pz:s}=e;if(r.eql(s,r.ONE))return{x:n,y:i};const a=e.is0();null==t&&(t=a?r.ONE:r.inv(s));const o=r.mul(n,t),c=r.mul(i,t),u=r.mul(s,t);if(a)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw Error("invZ was invalid");return{x:o,y:c}})),l=gc((e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw Error("bad point: x or y not FE");const s=r.sqr(i),o=a(n);if(!r.eql(s,o))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0}));class h{constructor(e,t,n){if(this.px=e,this.py=t,this.pz=n,null==e||!r.isValid(e))throw Error("x required");if(null==t||!r.isValid(t))throw Error("y required");if(null==n||!r.isValid(n))throw Error("z required");Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw Error("invalid affine point");if(e instanceof h)throw Error("projective point not allowed");const i=e=>r.eql(e,r.ZERO);return i(t)&&i(n)?h.ZERO:new h(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=r.invertBatch(e.map((e=>e.pz)));return e.map(((e,r)=>e.toAffine(t[r]))).map(h.fromAffine)}static fromHex(e){const t=h.fromAffine(s(ic("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return h.BASE.multiply(o(e))}static msm(e,t){return Mc(h,n,e,t)}_setWindowSize(e){p.setWindowSize(this,e)}assertValidity(){l(this)}hasEvenY(){const{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){c(e);const{px:t,py:n,pz:i}=this,{px:s,py:a,pz:o}=e,u=r.eql(r.mul(t,o),r.mul(s,i)),l=r.eql(r.mul(n,o),r.mul(a,i));return u&&l}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){const{a:e,b:n}=t,i=r.mul(n,Gc),{px:s,py:a,pz:o}=this;let c=r.ZERO,u=r.ZERO,l=r.ZERO,f=r.mul(s,s),p=r.mul(a,a),y=r.mul(o,o),d=r.mul(s,a);return d=r.add(d,d),l=r.mul(s,o),l=r.add(l,l),c=r.mul(e,l),u=r.mul(i,y),u=r.add(c,u),c=r.sub(p,u),u=r.add(p,u),u=r.mul(c,u),c=r.mul(d,c),l=r.mul(i,l),y=r.mul(e,y),d=r.sub(f,y),d=r.mul(e,d),d=r.add(d,l),l=r.add(f,f),f=r.add(l,f),f=r.add(f,y),f=r.mul(f,d),u=r.add(u,f),y=r.mul(a,o),y=r.add(y,y),f=r.mul(y,d),c=r.sub(c,f),l=r.mul(y,p),l=r.add(l,l),l=r.add(l,l),new h(c,u,l)}add(e){c(e);const{px:n,py:i,pz:s}=this,{px:a,py:o,pz:u}=e;let l=r.ZERO,f=r.ZERO,p=r.ZERO;const y=t.a,d=r.mul(t.b,Gc);let g=r.mul(n,a),m=r.mul(i,o),v=r.mul(s,u),A=r.add(n,i),b=r.add(a,o);A=r.mul(A,b),b=r.add(g,m),A=r.sub(A,b),b=r.add(n,s);let w=r.add(a,u);return b=r.mul(b,w),w=r.add(g,v),b=r.sub(b,w),w=r.add(i,s),l=r.add(o,u),w=r.mul(w,l),l=r.add(m,v),w=r.sub(w,l),p=r.mul(y,b),l=r.mul(d,v),p=r.add(l,p),l=r.sub(m,p),p=r.add(m,p),f=r.mul(l,p),m=r.add(g,g),m=r.add(m,g),v=r.mul(y,v),b=r.mul(d,b),m=r.add(m,v),v=r.sub(g,v),v=r.mul(y,v),b=r.add(b,v),g=r.mul(m,b),f=r.add(f,g),g=r.mul(w,b),l=r.mul(A,l),l=r.sub(l,g),g=r.mul(A,m),p=r.mul(w,p),p=r.add(p,g),new h(l,f,p)}subtract(e){return this.add(e.negate())}is0(){return this.equals(h.ZERO)}wNAF(e){return p.wNAFCached(this,e,h.normalizeZ)}multiplyUnsafe(e){cc("scalar",e,qc,t.n);const n=h.ZERO;if(e===qc)return n;if(e===zc)return this;const{endo:i}=t;if(!i)return p.unsafeLadder(this,e);let{k1neg:s,k1:a,k2neg:o,k2:c}=i.splitScalar(e),u=n,l=n,f=this;for(;a>qc||c>qc;)a&zc&&(u=u.add(f)),c&zc&&(l=l.add(f)),f=f.double(),a>>=zc,c>>=zc;return s&&(u=u.negate()),o&&(l=l.negate()),l=new h(r.mul(l.px,i.beta),l.py,l.pz),u.add(l)}multiply(e){const{endo:n,n:i}=t;let s,a;if(cc("scalar",e,zc,i),n){const{k1neg:t,k1:i,k2neg:o,k2:c}=n.splitScalar(e);let{p:u,f:l}=this.wNAF(i),{p:f,f:y}=this.wNAF(c);u=p.constTimeNegate(t,u),f=p.constTimeNegate(o,f),f=new h(r.mul(f.px,n.beta),f.py,f.pz),s=u.add(f),a=l.add(y)}else{const{p:t,f:r}=this.wNAF(e);s=t,a=r}return h.normalizeZ([s,a])[0]}multiplyAndAddUnsafe(e,t,r){const n=h.BASE,i=(e,t)=>t!==qc&&t!==zc&&e.equals(n)?e.multiply(t):e.multiplyUnsafe(t),s=i(this,t).add(i(e,r));return s.is0()?void 0:s}toAffine(e){return u(this,e)}isTorsionFree(){const{h:e,isTorsionFree:r}=t;if(e===zc)return!0;if(r)return r(h,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:r}=t;return e===zc?this:r?r(h,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return Go("isCompressed",e),this.assertValidity(),i(h,this,e)}toHex(e=!0){return Go("isCompressed",e),Wo(this.toRawBytes(e))}}h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);const f=t.nBitLength,p=Oc(h,t.endo?Math.ceil(f/2):f);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:o,weierstrassEquation:a,isWithinCurveOrder:function(e){return oc(e,zc,t.n)}}}({...t,toBytes(e,t,n){const i=t.toAffine(),s=r.toBytes(i.x),a=sc;return Go("isCompressed",n),n?a(Uint8Array.from([t.hasEvenY()?2:3]),s):a(Uint8Array.from([4]),s,r.toBytes(i.y))},fromBytes(e){const t=e.length,n=e[0],a=e.subarray(1);if(t!==i||2!==n&&3!==n){if(t===s&&4===n)return{x:r.fromBytes(a.subarray(0,r.BYTES)),y:r.fromBytes(a.subarray(r.BYTES,2*r.BYTES))};throw Error(`Point of length ${t} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}{const t=ec(a);if(!oc(t,zc,r.ORDER))throw Error("Point is not on curve");const i=l(t);let s;try{s=r.sqrt(i)}catch(e){const t=e instanceof Error?": "+e.message:"";throw Error("Point is not on curve"+t)}return!(1&~n)!=((s&zc)===zc)&&(s=r.neg(s)),{x:t,y:s}}}}),f=e=>Wo(rc(e,t.nByteLength));function p(e){return e>n>>zc}const y=(e,t,r)=>ec(e.slice(t,r));class d{constructor(e,t,r){this.r=e,this.s=t,this.recovery=r,this.assertValidity()}static fromCompact(e){const r=t.nByteLength;return e=ic("compactSignature",e,2*r),new d(y(e,0,r),y(e,r,2*r))}static fromDER(e){const{r:t,s:r}=Qc.toSig(ic("DER",e));return new d(t,r)}assertValidity(){cc("r",this.r,zc,n),cc("s",this.s,zc,n)}addRecoveryBit(e){return new d(this.r,this.s,e)}recoverPublicKey(e){const{r:n,s:i,recovery:s}=this,u=A(ic("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");const l=2===s||3===s?n+t.n:n;if(l>=r.ORDER)throw Error("recovery id 2 or 3 invalid");const h=1&s?"03":"02",p=c.fromHex(h+f(l)),y=o(l),d=a(-u*y),g=a(i*y),m=c.BASE.multiplyAndAddUnsafe(p,d,g);if(!m)throw Error("point at infinify");return m.assertValidity(),m}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new d(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Zo(this.toDERHex())}toDERHex(){return Qc.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Zo(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const g={isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const e=Rc(t.n);return function(e,t,r=!1){const n=e.length,i=Dc(t),s=Rc(t);if(n<16||n<s||n>1024)throw Error(`expected ${s}-1024 bytes of input, got ${n}`);const a=Bc(r?ec(e):tc(e),t-Ac)+Ac;return r?nc(a,i):rc(a,i)}(t.randomBytes(e),t.n)},precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function m(e){const t=qo(e),r="string"==typeof e,n=(t||r)&&e.length;return t?n===i||n===s:r?n===2*i||n===2*s:e instanceof c}const v=t.bits2int||function(e){const r=ec(e),n=8*e.length-t.nBitLength;return n>0?r>>BigInt(n):r},A=t.bits2int_modN||function(e){return a(v(e))},b=lc(t.nBitLength);function w(e){return cc("num < 2^"+t.nBitLength,e,qc,b),rc(e,t.nByteLength)}function E(e,n,i=S){if(["recovered","canonical"].some((e=>e in i)))throw Error("sign() legacy options not supported");const{hash:s,randomBytes:l}=t;let{lowS:f,prehash:y,extraEntropy:g}=i;null==f&&(f=!0),e=ic("msgHash",e),Vc(i),y&&(e=ic("prehashed msgHash",s(e)));const m=A(e),b=u(n),E=[w(b),w(m)];if(null!=g&&!1!==g){const e=!0===g?l(r.BYTES):g;E.push(ic("extraEntropy",e))}const C=sc(...E),B=m;return{seed:C,k2sig:function(e){const t=v(e);if(!h(t))return;const r=o(t),n=c.BASE.multiply(t).toAffine(),i=a(n.x);if(i===qc)return;const s=a(r*a(B+i*b));if(s===qc)return;let u=(n.x===i?0:2)|Number(n.y&zc),l=s;return f&&p(s)&&(l=function(e){return p(e)?a(-e):e}(s),u^=1),new d(i,l,u)}}}const S={lowS:t.lowS,prehash:!1},C={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(m(e))throw Error("first arg must be private key");if(!m(t))throw Error("second arg must be public key");return c.fromHex(t).multiply(u(e)).toRawBytes(r)},sign:function(e,r,n=S){const{seed:i,k2sig:s}=E(e,r,n),a=t;return pc(a.hash.outputLen,a.nByteLength,a.hmac)(i,s)},verify:function(e,r,n,i=C){const s=e;if(r=ic("msgHash",r),n=ic("publicKey",n),"strict"in i)throw Error("options.strict was renamed to lowS");Vc(i);const{lowS:u,prehash:l}=i;let h,f;try{if("string"==typeof s||qo(s))try{h=d.fromDER(s)}catch(e){if(!(e instanceof Qc.Err))throw e;h=d.fromCompact(s)}else{if("object"!=typeof s||"bigint"!=typeof s.r||"bigint"!=typeof s.s)throw Error("PARSE");{const{r:e,s:t}=s;h=new d(e,t)}}f=c.fromHex(n)}catch(e){if("PARSE"===e.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&h.hasHighS())return!1;l&&(r=t.hash(r));const{r:p,s:y}=h,g=A(r),m=o(y),v=a(g*m),b=a(p*m),w=c.BASE.multiplyAndAddUnsafe(f,v,b)?.toAffine();return!!w&&a(w.x)===p},ProjectivePoint:c,Signature:d,utils:g}}({...e,...$c(t)});return Object.freeze({...r(t),create:r})}BigInt(4);const Yc=xc(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),Jc=Wc({a:Yc.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:Yc,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Oo),Xc=BigInt(2**32-1),Zc=BigInt(32);function eu(e,t=!1){return t?{h:Number(e&Xc),l:Number(e>>Zc&Xc)}:{h:0|Number(e>>Zc&Xc),l:0|Number(e&Xc)}}function tu(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:s,l:a}=eu(e[i],t);[r[i],n[i]]=[s,a]}return[r,n]}const ru=(e,t,r)=>e<<r|t>>>32-r,nu=(e,t,r)=>t<<r|e>>>32-r,iu=(e,t,r)=>t<<r-32|e>>>64-r,su=(e,t,r)=>e<<r-32|t>>>64-r,au={fromBig:eu,split:tu,toBig:(e,t)=>BigInt(e>>>0)<<Zc|BigInt(t>>>0),shrSH:(e,t,r)=>e>>>r,shrSL:(e,t,r)=>e<<32-r|t>>>r,rotrSH:(e,t,r)=>e>>>r|t<<32-r,rotrSL:(e,t,r)=>e<<32-r|t>>>r,rotrBH:(e,t,r)=>e<<64-r|t>>>r-32,rotrBL:(e,t,r)=>e>>>r-32|t<<64-r,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:ru,rotlSL:nu,rotlBH:iu,rotlBL:su,add:function(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}},add3L:(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H:(e,t,r,n)=>t+r+n+(e/2**32|0)|0,add4L:(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H:(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,add5H:(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0,add5L:(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},[ou,cu]=(()=>au.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),uu=new Uint32Array(80),lu=new Uint32Array(80);class hu extends Do{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:a,Dl:o,Eh:c,El:u,Fh:l,Fl:h,Gh:f,Gl:p,Hh:y,Hl:d}=this;return[e,t,r,n,i,s,a,o,c,u,l,h,f,p,y,d]}set(e,t,r,n,i,s,a,o,c,u,l,h,f,p,y,d){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|a,this.Dl=0|o,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|h,this.Gh=0|f,this.Gl=0|p,this.Hh=0|y,this.Hl=0|d}process(e,t){for(let r=0;r<16;r++,t+=4)uu[r]=e.getUint32(t),lu[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|uu[e-15],r=0|lu[e-15],n=au.rotrSH(t,r,1)^au.rotrSH(t,r,8)^au.shrSH(t,r,7),i=au.rotrSL(t,r,1)^au.rotrSL(t,r,8)^au.shrSL(t,r,7),s=0|uu[e-2],a=0|lu[e-2],o=au.rotrSH(s,a,19)^au.rotrBH(s,a,61)^au.shrSH(s,a,6),c=au.rotrSL(s,a,19)^au.rotrBL(s,a,61)^au.shrSL(s,a,6),u=au.add4L(i,c,lu[e-7],lu[e-16]),l=au.add4H(u,n,o,uu[e-7],uu[e-16]);uu[e]=0|l,lu[e]=0|u}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:a,Cl:o,Dh:c,Dl:u,Eh:l,El:h,Fh:f,Fl:p,Gh:y,Gl:d,Hh:g,Hl:m}=this;for(let e=0;e<80;e++){const t=au.rotrSH(l,h,14)^au.rotrSH(l,h,18)^au.rotrBH(l,h,41),v=au.rotrSL(l,h,14)^au.rotrSL(l,h,18)^au.rotrBL(l,h,41),A=l&f^~l&y,b=h&p^~h&d,w=au.add5L(m,v,b,cu[e],lu[e]),E=au.add5H(w,g,t,A,ou[e],uu[e]),S=0|w,C=au.rotrSH(r,n,28)^au.rotrBH(r,n,34)^au.rotrBH(r,n,39),B=au.rotrSL(r,n,28)^au.rotrBL(r,n,34)^au.rotrBL(r,n,39),I=r&i^r&a^i&a,k=n&s^n&o^s&o;g=0|y,m=0|d,y=0|f,d=0|p,f=0|l,p=0|h,({h:l,l:h}=au.add(0|c,0|u,0|E,0|S)),c=0|a,u=0|o,a=0|i,o=0|s,i=0|r,s=0|n;const T=au.add3L(S,B,k);r=au.add3H(T,E,C,I),n=0|T}({h:r,l:n}=au.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=au.add(0|this.Bh,0|this.Bl,0|i,0|s)),({h:a,l:o}=au.add(0|this.Ch,0|this.Cl,0|a,0|o)),({h:c,l:u}=au.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h:l,l:h}=au.add(0|this.Eh,0|this.El,0|l,0|h)),({h:f,l:p}=au.add(0|this.Fh,0|this.Fl,0|f,0|p)),({h:y,l:d}=au.add(0|this.Gh,0|this.Gl,0|y,0|d)),({h:g,l:m}=au.add(0|this.Hh,0|this.Hl,0|g,0|m)),this.set(r,n,i,s,a,o,c,u,l,h,f,p,y,d,g,m)}roundClean(){uu.fill(0),lu.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class fu extends hu{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const pu=To((()=>new hu)),yu=To((()=>new fu)),du=xc(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),gu=Wc({a:du.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:du,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},yu),mu=xc(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),vu={a:mu.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:mu,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},Au=Wc({a:vu.a,b:vu.b,Fp:mu,n:vu.n,Gx:vu.Gx,Gy:vu.Gy,h:vu.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},pu),bu=[],wu=[],Eu=[],Su=BigInt(0),Cu=BigInt(1),Bu=BigInt(2),Iu=BigInt(7),ku=BigInt(256),Tu=BigInt(113);for(let e=0,t=Cu,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],bu.push(2*(5*n+r)),wu.push((e+1)*(e+2)/2%64);let i=Su;for(let e=0;e<7;e++)t=(t<<Cu^(t>>Iu)*Tu)%ku,t&Bu&&(i^=Cu<<(Cu<<BigInt(e))-Cu);Eu.push(i)}const[Nu,Uu]=tu(Eu,!0),xu=(e,t,r)=>r>32?iu(e,t,r):ru(e,t,r),Du=(e,t,r)=>r>32?su(e,t,r):nu(e,t,r);class Ru extends ko{constructor(e,t,r,n=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,po(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");var s;this.state=new Uint8Array(200),this.state32=(s=this.state,new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)))}keccak(){Eo||So(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,s=r[i],a=r[i+1],o=xu(s,a,1)^r[n],c=Du(s,a,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=o,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=wu[r],s=xu(t,i,n),a=Du(t,i,n),o=bu[r];t=e[o],i=e[o+1],e[o]=s,e[o+1]=a}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=Nu[n],e[1]^=Uu[n]}r.fill(0)}(this.state32,this.rounds),Eo||So(this.state32),this.posOut=0,this.pos=0}update(e){go(this);const{blockLen:t,state:r}=this,n=(e=Bo(e)).length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){go(this,!1),yo(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return po(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(mo(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new Ru(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}const Pu=(e,t,r)=>To((()=>new Ru(t,e,r))),Lu=Pu(6,136,32),_u=Pu(6,72,64),Ku=(()=>function(e){const t=(t,r)=>e(r).update(Bo(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(((e={})=>new Ru(136,31,void 0===e.dkLen?32:e.dkLen,!0))))(),Ou=BigInt(0),Mu=BigInt(1),Hu=BigInt(2),Vu=BigInt(8),Fu={zip215:!0};function ju(e){const t=function(e){const t=Hc(e);return dc(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:r,n,prehash:i,hash:s,randomBytes:a,nByteLength:o,h:c}=t,u=Hu<<BigInt(8*o)-Mu,l=r.create,h=xc(t.n,t.nBitLength),f=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch(e){return{isValid:!1,value:Ou}}}),p=t.adjustScalarBytes||(e=>e),y=t.domain||((e,t,r)=>{if(Go("phflag",r),t.length||r)throw Error("Contexts/pre-hash are not supported");return e});function d(e,t){cc("coordinate "+e,t,Ou,u)}function g(e){if(!(e instanceof A))throw Error("ExtendedPoint expected")}const m=gc(((e,t)=>{const{ex:n,ey:i,ez:s}=e,a=e.is0();null==t&&(t=a?Vu:r.inv(s));const o=l(n*t),c=l(i*t),u=l(s*t);if(a)return{x:Ou,y:Mu};if(u!==Mu)throw Error("invZ was invalid");return{x:o,y:c}})),v=gc((e=>{const{a:r,d:n}=t;if(e.is0())throw Error("bad point: ZERO");const{ex:i,ey:s,ez:a,et:o}=e,c=l(i*i),u=l(s*s),h=l(a*a),f=l(h*h),p=l(c*r);if(l(h*l(p+u))!==l(f+l(n*l(c*u))))throw Error("bad point: equation left != right (1)");if(l(i*s)!==l(a*o))throw Error("bad point: equation left != right (2)");return!0}));class A{constructor(e,t,r,n){this.ex=e,this.ey=t,this.ez=r,this.et=n,d("x",e),d("y",t),d("z",r),d("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof A)throw Error("extended point not allowed");const{x:t,y:r}=e||{};return d("x",t),d("y",r),new A(t,r,Mu,l(t*r))}static normalizeZ(e){const t=r.invertBatch(e.map((e=>e.ez)));return e.map(((e,r)=>e.toAffine(t[r]))).map(A.fromAffine)}static msm(e,t){return Mc(A,h,e,t)}_setWindowSize(e){E.setWindowSize(this,e)}assertValidity(){v(this)}equals(e){g(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:s,ez:a}=e,o=l(t*a),c=l(i*n),u=l(r*a),h=l(s*n);return o===c&&u===h}is0(){return this.equals(A.ZERO)}negate(){return new A(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:e}=t,{ex:r,ey:n,ez:i}=this,s=l(r*r),a=l(n*n),o=l(Hu*l(i*i)),c=l(e*s),u=r+n,h=l(l(u*u)-s-a),f=c+a,p=f-o,y=c-a,d=l(h*p),g=l(f*y),m=l(h*y),v=l(p*f);return new A(d,g,v,m)}add(e){g(e);const{a:r,d:n}=t,{ex:i,ey:s,ez:a,et:o}=this,{ex:c,ey:u,ez:h,et:f}=e;if(r===BigInt(-1)){const e=l((s-i)*(u+c)),t=l((s+i)*(u-c)),r=l(t-e);if(r===Ou)return this.double();const n=l(a*Hu*f),p=l(o*Hu*h),y=p+n,d=t+e,g=p-n,m=l(y*r),v=l(d*g),b=l(y*g),w=l(r*d);return new A(m,v,w,b)}const p=l(i*c),y=l(s*u),d=l(o*n*f),m=l(a*h),v=l((i+s)*(c+u)-p-y),b=m-d,w=m+d,E=l(y-r*p),S=l(v*b),C=l(w*E),B=l(v*E),I=l(b*w);return new A(S,C,I,B)}subtract(e){return this.add(e.negate())}wNAF(e){return E.wNAFCached(this,e,A.normalizeZ)}multiply(e){const t=e;cc("scalar",t,Mu,n);const{p:r,f:i}=this.wNAF(t);return A.normalizeZ([r,i])[0]}multiplyUnsafe(e){const t=e;return cc("scalar",t,Ou,n),t===Ou?w:this.equals(w)||t===Mu?this:this.equals(b)?this.wNAF(t).p:E.unsafeLadder(this,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return E.unsafeLadder(this,n).is0()}toAffine(e){return m(this,e)}clearCofactor(){const{h:e}=t;return e===Mu?this:this.multiplyUnsafe(e)}static fromHex(e,n=!1){const{d:i,a:s}=t,a=r.BYTES;e=ic("pointHex",e,a),Go("zip215",n);const o=e.slice(),c=e[a-1];o[a-1]=-129&c;const h=tc(o),p=n?u:r.ORDER;cc("pointHex.y",h,Ou,p);const y=l(h*h),d=l(y-Mu),g=l(i*y-s);let{isValid:m,value:v}=f(d,g);if(!m)throw Error("Point.fromHex: invalid y coordinate");const b=(v&Mu)===Mu,w=!!(128&c);if(!n&&v===Ou&&w)throw Error("Point.fromHex: x=0 and x_0=1");return w!==b&&(v=l(-v)),A.fromAffine({x:v,y:h})}static fromPrivateKey(e){return B(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),n=nc(t,r.BYTES);return n[n.length-1]|=e&Mu?128:0,n}toHex(){return Wo(this.toRawBytes())}}A.BASE=new A(t.Gx,t.Gy,Mu,l(t.Gx*t.Gy)),A.ZERO=new A(Ou,Mu,Mu,Ou);const{BASE:b,ZERO:w}=A,E=Oc(A,8*o);function S(e){return Bc(e,n)}function C(e){return S(tc(e))}function B(e){const t=o;e=ic("private key",e,t);const r=ic("hashed private key",s(e),2*t),n=p(r.slice(0,t)),i=r.slice(t,2*t),a=C(n),c=b.multiply(a),u=c.toRawBytes();return{head:n,prefix:i,scalar:a,point:c,pointBytes:u}}function I(e=new Uint8Array,...t){const r=sc(...t);return C(s(y(r,ic("context",e),!!i)))}const k=Fu;return b._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return B(e).pointBytes},sign:function(e,t,s={}){e=ic("message",e),i&&(e=i(e));const{prefix:a,scalar:c,pointBytes:u}=B(t),l=I(s.context,a,e),h=b.multiply(l).toRawBytes(),f=S(l+I(s.context,h,u,e)*c);return cc("signature.s",f,Ou,n),ic("result",sc(h,nc(f,r.BYTES)),2*o)},verify:function(e,t,n,s=k){const{context:a,zip215:o}=s,c=r.BYTES;e=ic("signature",e,2*c),t=ic("message",t),void 0!==o&&Go("zip215",o),i&&(t=i(t));const u=tc(e.slice(c,2*c));let l,h,f;try{l=A.fromHex(n,o),h=A.fromHex(e.slice(0,c),o),f=b.multiplyUnsafe(u)}catch(e){return!1}if(!o&&l.isSmallOrder())return!1;const p=I(a,h.toRawBytes(),l.toRawBytes(),t);return h.add(l.multiplyUnsafe(p)).subtract(f).clearCofactor().equals(A.ZERO)},ExtendedPoint:A,utils:{getExtendedPublicKey:B,randomPrivateKey:()=>a(r.BYTES),precompute:(e=8,t=A.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}const Qu=BigInt(0),qu=BigInt(1),zu=To((()=>Ku.create({dkLen:114}))),Gu=(To((()=>Ku.create({dkLen:64}))),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),$u=BigInt(1),Wu=BigInt(2),Yu=BigInt(3);BigInt(4);const Ju=BigInt(11),Xu=BigInt(22),Zu=BigInt(44),el=BigInt(88),tl=BigInt(223);function rl(e){const t=Gu,r=e*e*e%t,n=r*r*e%t,i=kc(n,Yu,t)*n%t,s=kc(i,Yu,t)*n%t,a=kc(s,Wu,t)*r%t,o=kc(a,Ju,t)*a%t,c=kc(o,Xu,t)*o%t,u=kc(c,Zu,t)*c%t,l=kc(u,el,t)*u%t,h=kc(l,Zu,t)*c%t,f=kc(h,Wu,t)*r%t,p=kc(f,$u,t)*e%t;return kc(p,tl,t)*f%t}function nl(e){return e[0]&=252,e[55]|=128,e[56]=0,e}const il=xc(Gu,456,!0),sl={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:il,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:zu,randomBytes:No,adjustScalarBytes:nl,domain:(e,t,r)=>{if(t.length>255)throw Error("Context is too big: "+t.length);return Io(Co("SigEd448"),new Uint8Array([r?1:0,t.length]),t,e)},uvRatio:function(e,t){const r=Gu,n=Bc(e*e*t,r),i=Bc(n*e,r),s=Bc(i*n*t,r),a=Bc(i*rl(s),r),o=Bc(a*a,r);return{isValid:Bc(o*t,r)===e,value:a}}},al=ju(sl),ol=(()=>function(e){const t=(dc(r=e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r}));var r;const{P:n}=t,i=e=>Bc(e,n),s=t.montgomeryBits,a=Math.ceil(s/8),o=t.nByteLength,c=t.adjustScalarBytes||(e=>e),u=t.powPminus2||(e=>Ic(e,n-BigInt(2),n));function l(e,t,r){const n=i(e*(t-r));return[t=i(t-n),r=i(r+n)]}const h=(t.a-BigInt(2))/BigInt(4);function f(e){return nc(i(e),a)}function p(e,t){const r=function(e){const t=ic("u coordinate",e,a);return 32===o&&(t[31]&=127),tc(t)}(t),p=function(e){const t=ic("scalar",e),r=t.length;if(r!==a&&r!==o)throw Error(`Expected ${a} or ${o} bytes, got ${r}`);return tc(c(t))}(e),y=function(e,t){cc("u",e,Qu,n),cc("scalar",t,Qu,n);const r=t,a=e;let o,c=qu,f=Qu,p=e,y=qu,d=Qu;for(let e=BigInt(s-1);e>=Qu;e--){const t=r>>e&qu;d^=t,o=l(d,c,p),c=o[0],p=o[1],o=l(d,f,y),f=o[0],y=o[1],d=t;const n=c+f,s=i(n*n),u=c-f,g=i(u*u),m=s-g,v=p+y,A=i((p-y)*n),b=i(v*u),w=A+b,E=A-b;p=i(w*w),y=i(a*i(E*E)),c=i(s*g),f=i(m*(s+i(h*m)))}o=l(d,c,p),c=o[0],p=o[1],o=l(d,f,y),f=o[0],y=o[1];const g=u(f);return i(c*g)}(r,p);if(y===Qu)throw Error("Invalid private or public key received");return f(y)}const y=f(t.Gu);function d(e){return p(e,y)}return{scalarMult:p,scalarMultBase:d,getSharedSecret:(e,t)=>p(e,t),getPublicKey:e=>d(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:y}}({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:Gu,Gu:BigInt(5),powPminus2:e=>{const t=Gu;return Bc(kc(rl(e),BigInt(2),t)*e,t)},adjustScalarBytes:nl,randomBytes:No}))();il.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const cl=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ul=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ll=BigInt(1),hl=BigInt(2),fl=(e,t)=>(e+t/hl)/t,pl=xc(cl,void 0,void 0,{sqrt:function(e){const t=cl,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),u=e*e*e%t,l=u*u*e%t,h=kc(l,r,t)*l%t,f=kc(h,r,t)*l%t,p=kc(f,hl,t)*u%t,y=kc(p,i,t)*p%t,d=kc(y,s,t)*y%t,g=kc(d,o,t)*d%t,m=kc(g,c,t)*g%t,v=kc(m,o,t)*d%t,A=kc(v,r,t)*l%t,b=kc(A,a,t)*y%t,w=kc(b,n,t)*u%t,E=kc(w,hl,t);if(!pl.eql(pl.sqr(E),e))throw Error("Cannot find square root");return E}}),yl=Wc({a:BigInt(0),b:BigInt(7),Fp:pl,n:ul,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=ul,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ll*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=fl(s*e,t),c=fl(-n*e,t);let u=Bc(e-o*r-c*i,t),l=Bc(-o*n-c*s,t);const h=u>a,f=l>a;if(h&&(u=t-u),f&&(l=t-l),u>a||l>a)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:f,k2:l}}}},Oo);BigInt(0),yl.ProjectivePoint;const dl=xc(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),gl=Wc({a:dl.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:dl,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},Oo),ml=xc(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),vl=Wc({a:ml.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:ml,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},yu),Al=xc(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),bl=Wc({a:Al.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:Al,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},pu),wl=new Map(Object.entries({nistP256:Jc,nistP384:gu,nistP521:Au,brainpoolP256r1:gl,brainpoolP384r1:vl,brainpoolP512r1:bl,secp256k1:yl,x448:ol,ed448:al}));var El=Object.freeze({__proto__:null,nobleCurves:wl});const Sl=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),Cl=new Uint32Array(80);class Bl extends Do{constructor(){super(64,20,8,!1),this.A=0|Sl[0],this.B=0|Sl[1],this.C=0|Sl[2],this.D=0|Sl[3],this.E=0|Sl[4]}get(){const{A:e,B:t,C:r,D:n,E:i}=this;return[e,t,r,n,i]}set(e,t,r,n,i){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i}process(e,t){for(let r=0;r<16;r++,t+=4)Cl[r]=e.getUint32(t,!1);for(let e=16;e<80;e++)Cl[e]=wo(Cl[e-3]^Cl[e-8]^Cl[e-14]^Cl[e-16],1);let{A:r,B:n,C:i,D:s,E:a}=this;for(let e=0;e<80;e++){let t,o;e<20?(t=Uo(n,i,s),o=1518500249):e<40?(t=n^i^s,o=1859775393):e<60?(t=xo(n,i,s),o=2400959708):(t=n^i^s,o=3395469782);const c=wo(r,5)+t+a+o+Cl[e]|0;a=s,s=i,i=wo(n,30),n=r,r=c}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,this.set(r,n,i,s,a)}roundClean(){Cl.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const Il=To((()=>new Bl)),kl=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Tl=new Uint8Array(Array(16).fill(0).map(((e,t)=>t))),Nl=Tl.map((e=>(9*e+5)%16));let Ul=[Tl],xl=[Nl];for(let e=0;e<4;e++)for(let t of[Ul,xl])t.push(t[e].map((e=>kl[e])));const Dl=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((e=>new Uint8Array(e))),Rl=Ul.map(((e,t)=>e.map((e=>Dl[t][e])))),Pl=xl.map(((e,t)=>e.map((e=>Dl[t][e])))),Ll=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),_l=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function Kl(e,t,r,n){return 0===e?t^r^n:1===e?t&r|~t&n:2===e?(t|~r)^n:3===e?t&n|r&~n:t^(r|~n)}const Ol=new Uint32Array(16);class Ml extends Do{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:r,h3:n,h4:i}=this;return[e,t,r,n,i]}set(e,t,r,n,i){this.h0=0|e,this.h1=0|t,this.h2=0|r,this.h3=0|n,this.h4=0|i}process(e,t){for(let r=0;r<16;r++,t+=4)Ol[r]=e.getUint32(t,!0);let r=0|this.h0,n=r,i=0|this.h1,s=i,a=0|this.h2,o=a,c=0|this.h3,u=c,l=0|this.h4,h=l;for(let e=0;e<5;e++){const t=4-e,f=Ll[e],p=_l[e],y=Ul[e],d=xl[e],g=Rl[e],m=Pl[e];for(let t=0;t<16;t++){const n=wo(r+Kl(e,i,a,c)+Ol[y[t]]+f,g[t])+l|0;r=l,l=c,c=0|wo(a,10),a=i,i=n}for(let e=0;e<16;e++){const r=wo(n+Kl(t,s,o,u)+Ol[d[e]]+p,m[e])+h|0;n=h,h=u,u=0|wo(o,10),o=s,s=r}}this.set(this.h1+a+u|0,this.h2+c+h|0,this.h3+l+n|0,this.h4+r+s|0,this.h0+i+o|0)}roundClean(){Ol.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const Hl=To((()=>new Ml)),Vl=Array.from({length:64},((e,t)=>Math.floor(2**32*Math.abs(Math.sin(t+1))))),Fl=(e,t,r)=>e&t^~e&r,jl=new Uint32Array([1732584193,4023233417,2562383102,271733878]),Ql=new Uint32Array(16);class ql extends Do{constructor(){super(64,16,8,!0),this.A=0|jl[0],this.B=0|jl[1],this.C=0|jl[2],this.D=0|jl[3]}get(){const{A:e,B:t,C:r,D:n}=this;return[e,t,r,n]}set(e,t,r,n){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n}process(e,t){for(let r=0;r<16;r++,t+=4)Ql[r]=e.getUint32(t,!0);let{A:r,B:n,C:i,D:s}=this;for(let e=0;e<64;e++){let t,a,o;e<16?(t=Fl(n,i,s),a=e,o=[7,12,17,22]):e<32?(t=Fl(s,n,i),a=(5*e+1)%16,o=[5,9,14,20]):e<48?(t=n^i^s,a=(3*e+5)%16,o=[4,11,16,23]):(t=i^(n|~s),a=7*e%16,o=[6,10,15,21]),t=t+r+Vl[e]+Ql[a],r=s,s=i,i=n,n+=wo(t,o[e%4])}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,this.set(r,n,i,s)}roundClean(){Ql.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}}const zl=new Map(Object.entries({md5:To((()=>new ql)),sha1:Il,sha224:Mo,sha256:Oo,sha384:yu,sha512:pu,sha3_256:Lu,sha3_512:_u,ripemd160:Hl}));var Gl=Object.freeze({__proto__:null,nobleHashes:zl});function $l(e,t,r,n,i,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],h=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],f=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let y,d,g,m,v,A,b,w,E,S,C=0,B=t.length;const I=32===e.length?3:9;w=3===I?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],r&&(t=function(e){const t=8-e.length%8;let r;if(!(t<8)){if(8===t)return e;throw Error("des: invalid padding")}r=0;const n=new Uint8Array(e.length+t);for(let t=0;t<e.length;t++)n[t]=e[t];for(let r=0;r<t;r++)n[e.length+r]=0;return n}(t),B=t.length);let k=new Uint8Array(B),T=0;for(;C<B;){for(A=t[C++]<<24|t[C++]<<16|t[C++]<<8|t[C++],b=t[C++]<<24|t[C++]<<16|t[C++]<<8|t[C++],g=252645135&(A>>>4^b),b^=g,A^=g<<4,g=65535&(A>>>16^b),b^=g,A^=g<<16,g=858993459&(b>>>2^A),A^=g,b^=g<<2,g=16711935&(b>>>8^A),A^=g,b^=g<<8,g=1431655765&(A>>>1^b),b^=g,A^=g<<1,A=A<<1|A>>>31,b=b<<1|b>>>31,d=0;d<I;d+=3){for(E=w[d+1],S=w[d+2],y=w[d];y!==E;y+=S)m=b^e[y],v=(b>>>4|b<<28)^e[y+1],g=A,A=b,b=g^(o[m>>>24&63]|u[m>>>16&63]|h[m>>>8&63]|p[63&m]|a[v>>>24&63]|c[v>>>16&63]|l[v>>>8&63]|f[63&v]);g=A,A=b,b=g}A=A>>>1|A<<31,b=b>>>1|b<<31,g=1431655765&(A>>>1^b),b^=g,A^=g<<1,g=16711935&(b>>>8^A),A^=g,b^=g<<8,g=858993459&(b>>>2^A),A^=g,b^=g<<2,g=65535&(A>>>16^b),b^=g,A^=g<<16,g=252645135&(A>>>4^b),b^=g,A^=g<<4,k[T++]=A>>>24,k[T++]=A>>>16&255,k[T++]=A>>>8&255,k[T++]=255&A,k[T++]=b>>>24,k[T++]=b>>>16&255,k[T++]=b>>>8&255,k[T++]=255&b}return r||(k=function(e){let t,r=null;if(t=0,!r){for(r=1;0===e[e.length-r];)r++;r--}return e.subarray(0,e.length-r)}(k)),k}function Wl(e){const t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=e.length>8?3:1,g=Array(32*d),m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let v,A,b,w=0,E=0;for(let S=0;S<d;S++){let d=e[w++]<<24|e[w++]<<16|e[w++]<<8|e[w++],S=e[w++]<<24|e[w++]<<16|e[w++]<<8|e[w++];b=252645135&(d>>>4^S),S^=b,d^=b<<4,b=65535&(S>>>-16^d),d^=b,S^=b<<-16,b=858993459&(d>>>2^S),S^=b,d^=b<<2,b=65535&(S>>>-16^d),d^=b,S^=b<<-16,b=1431655765&(d>>>1^S),S^=b,d^=b<<1,b=16711935&(S>>>8^d),d^=b,S^=b<<8,b=1431655765&(d>>>1^S),S^=b,d^=b<<1,b=d<<8|S>>>20&240,d=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=b;for(let e=0;e<16;e++)m[e]?(d=d<<2|d>>>26,S=S<<2|S>>>26):(d=d<<1|d>>>27,S=S<<1|S>>>27),d&=-15,S&=-15,v=t[d>>>28]|r[d>>>24&15]|n[d>>>20&15]|i[d>>>16&15]|s[d>>>12&15]|a[d>>>8&15]|o[d>>>4&15],A=c[S>>>28]|u[S>>>24&15]|l[S>>>20&15]|h[S>>>16&15]|f[S>>>12&15]|p[S>>>8&15]|y[S>>>4&15],b=65535&(A>>>16^v),g[E++]=v^b,g[E++]=A^b<<16}return g}function Yl(e){this.key=[];for(let t=0;t<3;t++)this.key.push(new Uint8Array(e.subarray(8*t,8*t+8)));this.encrypt=function(e){return $l(Wl(this.key[2]),$l(Wl(this.key[1]),$l(Wl(this.key[0]),e,!0),!1),!0)}}function Jl(){this.BlockSize=8,this.KeySize=16,this.setKey=function(e){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),e.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(e),!0},this.reset=function(){for(let e=0;e<16;e++)this.masking[e]=0,this.rotate[e]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(e){const t=Array(e.length);for(let s=0;s<e.length;s+=8){let a,o=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3],c=e[s+4]<<24|e[s+5]<<16|e[s+6]<<8|e[s+7];a=c,c=o^r(c,this.masking[0],this.rotate[0]),o=a,a=c,c=o^n(c,this.masking[1],this.rotate[1]),o=a,a=c,c=o^i(c,this.masking[2],this.rotate[2]),o=a,a=c,c=o^r(c,this.masking[3],this.rotate[3]),o=a,a=c,c=o^n(c,this.masking[4],this.rotate[4]),o=a,a=c,c=o^i(c,this.masking[5],this.rotate[5]),o=a,a=c,c=o^r(c,this.masking[6],this.rotate[6]),o=a,a=c,c=o^n(c,this.masking[7],this.rotate[7]),o=a,a=c,c=o^i(c,this.masking[8],this.rotate[8]),o=a,a=c,c=o^r(c,this.masking[9],this.rotate[9]),o=a,a=c,c=o^n(c,this.masking[10],this.rotate[10]),o=a,a=c,c=o^i(c,this.masking[11],this.rotate[11]),o=a,a=c,c=o^r(c,this.masking[12],this.rotate[12]),o=a,a=c,c=o^n(c,this.masking[13],this.rotate[13]),o=a,a=c,c=o^i(c,this.masking[14],this.rotate[14]),o=a,a=c,c=o^r(c,this.masking[15],this.rotate[15]),o=a,t[s]=c>>>24&255,t[s+1]=c>>>16&255,t[s+2]=c>>>8&255,t[s+3]=255&c,t[s+4]=o>>>24&255,t[s+5]=o>>>16&255,t[s+6]=o>>>8&255,t[s+7]=255&o}return t},this.decrypt=function(e){const t=Array(e.length);for(let s=0;s<e.length;s+=8){let a,o=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3],c=e[s+4]<<24|e[s+5]<<16|e[s+6]<<8|e[s+7];a=c,c=o^r(c,this.masking[15],this.rotate[15]),o=a,a=c,c=o^i(c,this.masking[14],this.rotate[14]),o=a,a=c,c=o^n(c,this.masking[13],this.rotate[13]),o=a,a=c,c=o^r(c,this.masking[12],this.rotate[12]),o=a,a=c,c=o^i(c,this.masking[11],this.rotate[11]),o=a,a=c,c=o^n(c,this.masking[10],this.rotate[10]),o=a,a=c,c=o^r(c,this.masking[9],this.rotate[9]),o=a,a=c,c=o^i(c,this.masking[8],this.rotate[8]),o=a,a=c,c=o^n(c,this.masking[7],this.rotate[7]),o=a,a=c,c=o^r(c,this.masking[6],this.rotate[6]),o=a,a=c,c=o^i(c,this.masking[5],this.rotate[5]),o=a,a=c,c=o^n(c,this.masking[4],this.rotate[4]),o=a,a=c,c=o^r(c,this.masking[3],this.rotate[3]),o=a,a=c,c=o^i(c,this.masking[2],this.rotate[2]),o=a,a=c,c=o^n(c,this.masking[1],this.rotate[1]),o=a,a=c,c=o^r(c,this.masking[0],this.rotate[0]),o=a,t[s]=c>>>24&255,t[s+1]=c>>>16&255,t[s+2]=c>>>8&255,t[s+3]=255&c,t[s+4]=o>>>24&255,t[s+5]=o>>16&255,t[s+6]=o>>8&255,t[s+7]=255&o}return t};const e=[,,,,];e[0]=[,,,,],e[0][0]=[4,0,13,15,12,14,8],e[0][1]=[5,2,16,18,17,19,10],e[0][2]=[6,3,23,22,21,20,9],e[0][3]=[7,1,26,25,27,24,11],e[1]=[,,,,],e[1][0]=[0,6,21,23,20,22,16],e[1][1]=[1,4,0,2,1,3,18],e[1][2]=[2,5,7,6,5,4,17],e[1][3]=[3,7,10,9,11,8,19],e[2]=[,,,,],e[2][0]=[4,0,13,15,12,14,8],e[2][1]=[5,2,16,18,17,19,10],e[2][2]=[6,3,23,22,21,20,9],e[2][3]=[7,1,26,25,27,24,11],e[3]=[,,,,],e[3][0]=[0,6,21,23,20,22,16],e[3][1]=[1,4,0,2,1,3,18],e[3][2]=[2,5,7,6,5,4,17],e[3][3]=[3,7,10,9,11,8,19];const t=[,,,,];function r(e,t,r){const n=t+e,i=n<<r|n>>>32-r;return(s[0][i>>>24]^s[1][i>>>16&255])-s[2][i>>>8&255]+s[3][255&i]}function n(e,t,r){const n=t^e,i=n<<r|n>>>32-r;return s[0][i>>>24]-s[1][i>>>16&255]+s[2][i>>>8&255]^s[3][255&i]}function i(e,t,r){const n=t-e,i=n<<r|n>>>32-r;return(s[0][i>>>24]+s[1][i>>>16&255]^s[2][i>>>8&255])-s[3][255&i]}t[0]=[,,,,],t[0][0]=[24,25,23,22,18],t[0][1]=[26,27,21,20,22],t[0][2]=[28,29,19,18,25],t[0][3]=[30,31,17,16,28],t[1]=[,,,,],t[1][0]=[3,2,12,13,8],t[1][1]=[1,0,14,15,13],t[1][2]=[7,6,8,9,3],t[1][3]=[5,4,10,11,7],t[2]=[,,,,],t[2][0]=[19,18,28,29,25],t[2][1]=[17,16,30,31,28],t[2][2]=[23,22,24,25,18],t[2][3]=[21,20,26,27,22],t[3]=[,,,,],t[3][0]=[8,9,7,6,3],t[3][1]=[10,11,5,4,7],t[3][2]=[12,13,3,2,8],t[3][3]=[14,15,1,0,13],this.keySchedule=function(r){const n=[,,,,,,,,],i=Array(32);let a;for(let e=0;e<4;e++)a=4*e,n[e]=r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3];const o=[6,7,4,5];let c,u=0;for(let r=0;r<2;r++)for(let r=0;r<4;r++){for(a=0;a<4;a++){const t=e[r][a];c=n[t[1]],c^=s[4][n[t[2]>>>2]>>>24-8*(3&t[2])&255],c^=s[5][n[t[3]>>>2]>>>24-8*(3&t[3])&255],c^=s[6][n[t[4]>>>2]>>>24-8*(3&t[4])&255],c^=s[7][n[t[5]>>>2]>>>24-8*(3&t[5])&255],c^=s[o[a]][n[t[6]>>>2]>>>24-8*(3&t[6])&255],n[t[0]]=c}for(a=0;a<4;a++){const e=t[r][a];c=s[4][n[e[0]>>>2]>>>24-8*(3&e[0])&255],c^=s[5][n[e[1]>>>2]>>>24-8*(3&e[1])&255],c^=s[6][n[e[2]>>>2]>>>24-8*(3&e[2])&255],c^=s[7][n[e[3]>>>2]>>>24-8*(3&e[3])&255],c^=s[4+a][n[e[4]>>>2]>>>24-8*(3&e[4])&255],i[u]=c,u++}}for(let e=0;e<16;e++)this.masking[e]=i[e],this.rotate[e]=31&i[16+e]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Xl(e){this.cast5=new Jl,this.cast5.setKey(e),this.encrypt=function(e){return this.cast5.encrypt(e)}}Yl.keySize=Yl.prototype.keySize=24,Yl.blockSize=Yl.prototype.blockSize=8,Xl.blockSize=Xl.prototype.blockSize=8,Xl.keySize=Xl.prototype.keySize=16;const Zl=4294967295;function eh(e,t){return(e<<t|e>>>32-t)&Zl}function th(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function rh(e,t,r){e.splice(t,4,255&r,r>>>8&255,r>>>16&255,r>>>24&255)}function nh(e,t){return e>>>8*t&255}function ih(e){this.tf=function(){let e=null,t=null,r=-1,n=[],i=[[],[],[],[]];function s(e){return i[0][nh(e,0)]^i[1][nh(e,1)]^i[2][nh(e,2)]^i[3][nh(e,3)]}function a(e){return i[0][nh(e,3)]^i[1][nh(e,0)]^i[2][nh(e,1)]^i[3][nh(e,2)]}function o(e,t){let r=s(t[0]),i=a(t[1]);t[2]=eh(t[2]^r+i+n[4*e+8]&Zl,31),t[3]=eh(t[3],1)^r+2*i+n[4*e+9]&Zl,r=s(t[2]),i=a(t[3]),t[0]=eh(t[0]^r+i+n[4*e+10]&Zl,31),t[1]=eh(t[1],1)^r+2*i+n[4*e+11]&Zl}function c(e,t){let r=s(t[0]),i=a(t[1]);t[2]=eh(t[2],1)^r+i+n[4*e+10]&Zl,t[3]=eh(t[3]^r+2*i+n[4*e+11]&Zl,31),r=s(t[2]),i=a(t[3]),t[0]=eh(t[0],1)^r+i+n[4*e+8]&Zl,t[1]=eh(t[1]^r+2*i+n[4*e+9]&Zl,31)}return{name:"twofish",blocksize:16,open:function(t){let r,s,a,o,c;e=t;const u=[],l=[],h=[];let f;const p=[];let y,d,g;const m=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],v=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],A=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],b=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],w=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],E=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],S=[[],[]],C=[[],[],[],[]];function B(e){return e^e>>2^[0,90,180,238][3&e]}function I(e){return e^e>>1^e>>2^[0,238,180,90][3&e]}function k(e,t){let r,n,i;for(r=0;r<8;r++)n=t>>>24,t=t<<8&Zl|e>>>24,e=e<<8&Zl,i=n<<1,128&n&&(i^=333),t^=n^i<<16,i^=n>>>1,1&n&&(i^=166),t^=i<<24|i<<8;return t}function T(e,t){const r=t>>4,n=15&t,i=m[e][r^n],s=v[e][w[n]^E[r]];return b[e][w[s]^E[i]]<<4|A[e][i^s]}function N(e,t){let r=nh(e,0),n=nh(e,1),i=nh(e,2),s=nh(e,3);switch(f){case 4:r=S[1][r]^nh(t[3],0),n=S[0][n]^nh(t[3],1),i=S[0][i]^nh(t[3],2),s=S[1][s]^nh(t[3],3);case 3:r=S[1][r]^nh(t[2],0),n=S[1][n]^nh(t[2],1),i=S[0][i]^nh(t[2],2),s=S[0][s]^nh(t[2],3);case 2:r=S[0][S[0][r]^nh(t[1],0)]^nh(t[0],0),n=S[0][S[1][n]^nh(t[1],1)]^nh(t[0],1),i=S[1][S[0][i]^nh(t[1],2)]^nh(t[0],2),s=S[1][S[1][s]^nh(t[1],3)]^nh(t[0],3)}return C[0][r]^C[1][n]^C[2][i]^C[3][s]}for(e=e.slice(0,32),r=e.length;16!==r&&24!==r&&32!==r;)e[r++]=0;for(r=0;r<e.length;r+=4)h[r>>2]=th(e,r);for(r=0;r<256;r++)S[0][r]=T(0,r),S[1][r]=T(1,r);for(r=0;r<256;r++)y=S[1][r],d=B(y),g=I(y),C[0][r]=y+(d<<8)+(g<<16)+(g<<24),C[2][r]=d+(g<<8)+(y<<16)+(g<<24),y=S[0][r],d=B(y),g=I(y),C[1][r]=g+(g<<8)+(d<<16)+(y<<24),C[3][r]=d+(y<<8)+(g<<16)+(d<<24);for(f=h.length/2,r=0;r<f;r++)s=h[r+r],u[r]=s,a=h[r+r+1],l[r]=a,p[f-r-1]=k(s,a);for(r=0;r<40;r+=2)s=16843009*r,a=s+16843009,s=N(s,u),a=eh(N(a,l),8),n[r]=s+a&Zl,n[r+1]=eh(s+2*a,9);for(r=0;r<256;r++)switch(s=a=o=c=r,f){case 4:s=S[1][s]^nh(p[3],0),a=S[0][a]^nh(p[3],1),o=S[0][o]^nh(p[3],2),c=S[1][c]^nh(p[3],3);case 3:s=S[1][s]^nh(p[2],0),a=S[1][a]^nh(p[2],1),o=S[0][o]^nh(p[2],2),c=S[0][c]^nh(p[2],3);case 2:i[0][r]=C[0][S[0][S[0][s]^nh(p[1],0)]^nh(p[0],0)],i[1][r]=C[1][S[0][S[1][a]^nh(p[1],1)]^nh(p[0],1)],i[2][r]=C[2][S[1][S[0][o]^nh(p[1],2)]^nh(p[0],2)],i[3][r]=C[3][S[1][S[1][c]^nh(p[1],3)]^nh(p[0],3)]}},close:function(){n=[],i=[[],[],[],[]]},encrypt:function(e,i){t=e,r=i;const s=[th(t,r)^n[0],th(t,r+4)^n[1],th(t,r+8)^n[2],th(t,r+12)^n[3]];for(let e=0;e<8;e++)o(e,s);return rh(t,r,s[2]^n[4]),rh(t,r+4,s[3]^n[5]),rh(t,r+8,s[0]^n[6]),rh(t,r+12,s[1]^n[7]),r+=16,t},decrypt:function(e,i){t=e,r=i;const s=[th(t,r)^n[4],th(t,r+4)^n[5],th(t,r+8)^n[6],th(t,r+12)^n[7]];for(let e=7;e>=0;e--)c(e,s);rh(t,r,s[2]^n[0]),rh(t,r+4,s[3]^n[1]),rh(t,r+8,s[0]^n[2]),rh(t,r+12,s[1]^n[3]),r+=16},finalize:function(){return t}}}(),this.tf.open(Array.from(e),0),this.encrypt=function(e){return this.tf.encrypt(Array.from(e),0)}}function sh(){}function ah(e){this.bf=new sh,this.bf.init(e),this.encrypt=function(e){return this.bf.encryptBlock(e)}}ih.keySize=ih.prototype.keySize=32,ih.blockSize=ih.prototype.blockSize=16,sh.prototype.BLOCKSIZE=8,sh.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],sh.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],sh.prototype.NN=16,sh.prototype._clean=function(e){return e<0&&(e=2147483648+(2147483647&e)),e},sh.prototype._F=function(e){let t;const r=255&e,n=255&(e>>>=8),i=255&(e>>>=8),s=255&(e>>>=8);return t=this.sboxes[0][s]+this.sboxes[1][i],t^=this.sboxes[2][n],t+=this.sboxes[3][r],t},sh.prototype._encryptBlock=function(e){let t,r=e[0],n=e[1];for(t=0;t<this.NN;++t){r^=this.parray[t],n=this._F(r)^n;const e=r;r=n,n=e}r^=this.parray[this.NN+0],n^=this.parray[this.NN+1],e[0]=this._clean(n),e[1]=this._clean(r)},sh.prototype.encryptBlock=function(e){let t;const r=[0,0],n=this.BLOCKSIZE/2;for(t=0;t<this.BLOCKSIZE/2;++t)r[0]=r[0]<<8|255&e[t+0],r[1]=r[1]<<8|255&e[t+n];this._encryptBlock(r);const i=[];for(t=0;t<this.BLOCKSIZE/2;++t)i[t+0]=r[0]>>>24-8*t&255,i[t+n]=r[1]>>>24-8*t&255;return i},sh.prototype._decryptBlock=function(e){let t,r=e[0],n=e[1];for(t=this.NN+1;t>1;--t){r^=this.parray[t],n=this._F(r)^n;const e=r;r=n,n=e}r^=this.parray[1],n^=this.parray[0],e[0]=this._clean(n),e[1]=this._clean(r)},sh.prototype.init=function(e){let t,r=0;for(this.parray=[],t=0;t<this.NN+2;++t){let n=0;for(let t=0;t<4;++t)n=n<<8|255&e[r],++r>=e.length&&(r=0);this.parray[t]=this.PARRAY[t]^n}for(this.sboxes=[],t=0;t<4;++t)for(this.sboxes[t]=[],r=0;r<256;++r)this.sboxes[t][r]=this.SBOXES[t][r];const n=[0,0];for(t=0;t<this.NN+2;t+=2)this._encryptBlock(n),this.parray[t+0]=n[0],this.parray[t+1]=n[1];for(t=0;t<4;++t)for(r=0;r<256;r+=2)this._encryptBlock(n),this.sboxes[t][r+0]=n[0],this.sboxes[t][r+1]=n[1]},ah.keySize=ah.prototype.keySize=16,ah.blockSize=ah.prototype.blockSize=8;const oh=new Map(Object.entries({tripledes:Yl,cast5:Xl,twofish:ih,blowfish:ah}));var ch=Object.freeze({__proto__:null,legacyCiphers:oh});function uh(e,t,r,n){e[t]+=r[n],e[t+1]+=r[n+1]+(e[t]<r[n])}function lh(e,t){e[0]+=t,e[1]+=e[0]<t}function hh(e,t,r,n,i,s,a,o){uh(e,r,e,n),uh(e,r,t,a);let c=e[s]^e[r],u=e[s+1]^e[r+1];e[s]=u,e[s+1]=c,uh(e,i,e,s),c=e[n]^e[i],u=e[n+1]^e[i+1],e[n]=c>>>24^u<<8,e[n+1]=u>>>24^c<<8,uh(e,r,e,n),uh(e,r,t,o),c=e[s]^e[r],u=e[s+1]^e[r+1],e[s]=c>>>16^u<<16,e[s+1]=u>>>16^c<<16,uh(e,i,e,s),c=e[n]^e[i],u=e[n+1]^e[i+1],e[n]=u>>>31^c<<1,e[n+1]=c>>>31^u<<1}const fh=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ph=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((e=>2*e)));function yh(e,t){const r=new Uint32Array(32),n=new Uint32Array(e.b.buffer,e.b.byteOffset,32);for(let t=0;t<16;t++)r[t]=e.h[t],r[t+16]=fh[t];r[24]^=e.t0[0],r[25]^=e.t0[1];const i=t?4294967295:0;r[28]^=i,r[29]^=i;for(let e=0;e<12;e++){const t=e<<4;hh(r,n,0,8,16,24,ph[t+0],ph[t+1]),hh(r,n,2,10,18,26,ph[t+2],ph[t+3]),hh(r,n,4,12,20,28,ph[t+4],ph[t+5]),hh(r,n,6,14,22,30,ph[t+6],ph[t+7]),hh(r,n,0,10,20,30,ph[t+8],ph[t+9]),hh(r,n,2,12,22,24,ph[t+10],ph[t+11]),hh(r,n,4,14,16,26,ph[t+12],ph[t+13]),hh(r,n,6,8,18,28,ph[t+14],ph[t+15])}for(let t=0;t<16;t++)e.h[t]^=r[t]^r[t+16]}class dh{constructor(e,t,r,n){const i=new Uint8Array(64);this.S={b:new Uint8Array(vh),h:new Uint32Array(mh/4),t0:new Uint32Array(2),c:0,outlen:e},i[0]=e,t&&(i[1]=t.length),i[2]=1,i[3]=1,r&&i.set(r,32),n&&i.set(n,48);const s=new Uint32Array(i.buffer,i.byteOffset,i.length/Uint32Array.BYTES_PER_ELEMENT);for(let e=0;e<16;e++)this.S.h[e]=fh[e]^s[e];if(t){const e=new Uint8Array(vh);e.set(t),this.update(e)}}update(e){if(!(e instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let t=0;for(;t<e.length;){this.S.c===vh&&(lh(this.S.t0,this.S.c),yh(this.S,!1),this.S.c=0);let r=vh-this.S.c;this.S.b.set(e.subarray(t,t+r),this.S.c);const n=Math.min(r,e.length-t);this.S.c+=n,t+=n}return this}digest(e){lh(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=vh,yh(this.S,!0);const t=e||new Uint8Array(this.S.outlen);for(let e=0;e<this.S.outlen;e++)t[e]=this.S.h[e>>2]>>8*(3&e);return this.S.h=null,t.buffer}}function gh(e,t,r,n){if(e>mh)throw Error(`outlen must be at most ${mh} (given: ${e})`);return new dh(e,t,r,n)}const mh=64,vh=128,Ah=1024,bh=205===new Uint8Array(new Uint16Array([43981]).buffer)[0];function wh(e,t,r){return e[r+0]=t,e[r+1]=t>>8,e[r+2]=t>>16,e[r+3]=t>>24,e}function Eh(e,t,r){if(t>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let n=t;for(let t=r;t<r+7;t++)e[t]=n,n=(n-e[t])/256;return e}function Sh(e,t,r){const n=new Uint8Array(64),i=new Uint8Array(4+t.length);if(wh(i,e,0),i.set(t,4),e<=64)return gh(e).update(i).digest(r),r;const s=Math.ceil(e/32)-2;for(let e=0;e<s;e++)gh(64).update(0===e?i:n).digest(n),r.set(n.subarray(0,32),32*e);const a=new Uint8Array(gh(e-32*s).update(n).digest());return r.set(a,32*s),r}function Ch(e,t,r,n){return e.fn.XOR(t.byteOffset,r.byteOffset,n.byteOffset),t}function Bh(e,t,r,n){return e.fn.G(t.byteOffset,r.byteOffset,n.byteOffset,e.refs.gZ.byteOffset),n}function Ih(e,t,r,n){return e.fn.G2(t.byteOffset,r.byteOffset,n.byteOffset,e.refs.gZ.byteOffset),n}function*kh(e,t,r,n,i,s,a,o){e.refs.prngTmp.fill(0);const c=e.refs.prngTmp.subarray(0,48);Eh(c,t,0),Eh(c,r,8),Eh(c,n,16),Eh(c,i,24),Eh(c,s,32),Eh(c,2,40);for(let t=1;t<=a;t++){Eh(e.refs.prngTmp,t,c.length);const r=Ih(e,e.refs.ZERO1024,e.refs.prngTmp,e.refs.prngR);for(let e=1===t?8*o:0;e<r.length;e+=8)yield r.subarray(e,e+8)}return[]}let Th;function Nh(e,t,r,n){var i=null,s=o.atob(r),a=s.length;i=new Uint8Array(new ArrayBuffer(a));for(var c=0;c<a;c++)i[c]=s.charCodeAt(c);return function(e,t){var r=WebAssembly.instantiate,n=WebAssembly.compile;return t?r(e,t):n(e)}(i,n)}var Uh=Object.freeze({__proto__:null,default:async()=>async function(e,t){const r=new WebAssembly.Memory({initial:1040,maximum:65536}),n=await async function(e,t,r){const n={env:{memory:e}};if(void 0===Th)try{const e=await t(n);return Th=!0,e}catch(e){Th=!1}return(Th?t:r)(n)}(r,e,t);return e=>function(e,{memory:t,instance:r}){if(!bh)throw Error("BigEndian system not supported");const n=function({type:e,version:t,tagLength:r,password:n,salt:i,ad:s,secret:a,parallelism:o,memorySize:c,passes:u}){const l=(e,t,r,n)=>{if(t<r||t>n)throw Error(`${e} size should be between ${r} and ${n} bytes`)};if(2!==e||19!==t)throw Error("Unsupported type or version");return l("password",n,8,4294967295),l("salt",i,8,4294967295),l("tag",r,4,4294967295),l("memory",c,8*o,4294967295),s&&l("associated data",s,0,4294967295),a&&l("secret",a,0,32),{type:e,version:t,tagLength:r,password:n,salt:i,ad:s,secret:a,lanes:o,memorySize:c,passes:u}}({type:2,version:19,...e}),{G:i,G2:s,xor:a,getLZ:o}=r.exports,c={},u={};u.G=i,u.G2=s,u.XOR=a;const l=4*n.lanes*Math.floor(n.memorySize/(4*n.lanes)),h=l*Ah+10240;if(t.buffer.byteLength<h){const e=Math.ceil((h-t.buffer.byteLength)/65536);t.grow(e)}let f=0;c.gZ=new Uint8Array(t.buffer,f,Ah),f+=c.gZ.length,c.prngR=new Uint8Array(t.buffer,f,Ah),f+=c.prngR.length,c.prngTmp=new Uint8Array(t.buffer,f,Ah),f+=c.prngTmp.length,c.ZERO1024=new Uint8Array(t.buffer,f,1024),f+=c.ZERO1024.length;const p=new Uint32Array(t.buffer,f,2);f+=p.length*Uint32Array.BYTES_PER_ELEMENT;const y={fn:u,refs:c},d=new Uint8Array(t.buffer,f,Ah);f+=d.length;const g=new Uint8Array(t.buffer,f,n.memorySize*Ah),m=new Uint8Array(t.buffer,0,f),v=function(e){const t=gh(64),r=new Uint8Array(4),n=new Uint8Array(24);wh(n,e.lanes,0),wh(n,e.tagLength,4),wh(n,e.memorySize,8),wh(n,e.passes,12),wh(n,e.version,16),wh(n,e.type,20);const i=[n];e.password?(i.push(wh(new Uint8Array(4),e.password.length,0)),i.push(e.password)):i.push(r),e.salt?(i.push(wh(new Uint8Array(4),e.salt.length,0)),i.push(e.salt)):i.push(r),e.secret?(i.push(wh(new Uint8Array(4),e.secret.length,0)),i.push(e.secret)):i.push(r),e.ad?(i.push(wh(new Uint8Array(4),e.ad.length,0)),i.push(e.ad)):i.push(r),t.update(function(e){if(1===e.length)return e[0];let t=0;for(let r=0;r<e.length;r++){if(!(e[r]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");t+=e[r].length}const r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.length})),r}(i));const s=t.digest();return new Uint8Array(s)}(n),A=l/n.lanes,b=Array(n.lanes).fill(null).map((()=>Array(A))),w=(e,t)=>(b[e][t]=g.subarray(e*A*1024+1024*t,e*A*1024+1024*t+Ah),b[e][t]);for(let e=0;e<n.lanes;e++){const t=new Uint8Array(v.length+8);t.set(v),wh(t,0,v.length),wh(t,e,v.length+4),Sh(Ah,t,w(e,0)),wh(t,1,v.length),Sh(Ah,t,w(e,1))}const E=A/4;for(let e=0;e<n.passes;e++)for(let t=0;t<4;t++){const r=0===e&&t<=1;for(let i=0;i<n.lanes;i++){let s=0===t&&0===e?2:0;const a=r?kh(y,e,i,t,l,n.passes,E,s):null;for(;s<E;s++){const c=t*E+s,u=c>0?b[i][c-1]:b[i][A-1],l=r?a.next().value:u;o(p.byteOffset,l.byteOffset,i,n.lanes,e,t,s,4,E);const h=p[0],f=p[1];0===e&&w(i,c),Bh(y,u,b[h][f],e>0?d:b[i][c]),e>0&&Ch(y,b[i][c],d,b[i][c])}}}const S=b[0][A-1];for(let e=1;e<n.lanes;e++)Ch(y,S,S,b[e][A-1]);const C=Sh(n.tagLength,S,new Uint8Array(n.tagLength));return m.fill(0),t.grow(0),C}(e,{instance:n.instance,memory:r})}((e=>Nh(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",e)),(e=>Nh(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",e)))}),xh=[0,1,3,7,15,31,63,127,255],Dh=function(e){this.stream=e,this.bitOffset=0,this.curByte=0,this.hasByte=!1};Dh.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},Dh.prototype.read=function(e){for(var t=0;e>0;){this._ensureByte();var r=8-this.bitOffset;if(e>=r)t<<=r,t|=xh[r]&this.curByte,this.hasByte=!1,this.bitOffset=0,e-=r;else{t<<=e;var n=r-e;t|=(this.curByte&xh[e]<<n)>>n,this.bitOffset+=e,e=0}}return t},Dh.prototype.seek=function(e){var t=e%8,r=(e-t)/8;this.bitOffset=t,this.stream.seek(r),this.hasByte=!1},Dh.prototype.pi=function(){var e,t=new Uint8Array(6);for(e=0;e<t.length;e++)t[e]=this.read(8);return function(e){return Array.prototype.map.call(e,(e=>("00"+e.toString(16)).slice(-2))).join("")}(t)};var Rh=Dh,Ph=function(){};Ph.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},Ph.prototype.read=function(e,t,r){for(var n=0;n<r;){var i=this.readByte();if(i<0)return 0===n?-1:n;e[t++]=i,n++}return n},Ph.prototype.seek=function(e){throw Error("abstract method seek() not implemented")},Ph.prototype.writeByte=function(e){throw Error("abstract method readByte() not implemented")},Ph.prototype.write=function(e,t,r){var n;for(n=0;n<r;n++)this.writeByte(e[t++]);return r},Ph.prototype.flush=function(){};var Lh,_h=Ph,Kh=(Lh=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var e=4294967295;this.getCRC=function(){return~e>>>0},this.updateCRC=function(t){e=e<<8^Lh[255&(e>>>24^t)]},this.updateCRCRun=function(t,r){for(;r-- >0;)e=e<<8^Lh[255&(e>>>24^t)]}}),Oh=Rh,Mh=_h,Hh=Kh,Vh=function(e,t){var r,n=e[t];for(r=t;r>0;r--)e[r]=e[r-1];return e[0]=n,n},Fh={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},jh={};jh[Fh.LAST_BLOCK]="Bad file checksum",jh[Fh.NOT_BZIP_DATA]="Not bzip data",jh[Fh.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",jh[Fh.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",jh[Fh.DATA_ERROR]="Data error",jh[Fh.OUT_OF_MEMORY]="Out of memory",jh[Fh.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var Qh=function(e,t){var r=jh[e]||"unknown error";t&&(r+=": "+t);var n=new TypeError(r);throw n.errorCode=e,n},qh=function(e,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(e,t)};qh.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new Hh,!0):(this.writeCount=-1,!1)},qh.prototype._start_bunzip=function(e,t){var r=new Uint8Array(4);4===e.read(r,0,4)&&"BZh"===String.fromCharCode(r[0],r[1],r[2])||Qh(Fh.NOT_BZIP_DATA,"bad magic");var n=r[3]-48;(n<1||n>9)&&Qh(Fh.NOT_BZIP_DATA,"level out of range"),this.reader=new Oh(e),this.dbufSize=1e5*n,this.nextoutput=0,this.outputStream=t,this.streamCRC=0},qh.prototype._get_next_block=function(){var e,t,r,n=this.reader,i=n.pi();if("177245385090"===i)return!1;"314159265359"!==i&&Qh(Fh.NOT_BZIP_DATA),this.targetBlockCRC=n.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,n.read(1)&&Qh(Fh.OBSOLETE_INPUT);var s=n.read(24);s>this.dbufSize&&Qh(Fh.DATA_ERROR,"initial position out of bounds");var a=n.read(16),o=new Uint8Array(256),c=0;for(e=0;e<16;e++)if(a&1<<15-e){var u=16*e;for(r=n.read(16),t=0;t<16;t++)r&1<<15-t&&(o[c++]=u+t)}var l=n.read(3);(l<2||l>6)&&Qh(Fh.DATA_ERROR);var h=n.read(15);0===h&&Qh(Fh.DATA_ERROR);var f=new Uint8Array(256);for(e=0;e<l;e++)f[e]=e;var p=new Uint8Array(h);for(e=0;e<h;e++){for(t=0;n.read(1);t++)t>=l&&Qh(Fh.DATA_ERROR);p[e]=Vh(f,t)}var y,d=c+2,g=[];for(t=0;t<l;t++){var m,v,A=new Uint8Array(d),b=new Uint16Array(21);for(a=n.read(5),e=0;e<d;e++){for(;(a<1||a>20)&&Qh(Fh.DATA_ERROR),n.read(1);)n.read(1)?a--:a++;A[e]=a}for(m=v=A[0],e=1;e<d;e++)A[e]>v?v=A[e]:A[e]<m&&(m=A[e]);y={},g.push(y),y.permute=new Uint16Array(258),y.limit=new Uint32Array(22),y.base=new Uint32Array(21),y.minLen=m,y.maxLen=v;var w=0;for(e=m;e<=v;e++)for(b[e]=y.limit[e]=0,a=0;a<d;a++)A[a]===e&&(y.permute[w++]=a);for(e=0;e<d;e++)b[A[e]]++;for(w=a=0,e=m;e<v;e++)w+=b[e],y.limit[e]=w-1,w<<=1,a+=b[e],y.base[e+1]=w-a;y.limit[v+1]=Number.MAX_VALUE,y.limit[v]=w+b[v]-1,y.base[m]=0}var E=new Uint32Array(256);for(e=0;e<256;e++)f[e]=e;var S,C=0,B=0,I=0,k=this.dbuf=new Uint32Array(this.dbufSize);for(d=0;;){for(d--||(d=49,I>=h&&Qh(Fh.DATA_ERROR),y=g[p[I++]]),e=y.minLen,t=n.read(e);e>y.maxLen&&Qh(Fh.DATA_ERROR),!(t<=y.limit[e]);e++)t=t<<1|n.read(1);((t-=y.base[e])<0||t>=258)&&Qh(Fh.DATA_ERROR);var T=y.permute[t];if(0!==T&&1!==T){if(C)for(C=0,B+a>this.dbufSize&&Qh(Fh.DATA_ERROR),E[S=o[f[0]]]+=a;a--;)k[B++]=S;if(T>c)break;B>=this.dbufSize&&Qh(Fh.DATA_ERROR),E[S=o[S=Vh(f,e=T-1)]]++,k[B++]=S}else C||(C=1,a=0),a+=0===T?C:2*C,C<<=1}for((s<0||s>=B)&&Qh(Fh.DATA_ERROR),t=0,e=0;e<256;e++)r=t+E[e],E[e]=t,t=r;for(e=0;e<B;e++)k[E[S=255&k[e]]]|=e<<8,E[S]++;var N=0,U=0,x=0;return B&&(U=255&(N=k[s]),N>>=8,x=-1),this.writePos=N,this.writeCurrent=U,this.writeCount=B,this.writeRun=x,!0},qh.prototype._read_bunzip=function(e,t){var r,n,i;if(this.writeCount<0)return 0;var s=this.dbuf,a=this.writePos,o=this.writeCurrent,c=this.writeCount;this.outputsize;for(var u=this.writeRun;c;){for(c--,n=o,o=255&(a=s[a]),a>>=8,3==u++?(r=o,i=n,o=-1):(r=1,i=o),this.blockCRC.updateCRCRun(i,r);r--;)this.outputStream.writeByte(i),this.nextoutput++;o!=n&&(u=0)}return this.writeCount=c,this.blockCRC.getCRC()!==this.targetBlockCRC&&Qh(Fh.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var zh=function(e){if("readByte"in e)return e;var t=new Mh;return t.pos=0,t.readByte=function(){return e[this.pos++]},t.seek=function(e){this.pos=e},t.eof=function(){return this.pos>=e.length},t},Gh=function(e){var t=new Mh,r=!0;if(e)if("number"==typeof e)t.buffer=new Uint8Array(e),r=!1;else{if("writeByte"in e)return e;t.buffer=e,r=!1}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(e){if(r&&this.pos>=this.buffer.length){var t=new Uint8Array(2*this.buffer.length);t.set(this.buffer),this.buffer=t}this.buffer[this.pos++]=e},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!r)throw new TypeError("outputsize does not match decoded input");var e=new Uint8Array(this.pos);e.set(this.buffer.subarray(0,this.pos)),this.buffer=e}return this.buffer},t._coerced=!0,t},$h={Bunzip:qh,Stream:Mh,Err:Fh,decode:function(e,t,r){for(var n=zh(e),i=Gh(t),s=new qh(n,i);!("eof"in n)||!n.eof();)if(s._init_block())s._read_bunzip();else{var a=s.reader.read(32)>>>0;if(a!==s.streamCRC&&Qh(Fh.DATA_ERROR,"Bad stream CRC (got "+s.streamCRC.toString(16)+" expected "+a.toString(16)+")"),!r||!("eof"in n)||n.eof())break;s._start_bunzip(n,i)}if("getBuffer"in i)return i.getBuffer()},decodeBlock:function(e,t,r){var n=zh(e),i=Gh(r),s=new qh(n,i);if(s.reader.seek(t),s._get_next_block()&&(s.blockCRC=new Hh,s.writeCopies=0,s._read_bunzip()),"getBuffer"in i)return i.getBuffer()},table:function(e,t,r){var n=new Mh;n.delegate=zh(e),n.pos=0,n.readByte=function(){return this.pos++,this.delegate.readByte()},n.delegate.eof&&(n.eof=n.delegate.eof.bind(n.delegate));var i=new Mh;i.pos=0,i.writeByte=function(){this.pos++};for(var s=new qh(n,i),a=s.dbufSize;!("eof"in n)||!n.eof();){var o=8*n.pos+s.reader.bitOffset;if(s.reader.hasByte&&(o-=8),s._init_block()){var c=i.pos;s._read_bunzip(),t(o,i.pos-c)}else{if(s.reader.read(32),!r||!("eof"in n)||n.eof())break;s._start_bunzip(n,i),console.assert(s.dbufSize===a,"shouldn't change block size within multistream file")}}}},Wh=c({__proto__:null},[$h]);const Yh="pgpPublicKey";async function Jh(e){try{console.log("Detected PGP public key format");try{const t=await async function({armoredKey:e,binaryKey:t,config:r,...n}){if(r={...F,...r},!e&&!t)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(e&&!Q.isString(e))throw Error("readKey: options.armoredKey must be a string");if(t&&!Q.isUint8Array(t))throw Error("readKey: options.binaryKey must be a Uint8Array");const i=Object.keys(n);if(i.length>0)throw Error("Unknown option: "+i.join(", "));let s;if(e){const{type:t,data:r}=await se(e);if(t!==V.armor.publicKey&&t!==V.armor.privateKey)throw Error("Armored text not of type key");s=r}else s=t;const a=await ga.fromBinary(s,io,r),o=a.indexOfTag(V.packet.publicKey,V.packet.secretKey);if(0===o.length)throw Error("No key packet found");return function(e){for(const t of e)switch(t.constructor.tag){case V.packet.secretKey:return new no(e);case V.packet.publicKey:return new ro(e)}throw Error("No key packet found")}(a.slice(o[0],o[1]))}({armoredKey:e});return console.log("Successfully parsed PGP public key"),{key:t,format:Yh}}catch(e){throw console.error("Failed to process PGP public key with OpenPGP.js:",e),new Error("Failed to process PGP public key: "+e.message)}}catch(e){throw console.error("Failed to parse PGP public key:",e),new Error("Failed to parse PGP public key: "+e.message)}}function Xh(e){try{return console.log("Detected RSA public key format"),{key:t.pki.publicKeyFromPem(e),format:"rsaPublicKey"}}catch(e){throw console.error("Failed to parse RSA public key:",e),new Error("Failed to parse RSA public key: "+e.message)}}__webpack_require__(8630);var Zh=__webpack_require__(152);function ef(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function tf(e,t,r=-1){const n=r;let i=e,s=0,a=Math.pow(2,t);for(let r=1;r<8;r++){if(e<a){let e;if(n<0)e=new ArrayBuffer(r),s=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),s=n}const a=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);a[s-e-1]=Math.floor(i/r),i-=a[s-e-1]*r}return e}a*=Math.pow(2,t)}return new ArrayBuffer(0)}function rf(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i}function nf(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&!(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=ef(r,8),i=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)s[t]=e[t];return s[0]&=127,ef(s,8)-n}function sf(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)}function af(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function of(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;const n=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function cf(e,t,r,n){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0&&(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1)):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}Math.log(2);class uf{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return of(this.items)}}const lf=[new Uint8Array([1])],hf="0123456789",ff="name",pf="valueHexView",yf="isHexOnly",df="idBlock",gf="tagClass",mf="tagNumber",vf="isConstructed",Af="fromBER",bf="toBER",wf="local",Ef="",Sf=new ArrayBuffer(0),Cf=new Uint8Array(0),Bf="EndOfContent",If="OCTET STRING",kf="BIT STRING";function Tf(e){var t;return(t=class extends e{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?Zh._H.toUint8Array(r.valueHex):Cf}fromBER(e,t,r){const n=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!cf(this,n,t,r))return-1;const i=t+r;return this.valueHexView=n.subarray(t,i),this.valueHexView.length?(this.blockLength=r,i):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Sf)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:Zh.U$.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class Nf{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t=Ef,warnings:r=[],valueBeforeDecode:n=Cf}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=Zh._H.toUint8Array(n)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:Zh.U$.ToHex(this.valueBeforeDecodeView)}}}Nf.NAME="baseBlock";class Uf extends Nf{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}Uf.NAME="valueBlock";class xf extends(Tf(Nf)){constructor({idBlock:e={}}={}){var t,r,n,i;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?Zh._H.toUint8Array(e.valueHex):Cf,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(n=e.tagNumber)&&void 0!==n?n:-1,this.isConstructed=null!==(i=e.isConstructed)&&void 0!==i&&i):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Sf}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){const r=tf(this.tagNumber,7),n=new Uint8Array(r),i=r.byteLength,s=new Uint8Array(i+1);if(s[0]=31|t,!e){for(let e=0;e<i-1;e++)s[e+1]=128|n[e];s[i]=n[i-1]}return s.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){const n=Zh._H.toUint8Array(e);if(!cf(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;switch(192&i[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=!(32&~i[0]),this.isHexOnly=!1;const s=31&i[0];if(31!==s)this.tagNumber=s,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&i[e];){if(t[e-1]=127&i[e],e++,e>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;const e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&i[e];const n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t[r];t=this.valueHexView=new Uint8Array(e),t.set(n),this.blockLength<=9?this.tagNumber=ef(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}xf.NAME="identificationBlock";class Df extends Nf{constructor({lenBlock:e={}}={}){var t,r,n;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(n=e.length)&&void 0!==n?n:0}fromBER(e,t,r){const n=Zh._H.toUint8Array(e);if(!cf(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;if(255===i[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===i[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&i[0]),!1===this.longFormUsed)return this.length=i[0],this.blockLength=1,t+this.blockLength;const s=127&i[0];if(s>8)return this.error="Too big integer",-1;if(s+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const a=t+1,o=n.subarray(a,a+s);return 0===o[s-1]&&this.warnings.push("Needlessly long encoded length"),this.length=ef(o,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=s+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const n=tf(this.length,8);if(n.byteLength>127)return this.error="Too big length",Sf;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}Df.NAME="lengthBlock";const Rf={};class Pf extends Nf{constructor({name:e=Ef,optional:t=!1,primitiveSchema:r,...n}={},i){super(n),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new xf(n),this.lenBlock=new Df(n),this.valueBlock=i?new i(n):new Uf(n)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const r=t||new uf;t||Lf(this);const n=this.idBlock.toBER(e);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const n=this.lenBlock.toBER(e);r.write(n),r.write(t)}return t?Sf:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():Zh.U$.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${Zh.U$.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){return this===e||e instanceof this.constructor&&function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}(this.toBER(),e.toBER())}}function Lf(e){var t;if(e instanceof Rf.Constructed)for(const t of e.valueBlock.value)Lf(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!(null===(t=e.lenBlock)||void 0===t?void 0:t.isIndefiniteForm)}Pf.NAME="BaseBlock";class _f extends Pf{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e=Ef,...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}_f.NAME="BaseStringBlock";class Kf extends(Tf(Uf)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}var Of,Mf,Hf,Vf,Ff,jf,Qf,qf,zf,Gf,$f,Wf,Yf,Jf,Xf,Zf,ep,tp,rp,np,ip,sp,ap,op,cp,up,lp,hp,fp,pp,yp,dp,gp,mp,vp,Ap;Kf.NAME="PrimitiveValueBlock";class bp extends Pf{constructor(e={}){super(e,Kf),this.idBlock.isConstructed=!1}}function wp(e,t=0,r=e.length){const n=t;let i=new Pf({},Uf);const s=new Nf;if(!cf(s,e,t,r))return i.error=s.error,{offset:-1,result:i};if(!e.subarray(t,t+r).length)return i.error="Zero buffer length",{offset:-1,result:i};let a=i.idBlock.fromBER(e,t,r);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===a)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=a,r-=i.idBlock.blockLength,a=i.lenBlock.fromBER(e,t,r),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===a)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=a,r-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let o=Pf;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};o=Rf.EndOfContent;break;case 1:o=Rf.Boolean;break;case 2:o=Rf.Integer;break;case 3:o=Rf.BitString;break;case 4:o=Rf.OctetString;break;case 5:o=Rf.Null;break;case 6:o=Rf.ObjectIdentifier;break;case 10:o=Rf.Enumerated;break;case 12:o=Rf.Utf8String;break;case 13:o=Rf.RelativeObjectIdentifier;break;case 14:o=Rf.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:o=Rf.Sequence;break;case 17:o=Rf.Set;break;case 18:o=Rf.NumericString;break;case 19:o=Rf.PrintableString;break;case 20:o=Rf.TeletexString;break;case 21:o=Rf.VideotexString;break;case 22:o=Rf.IA5String;break;case 23:o=Rf.UTCTime;break;case 24:o=Rf.GeneralizedTime;break;case 25:o=Rf.GraphicString;break;case 26:o=Rf.VisibleString;break;case 27:o=Rf.GeneralString;break;case 28:o=Rf.UniversalString;break;case 29:o=Rf.CharacterString;break;case 30:o=Rf.BmpString;break;case 31:o=Rf.DATE;break;case 32:o=Rf.TimeOfDay;break;case 33:o=Rf.DateTime;break;case 34:o=Rf.Duration;break;default:{const e=i.idBlock.isConstructed?new Rf.Constructed:new Rf.Primitive;e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else o=i.idBlock.isConstructed?Rf.Constructed:Rf.Primitive;return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(i,o),a=i.fromBER(e,t,i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecodeView=e.subarray(n,n+i.blockLength),{offset:a,result:i}}function Ep(e){if(!e.byteLength){const e=new Pf({},Uf);return e.error="Input buffer has zero length",{offset:-1,result:e}}return wp(Zh._H.toUint8Array(e).slice(),0,e.byteLength)}Of=bp,Rf.Primitive=Of,bp.NAME="PRIMITIVE";class Sp extends Uf{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const n=Zh._H.toUint8Array(e);if(!cf(this,n,t,r))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let i=t;for(;(this.isIndefiniteForm?1:r)>0;){const e=wp(n,i,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(i=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===Bf)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Bf?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,t){const r=t||new uf;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?Sf:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}Sp.NAME="ConstructedValueBlock";class Cp extends Pf{constructor(e={}){super(e,Sp),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}Mf=Cp,Rf.Constructed=Mf,Cp.NAME="CONSTRUCTED";class Bp extends Uf{fromBER(e,t,r){return t}toBER(e){return Sf}}Bp.override="EndOfContentValueBlock";class Ip extends Pf{constructor(e={}){super(e,Bp),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Hf=Ip,Rf.EndOfContent=Hf,Ip.NAME=Bf;class kp extends Pf{constructor(e={}){super(e,Uf),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}Vf=kp,Rf.Null=Vf,kp.NAME="NULL";class Tp extends(Tf(Uf)){get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=Zh._H.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){const n=Zh._H.toUint8Array(e);return cf(this,n,t,r)?(this.valueHexView=n.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,nf.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}Tp.NAME="BooleanValueBlock";class Np extends Pf{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,Tp),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Ff=Np,Rf.Boolean=Ff,Np.NAME="BOOLEAN";class Up extends(Tf(Sp)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=Sp.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===Bf){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==If)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e,t){return this.isConstructed?Sp.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}Up.NAME="OctetStringValueBlock";class xp extends Pf{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Up),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(n.byteLength){const e=wp(n,0,n.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Cp.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${Zh.U$.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof jf&&e.push(t.valueBlock.valueHexView);return Zh._H.concat(e)}}jf=xp,Rf.OctetString=jf,xp.NAME=If;class Dp extends(Tf(Sp)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let n=-1;if(this.isConstructed){if(n=Sp.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(const e of this.value){const t=e.constructor.NAME;if(t===Bf){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==kf)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return n}const i=Zh._H.toUint8Array(e);if(!cf(this,i,t,r))return-1;const s=i.subarray(t,t+r);if(this.unusedBits=s[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=s.subarray(1);try{if(e.byteLength){const t=wp(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch{}}return this.valueHexView=s.subarray(1),this.blockLength=s.length,t+r}toBER(e,t){if(this.isConstructed)return Sp.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Sf;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Dp.NAME="BitStringValueBlock";class Rp extends Pf{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Dp),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Cp.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}function Pp(e,t){const r=new Uint8Array([0]),n=new Uint8Array(e),i=new Uint8Array(t);let s=n.slice(0);const a=s.length-1,o=i.slice(0),c=o.length-1;let u=0,l=0;for(let e=c<a?a:c;e>=0;e--,l++)u=1==l<o.length?s[a-l]+o[c-l]+r[0]:s[a-l]+r[0],r[0]=u/10,1==l>=s.length?s=rf(new Uint8Array([u%10]),s):s[a-l]=u%10;return r[0]>0&&(s=rf(r,s)),s}function Lp(e){if(e>=lf.length)for(let t=lf.length;t<=e;t++){const e=new Uint8Array([0]);let r=lf[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=rf(e,r)),lf.push(r)}return lf[e]}function _p(e,t){let r=0;const n=new Uint8Array(e),i=new Uint8Array(t),s=n.slice(0),a=s.length-1,o=i.slice(0),c=o.length-1;let u,l=0;for(let e=c;e>=0;e--,l++)u=s[a-l]-o[c-l]-r,1==u<0?(r=1,s[a-l]=u+10):(r=0,s[a-l]=u);if(r>0)for(let e=a-c+1;e>=0;e--,l++){if(u=s[a-l]-r,!(u<0)){r=0,s[a-l]=u;break}r=1,s[a-l]=u+10}return s.slice()}Qf=Rp,Rf.BitString=Qf,Rp.NAME=kf;class Kp extends(Tf(Uf)){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=nf.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=tf(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=tf(t,8,n),s=new Uint8Array(i);if(128&s[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),s=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)s[r+1]=t[r];s[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const s=this.valueHexView;return 0===s[0]&&128&s[1]?this.valueHexView=s.subarray(1):0!==n&&s.length<n&&(n-s.length>1&&(n=s.length+1),this.valueHexView=s.subarray(n-s.length)),i}toDER(e=!1){const t=this.valueHexView;switch(!0){case!!(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&!(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,r=new Uint8Array(8*this.valueHexView.length/3),n=0;const i=this.valueHexView;let s="",a=!1;for(let a=i.byteLength-1;a>=0;a--){t=i[a];for(let i=0;i<8;i++)1&~t||(n===e?(r=_p(Lp(n),r),s="-"):r=Pp(r,Lp(n))),n++,t>>=1}for(let e=0;e<r.length;e++)r[e]&&(a=!0),a&&(s+=hf.charAt(r[e]));return!1===a&&(s+=hf.charAt(0)),s}}qf=Kp,Kp.NAME="IntegerValueBlock",Object.defineProperty(qf.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Op extends Pf{constructor(e={}){super(e,Kp),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return af(),BigInt(this.valueBlock.toString())}static fromBigInt(e){af();const t=BigInt(e),r=new uf,n=t.toString(16).replace(/^-/,""),i=new Uint8Array(Zh.U$.FromHex(n));if(t<0){const e=new Uint8Array(i.length+(128&i[0]?1:0));e[0]|=128;const n=BigInt(`0x${Zh.U$.ToHex(e)}`)+t,s=Zh._H.toUint8Array(Zh.U$.FromHex(n.toString(16)));s[0]|=128,r.write(s)}else 128&i[0]&&r.write(new Uint8Array([0])),r.write(i);return new zf({valueHex:r.final()})}convertToDER(){const e=new zf({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new zf({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}zf=Op,Rf.Integer=zf,Op.NAME="INTEGER";class Mp extends Op{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Gf=Mp,Rf.Enumerated=Gf,Mp.NAME="ENUMERATED";class Hp extends(Tf(Uf)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const n=Zh._H.toUint8Array(e);if(!cf(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,128&i[e]);e++);const s=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)s[e]=this.valueHexView[e];return this.valueHexView=s,128&i[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=ef(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){af();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=tf(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Sf;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r}toString(){let e="";if(this.isHexOnly)e=Zh.U$.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Hp.NAME="sidBlock";class Vp extends Uf{constructor({value:e=Ef,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new Hp;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,Sf;t.push(n)}return of(t)}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const r=parseInt(n,10);if(isNaN(r))return;e.valueDec=r+t,i=!1}else{const e=new Hp;if(n>Number.MAX_SAFE_INTEGER){af();const t=BigInt(n);e.valueBigInt=t}else if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Vp.NAME="ObjectIdentifierValueBlock";class Fp extends Pf{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,Vp),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}$f=Fp,Rf.ObjectIdentifier=$f,Fp.NAME="OBJECT IDENTIFIER";class jp extends(Tf(Nf)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const n=Zh._H.toUint8Array(e);if(!cf(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,128&i[e]);e++);const s=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)s[e]=this.valueHexView[e];return this.valueHexView=s,128&i[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=ef(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=tf(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Sf;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r.buffer}toString(){let e="";return e=this.isHexOnly?Zh.U$.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}jp.NAME="relativeSidBlock";class Qp extends Uf{constructor({value:e=Ef,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new jp;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e,t){const r=[];for(let t=0;t<this.value.length;t++){const n=this.value[t].toBER(e);if(0===n.byteLength)return this.error=this.value[t].error,Sf;r.push(n)}return of(r)}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1;const i=new jp;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Qp.NAME="RelativeObjectIdentifierValueBlock";class qp extends Pf{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,Qp),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Wf=qp,Rf.RelativeObjectIdentifier=Wf,qp.NAME="RelativeObjectIdentifier";class zp extends Cp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Yf=zp,Rf.Sequence=Yf,zp.NAME="SEQUENCE";class Gp extends Cp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}Jf=Gp,Rf.Set=Jf,Gp.NAME="SET";class $p extends(Tf(Uf)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=Ef}toJSON(){return{...super.toJSON(),value:this.value}}}$p.NAME="StringValueBlock";class Wp extends $p{}Wp.NAME="SimpleStringValueBlock";class Yp extends _f{constructor({...e}={}){super(e,Wp)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,Zh._H.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}Yp.NAME="SIMPLE STRING";class Jp extends Yp{fromBuffer(e){this.valueBlock.valueHexView=Zh._H.toUint8Array(e);try{this.valueBlock.value=Zh.U$.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=Zh.U$.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(Zh.U$.FromUtf8String(e)),this.valueBlock.value=e}}Jp.NAME="Utf8StringValueBlock";class Xp extends Jp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Xf=Xp,Rf.Utf8String=Xf,Xp.NAME="UTF8String";class Zp extends Yp{fromBuffer(e){this.valueBlock.value=Zh.U$.ToUtf16String(e),this.valueBlock.valueHexView=Zh._H.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(Zh.U$.FromUtf16String(e))}}Zp.NAME="BmpStringValueBlock";class ey extends Zp{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Zf=ey,Rf.BmpString=Zf,ey.NAME="BMPString";class ty extends Yp{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let n=0;n<t;n++){const t=tf(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const s=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+s]=i[e]}this.valueBlock.value=e}}ty.NAME="UniversalStringValueBlock";class ry extends ty{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}ep=ry,Rf.UniversalString=ep,ry.NAME="UniversalString";class ny extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}tp=ny,Rf.NumericString=tp,ny.NAME="NumericString";class iy extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}rp=iy,Rf.PrintableString=rp,iy.NAME="PrintableString";class sy extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}np=sy,Rf.TeletexString=np,sy.NAME="TeletexString";class ay extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}ip=ay,Rf.VideotexString=ip,ay.NAME="VideotexString";class oy extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}sp=oy,Rf.IA5String=sp,oy.NAME="IA5String";class cy extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}ap=cy,Rf.GraphicString=ap,cy.NAME="GraphicString";class uy extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}op=uy,Rf.VisibleString=op,uy.NAME="VisibleString";class ly extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}cp=ly,Rf.GeneralString=cp,ly.NAME="GeneralString";class hy extends Yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}up=hy,Rf.CharacterString=up,hy.NAME="CharacterString";class fy extends uy{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,Zh._H.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){const e=new Array(7);return e[0]=sf(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=sf(this.month,2),e[2]=sf(this.day,2),e[3]=sf(this.hour,2),e[4]=sf(this.minute,2),e[5]=sf(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}lp=fy,Rf.UTCTime=lp,fy.NAME="UTCTime";class py extends fy{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){const e=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond);return new Date(e)}fromString(e){let t,r=!1,n="",i="",s=0,a=0,o=0;if("Z"===e[e.length-1])n=e.substring(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substring(t+1),n=n.substring(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let i=parseInt(r.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(a=e*i,4===r.length){if(i=parseInt(r.substring(2,4),10),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");o=e*i}}}let c=n.indexOf(".");if(-1===c&&(c=n.indexOf(",")),-1!==c){const e=new Number(`0${n.substring(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");s=e.valueOf(),i=n.substring(0,c)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const u=t.exec(i);if(null===u)throw new Error("Wrong input string for conversion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+a;break;case 5:this.minute=parseInt(u[e],10)+o;break;case 6:this.second=parseInt(u[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){const e=[];return e.push(sf(this.year,4)),e.push(sf(this.month,2)),e.push(sf(this.day,2)),e.push(sf(this.hour,2)),e.push(sf(this.minute,2)),e.push(sf(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(sf(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}hp=py,Rf.GeneralizedTime=hp,py.NAME="GeneralizedTime";class yy extends Xp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}fp=yy,Rf.DATE=fp,yy.NAME="DATE";class dy extends Xp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}pp=dy,Rf.TimeOfDay=pp,dy.NAME="TimeOfDay";class gy extends Xp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}yp=gy,Rf.DateTime=yp,gy.NAME="DateTime";class my extends Xp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}dp=my,Rf.Duration=dp,my.NAME="Duration";class vy extends Xp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}gp=vy,Rf.TIME=gp,vy.NAME="TIME";class Ay{constructor({name:e=Ef,optional:t=!1}={}){this.name=e,this.optional=t}}class by extends Ay{constructor({value:e=[],...t}={}){super(t),this.value=e}}class wy extends Ay{constructor({value:e=new Ay,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class Ey{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=Zh._H.toUint8Array(e)}constructor({data:e=Cf}={}){this.dataView=Zh._H.toUint8Array(e)}fromBER(e,t,r){const n=t+r;return this.dataView=Zh._H.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}}function Sy(e,t,r){if(r instanceof by){for(const n of r.value)if(Sy(e,t,n).verified)return{verified:!0,result:e};{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(ff)&&(e.name=r.name),e}}if(r instanceof Ay)return r.hasOwnProperty(ff)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==0)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(df in r==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(Af in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(bf in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty(gf))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(mf))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(vf))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!(yf in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(pf in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.valueHexView,i=t.idBlock.valueHexView;if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ef),r.name&&(e[r.name]=t)),r instanceof Rf.Constructed){let n=0,i={verified:!1,result:{error:"Unknown error"}},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof wy&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ef),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let a=0;a<s;a++)if(a-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[a].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ef),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof wy){if(i=Sy(e,t.valueBlock.value[a],r.valueBlock.value[0].value),!1===i.verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ef),r.name&&delete e[r.name]),i;n++}if(ff in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n=wf in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[a])}}else if(i=Sy(e,t.valueBlock.value[a-n],r.valueBlock.value[a]),!1===i.verified){if(!r.valueBlock.value[a].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ef),r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ef),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&pf in t.valueBlock){const n=wp(t.valueBlock.valueHexView);if(-1===n.offset){const t={verified:!1,result:n.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ef),r.name&&(delete e[r.name],t.name=r.name)),t}return Sy(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}function Cy(e,t){if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=wp(Zh._H.toUint8Array(e));return-1===r.offset?{verified:!1,result:r.result}:Sy(r.result,r.result,t)}(Ap=mp||(mp={}))[Ap.Sequence=0]="Sequence",Ap[Ap.Set=1]="Set",Ap[Ap.Choice=2]="Choice",function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(vp||(vp={}));class By{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else{if(!Zh._H.isBufferSource(e))throw TypeError("Unsupported type of 'params' argument for BitString");this.unusedBits=t,this.value=Zh._H.toArrayBuffer(e)}}fromASN(e){if(!(e instanceof Rp))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new Rp({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new Rp({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const r of t)e+=r.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;const n=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let i=0;for(;i<r;)n[i]=parseInt(t.slice(i<<3,8+(i<<3)),2),i++;this.value=n.buffer}}class Iy{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):Zh._H.isBufferSource(e)?this.buffer=Zh._H.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof xp))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new xp({valueHex:this.buffer})}toSchema(e){return new xp({name:e})}}const ky={fromASN:e=>e instanceof kp?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new kp;const t=Ep(e);if(t.result.error)throw new Error(t.result.error);return t.result}},Ty={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new Op({value:+e})},Ny={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new Mp({value:e})},Uy={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Op({valueHex:e})},xy={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Rp({valueHex:e})},Dy={fromASN:e=>e.valueBlock.toString(),toASN:e=>new Fp({value:e})},Ry={fromASN:e=>e.valueBlock.value,toASN:e=>new Np({value:e})},Py={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new xp({valueHex:e})},Ly={fromASN:e=>new Iy(e.getValue()),toASN:e=>e.toASN()};function _y(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}const Ky=_y(Xp),Oy=_y(ey),My=_y(ry),Hy=_y(ny),Vy=_y(iy),Fy=_y(sy),jy=_y(ay),Qy=_y(oy),qy=_y(cy),zy=_y(uy),Gy=_y(ly),$y=_y(hy),Wy={fromASN:e=>e.toDate(),toASN:e=>new fy({valueDate:e})},Yy={fromASN:e=>e.toDate(),toASN:e=>new py({valueDate:e})},Jy={fromASN:()=>null,toASN:()=>new kp};function Xy(e){switch(e){case vp.Any:return ky;case vp.BitString:return xy;case vp.BmpString:return Oy;case vp.Boolean:return Ry;case vp.CharacterString:return $y;case vp.Enumerated:return Ny;case vp.GeneralString:return Gy;case vp.GeneralizedTime:return Yy;case vp.GraphicString:return qy;case vp.IA5String:return Qy;case vp.Integer:return Ty;case vp.Null:return Jy;case vp.NumericString:return Hy;case vp.ObjectIdentifier:return Dy;case vp.OctetString:return Py;case vp.PrintableString:return Vy;case vp.TeletexString:return Fy;case vp.UTCTime:return Wy;case vp.UniversalString:return My;case vp.Utf8String:return Ky;case vp.VideotexString:return jy;case vp.VisibleString:return zy;default:return null}}function Zy(e){return"function"==typeof e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||Zy(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}function ed(e){var t;if(e){const r=Object.getPrototypeOf(e);return(null===(t=null==r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||ed(r)}return!1}function td(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}const rd=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){const r=this.items.get(e);if(!r)throw new Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw new Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:mp.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(t,r){const n=this.items.get(t)||this.createDefault(t),i=[];for(const t in n.items){const s=n.items[t],a=r?t:"";let o;if("number"==typeof s.type){const t=vp[s.type],r=e[t];if(!r)throw new Error(`Cannot get ASN1 class by name '${t}'`);o=new r({name:a})}else Zy(s.type)?o=(new s.type).toSchema(a):s.optional?this.get(s.type).type===mp.Choice?o=new Ay({name:a}):(o=this.create(s.type,!1),o.name=a):o=new Ay({name:a});const c=!!s.optional||void 0!==s.defaultValue;if(s.repeated&&(o.name="",o=new("set"===s.repeated?Gp:zp)({name:"",value:[new wy({name:a,value:o})]})),null!==s.context&&void 0!==s.context)if(s.implicit)if("number"==typeof s.type||Zy(s.type)){const e=s.repeated?Cp:bp;i.push(new e({name:a,optional:c,idBlock:{tagClass:3,tagNumber:s.context}}))}else{this.cache(s.type);const e=!!s.repeated;let t=e?o:this.get(s.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,i.push(new Cp({name:e?"":a,optional:c,idBlock:{tagClass:3,tagNumber:s.context},value:t}))}else i.push(new Cp({optional:c,idBlock:{tagClass:3,tagNumber:s.context},value:[o]}));else o.optional=c,i.push(o)}switch(n.type){case mp.Sequence:return new zp({value:i,name:""});case mp.Set:return new Gp({value:i,name:""});case mp.Choice:return new by({value:i,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}},nd=e=>t=>{let r;rd.has(t)?r=rd.get(t):(r=rd.createDefault(t),rd.set(t,r)),Object.assign(r,e)},id=e=>(t,r)=>{let n;rd.has(t.constructor)?n=rd.get(t.constructor):(n=rd.createDefault(t.constructor),rd.set(t.constructor,n));const i=Object.assign({},e);if("number"==typeof i.type&&!i.converter){const n=Xy(e.type);if(!n)throw new Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);i.converter=n}n.items[r]=i};class sd extends Error{constructor(){super(...arguments),this.schemas=[]}}class ad{static parse(e,t){const r=Ep(e);if(r.result.error)throw new Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(t,r){var n;try{if(Zy(r))return(new r).fromASN(t);const i=rd.get(r);rd.cache(r);let s=i.schema;if(t.constructor===Cp&&i.type!==mp.Choice){s=new Cp({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:i.schema.valueBlock.value});for(const e in i.items)delete t[e]}const a=Sy({},t,s);if(!a.verified)throw new sd(`Data does not match to ${r.name} ASN1 schema. ${a.result.error}`);const o=new r;if(ed(r)){if(!("value"in t.valueBlock)||!Array.isArray(t.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const e=i.itemType;if("number"==typeof e){const n=Xy(e);if(!n)throw new Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(t.valueBlock.value,(e=>n.fromASN(e)))}return r.from(t.valueBlock.value,(t=>this.fromASN(t,e)))}for(const t in i.items){const r=a.result[t];if(!r)continue;const s=i.items[t],c=s.type;if("number"==typeof c||Zy(c)){const i=null!==(n=s.converter)&&void 0!==n?n:Zy(c)?new c:null;if(!i)throw new Error("Converter is empty");if(s.repeated)if(s.implicit){const e=new("sequence"===s.repeated?zp:Gp);e.valueBlock=r.valueBlock;const n=Ep(e.toBER(!1));if(-1===n.offset)throw new Error(`Cannot parse the child item. ${n.result.error}`);if(!("value"in n.result.valueBlock)||!Array.isArray(n.result.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const a=n.result.valueBlock.value;o[t]=Array.from(a,(e=>i.fromASN(e)))}else o[t]=Array.from(r,(e=>i.fromASN(e)));else{let n=r;if(s.implicit){let t;if(Zy(c))t=(new c).toSchema("");else{const r=vp[c],n=e[r];if(!n)throw new Error(`Cannot get '${r}' class from asn1js module`);t=new n}t.valueBlock=n.valueBlock,n=Ep(t.toBER(!1)).result}o[t]=i.fromASN(n)}}else if(s.repeated){if(!Array.isArray(r))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");o[t]=Array.from(r,(e=>this.fromASN(e,c)))}else o[t]=this.fromASN(r,c)}return o}catch(e){throw e instanceof sd&&e.schemas.push(r.name),e}}}class od{static serialize(e){return e instanceof Pf?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&"object"==typeof e&&Zy(e))return e.toASN();if(!e||"object"!=typeof e)throw new TypeError("Parameter 1 should be type of Object.");const t=e.constructor,r=rd.get(t);rd.cache(t);let n,i=[];if(r.itemType){if(!Array.isArray(e))throw new TypeError("Parameter 1 should be type of Array.");if("number"==typeof r.itemType){const n=Xy(r.itemType);if(!n)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);i=e.map((e=>n.toASN(e)))}else i=e.map((e=>this.toAsnItem({type:r.itemType},"[]",t,e)))}else for(const n in r.items){const s=r.items[n],a=e[n];if(void 0===a||s.defaultValue===a||"object"==typeof s.defaultValue&&"object"==typeof a&&td(this.serialize(s.defaultValue),this.serialize(a)))continue;const o=od.toAsnItem(s,n,t,a);if("number"==typeof s.context)if(s.implicit)if(s.repeated||"number"!=typeof s.type&&!Zy(s.type))i.push(new Cp({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:o.valueBlock.value}));else{const e={};e.valueHex=o instanceof kp?o.valueBeforeDecodeView:o.valueBlock.toBER(),i.push(new bp({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},...e}))}else i.push(new Cp({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:[o]}));else s.repeated?i=i.concat(o):i.push(o)}switch(r.type){case mp.Sequence:n=new zp({value:i});break;case mp.Set:n=new Gp({value:i});break;case mp.Choice:if(!i[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);n=i[0]}return n}static toAsnItem(e,t,r,n){let i;if("number"==typeof e.type){const s=e.converter;if(!s)throw new Error(`Property '${t}' doesn't have converter for type ${vp[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(n,(e=>s.toASN(e)));i=new("sequence"===e.repeated?zp:Gp)({value:t})}else i=s.toASN(n)}else if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(n,(e=>this.toASN(e)));i=new("sequence"===e.repeated?zp:Gp)({value:t})}else i=this.toASN(n);return i}}class cd extends Array{constructor(e=[]){if("number"==typeof e)super(e);else{super();for(const t of e)this.push(t)}}}class ud{static serialize(e){return od.serialize(e)}static parse(e,t){return ad.parse(e,t)}static toString(e){const t=Ep(Zh._H.isBufferSource(e)?Zh._H.toArrayBuffer(e):ud.serialize(e));if(-1===t.offset)throw new Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}function ld(e,t,r,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(a=(s<3?i(a):s>3?i(t,r,a):i(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;class hd{static isIPv4(e){return/^(\d{1,3}\.){3}\d{1,3}$/.test(e)}static parseIPv4(e){const t=e.split(".");if(4!==t.length)throw new Error("Invalid IPv4 address");return t.map((e=>{const t=parseInt(e,10);if(isNaN(t)||t<0||t>255)throw new Error("Invalid IPv4 address part");return t}))}static parseIPv6(e){const t=this.expandIPv6(e).split(":");if(8!==t.length)throw new Error("Invalid IPv6 address");return t.reduce(((e,t)=>{const r=parseInt(t,16);if(isNaN(r)||r<0||r>65535)throw new Error("Invalid IPv6 address part");return e.push(r>>8&255),e.push(255&r),e}),[])}static expandIPv6(e){if(!e.includes("::"))return e;const t=e.split("::");if(t.length>2)throw new Error("Invalid IPv6 address");const r=t[0]?t[0].split(":"):[],n=t[1]?t[1].split(":"):[],i=8-(r.length+n.length);if(i<0)throw new Error("Invalid IPv6 address");return[...r,...Array(i).fill("0"),...n].join(":")}static formatIPv6(e){const t=[];for(let r=0;r<16;r+=2)t.push((e[r]<<8|e[r+1]).toString(16));return this.compressIPv6(t.join(":"))}static compressIPv6(e){const t=e.split(":");let r=-1,n=0,i=-1,s=0;for(let e=0;e<t.length;e++)"0"===t[e]?(-1===i&&(i=e),s++):(s>n&&(r=i,n=s),i=-1,s=0);return s>n&&(r=i,n=s),n>1?`${t.slice(0,r).join(":")}::${t.slice(r+n).join(":")}`:e}static parseCIDR(e){const[t,r]=e.split("/"),n=parseInt(r,10);if(this.isIPv4(t)){if(n<0||n>32)throw new Error("Invalid IPv4 prefix length");return[this.parseIPv4(t),n]}if(n<0||n>128)throw new Error("Invalid IPv6 prefix length");return[this.parseIPv6(t),n]}static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce(((e,t)=>e+ +t),0);let r=e.slice(0,8).replace(/(.{2})/g,(e=>`${parseInt(e,16)}.`));return r=r.slice(0,-1),`${r}/${t}`}static toString(e){const t=new Uint8Array(e);if(4===t.length)return Array.from(t).join(".");if(16===t.length)return this.formatIPv6(t);if(8===t.length||32===t.length){const e=t.length/2,r=t.slice(0,e),n=t.slice(e);if(t.every((e=>0===e)))return 8===t.length?"0.0.0.0/0":"::/0";const i=n.reduce(((e,t)=>e+(t.toString(2).match(/1/g)||[]).length),0);return 8===t.length?`${Array.from(r).join(".")}/${i}`:`${this.formatIPv6(r)}/${i}`}return this.decodeIP(Zh.U$.ToHex(e))}static fromString(e){if(e.includes("/")){const[t,r]=this.parseCIDR(e),n=new Uint8Array(t.length);let i=r;for(let e=0;e<n.length;e++)i>=8?(n[e]=255,i-=8):i>0&&(n[e]=255<<8-i,i=0);const s=new Uint8Array(2*t.length);return s.set(t,0),s.set(n,t.length),s.buffer}const t=this.isIPv4(e)?this.parseIPv4(e):this.parseIPv6(e);return new Uint8Array(t).buffer}}var fd,pd,yd;let dd=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};ld([id({type:vp.TeletexString})],dd.prototype,"teletexString",void 0),ld([id({type:vp.PrintableString})],dd.prototype,"printableString",void 0),ld([id({type:vp.UniversalString})],dd.prototype,"universalString",void 0),ld([id({type:vp.Utf8String})],dd.prototype,"utf8String",void 0),ld([id({type:vp.BmpString})],dd.prototype,"bmpString",void 0),dd=ld([nd({type:mp.Choice})],dd);let gd=class extends dd{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?Zh.U$.ToHex(this.anyValue):super.toString())}};ld([id({type:vp.IA5String})],gd.prototype,"ia5String",void 0),ld([id({type:vp.Any})],gd.prototype,"anyValue",void 0),gd=ld([nd({type:mp.Choice})],gd);class md{constructor(e={}){this.type="",this.value=new gd,Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],md.prototype,"type",void 0),ld([id({type:gd})],md.prototype,"value",void 0);let vd=fd=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,fd.prototype)}};vd=fd=ld([nd({type:mp.Set,itemType:md})],vd);let Ad=pd=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,pd.prototype)}};Ad=pd=ld([nd({type:mp.Sequence,itemType:vd})],Ad);let bd=yd=class extends Ad{constructor(e){super(e),Object.setPrototypeOf(this,yd.prototype)}};bd=yd=ld([nd({type:mp.Sequence})],bd);const wd={fromASN:e=>hd.toString(Py.fromASN(e)),toASN:e=>Py.toASN(hd.fromString(e))};class Ed{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Ed.prototype,"typeId",void 0),ld([id({type:vp.Any,context:0})],Ed.prototype,"value",void 0);class Sd{constructor(e={}){this.partyName=new dd,Object.assign(this,e)}}ld([id({type:dd,optional:!0,context:0,implicit:!0})],Sd.prototype,"nameAssigner",void 0),ld([id({type:dd,context:1,implicit:!0})],Sd.prototype,"partyName",void 0);let Cd=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:Ed,context:0,implicit:!0})],Cd.prototype,"otherName",void 0),ld([id({type:vp.IA5String,context:1,implicit:!0})],Cd.prototype,"rfc822Name",void 0),ld([id({type:vp.IA5String,context:2,implicit:!0})],Cd.prototype,"dNSName",void 0),ld([id({type:vp.Any,context:3,implicit:!0})],Cd.prototype,"x400Address",void 0),ld([id({type:bd,context:4,implicit:!1})],Cd.prototype,"directoryName",void 0),ld([id({type:Sd,context:5})],Cd.prototype,"ediPartyName",void 0),ld([id({type:vp.IA5String,context:6,implicit:!0})],Cd.prototype,"uniformResourceIdentifier",void 0),ld([id({type:vp.OctetString,context:7,implicit:!0,converter:wd})],Cd.prototype,"iPAddress",void 0),ld([id({type:vp.ObjectIdentifier,context:8,implicit:!0})],Cd.prototype,"registeredID",void 0),Cd=ld([nd({type:mp.Choice})],Cd);const Bd="1.3.6.1.5.5.7",Id=`${Bd}.3`,kd=`${Bd}.48`,Td=`${kd}.1`,Nd=`${kd}.2`,Ud=`${kd}.3`,xd=`${kd}.5`,Dd="2.5.29";var Rd;const Pd=`${Bd}.1.1`;class Ld{constructor(e={}){this.accessMethod="",this.accessLocation=new Cd,Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Ld.prototype,"accessMethod",void 0),ld([id({type:Cd})],Ld.prototype,"accessLocation",void 0);let _d=Rd=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Rd.prototype)}};_d=Rd=ld([nd({type:mp.Sequence,itemType:Ld})],_d);const Kd=`${Dd}.35`;class Od extends Iy{}class Md{constructor(e={}){e&&Object.assign(this,e)}}ld([id({type:Od,context:0,optional:!0,implicit:!0})],Md.prototype,"keyIdentifier",void 0),ld([id({type:Cd,context:1,optional:!0,implicit:!0,repeated:"sequence"})],Md.prototype,"authorityCertIssuer",void 0),ld([id({type:vp.Integer,context:2,optional:!0,implicit:!0,converter:Uy})],Md.prototype,"authorityCertSerialNumber",void 0);const Hd=`${Dd}.19`;class Vd{constructor(e={}){this.cA=!1,Object.assign(this,e)}}var Fd;ld([id({type:vp.Boolean,defaultValue:!1})],Vd.prototype,"cA",void 0),ld([id({type:vp.Integer,optional:!0})],Vd.prototype,"pathLenConstraint",void 0);let jd=Fd=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Fd.prototype)}};var Qd;jd=Fd=ld([nd({type:mp.Sequence,itemType:Cd})],jd);let qd=Qd=class extends jd{constructor(e){super(e),Object.setPrototypeOf(this,Qd.prototype)}};var zd;qd=Qd=ld([nd({type:mp.Sequence})],qd);const Gd=`${Dd}.32`;let $d=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};ld([id({type:vp.IA5String})],$d.prototype,"ia5String",void 0),ld([id({type:vp.VisibleString})],$d.prototype,"visibleString",void 0),ld([id({type:vp.BmpString})],$d.prototype,"bmpString",void 0),ld([id({type:vp.Utf8String})],$d.prototype,"utf8String",void 0),$d=ld([nd({type:mp.Choice})],$d);class Wd{constructor(e={}){this.organization=new $d,this.noticeNumbers=[],Object.assign(this,e)}}ld([id({type:$d})],Wd.prototype,"organization",void 0),ld([id({type:vp.Integer,repeated:"sequence"})],Wd.prototype,"noticeNumbers",void 0);class Yd{constructor(e={}){Object.assign(this,e)}}ld([id({type:Wd,optional:!0})],Yd.prototype,"noticeRef",void 0),ld([id({type:$d,optional:!0})],Yd.prototype,"explicitText",void 0);let Jd=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:vp.IA5String})],Jd.prototype,"cPSuri",void 0),ld([id({type:Yd})],Jd.prototype,"userNotice",void 0),Jd=ld([nd({type:mp.Choice})],Jd);class Xd{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Xd.prototype,"policyQualifierId",void 0),ld([id({type:vp.Any})],Xd.prototype,"qualifier",void 0);class Zd{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Zd.prototype,"policyIdentifier",void 0),ld([id({type:Xd,repeated:"sequence",optional:!0})],Zd.prototype,"policyQualifiers",void 0);let eg=zd=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,zd.prototype)}};eg=zd=ld([nd({type:mp.Sequence,itemType:Zd})],eg);let tg=class{constructor(e=0){this.value=e}};ld([id({type:vp.Integer})],tg.prototype,"value",void 0),tg=ld([nd({type:mp.Choice})],tg);let rg=class extends tg{};var ng;rg=ld([nd({type:mp.Choice})],rg);const ig=`${Dd}.31`;var sg;!function(e){e[e.unused=1]="unused",e[e.keyCompromise=2]="keyCompromise",e[e.cACompromise=4]="cACompromise",e[e.affiliationChanged=8]="affiliationChanged",e[e.superseded=16]="superseded",e[e.cessationOfOperation=32]="cessationOfOperation",e[e.certificateHold=64]="certificateHold",e[e.privilegeWithdrawn=128]="privilegeWithdrawn",e[e.aACompromise=256]="aACompromise"}(sg||(sg={}));class ag extends By{toJSON(){const e=[],t=this.toNumber();return t&sg.aACompromise&&e.push("aACompromise"),t&sg.affiliationChanged&&e.push("affiliationChanged"),t&sg.cACompromise&&e.push("cACompromise"),t&sg.certificateHold&&e.push("certificateHold"),t&sg.cessationOfOperation&&e.push("cessationOfOperation"),t&sg.keyCompromise&&e.push("keyCompromise"),t&sg.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&sg.superseded&&e.push("superseded"),t&sg.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let og=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:Cd,context:0,repeated:"sequence",implicit:!0})],og.prototype,"fullName",void 0),ld([id({type:vd,context:1,implicit:!0})],og.prototype,"nameRelativeToCRLIssuer",void 0),og=ld([nd({type:mp.Choice})],og);class cg{constructor(e={}){Object.assign(this,e)}}ld([id({type:og,context:0,optional:!0})],cg.prototype,"distributionPoint",void 0),ld([id({type:ag,context:1,optional:!0,implicit:!0})],cg.prototype,"reasons",void 0),ld([id({type:Cd,context:2,optional:!0,repeated:"sequence",implicit:!0})],cg.prototype,"cRLIssuer",void 0);let ug=ng=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,ng.prototype)}};var lg;ug=ng=ld([nd({type:mp.Sequence,itemType:cg})],ug);let hg=lg=class extends ug{constructor(e){super(e),Object.setPrototypeOf(this,lg.prototype)}};hg=lg=ld([nd({type:mp.Sequence,itemType:cg})],hg);class fg{constructor(e={}){this.onlyContainsUserCerts=fg.ONLY,this.onlyContainsCACerts=fg.ONLY,this.indirectCRL=fg.ONLY,this.onlyContainsAttributeCerts=fg.ONLY,Object.assign(this,e)}}var pg;fg.ONLY=!1,ld([id({type:og,context:0,optional:!0})],fg.prototype,"distributionPoint",void 0),ld([id({type:vp.Boolean,context:1,defaultValue:fg.ONLY,implicit:!0})],fg.prototype,"onlyContainsUserCerts",void 0),ld([id({type:vp.Boolean,context:2,defaultValue:fg.ONLY,implicit:!0})],fg.prototype,"onlyContainsCACerts",void 0),ld([id({type:ag,context:3,optional:!0,implicit:!0})],fg.prototype,"onlySomeReasons",void 0),ld([id({type:vp.Boolean,context:4,defaultValue:fg.ONLY,implicit:!0})],fg.prototype,"indirectCRL",void 0),ld([id({type:vp.Boolean,context:5,defaultValue:fg.ONLY,implicit:!0})],fg.prototype,"onlyContainsAttributeCerts",void 0),function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(pg||(pg={}));let yg=class{constructor(e=pg.unspecified){this.reason=pg.unspecified,this.reason=e}toJSON(){return pg[this.reason]}toString(){return this.toJSON()}};var dg;ld([id({type:vp.Enumerated})],yg.prototype,"reason",void 0),yg=ld([nd({type:mp.Choice})],yg);const gg=`${Dd}.37`;let mg=dg=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,dg.prototype)}};mg=dg=ld([nd({type:mp.Sequence,itemType:vp.ObjectIdentifier})],mg);const vg=`${Id}.1`,Ag=`${Id}.2`,bg=`${Id}.3`,wg=`${Id}.4`,Eg=`${Id}.8`,Sg=`${Id}.9`;let Cg=class{constructor(e=new ArrayBuffer(0)){this.value=e}};ld([id({type:vp.Integer,converter:Uy})],Cg.prototype,"value",void 0),Cg=ld([nd({type:mp.Choice})],Cg);let Bg=class{constructor(e){this.value=new Date,e&&(this.value=e)}};var Ig;ld([id({type:vp.GeneralizedTime})],Bg.prototype,"value",void 0),Bg=ld([nd({type:mp.Choice})],Bg);let kg=Ig=class extends jd{constructor(e){super(e),Object.setPrototypeOf(this,Ig.prototype)}};kg=Ig=ld([nd({type:mp.Sequence})],kg);const Tg=`${Dd}.15`;var Ng,Ug;!function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(Ng||(Ng={}));class xg extends By{toJSON(){const e=this.toNumber(),t=[];return e&Ng.cRLSign&&t.push("crlSign"),e&Ng.dataEncipherment&&t.push("dataEncipherment"),e&Ng.decipherOnly&&t.push("decipherOnly"),e&Ng.digitalSignature&&t.push("digitalSignature"),e&Ng.encipherOnly&&t.push("encipherOnly"),e&Ng.keyAgreement&&t.push("keyAgreement"),e&Ng.keyCertSign&&t.push("keyCertSign"),e&Ng.keyEncipherment&&t.push("keyEncipherment"),e&Ng.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class Dg{constructor(e={}){this.base=new Cd,this.minimum=0,Object.assign(this,e)}}ld([id({type:Cd})],Dg.prototype,"base",void 0),ld([id({type:vp.Integer,context:0,defaultValue:0,implicit:!0})],Dg.prototype,"minimum",void 0),ld([id({type:vp.Integer,context:1,optional:!0,implicit:!0})],Dg.prototype,"maximum",void 0);let Rg=Ug=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Ug.prototype)}};Rg=Ug=ld([nd({type:mp.Sequence,itemType:Dg})],Rg);class Pg{constructor(e={}){Object.assign(this,e)}}ld([id({type:Rg,context:0,optional:!0,implicit:!0})],Pg.prototype,"permittedSubtrees",void 0),ld([id({type:Rg,context:1,optional:!0,implicit:!0})],Pg.prototype,"excludedSubtrees",void 0);class Lg{constructor(e={}){Object.assign(this,e)}}var _g;ld([id({type:vp.Integer,context:0,implicit:!0,optional:!0,converter:Uy})],Lg.prototype,"requireExplicitPolicy",void 0),ld([id({type:vp.Integer,context:1,implicit:!0,optional:!0,converter:Uy})],Lg.prototype,"inhibitPolicyMapping",void 0);class Kg{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Kg.prototype,"issuerDomainPolicy",void 0),ld([id({type:vp.ObjectIdentifier})],Kg.prototype,"subjectDomainPolicy",void 0);let Og=_g=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,_g.prototype)}};var Mg;Og=_g=ld([nd({type:mp.Sequence,itemType:Kg})],Og);const Hg=`${Dd}.17`;let Vg=Mg=class extends jd{constructor(e){super(e),Object.setPrototypeOf(this,Mg.prototype)}};Vg=Mg=ld([nd({type:mp.Sequence})],Vg);class Fg{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}var jg;ld([id({type:vp.ObjectIdentifier})],Fg.prototype,"type",void 0),ld([id({type:vp.Any,repeated:"set"})],Fg.prototype,"values",void 0);let Qg=jg=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,jg.prototype)}};Qg=jg=ld([nd({type:mp.Sequence,itemType:Fg})],Qg);const qg=`${Dd}.14`;class zg extends Od{}class Gg{constructor(e={}){Object.assign(this,e)}}var $g,Wg;ld([id({type:vp.GeneralizedTime,context:0,implicit:!0,optional:!0})],Gg.prototype,"notBefore",void 0),ld([id({type:vp.GeneralizedTime,context:1,implicit:!0,optional:!0})],Gg.prototype,"notAfter",void 0),function(e){e[e.keyUpdateAllowed=1]="keyUpdateAllowed",e[e.newExtensions=2]="newExtensions",e[e.pKIXCertificate=4]="pKIXCertificate"}($g||($g={}));class Yg extends By{toJSON(){const e=[],t=this.toNumber();return t&$g.pKIXCertificate&&e.push("pKIXCertificate"),t&$g.newExtensions&&e.push("newExtensions"),t&$g.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class Jg{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new Yg,Object.assign(this,e)}}ld([id({type:vp.GeneralString})],Jg.prototype,"entrustVers",void 0),ld([id({type:Yg})],Jg.prototype,"entrustInfoFlags",void 0);let Xg=Wg=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Wg.prototype)}};Xg=Wg=ld([nd({type:mp.Sequence,itemType:Ld})],Xg);class Zg{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof Zg&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&Zh.n4(e.parameters,this.parameters)||e.parameters===this.parameters)}}ld([id({type:vp.ObjectIdentifier})],Zg.prototype,"algorithm",void 0),ld([id({type:vp.Any,optional:!0})],Zg.prototype,"parameters",void 0);class em{constructor(e={}){this.algorithm=new Zg,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:Zg})],em.prototype,"algorithm",void 0),ld([id({type:vp.BitString})],em.prototype,"subjectPublicKey",void 0);let tm=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};ld([id({type:vp.UTCTime})],tm.prototype,"utcTime",void 0),ld([id({type:vp.GeneralizedTime})],tm.prototype,"generalTime",void 0),tm=ld([nd({type:mp.Choice})],tm);class rm{constructor(e){this.notBefore=new tm(new Date),this.notAfter=new tm(new Date),e&&(this.notBefore=new tm(e.notBefore),this.notAfter=new tm(e.notAfter))}}var nm;ld([id({type:tm})],rm.prototype,"notBefore",void 0),ld([id({type:tm})],rm.prototype,"notAfter",void 0);class im{constructor(e={}){this.extnID="",this.critical=im.CRITICAL,this.extnValue=new Iy,Object.assign(this,e)}}im.CRITICAL=!1,ld([id({type:vp.ObjectIdentifier})],im.prototype,"extnID",void 0),ld([id({type:vp.Boolean,defaultValue:im.CRITICAL})],im.prototype,"critical",void 0),ld([id({type:Iy})],im.prototype,"extnValue",void 0);let sm=nm=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,nm.prototype)}};var am;sm=nm=ld([nd({type:mp.Sequence,itemType:im})],sm),function(e){e[e.v1=0]="v1",e[e.v2=1]="v2",e[e.v3=2]="v3"}(am||(am={}));class om{constructor(e={}){this.version=am.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new Zg,this.issuer=new bd,this.validity=new rm,this.subject=new bd,this.subjectPublicKeyInfo=new em,Object.assign(this,e)}}ld([id({type:vp.Integer,context:0,defaultValue:am.v1})],om.prototype,"version",void 0),ld([id({type:vp.Integer,converter:Uy})],om.prototype,"serialNumber",void 0),ld([id({type:Zg})],om.prototype,"signature",void 0),ld([id({type:bd})],om.prototype,"issuer",void 0),ld([id({type:rm})],om.prototype,"validity",void 0),ld([id({type:bd})],om.prototype,"subject",void 0),ld([id({type:em})],om.prototype,"subjectPublicKeyInfo",void 0),ld([id({type:vp.BitString,context:1,implicit:!0,optional:!0})],om.prototype,"issuerUniqueID",void 0),ld([id({type:vp.BitString,context:2,implicit:!0,optional:!0})],om.prototype,"subjectUniqueID",void 0),ld([id({type:sm,context:3,optional:!0})],om.prototype,"extensions",void 0);class cm{constructor(e={}){this.tbsCertificate=new om,this.signatureAlgorithm=new Zg,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:om})],cm.prototype,"tbsCertificate",void 0),ld([id({type:Zg})],cm.prototype,"signatureAlgorithm",void 0),ld([id({type:vp.BitString})],cm.prototype,"signatureValue",void 0);class um{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new tm,Object.assign(this,e)}}ld([id({type:vp.Integer,converter:Uy})],um.prototype,"userCertificate",void 0),ld([id({type:tm})],um.prototype,"revocationDate",void 0),ld([id({type:im,optional:!0,repeated:"sequence"})],um.prototype,"crlEntryExtensions",void 0);class lm{constructor(e={}){this.signature=new Zg,this.issuer=new bd,this.thisUpdate=new tm,Object.assign(this,e)}}ld([id({type:vp.Integer,optional:!0})],lm.prototype,"version",void 0),ld([id({type:Zg})],lm.prototype,"signature",void 0),ld([id({type:bd})],lm.prototype,"issuer",void 0),ld([id({type:tm})],lm.prototype,"thisUpdate",void 0),ld([id({type:tm,optional:!0})],lm.prototype,"nextUpdate",void 0),ld([id({type:um,repeated:"sequence",optional:!0})],lm.prototype,"revokedCertificates",void 0),ld([id({type:im,optional:!0,context:0,repeated:"sequence"})],lm.prototype,"crlExtensions",void 0);class hm{constructor(e={}){this.tbsCertList=new lm,this.signatureAlgorithm=new Zg,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:lm})],hm.prototype,"tbsCertList",void 0),ld([id({type:Zg})],hm.prototype,"signatureAlgorithm",void 0),ld([id({type:vp.BitString})],hm.prototype,"signature",void 0);class fm{constructor(e={}){this.issuer=new bd,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:bd})],fm.prototype,"issuer",void 0),ld([id({type:vp.Integer,converter:Uy})],fm.prototype,"serialNumber",void 0);let pm=class{constructor(e={}){Object.assign(this,e)}};var ym;ld([id({type:zg,context:0,implicit:!0})],pm.prototype,"subjectKeyIdentifier",void 0),ld([id({type:fm})],pm.prototype,"issuerAndSerialNumber",void 0),pm=ld([nd({type:mp.Choice})],pm),function(e){e[e.v0=0]="v0",e[e.v1=1]="v1",e[e.v2=2]="v2",e[e.v3=3]="v3",e[e.v4=4]="v4",e[e.v5=5]="v5"}(ym||(ym={}));let dm=class extends Zg{};dm=ld([nd({type:mp.Sequence})],dm);let gm=class extends Zg{};gm=ld([nd({type:mp.Sequence})],gm);let mm=class extends Zg{};mm=ld([nd({type:mp.Sequence})],mm);let vm=class extends Zg{};vm=ld([nd({type:mp.Sequence})],vm);let Am=class extends Zg{};Am=ld([nd({type:mp.Sequence})],Am);let bm=class extends Zg{};bm=ld([nd({type:mp.Sequence})],bm);class wm{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}var Em;ld([id({type:vp.ObjectIdentifier})],wm.prototype,"attrType",void 0),ld([id({type:vp.Any,repeated:"set"})],wm.prototype,"attrValues",void 0);class Sm{constructor(e={}){this.version=ym.v0,this.sid=new pm,this.digestAlgorithm=new dm,this.signatureAlgorithm=new gm,this.signature=new Iy,Object.assign(this,e)}}ld([id({type:vp.Integer})],Sm.prototype,"version",void 0),ld([id({type:pm})],Sm.prototype,"sid",void 0),ld([id({type:dm})],Sm.prototype,"digestAlgorithm",void 0),ld([id({type:wm,repeated:"set",context:0,implicit:!0,optional:!0})],Sm.prototype,"signedAttrs",void 0),ld([id({type:gm})],Sm.prototype,"signatureAlgorithm",void 0),ld([id({type:Iy})],Sm.prototype,"signature",void 0),ld([id({type:wm,repeated:"set",context:1,implicit:!0,optional:!0})],Sm.prototype,"unsignedAttrs",void 0);let Cm=Em=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Em.prototype)}};Cm=Em=ld([nd({type:mp.Set,itemType:Sm})],Cm);let Bm=class extends tm{};Bm=ld([nd({type:mp.Choice})],Bm);let Im=class extends Sm{};Im=ld([nd({type:mp.Sequence})],Im);class km{constructor(e={}){this.acIssuer=new Cd,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}var Tm;ld([id({type:Cd})],km.prototype,"acIssuer",void 0),ld([id({type:vp.Integer})],km.prototype,"acSerial",void 0),ld([id({type:Fg,repeated:"sequence"})],km.prototype,"attrs",void 0);let Nm=Tm=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Tm.prototype)}};Nm=Tm=ld([nd({type:mp.Sequence,itemType:vp.ObjectIdentifier})],Nm);class Um{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}ld([id({type:vp.Integer,optional:!0})],Um.prototype,"pathLenConstraint",void 0),ld([id({type:Nm,implicit:!0,context:0,optional:!0})],Um.prototype,"permittedAttrs",void 0),ld([id({type:Nm,implicit:!0,context:1,optional:!0})],Um.prototype,"excludedAttrs",void 0),ld([id({type:vp.Boolean,defaultValue:!0})],Um.prototype,"permitUnSpecified",void 0);class xm{constructor(e={}){this.issuer=new jd,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}var Dm;ld([id({type:jd})],xm.prototype,"issuer",void 0),ld([id({type:vp.Integer,converter:Uy})],xm.prototype,"serial",void 0),ld([id({type:vp.BitString,optional:!0})],xm.prototype,"issuerUID",void 0),function(e){e[e.publicKey=0]="publicKey",e[e.publicKeyCert=1]="publicKeyCert",e[e.otherObjectTypes=2]="otherObjectTypes"}(Dm||(Dm={}));class Rm{constructor(e={}){this.digestedObjectType=Dm.publicKey,this.digestAlgorithm=new Zg,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.Enumerated})],Rm.prototype,"digestedObjectType",void 0),ld([id({type:vp.ObjectIdentifier,optional:!0})],Rm.prototype,"otherObjectTypeID",void 0),ld([id({type:Zg})],Rm.prototype,"digestAlgorithm",void 0),ld([id({type:vp.BitString})],Rm.prototype,"objectDigest",void 0);class Pm{constructor(e={}){Object.assign(this,e)}}ld([id({type:jd,optional:!0})],Pm.prototype,"issuerName",void 0),ld([id({type:xm,context:0,implicit:!0,optional:!0})],Pm.prototype,"baseCertificateID",void 0),ld([id({type:Rm,context:1,implicit:!0,optional:!0})],Pm.prototype,"objectDigestInfo",void 0);let Lm=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:Cd,repeated:"sequence"})],Lm.prototype,"v1Form",void 0),ld([id({type:Pm,context:0,implicit:!0})],Lm.prototype,"v2Form",void 0),Lm=ld([nd({type:mp.Choice})],Lm);class _m{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}ld([id({type:vp.GeneralizedTime})],_m.prototype,"notBeforeTime",void 0),ld([id({type:vp.GeneralizedTime})],_m.prototype,"notAfterTime",void 0);class Km{constructor(e={}){Object.assign(this,e)}}var Om,Mm,Hm;ld([id({type:xm,implicit:!0,context:0,optional:!0})],Km.prototype,"baseCertificateID",void 0),ld([id({type:jd,implicit:!0,context:1,optional:!0})],Km.prototype,"entityName",void 0),ld([id({type:Rm,implicit:!0,context:2,optional:!0})],Km.prototype,"objectDigestInfo",void 0),function(e){e[e.v2=1]="v2"}(Om||(Om={}));class Vm{constructor(e={}){this.version=Om.v2,this.holder=new Km,this.issuer=new Lm,this.signature=new Zg,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new _m,this.attributes=[],Object.assign(this,e)}}ld([id({type:vp.Integer})],Vm.prototype,"version",void 0),ld([id({type:Km})],Vm.prototype,"holder",void 0),ld([id({type:Lm})],Vm.prototype,"issuer",void 0),ld([id({type:Zg})],Vm.prototype,"signature",void 0),ld([id({type:vp.Integer,converter:Uy})],Vm.prototype,"serialNumber",void 0),ld([id({type:_m})],Vm.prototype,"attrCertValidityPeriod",void 0),ld([id({type:Fg,repeated:"sequence"})],Vm.prototype,"attributes",void 0),ld([id({type:vp.BitString,optional:!0})],Vm.prototype,"issuerUniqueID",void 0),ld([id({type:sm,optional:!0})],Vm.prototype,"extensions",void 0);class Fm{constructor(e={}){this.acinfo=new Vm,this.signatureAlgorithm=new Zg,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:Vm})],Fm.prototype,"acinfo",void 0),ld([id({type:Zg})],Fm.prototype,"signatureAlgorithm",void 0),ld([id({type:vp.BitString})],Fm.prototype,"signatureValue",void 0),function(e){e[e.unmarked=1]="unmarked",e[e.unclassified=2]="unclassified",e[e.restricted=4]="restricted",e[e.confidential=8]="confidential",e[e.secret=16]="secret",e[e.topSecret=32]="topSecret"}(Mm||(Mm={}));class jm extends By{}class Qm{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier,implicit:!0,context:0})],Qm.prototype,"type",void 0),ld([id({type:vp.Any,implicit:!0,context:1})],Qm.prototype,"value",void 0);class qm{constructor(e={}){this.policyId="",this.classList=new jm(Mm.unclassified),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],qm.prototype,"policyId",void 0),ld([id({type:jm,defaultValue:new jm(Mm.unclassified)})],qm.prototype,"classList",void 0),ld([id({type:Qm,repeated:"set"})],qm.prototype,"securityCategories",void 0);class zm{constructor(e={}){Object.assign(this,e)}}ld([id({type:Iy})],zm.prototype,"cotets",void 0),ld([id({type:vp.ObjectIdentifier})],zm.prototype,"oid",void 0),ld([id({type:vp.Utf8String})],zm.prototype,"string",void 0);class Gm{constructor(e={}){this.values=[],Object.assign(this,e)}}ld([id({type:jd,implicit:!0,context:0,optional:!0})],Gm.prototype,"policyAuthority",void 0),ld([id({type:zm,repeated:"sequence"})],Gm.prototype,"values",void 0);class $m{constructor(e={}){this.targetCertificate=new xm,Object.assign(this,e)}}ld([id({type:xm})],$m.prototype,"targetCertificate",void 0),ld([id({type:Cd,optional:!0})],$m.prototype,"targetName",void 0),ld([id({type:Rm,optional:!0})],$m.prototype,"certDigestInfo",void 0);let Wm=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:Cd,context:0,implicit:!0})],Wm.prototype,"targetName",void 0),ld([id({type:Cd,context:1,implicit:!0})],Wm.prototype,"targetGroup",void 0),ld([id({type:$m,context:2,implicit:!0})],Wm.prototype,"targetCert",void 0),Wm=ld([nd({type:mp.Choice})],Wm);let Ym=Hm=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Hm.prototype)}};var Jm;Ym=Hm=ld([nd({type:mp.Sequence,itemType:Wm})],Ym);let Xm=Jm=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Jm.prototype)}};Xm=Jm=ld([nd({type:mp.Sequence,itemType:Ym})],Xm);class Zm{constructor(e={}){Object.assign(this,e)}}ld([id({type:jd,implicit:!0,context:0,optional:!0})],Zm.prototype,"roleAuthority",void 0),ld([id({type:Cd,implicit:!0,context:1})],Zm.prototype,"roleName",void 0);class ev{constructor(e={}){this.service=new Cd,this.ident=new Cd,Object.assign(this,e)}}var tv;ld([id({type:Cd})],ev.prototype,"service",void 0),ld([id({type:Cd})],ev.prototype,"ident",void 0),ld([id({type:Iy,optional:!0})],ev.prototype,"authInfo",void 0);class rv{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],rv.prototype,"otherCertFormat",void 0),ld([id({type:vp.Any})],rv.prototype,"otherCert",void 0);let nv=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:cm})],nv.prototype,"certificate",void 0),ld([id({type:Fm,context:2,implicit:!0})],nv.prototype,"v2AttrCert",void 0),ld([id({type:rv,context:3,implicit:!0})],nv.prototype,"other",void 0),nv=ld([nd({type:mp.Choice})],nv);let iv=tv=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,tv.prototype)}};iv=tv=ld([nd({type:mp.Set,itemType:nv})],iv);class sv{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],sv.prototype,"contentType",void 0),ld([id({type:vp.Any,context:0})],sv.prototype,"content",void 0);let av=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:Iy})],av.prototype,"single",void 0),ld([id({type:vp.Any})],av.prototype,"any",void 0),av=ld([nd({type:mp.Choice})],av);class ov{constructor(e={}){this.eContentType="",Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],ov.prototype,"eContentType",void 0),ld([id({type:av,context:0,optional:!0})],ov.prototype,"eContent",void 0);let cv=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:Iy,context:0,implicit:!0,optional:!0})],cv.prototype,"value",void 0),ld([id({type:Iy,converter:Ly,context:0,implicit:!0,optional:!0,repeated:"sequence"})],cv.prototype,"constructedValue",void 0),cv=ld([nd({type:mp.Choice})],cv);class uv{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new vm,Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],uv.prototype,"contentType",void 0),ld([id({type:vm})],uv.prototype,"contentEncryptionAlgorithm",void 0),ld([id({type:cv,optional:!0})],uv.prototype,"encryptedContent",void 0);class lv{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}var hv;ld([id({type:vp.ObjectIdentifier})],lv.prototype,"keyAttrId",void 0),ld([id({type:vp.Any,optional:!0})],lv.prototype,"keyAttr",void 0);class fv{constructor(e={}){this.subjectKeyIdentifier=new zg,Object.assign(this,e)}}ld([id({type:zg})],fv.prototype,"subjectKeyIdentifier",void 0),ld([id({type:vp.GeneralizedTime,optional:!0})],fv.prototype,"date",void 0),ld([id({type:lv,optional:!0})],fv.prototype,"other",void 0);let pv=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:fv,context:0,implicit:!0,optional:!0})],pv.prototype,"rKeyId",void 0),ld([id({type:fm,optional:!0})],pv.prototype,"issuerAndSerialNumber",void 0),pv=ld([nd({type:mp.Choice})],pv);class yv{constructor(e={}){this.rid=new pv,this.encryptedKey=new Iy,Object.assign(this,e)}}ld([id({type:pv})],yv.prototype,"rid",void 0),ld([id({type:Iy})],yv.prototype,"encryptedKey",void 0);let dv=hv=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,hv.prototype)}};dv=hv=ld([nd({type:mp.Sequence,itemType:yv})],dv);class gv{constructor(e={}){this.algorithm=new Zg,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:Zg})],gv.prototype,"algorithm",void 0),ld([id({type:vp.BitString})],gv.prototype,"publicKey",void 0);let mv=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:zg,context:0,implicit:!0,optional:!0})],mv.prototype,"subjectKeyIdentifier",void 0),ld([id({type:gv,context:1,implicit:!0,optional:!0})],mv.prototype,"originatorKey",void 0),ld([id({type:fm,optional:!0})],mv.prototype,"issuerAndSerialNumber",void 0),mv=ld([nd({type:mp.Choice})],mv);class vv{constructor(e={}){this.version=ym.v3,this.originator=new mv,this.keyEncryptionAlgorithm=new mm,this.recipientEncryptedKeys=new dv,Object.assign(this,e)}}ld([id({type:vp.Integer})],vv.prototype,"version",void 0),ld([id({type:mv,context:0})],vv.prototype,"originator",void 0),ld([id({type:Iy,context:1,optional:!0})],vv.prototype,"ukm",void 0),ld([id({type:mm})],vv.prototype,"keyEncryptionAlgorithm",void 0),ld([id({type:dv})],vv.prototype,"recipientEncryptedKeys",void 0);let Av=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:zg,context:0,implicit:!0})],Av.prototype,"subjectKeyIdentifier",void 0),ld([id({type:fm})],Av.prototype,"issuerAndSerialNumber",void 0),Av=ld([nd({type:mp.Choice})],Av);class bv{constructor(e={}){this.version=ym.v0,this.rid=new Av,this.keyEncryptionAlgorithm=new mm,this.encryptedKey=new Iy,Object.assign(this,e)}}ld([id({type:vp.Integer})],bv.prototype,"version",void 0),ld([id({type:Av})],bv.prototype,"rid",void 0),ld([id({type:mm})],bv.prototype,"keyEncryptionAlgorithm",void 0),ld([id({type:Iy})],bv.prototype,"encryptedKey",void 0);class wv{constructor(e={}){this.keyIdentifier=new Iy,Object.assign(this,e)}}ld([id({type:Iy})],wv.prototype,"keyIdentifier",void 0),ld([id({type:vp.GeneralizedTime,optional:!0})],wv.prototype,"date",void 0),ld([id({type:lv,optional:!0})],wv.prototype,"other",void 0);class Ev{constructor(e={}){this.version=ym.v4,this.kekid=new wv,this.keyEncryptionAlgorithm=new mm,this.encryptedKey=new Iy,Object.assign(this,e)}}ld([id({type:vp.Integer})],Ev.prototype,"version",void 0),ld([id({type:wv})],Ev.prototype,"kekid",void 0),ld([id({type:mm})],Ev.prototype,"keyEncryptionAlgorithm",void 0),ld([id({type:Iy})],Ev.prototype,"encryptedKey",void 0);class Sv{constructor(e={}){this.version=ym.v0,this.keyEncryptionAlgorithm=new mm,this.encryptedKey=new Iy,Object.assign(this,e)}}ld([id({type:vp.Integer})],Sv.prototype,"version",void 0),ld([id({type:bm,context:0,optional:!0})],Sv.prototype,"keyDerivationAlgorithm",void 0),ld([id({type:mm})],Sv.prototype,"keyEncryptionAlgorithm",void 0),ld([id({type:Iy})],Sv.prototype,"encryptedKey",void 0);class Cv{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Cv.prototype,"oriType",void 0),ld([id({type:vp.Any})],Cv.prototype,"oriValue",void 0);let Bv=class{constructor(e={}){Object.assign(this,e)}};var Iv;ld([id({type:bv,optional:!0})],Bv.prototype,"ktri",void 0),ld([id({type:vv,context:1,implicit:!0,optional:!0})],Bv.prototype,"kari",void 0),ld([id({type:Ev,context:2,implicit:!0,optional:!0})],Bv.prototype,"kekri",void 0),ld([id({type:Sv,context:3,implicit:!0,optional:!0})],Bv.prototype,"pwri",void 0),ld([id({type:Cv,context:4,implicit:!0,optional:!0})],Bv.prototype,"ori",void 0),Bv=ld([nd({type:mp.Choice})],Bv);let kv=Iv=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Iv.prototype)}};var Tv;kv=Iv=ld([nd({type:mp.Set,itemType:Bv})],kv);class Nv{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Nv.prototype,"otherRevInfoFormat",void 0),ld([id({type:vp.Any})],Nv.prototype,"otherRevInfo",void 0);let Uv=class{constructor(e={}){this.other=new Nv,Object.assign(this,e)}};ld([id({type:Nv,context:1,implicit:!0})],Uv.prototype,"other",void 0),Uv=ld([nd({type:mp.Choice})],Uv);let xv=Tv=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Tv.prototype)}};xv=Tv=ld([nd({type:mp.Set,itemType:Uv})],xv);class Dv{constructor(e={}){Object.assign(this,e)}}var Rv;ld([id({type:iv,context:0,implicit:!0,optional:!0})],Dv.prototype,"certs",void 0),ld([id({type:xv,context:1,implicit:!0,optional:!0})],Dv.prototype,"crls",void 0);let Pv=Rv=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Rv.prototype)}};Pv=Rv=ld([nd({type:mp.Set,itemType:wm})],Pv);class Lv{constructor(e={}){this.version=ym.v0,this.recipientInfos=new kv,this.encryptedContentInfo=new uv,Object.assign(this,e)}}ld([id({type:vp.Integer})],Lv.prototype,"version",void 0),ld([id({type:Dv,context:0,implicit:!0,optional:!0})],Lv.prototype,"originatorInfo",void 0),ld([id({type:kv})],Lv.prototype,"recipientInfos",void 0),ld([id({type:uv})],Lv.prototype,"encryptedContentInfo",void 0),ld([id({type:Pv,context:1,implicit:!0,optional:!0})],Lv.prototype,"unprotectedAttrs",void 0);const _v="1.2.840.113549.1.7.2";var Kv;let Ov=Kv=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Kv.prototype)}};Ov=Kv=ld([nd({type:mp.Set,itemType:dm})],Ov);class Mv{constructor(e={}){this.version=ym.v0,this.digestAlgorithms=new Ov,this.encapContentInfo=new ov,this.signerInfos=new Cm,Object.assign(this,e)}}ld([id({type:vp.Integer})],Mv.prototype,"version",void 0),ld([id({type:Ov})],Mv.prototype,"digestAlgorithms",void 0),ld([id({type:ov})],Mv.prototype,"encapContentInfo",void 0),ld([id({type:iv,context:0,implicit:!0,optional:!0})],Mv.prototype,"certificates",void 0),ld([id({type:xv,context:1,implicit:!0,optional:!0})],Mv.prototype,"crls",void 0),ld([id({type:Cm})],Mv.prototype,"signerInfos",void 0);const Hv="1.2.840.10045.2.1",Vv="1.2.840.10045.4.1",Fv="1.2.840.10045.4.3.1",jv="1.2.840.10045.4.3.2",Qv="1.2.840.10045.4.3.3",qv="1.2.840.10045.4.3.4",zv="1.2.840.10045.3.1.7",Gv="1.3.132.0.34",$v="1.3.132.0.35";function Wv(e){return new Zg({algorithm:e})}const Yv=Wv(Vv),Jv=(Wv(Fv),Wv(jv)),Xv=Wv(Qv),Zv=Wv(qv);let eA=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:vp.ObjectIdentifier})],eA.prototype,"fieldType",void 0),ld([id({type:vp.Any})],eA.prototype,"parameters",void 0),eA=ld([nd({type:mp.Sequence})],eA);let tA=class{constructor(e={}){Object.assign(this,e)}};var rA;ld([id({type:vp.OctetString})],tA.prototype,"a",void 0),ld([id({type:vp.OctetString})],tA.prototype,"b",void 0),ld([id({type:vp.BitString,optional:!0})],tA.prototype,"seed",void 0),tA=ld([nd({type:mp.Sequence})],tA),function(e){e[e.ecpVer1=1]="ecpVer1"}(rA||(rA={}));let nA=class{constructor(e={}){this.version=rA.ecpVer1,Object.assign(this,e)}};ld([id({type:vp.Integer})],nA.prototype,"version",void 0),ld([id({type:eA})],nA.prototype,"fieldID",void 0),ld([id({type:tA})],nA.prototype,"curve",void 0),ld([id({type:class extends Iy{}})],nA.prototype,"base",void 0),ld([id({type:vp.Integer,converter:Uy})],nA.prototype,"order",void 0),ld([id({type:vp.Integer,optional:!0})],nA.prototype,"cofactor",void 0),nA=ld([nd({type:mp.Sequence})],nA);let iA=class{constructor(e={}){Object.assign(this,e)}};ld([id({type:vp.ObjectIdentifier})],iA.prototype,"namedCurve",void 0),ld([id({type:vp.Null})],iA.prototype,"implicitCurve",void 0),ld([id({type:nA})],iA.prototype,"specifiedCurve",void 0),iA=ld([nd({type:mp.Choice})],iA);class sA{constructor(e={}){this.version=1,this.privateKey=new Iy,Object.assign(this,e)}}ld([id({type:vp.Integer})],sA.prototype,"version",void 0),ld([id({type:Iy})],sA.prototype,"privateKey",void 0),ld([id({type:iA,context:0,optional:!0})],sA.prototype,"parameters",void 0),ld([id({type:vp.BitString,context:1,optional:!0})],sA.prototype,"publicKey",void 0);class aA{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.Integer,converter:Uy})],aA.prototype,"r",void 0),ld([id({type:vp.Integer,converter:Uy})],aA.prototype,"s",void 0);const oA="1.2.840.113549.1.1",cA=`${oA}.1`,uA=`${oA}.7`,lA=`${oA}.9`,hA=`${oA}.10`,fA=`${oA}.2`,pA=`${oA}.4`,yA=`${oA}.5`,dA=`${oA}.14`,gA=`${oA}.11`,mA=`${oA}.12`,vA=`${oA}.13`,AA=`${oA}.15`,bA=`${oA}.16`,wA="1.3.14.3.2.26",EA="2.16.840.1.101.3.4.2.4",SA="2.16.840.1.101.3.4.2.1",CA="2.16.840.1.101.3.4.2.2",BA="2.16.840.1.101.3.4.2.3",IA=`${oA}.8`;function kA(e){return new Zg({algorithm:e,parameters:null})}kA("1.2.840.113549.2.2"),kA("1.2.840.113549.2.5");const TA=kA(wA),NA=(kA(EA),kA(SA),kA(CA),kA(BA),kA("2.16.840.1.101.3.4.2.5"),kA("2.16.840.1.101.3.4.2.6"),new Zg({algorithm:IA,parameters:ud.serialize(TA)})),UA=new Zg({algorithm:lA,parameters:ud.serialize(Py.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});kA(cA),kA(fA),kA(pA),kA(yA),kA(AA),kA(bA),kA(mA),kA(vA),kA(AA),kA(bA);class xA{constructor(e={}){this.hashAlgorithm=new Zg(TA),this.maskGenAlgorithm=new Zg({algorithm:IA,parameters:ud.serialize(TA)}),this.pSourceAlgorithm=new Zg(UA),Object.assign(this,e)}}ld([id({type:Zg,context:0,defaultValue:TA})],xA.prototype,"hashAlgorithm",void 0),ld([id({type:Zg,context:1,defaultValue:NA})],xA.prototype,"maskGenAlgorithm",void 0),ld([id({type:Zg,context:2,defaultValue:UA})],xA.prototype,"pSourceAlgorithm",void 0),new Zg({algorithm:uA,parameters:ud.serialize(new xA)});class DA{constructor(e={}){this.hashAlgorithm=new Zg(TA),this.maskGenAlgorithm=new Zg({algorithm:IA,parameters:ud.serialize(TA)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}ld([id({type:Zg,context:0,defaultValue:TA})],DA.prototype,"hashAlgorithm",void 0),ld([id({type:Zg,context:1,defaultValue:NA})],DA.prototype,"maskGenAlgorithm",void 0),ld([id({type:vp.Integer,context:2,defaultValue:20})],DA.prototype,"saltLength",void 0),ld([id({type:vp.Integer,context:3,defaultValue:1})],DA.prototype,"trailerField",void 0),new Zg({algorithm:hA,parameters:ud.serialize(new DA)});class RA{constructor(e={}){this.digestAlgorithm=new Zg,this.digest=new Iy,Object.assign(this,e)}}var PA;ld([id({type:Zg})],RA.prototype,"digestAlgorithm",void 0),ld([id({type:Iy})],RA.prototype,"digest",void 0);class LA{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.Integer,converter:Uy})],LA.prototype,"prime",void 0),ld([id({type:vp.Integer,converter:Uy})],LA.prototype,"exponent",void 0),ld([id({type:vp.Integer,converter:Uy})],LA.prototype,"coefficient",void 0);let _A=PA=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,PA.prototype)}};_A=PA=ld([nd({type:mp.Sequence,itemType:LA})],_A);class KA{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.Integer})],KA.prototype,"version",void 0),ld([id({type:vp.Integer,converter:Uy})],KA.prototype,"modulus",void 0),ld([id({type:vp.Integer,converter:Uy})],KA.prototype,"publicExponent",void 0),ld([id({type:vp.Integer,converter:Uy})],KA.prototype,"privateExponent",void 0),ld([id({type:vp.Integer,converter:Uy})],KA.prototype,"prime1",void 0),ld([id({type:vp.Integer,converter:Uy})],KA.prototype,"prime2",void 0),ld([id({type:vp.Integer,converter:Uy})],KA.prototype,"exponent1",void 0),ld([id({type:vp.Integer,converter:Uy})],KA.prototype,"exponent2",void 0),ld([id({type:vp.Integer,converter:Uy})],KA.prototype,"coefficient",void 0),ld([id({type:_A,optional:!0})],KA.prototype,"otherPrimeInfos",void 0);class OA{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}var MA;ld([id({type:vp.Integer,converter:Uy})],OA.prototype,"modulus",void 0),ld([id({type:vp.Integer,converter:Uy})],OA.prototype,"publicExponent",void 0),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(MA||(MA={}));const HA=MA;var VA=function(e,t){return VA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},VA(e,t)};function FA(e,t){function r(){this.constructor=e}VA(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function jA(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function QA(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}function qA(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(QA(arguments[t]));return e}function zA(e){return!!e.useClass}function GA(e){return!!e.useFactory}var $A=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(t=e(r.wrap()),n=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(r){t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t[0]=e(),Reflect[r].apply(void 0,qA(t))}})),t},e}();function WA(e){return"string"==typeof e||"symbol"==typeof e}function YA(e){return"object"==typeof e&&"token"in e&&"transform"in e}function JA(e){return!!e.useToken}function XA(e){return null!=e.useValue}const ZA=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),eb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return FA(t,e),t}(ZA),tb=function(){this.scopedResolutions=new Map};var rb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return FA(t,e),t}(ZA),nb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return FA(t,e),t}(ZA);const ib=function(){this.preResolution=new rb,this.postResolution=new nb};var sb=new Map,ab=function(){function e(e){this.parent=e,this._registry=new eb,this.interceptors=new ib,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,r){var n;if(void 0===r&&(r={lifecycle:HA.Transient}),this.ensureNotDisposed(),n=function(e){return zA(e)||XA(e)||JA(e)||GA(e)}(t)?t:{useClass:t},JA(n))for(var i=[e],s=n;null!=s;){var a=s.useToken;if(i.includes(a))throw new Error("Token registration cycle detected! "+qA(i,[a]).join(" -> "));i.push(a);var o=this._registry.get(a);s=o&&JA(o.provider)?o.provider:null}if((r.lifecycle===HA.Singleton||r.lifecycle==HA.ContainerScoped||r.lifecycle==HA.ResolutionScoped)&&(XA(n)||GA(n)))throw new Error('Cannot use lifecycle "'+HA[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:r}),this},e.prototype.registerType=function(e,t){return this.ensureNotDisposed(),WA(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),WA(e)){if(WA(t))return this.register(e,{useToken:t},{lifecycle:HA.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:HA.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!WA(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:HA.Singleton})},e.prototype.resolve=function(e,t,r){void 0===t&&(t=new tb),void 0===r&&(r=!1),this.ensureNotDisposed();var n=this.getRegistration(e);if(!n&&WA(e)){if(r)return;throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"Single"),n){var i=this.resolveRegistration(n,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}if(function(e){return"function"==typeof e||e instanceof $A}(e))return i=this.construct(e,t),this.executePostResolutionInterceptor(e,i,"Single"),i;throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,n;if(this.interceptors.preResolution.has(e)){var i=[];try{for(var s=jA(this.interceptors.preResolution.getAll(e)),a=s.next();!a.done;a=s.next()){var o=a.value;"Once"!=o.options.frequency&&i.push(o),o.callback(e,t)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,i)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var n,i;if(this.interceptors.postResolution.has(e)){var s=[];try{for(var a=jA(this.interceptors.postResolution.getAll(e)),o=a.next();!o.done;o=a.next()){var c=o.value;"Once"!=c.options.frequency&&s.push(c),c.callback(e,t,r)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,s)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===HA.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,n=e.options.lifecycle===HA.Singleton,i=e.options.lifecycle===HA.ContainerScoped,s=n||i;return r=XA(e.provider)?e.provider.useValue:JA(e.provider)?s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):zA(e.provider)?s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):GA(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===HA.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t,r){var n=this;void 0===t&&(t=new tb),void 0===r&&(r=!1),this.ensureNotDisposed();var i=this.getAllRegistrations(e);if(!i&&WA(e)){if(r)return[];throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"All"),i){var s=i.map((function(e){return n.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,s,"All"),s}var a=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,a,"All"),a},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var r=jA(this._registry.entries()),n=r.next();!n.done;n=r.next()){var i=QA(n.value,2),s=i[0],a=i[1];this._registry.setAll(s,a.filter((function(e){return!XA(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,r;this.ensureNotDisposed();var n=new e(this);try{for(var i=jA(this._registry.entries()),s=i.next();!s.done;s=i.next()){var a=QA(s.value,2),o=a[0],c=a[1];c.some((function(e){return e.options.lifecycle===HA.ContainerScoped}))&&n._registry.setAll(o,c.map((function(e){return e.options.lifecycle===HA.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.dispose=function(){return function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var e;return function(e,t){var r,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}(this,(function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach((function(t){var r=t.dispose();r&&e.push(r)})),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof $A)return e.createProxy((function(e){return r.resolve(e,t)}));var n,i=function(){var n=sb.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var i=n.map(r.resolveParams(t,e));return new(e.bind.apply(e,qA([void 0],i)))}();return"function"!=typeof(n=i).dispose||n.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var r=this;return function(n,i){var s,a,o,c;try{return"object"==typeof(c=n)&&"token"in c&&"multiple"in c?YA(n)?n.multiple?(s=r.resolve(n.transform)).transform.apply(s,qA([r.resolveAll(n.token,new tb,n.isOptional)],n.transformArgs)):(a=r.resolve(n.transform)).transform.apply(a,qA([r.resolve(n.token,e,n.isOptional)],n.transformArgs)):n.multiple?r.resolveAll(n.token,new tb,n.isOptional):r.resolve(n.token,e,n.isOptional):YA(n)?(o=r.resolve(n.transform,e)).transform.apply(o,qA([r.resolve(n.token,e)],n.transformArgs)):r.resolve(n,e)}catch(e){throw new Error(function(e,t,r){var n,i,s=QA(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1];return function(e,t,r){return void 0===r&&(r="    "),qA([e],t.message.split("\n").map((function(e){return r+e}))).join("\n")}("Cannot inject the dependency "+(i=t,(null===(n=void 0===s?null:s)?"at position #"+i:'"'+n.split(",")[i].trim()+'" at position #'+i)+' of "')+e.name+'" constructor. Reason:',r)}(t,i,e))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},e}(),ob=new ab;const cb=function(e){return function(t){sb.set(t,function(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],r=Reflect.getOwnMetadata("injectionTokens",e)||{};return Object.keys(r).forEach((function(e){t[+e]=r[e]})),t}(t)),e&&e.token&&(Array.isArray(e.token)?e.token.forEach((function(e){ob.register(e,t)})):ob.register(e.token,t))}};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var ub;class lb{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}ld([id({type:vp.ObjectIdentifier})],lb.prototype,"attrId",void 0),ld([id({type:vp.Any,repeated:"set"})],lb.prototype,"attrValues",void 0);let hb=ub=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,ub.prototype)}};var fb;hb=ub=ld([nd({type:mp.Sequence,itemType:lb})],hb);let pb=fb=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,fb.prototype)}};pb=fb=ld([nd({type:mp.Sequence,itemType:sv})],pb);class yb{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],yb.prototype,"certId",void 0),ld([id({type:vp.Any,context:0})],yb.prototype,"certValue",void 0);class db{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],db.prototype,"crlId",void 0),ld([id({type:vp.Any,context:0})],db.prototype,"crltValue",void 0);class gb extends Iy{}class mb{constructor(e={}){this.encryptionAlgorithm=new Zg,this.encryptedData=new gb,Object.assign(this,e)}}var vb,Ab;ld([id({type:Zg})],mb.prototype,"encryptionAlgorithm",void 0),ld([id({type:gb})],mb.prototype,"encryptedData",void 0),function(e){e[e.v1=0]="v1"}(Ab||(Ab={}));class bb extends Iy{}let wb=vb=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,vb.prototype)}};wb=vb=ld([nd({type:mp.Sequence,itemType:Fg})],wb);class Eb{constructor(e={}){this.version=Ab.v1,this.privateKeyAlgorithm=new Zg,this.privateKey=new bb,Object.assign(this,e)}}ld([id({type:vp.Integer})],Eb.prototype,"version",void 0),ld([id({type:Zg})],Eb.prototype,"privateKeyAlgorithm",void 0),ld([id({type:bb})],Eb.prototype,"privateKey",void 0),ld([id({type:wb,implicit:!0,context:0,optional:!0})],Eb.prototype,"attributes",void 0);let Sb=class extends Eb{};Sb=ld([nd({type:mp.Sequence})],Sb);let Cb=class extends mb{};Cb=ld([nd({type:mp.Sequence})],Cb);class Bb{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Bb.prototype,"secretTypeId",void 0),ld([id({type:vp.Any,context:0})],Bb.prototype,"secretValue",void 0);class Ib{constructor(e={}){this.mac=new RA,this.macSalt=new Iy,this.iterations=1,Object.assign(this,e)}}ld([id({type:RA})],Ib.prototype,"mac",void 0),ld([id({type:Iy})],Ib.prototype,"macSalt",void 0),ld([id({type:vp.Integer,defaultValue:1})],Ib.prototype,"iterations",void 0);class kb{constructor(e={}){this.version=3,this.authSafe=new sv,this.macData=new Ib,Object.assign(this,e)}}var Tb;ld([id({type:vp.Integer})],kb.prototype,"version",void 0),ld([id({type:sv})],kb.prototype,"authSafe",void 0),ld([id({type:Ib,optional:!0})],kb.prototype,"macData",void 0);class Nb{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:vp.ObjectIdentifier})],Nb.prototype,"bagId",void 0),ld([id({type:vp.Any,context:0})],Nb.prototype,"bagValue",void 0),ld([id({type:lb,repeated:"set",optional:!0})],Nb.prototype,"bagAttributes",void 0);let Ub=Tb=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Tb.prototype)}};var xb,Db,Rb;Ub=Tb=ld([nd({type:mp.Sequence,itemType:Nb})],Ub);const Pb="1.2.840.113549.1.9",Lb=`${Pb}.7`,_b=`${Pb}.14`;let Kb=class extends dd{constructor(e={}){super(e)}toString(){return{}.toString(),this.ia5String||super.toString()}};ld([id({type:vp.IA5String})],Kb.prototype,"ia5String",void 0),Kb=ld([nd({type:mp.Choice})],Kb);let Ob=class extends sv{};Ob=ld([nd({type:mp.Sequence})],Ob);let Mb=class extends kb{};Mb=ld([nd({type:mp.Sequence})],Mb);let Hb=class extends mb{};Hb=ld([nd({type:mp.Sequence})],Hb);let Vb=class{constructor(e=""){this.value=e}toString(){return this.value}};ld([id({type:vp.IA5String})],Vb.prototype,"value",void 0),Vb=ld([nd({type:mp.Choice})],Vb);let Fb=class extends Kb{};Fb=ld([nd({type:mp.Choice})],Fb);let jb=class extends dd{};jb=ld([nd({type:mp.Choice})],jb);let Qb=class{constructor(e=new Date){this.value=e}};ld([id({type:vp.GeneralizedTime})],Qb.prototype,"value",void 0),Qb=ld([nd({type:mp.Choice})],Qb);let qb=class extends dd{};qb=ld([nd({type:mp.Choice})],qb);let zb=class{constructor(e="M"){this.value=e}toString(){return this.value}};ld([id({type:vp.PrintableString})],zb.prototype,"value",void 0),zb=ld([nd({type:mp.Choice})],zb);let Gb=class{constructor(e=""){this.value=e}toString(){return this.value}};ld([id({type:vp.PrintableString})],Gb.prototype,"value",void 0),Gb=ld([nd({type:mp.Choice})],Gb);let $b=class extends Gb{};$b=ld([nd({type:mp.Choice})],$b);let Wb=class extends dd{};Wb=ld([nd({type:mp.Choice})],Wb);let Yb=class{constructor(e=""){this.value=e}toString(){return this.value}};ld([id({type:vp.ObjectIdentifier})],Yb.prototype,"value",void 0),Yb=ld([nd({type:mp.Choice})],Yb);let Jb=class extends tm{};Jb=ld([nd({type:mp.Choice})],Jb);let Xb=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};ld([id({type:vp.Integer})],Xb.prototype,"value",void 0),Xb=ld([nd({type:mp.Choice})],Xb);let Zb=class extends Sm{};Zb=ld([nd({type:mp.Sequence})],Zb);let ew=class extends dd{};ew=ld([nd({type:mp.Choice})],ew);let tw=xb=class extends sm{constructor(e){super(e),Object.setPrototypeOf(this,xb.prototype)}};tw=xb=ld([nd({type:mp.Sequence})],tw);let rw=Db=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Db.prototype)}};rw=Db=ld([nd({type:mp.Set,itemType:wm})],rw);let nw=class{constructor(e=""){this.value=e}toString(){return this.value}};ld([id({type:vp.BmpString})],nw.prototype,"value",void 0),nw=ld([nd({type:mp.Choice})],nw);let iw=class extends Zg{};iw=ld([nd({type:mp.Sequence})],iw);let sw=Rb=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,Rb.prototype)}};var aw;sw=Rb=ld([nd({type:mp.Sequence,itemType:iw})],sw);let ow=aw=class extends cd{constructor(e){super(e),Object.setPrototypeOf(this,aw.prototype)}};ow=aw=ld([nd({type:mp.Sequence,itemType:Fg})],ow);class cw{constructor(e={}){this.version=0,this.subject=new bd,this.subjectPKInfo=new em,this.attributes=new ow,Object.assign(this,e)}}ld([id({type:vp.Integer})],cw.prototype,"version",void 0),ld([id({type:bd})],cw.prototype,"subject",void 0),ld([id({type:em})],cw.prototype,"subjectPKInfo",void 0),ld([id({type:ow,implicit:!0,context:0})],cw.prototype,"attributes",void 0);class uw{constructor(e={}){this.certificationRequestInfo=new cw,this.signatureAlgorithm=new Zg,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}ld([id({type:cw})],uw.prototype,"certificationRequestInfo",void 0),ld([id({type:Zg})],uw.prototype,"signatureAlgorithm",void 0),ld([id({type:vp.BitString})],uw.prototype,"signature",void 0);const lw="crypto.algorithm",hw="crypto.algorithmProvider";var fw;ob.registerSingleton(hw,class{getAlgorithms(){return ob.resolveAll(lw)}toAsnAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toAsnAlgorithm(e);if(r)return r}if(/^[0-9.]+$/.test(e.name)){const t=new Zg({algorithm:e.name});if("parameters"in e){const r=e;t.parameters=r.parameters}return t}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});const pw="1.3.36.3.3.2.8.1.1",yw=`${pw}.1`,dw=`${pw}.2`,gw=`${pw}.3`,mw=`${pw}.4`,vw=`${pw}.5`,Aw=`${pw}.6`,bw=`${pw}.7`,ww=`${pw}.8`,Ew=`${pw}.9`,Sw=`${pw}.10`,Cw=`${pw}.11`,Bw=`${pw}.12`,Iw=`${pw}.13`,kw=`${pw}.14`,Tw="brainpoolP160r1",Nw="brainpoolP160t1",Uw="brainpoolP192r1",xw="brainpoolP192t1",Dw="brainpoolP224r1",Rw="brainpoolP224t1",Pw="brainpoolP256r1",Lw="brainpoolP256t1",_w="brainpoolP320r1",Kw="brainpoolP320t1",Ow="brainpoolP384r1",Mw="brainpoolP384t1",Hw="brainpoolP512r1",Vw="brainpoolP512t1",Fw="ECDSA";let jw=fw=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===Fw.toLowerCase())if("hash"in e)switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return Yv;case"sha-256":return Jv;case"sha-384":return Xv;case"sha-512":return Zv}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=zv;break;case"K-256":t=fw.SECP256K1;break;case"P-384":t=Gv;break;case"P-521":t=$v;break;case Tw:t=yw;break;case Nw:t=dw;break;case Uw:t=gw;break;case xw:t=mw;break;case Dw:t=vw;break;case Rw:t=Aw;break;case Pw:t=bw;break;case Lw:t=ww;break;case _w:t=Ew;break;case Kw:t=Sw;break;case Ow:t=Cw;break;case Mw:t=Bw;break;case Hw:t=Iw;break;case Vw:t=kw}if(t)return new Zg({algorithm:Hv,parameters:ud.serialize(new iA({namedCurve:t}))})}return null}toWebAlgorithm(e){switch(e.algorithm){case Vv:return{name:Fw,hash:{name:"SHA-1"}};case jv:return{name:Fw,hash:{name:"SHA-256"}};case Qv:return{name:Fw,hash:{name:"SHA-384"}};case qv:return{name:Fw,hash:{name:"SHA-512"}};case Hv:if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(ud.parse(e.parameters,iA).namedCurve){case zv:return{name:Fw,namedCurve:"P-256"};case fw.SECP256K1:return{name:Fw,namedCurve:"K-256"};case Gv:return{name:Fw,namedCurve:"P-384"};case $v:return{name:Fw,namedCurve:"P-521"};case yw:return{name:Fw,namedCurve:Tw};case dw:return{name:Fw,namedCurve:Nw};case gw:return{name:Fw,namedCurve:Uw};case mw:return{name:Fw,namedCurve:xw};case vw:return{name:Fw,namedCurve:Dw};case Aw:return{name:Fw,namedCurve:Rw};case bw:return{name:Fw,namedCurve:Pw};case ww:return{name:Fw,namedCurve:Lw};case Ew:return{name:Fw,namedCurve:_w};case Sw:return{name:Fw,namedCurve:Kw};case Cw:return{name:Fw,namedCurve:Ow};case Bw:return{name:Fw,namedCurve:Mw};case Iw:return{name:Fw,namedCurve:Hw};case kw:return{name:Fw,namedCurve:Vw}}}return null}};jw.SECP256K1="1.3.132.0.10",jw=fw=ld([cb()],jw),ob.registerSingleton(lw,jw);const Qw=Symbol("name"),qw=Symbol("value");class zw{constructor(e,t={},r=""){this[Qw]=e,this[qw]=r;for(const e in t)this[e]=t[e]}}zw.NAME=Qw,zw.VALUE=qw;class Gw{static toString(e){return this.items[e]||e}}Gw.items={[wA]:"sha1",[EA]:"sha224",[SA]:"sha256",[CA]:"sha384",[BA]:"sha512",[cA]:"rsaEncryption",[yA]:"sha1WithRSAEncryption",[dA]:"sha224WithRSAEncryption",[gA]:"sha256WithRSAEncryption",[mA]:"sha384WithRSAEncryption",[vA]:"sha512WithRSAEncryption",[Hv]:"ecPublicKey",[Vv]:"ecdsaWithSHA1",[Fv]:"ecdsaWithSHA224",[jv]:"ecdsaWithSHA256",[Qv]:"ecdsaWithSHA384",[qv]:"ecdsaWithSHA512",[vg]:"TLS WWW server authentication",[Ag]:"TLS WWW client authentication",[bg]:"Code Signing",[wg]:"E-mail Protection",[Eg]:"Time Stamping",[Sg]:"OCSP Signing",[_v]:"Signed Data"};class $w{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){const r=[];let n=this.pad(t++),i="";const s=e[zw.VALUE];s&&(i=` ${s}`),r.push(`${n}${e[zw.NAME]}:${i}`),n=this.pad(t);for(const i in e){if("symbol"==typeof i)continue;const s=e[i],a=i?`${i}: `:"";if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)r.push(`${n}${a}${s}`);else if(s instanceof Date)r.push(`${n}${a}${s.toUTCString()}`);else if(Array.isArray(s))for(const e of s)e[zw.NAME]=i,r.push(...this.serializeObj(e,t));else if(s instanceof zw)s[zw.NAME]=i,r.push(...this.serializeObj(s,t));else if(Zh._H.isBufferSource(s))i?(r.push(`${n}${a}`),r.push(...this.serializeBufferSource(s,t+1))):r.push(...this.serializeBufferSource(s,t));else{if(!("toTextObject"in s))throw new TypeError("Cannot serialize data in text format. Unsupported type.");{const e=s.toTextObject();e[zw.NAME]=i,r.push(...this.serializeObj(e,t))}}}return r}static serializeBufferSource(e,t=0){const r=this.pad(t),n=Zh._H.toUint8Array(e),i=[];for(let e=0;e<n.length;){const t=[];for(let r=0;r<16&&e<n.length;r++){8===r&&t.push("");const i=n[e++].toString(16).padStart(2,"0");t.push(i)}i.push(`${r}${t.join(" ")}`)}return i}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}$w.oidSerializer=Gw,$w.algorithmSerializer=class{static toTextObject(e){const t=new zw("Algorithm Identifier",{},Gw.toString(e.algorithm));if(e.parameters)switch(e.algorithm){case Hv:{const r=(new jw).toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters;break}default:t.Parameters=e.parameters}return t}};class Ww{constructor(...e){if(1===e.length){const t=e[0];this.rawData=ud.serialize(t),this.onInit(t)}else{const t=ud.parse(e[0],e[1]);this.rawData=Zh._H.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof Ww&&(0,Zh.n4)(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return ud.toString(this.rawData);case"text":return $w.serialize(this.toTextObject());case"hex":return Zh.U$.ToHex(this.rawData);case"base64":return Zh.U$.ToBase64(this.rawData);case"base64url":return Zh.U$.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new zw(this.getTextName(),{},e)}}Ww.NAME="ASN";class Yw extends Ww{constructor(...e){let t;t=Zh._H.isBufferSource(e[0])?Zh._H.toArrayBuffer(e[0]):ud.serialize(new im({extnID:e[0],critical:e[1],extnValue:new Iy(Zh._H.toArrayBuffer(e[2]))})),super(t,im)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[zw.NAME]===Yw.NAME&&(e[zw.NAME]=Gw.toString(this.type)),e}}var Jw;class Xw{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}constructor(){this.items=new Map,this[Jw]="CryptoProvider","undefined"!=typeof self&&"undefined"!=typeof crypto?this.set(Xw.DEFAULT,crypto):void 0!==__webpack_require__.g&&__webpack_require__.g.crypto&&__webpack_require__.g.crypto.subtle&&this.set(Xw.DEFAULT,__webpack_require__.g.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=Xw.DEFAULT){const t=this.items.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw new TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(Xw.DEFAULT,e);return this}}Jw=Symbol.toStringTag,Xw.DEFAULT="default";const Zw=new Xw,eE=/^[0-2](?:\.[1-9][0-9]*)+$/;class tE{constructor(e={}){this.items={};for(const t in e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return t=e,new RegExp(eE).test(t)?e:this.get(e);var t}register(e,t){this.items[e]=t,this.items[t]=e}}const rE=new tE;function nE(e,t){return`\\${Zh.U$.ToHex(Zh.U$.FromUtf8String(t)).toUpperCase()}`}rE.register("CN","2.5.4.3"),rE.register("L","2.5.4.7"),rE.register("ST","2.5.4.8"),rE.register("O","2.5.4.10"),rE.register("OU","2.5.4.11"),rE.register("C","2.5.4.6"),rE.register("DC","0.9.2342.19200300.100.1.25"),rE.register("E","1.2.840.113549.1.9.1"),rE.register("G","2.5.4.42"),rE.register("I","2.5.4.43"),rE.register("SN","2.5.4.4"),rE.register("T","2.5.4.12");class iE{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,t={}){this.extraNames=new tE,this.asn=new bd;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof bd?this.asn=e:Zh._H.isBufferSource(e)?this.asn=ud.parse(e,bd):this.asn=this.fromJSON(e)}getField(e){const t=this.extraNames.findId(e)||rE.findId(e),r=[];for(const e of this.asn)for(const n of e)n.type===t&&r.push(n.value.toString());return r}getName(e){return this.extraNames.get(e)||rE.get(e)}toString(){return this.asn.map((e=>e.map((e=>`${this.getName(e.type)||e.type}=${e.value.anyValue?`#${Zh.U$.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,nE)}`)).join("+"))).join(", ")}toJSON(){var e;const t=[];for(const r of this.asn){const n={};for(const t of r){const r=this.getName(t.type)||t.type;null!==(e=n[r])&&void 0!==e||(n[r]=[]),n[r].push(t.value.anyValue?`#${Zh.U$.ToHex(t.value.anyValue)}`:t.value.toString())}t.push(n)}return t}fromString(e){const t=new bd,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let n=null,i=",";for(;n=r.exec(`${e},`);){let[,e,r]=n;const s=r[r.length-1];","!==s&&"+"!==s||(r=r.slice(0,r.length-1),n[3]=s);const a=n[3];e=this.getTypeOid(e);const o=this.createAttribute(e,r);"+"===i?t[t.length-1].push(o):t.push(new vd([o])),i=a}return t}fromJSON(e){const t=new bd;for(const r of e){const e=new vd;for(const t in r){const n=this.getTypeOid(t),i=r[t];for(const t of i){const r=this.createAttribute(n,t);e.push(r)}}t.push(e)}return t}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,t){const r=new md({type:e});if("object"==typeof t)for(const e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else if("#"===t[0])r.value.anyValue=Zh.U$.FromHex(t.slice(1));else{const n=this.processStringValue(t);e===this.getName("E")||e===this.getName("DC")?r.value.ia5String=n:iE.isPrintableString(n)?r.value.printableString=n:r.value.utf8String=n}return r}processStringValue(e){const t=/"(.*?[^\\])?"/.exec(e);return t&&(e=t[1]),e.replace(/\\0a/gi,"\n").replace(/\\0d/gi,"\r").replace(/\\0g/gi,"\t").replace(/\\(.)/g,"$1")}toArrayBuffer(){return ud.serialize(this.asn)}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||Zw.get()):r=e[0]||Zw.get(),await r.subtle.digest(n,this.toArrayBuffer())}}const sE="Cannot initialize GeneralName from ASN.1 data.",aE=`${sE} Unsupported string format in use.`,oE=`${sE} Value doesn't match to GUID regular expression.`,cE=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,uE="1.3.6.1.4.1.311.25.1",lE="1.3.6.1.4.1.311.20.2.3",hE="dns",fE="dn",pE="email",yE="ip",dE="url",gE="guid",mE="upn",vE="id";class AE extends Ww{constructor(...e){let t;if(2===e.length)switch(e[0]){case fE:{const r=new iE(e[1]).toArrayBuffer(),n=ud.parse(r,bd);t=new Cd({directoryName:n});break}case hE:t=new Cd({dNSName:e[1]});break;case pE:t=new Cd({rfc822Name:e[1]});break;case gE:{const r=new RegExp(cE,"i").exec(e[1]);if(!r)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const n=r.slice(1).map(((e,t)=>t<3?Zh.U$.ToHex(new Uint8Array(Zh.U$.FromHex(e)).reverse()):e)).join("");t=new Cd({otherName:new Ed({typeId:uE,value:ud.serialize(new Iy(Zh.U$.FromHex(n)))})});break}case yE:t=new Cd({iPAddress:e[1]});break;case vE:t=new Cd({registeredID:e[1]});break;case mE:t=new Cd({otherName:new Ed({typeId:lE,value:ud.serialize(Ky.toASN(e[1]))})});break;case dE:t=new Cd({uniformResourceIdentifier:e[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else t=Zh._H.isBufferSource(e[0])?ud.parse(e[0],Cd):e[0];super(t)}onInit(e){if(null!=e.dNSName)this.type=hE,this.value=e.dNSName;else if(null!=e.rfc822Name)this.type=pE,this.value=e.rfc822Name;else if(null!=e.iPAddress)this.type=yE,this.value=e.iPAddress;else if(null!=e.uniformResourceIdentifier)this.type=dE,this.value=e.uniformResourceIdentifier;else if(null!=e.registeredID)this.type=vE,this.value=e.registeredID;else if(null!=e.directoryName)this.type=fE,this.value=new iE(e.directoryName).toString();else{if(null==e.otherName)throw new Error(aE);if(e.otherName.typeId===uE){this.type=gE;const t=ud.parse(e.otherName.value,Iy),r=new RegExp(cE,"i").exec(Zh.U$.ToHex(t));if(!r)throw new Error(oE);this.value=r.slice(1).map(((e,t)=>t<3?Zh.U$.ToHex(new Uint8Array(Zh.U$.FromHex(e)).reverse()):e)).join("-")}else{if(e.otherName.typeId!==lE)throw new Error(aE);this.type=mE,this.value=ud.parse(e.otherName.value,dd).toString()}}}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case fE:case hE:case gE:case yE:case vE:case mE:case dE:e=this.type.toUpperCase();break;case pE:e="Email";break;default:throw new Error("Unsupported GeneralName type")}let t=this.value;return this.type===vE&&(t=Gw.toString(t)),new zw(e,void 0,t)}}class bE extends Ww{constructor(e){let t;if(e instanceof jd)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof Cd)r.push(t);else{const e=ud.parse(new AE(t.type,t.value).rawData,Cd);r.push(e)}t=new jd(r)}else{if(!Zh._H.isBufferSource(e))throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");t=ud.parse(e,jd)}super(t)}onInit(e){const t=[];for(const r of e){let e=null;try{e=new AE(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map((e=>e.toJSON()))}toTextObject(){const e=super.toTextObjectEmpty();for(const t of this.items){const r=t.toTextObject();let n=e[r[zw.NAME]];Array.isArray(n)||(n=[],e[r[zw.NAME]]=n),n.push(r)}return e}}bE.NAME="GeneralNames";const wE="-{5}",EE="\\n",SE="\\n",CE=`${wE}BEGIN ([^${EE}]+(?=${wE}))${wE}${SE}(?:((?:[^:${EE}]+: (?:[^${EE}]+${SE}(?: +[^${EE}]+${SE})*))+))?${SE}?((?:[a-zA-Z0-9=+/]+${SE})+)${wE}END \\1${wE}`;class BE{static isPem(e){return"string"==typeof e&&new RegExp(CE,"g").test(e.replace(/\r/g,""))}static decodeWithHeaders(e){e=e.replace(/\r/g,"");const t=new RegExp(CE,"g"),r=[];let n=null;for(;n=t.exec(e);){const e=n[3].replace(new RegExp(`[${EE}]+`,"g"),""),t={type:n[1],headers:[],rawData:Zh.U$.FromBase64(e)},i=n[2];if(i){const e=i.split(new RegExp(SE,"g"));let r=null;for(const n of e){const[e,i]=n.split(/:(.*)/);if(void 0===i){if(!r)throw new Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:i.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map((e=>e.rawData))}static decodeFirst(e){const t=this.decode(e);if(!t.length)throw new RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){const r=new Array;return t?e.forEach((e=>{if(!Zh._H.isBufferSource(e))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:Zh._H.toArrayBuffer(e)}))})):e.forEach((e=>{if(!("type"in e))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))})),r.join("\n")}if(!t)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:Zh._H.toArrayBuffer(e)})}static encodeStruct(e){var t;const r=e.type.toLocaleUpperCase(),n=[];if(n.push(`-----BEGIN ${r}-----`),null===(t=e.headers)||void 0===t?void 0:t.length){for(const t of e.headers)n.push(`${t.key}: ${t.value}`);n.push("")}const i=Zh.U$.ToBase64(e.rawData);let s,a=0;const o=Array();for(;a<i.length&&(i.length-a<64?s=i.substring(a):(s=i.substring(a,a+64),a+=64),0!==s.length)&&(o.push(s),!(s.length<64)););return n.push(...o),n.push(`-----END ${r}-----`),n.join("\n")}}BE.CertificateTag="CERTIFICATE",BE.CrlTag="CRL",BE.CertificateRequestTag="CERTIFICATE REQUEST",BE.PublicKeyTag="PUBLIC KEY",BE.PrivateKeyTag="PRIVATE KEY";class IE extends Ww{static isAsnEncoded(e){return Zh._H.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e){if(BE.isPem(e))return BE.decode(e)[0];if(Zh.U$.isHex(e))return Zh.U$.FromHex(e);if(Zh.U$.isBase64(e))return Zh.U$.FromBase64(e);if(Zh.U$.isBase64Url(e))return Zh.U$.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}{const t=Zh.U$.ToBinary(e);return BE.isPem(t)?BE.decode(t)[0]:Zh.U$.isHex(t)?Zh.U$.FromHex(t):Zh.U$.isBase64(t)?Zh.U$.FromBase64(t):Zh.U$.isBase64Url(t)?Zh.U$.FromBase64Url(t):Zh._H.toArrayBuffer(e)}}constructor(...e){IE.isAsnEncoded(e[0])?super(IE.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?BE.encode(this.rawData,this.tag):super.toString(e)}}class kE extends IE{static async create(e,t=Zw.get()){if(e instanceof kE)return e;if(Xw.isCryptoKey(e)){if("public"!==e.type)throw new TypeError("Public key is required");const r=await t.subtle.exportKey("spki",e);return new kE(r)}if(e.publicKey)return e.publicKey;if(Zh._H.isBufferSource(e))return new kE(e);throw new TypeError("Unsupported PublicKeyType")}constructor(e){IE.isAsnEncoded(e)?super(e,em):super(e),this.tag=BE.PublicKeyTag}async export(...e){let t,r=["verify"],n={hash:"SHA-256",...this.algorithm};e.length>1?(n=e[0]||n,r=e[1]||r,t=e[2]||Zw.get()):t=e[0]||Zw.get();let i=this.rawData;const s=ud.parse(this.rawData,em);return s.algorithm.algorithm===hA&&(i=function(e){return e.algorithm=new Zg({algorithm:cA,parameters:null}),ud.serialize(e)}(s)),t.subtle.importKey("spki",i,n,!0,r)}onInit(e){const t=ob.resolve(hw),r=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case cA:{const t=ud.parse(e.subjectPublicKey,OA),n=Zh._H.toUint8Array(t.modulus);r.publicExponent=Zh._H.toUint8Array(t.publicExponent),r.modulusLength=(n[0]?n:n.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||Zw.get()):r=e[0]||Zw.get(),await r.subtle.digest(n,this.rawData)}async getKeyIdentifier(...e){let t,r="SHA-1";1===e.length?"string"==typeof e[0]?(r=e[0],t=Zw.get()):t=e[0]:2===e.length?(r=e[0],t=e[1]):t=Zw.get();const n=ud.parse(this.rawData,em);return await t.subtle.digest(r,n.subjectPublicKey)}toTextObject(){const e=this.toTextObjectEmpty(),t=ud.parse(this.rawData,em);return e.Algorithm=$w.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===Hv?e["EC Point"]=t.subjectPublicKey:e["Raw Data"]=t.subjectPublicKey,e}}class TE extends Yw{static async create(e,t=!1,r=Zw.get()){if("name"in e&&"serialNumber"in e)return new TE(e,t);const n=await kE.create(e,r),i=await n.getKeyIdentifier(r);return new TE(Zh.U$.ToHex(i),t)}constructor(...e){if(Zh._H.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new Md({keyIdentifier:new Od(Zh.U$.FromHex(e[0]))});super(Kd,e[1],ud.serialize(t))}else{const t=e[0],r=t.name instanceof bE?ud.parse(t.name.rawData,jd):t.name,n=new Md({authorityCertIssuer:r,authorityCertSerialNumber:Zh.U$.FromHex(t.serialNumber)});super(Kd,e[1],ud.serialize(n))}}onInit(e){super.onInit(e);const t=ud.parse(e.extnValue,Md);t.keyIdentifier&&(this.keyId=Zh.U$.ToHex(t.keyIdentifier)),(t.authorityCertIssuer||t.authorityCertSerialNumber)&&(this.certId={name:t.authorityCertIssuer||[],serialNumber:t.authorityCertSerialNumber?Zh.U$.ToHex(t.authorityCertSerialNumber):""})}toTextObject(){const e=this.toTextObjectWithoutValue(),t=ud.parse(this.value,Md);return t.authorityCertIssuer&&(e["Authority Issuer"]=new bE(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}TE.NAME="Authority Key Identifier";class NE extends Yw{constructor(...e){if(Zh._H.isBufferSource(e[0])){super(e[0]);const t=ud.parse(this.value,Vd);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new Vd({cA:e[0],pathLenConstraint:e[1]});super(Hd,e[2],ud.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}toTextObject(){const e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}var UE,xE;NE.NAME="Basic Constraints",function(e){e.serverAuth="1.3.6.1.5.5.7.3.1",e.clientAuth="1.3.6.1.5.5.7.3.2",e.codeSigning="1.3.6.1.5.5.7.3.3",e.emailProtection="1.3.6.1.5.5.7.3.4",e.timeStamping="1.3.6.1.5.5.7.3.8",e.ocspSigning="1.3.6.1.5.5.7.3.9"}(UE||(UE={}));class DE extends Yw{constructor(...e){if(Zh._H.isBufferSource(e[0])){super(e[0]);const t=ud.parse(this.value,mg);this.usages=t.map((e=>e))}else{const t=new mg(e[0]);super(gg,e[1],ud.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.usages.map((e=>Gw.toString(e))).join(", "),e}}DE.NAME="Extended Key Usages",function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(xE||(xE={}));class RE extends Yw{constructor(...e){if(Zh._H.isBufferSource(e[0])){super(e[0]);const t=ud.parse(this.value,xg);this.usages=t.toNumber()}else{const t=new xg(e[0]);super(Tg,e[1],ud.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=ud.parse(this.value,xg);return e[""]=t.toJSON().join(", "),e}}RE.NAME="Key Usages";class PE extends Yw{static async create(e,t=!1,r=Zw.get()){const n=await kE.create(e,r),i=await n.getKeyIdentifier(r);return new PE(Zh.U$.ToHex(i),t)}constructor(...e){if(Zh._H.isBufferSource(e[0])){super(e[0]);const t=ud.parse(this.value,zg);this.keyId=Zh.U$.ToHex(t)}else{const t="string"==typeof e[0]?Zh.U$.FromHex(e[0]):e[0],r=new zg(t);super(qg,e[1],ud.serialize(r)),this.keyId=Zh.U$.ToHex(t)}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=ud.parse(this.value,zg);return e[""]=t,e}}PE.NAME="Subject Key Identifier";class LE extends Yw{constructor(...e){Zh._H.isBufferSource(e[0])?super(e[0]):super(Hg,e[1],new bE(e[0]||[]).rawData)}onInit(e){super.onInit(e);const t=ud.parse(e.extnValue,Vg);this.names=new bE(t)}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(const r in t)e[r]=t[r];return e}}LE.NAME="Subject Alternative Name";class _E{static register(e,t){this.items.set(e,t)}static create(e){const t=new Yw(e),r=this.items.get(t.type);return r?new r(e):t}}_E.items=new Map;class KE extends Yw{constructor(...e){var t;if(Zh._H.isBufferSource(e[0])){super(e[0]);const t=ud.parse(this.value,eg);this.policies=t.map((e=>e.policyIdentifier))}else{const r=e[0],n=null!==(t=e[1])&&void 0!==t&&t,i=new eg(r.map((e=>new Zd({policyIdentifier:e}))));super(Gd,n,ud.serialize(i)),this.policies=r}}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map((e=>new zw("",{},Gw.toString(e)))),e}}KE.NAME="Certificate Policies",_E.register(Gd,KE);class OE extends Yw{constructor(...e){var t;if(Zh._H.isBufferSource(e[0]))super(e[0]);else if(Array.isArray(e[0])&&"string"==typeof e[0][0]){const t=e[0].map((e=>new cg({distributionPoint:new og({fullName:[new Cd({uniformResourceIdentifier:e})]})}))),r=new ug(t);super(ig,e[1],ud.serialize(r))}else{const t=new ug(e[0]);super(ig,e[1],ud.serialize(t))}null!==(t=this.distributionPoints)&&void 0!==t||(this.distributionPoints=[])}onInit(e){super.onInit(e);const t=ud.parse(e.extnValue,ug);this.distributionPoints=t}toTextObject(){const e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map((e=>{var t;const r={};return e.distributionPoint&&(r[""]=null===(t=e.distributionPoint.fullName)||void 0===t?void 0:t.map((e=>new AE(e).toString())).join(", ")),e.reasons&&(r.Reasons=e.reasons.toString()),e.cRLIssuer&&(r["CRL Issuer"]=e.cRLIssuer.map((e=>e.toString())).join(", ")),r})),e}}OE.NAME="CRL Distribution Points";class ME extends Yw{constructor(...e){var t,r,n,i;if(Zh._H.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof _d){const t=new _d(e[0]);super(Pd,e[1],ud.serialize(t))}else{const t=e[0],r=new _d;VE(r,t,Td,"ocsp"),VE(r,t,Nd,"caIssuers"),VE(r,t,Ud,"timeStamping"),VE(r,t,xd,"caRepository"),super(Pd,e[1],ud.serialize(r))}null!==(t=this.ocsp)&&void 0!==t||(this.ocsp=[]),null!==(r=this.caIssuers)&&void 0!==r||(this.caIssuers=[]),null!==(n=this.timeStamping)&&void 0!==n||(this.timeStamping=[]),null!==(i=this.caRepository)&&void 0!==i||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],ud.parse(e.extnValue,_d).forEach((e=>{switch(e.accessMethod){case Td:this.ocsp.push(new AE(e.accessLocation));break;case Nd:this.caIssuers.push(new AE(e.accessLocation));break;case Ud:this.timeStamping.push(new AE(e.accessLocation));break;case xd:this.caRepository.push(new AE(e.accessLocation))}}))}toTextObject(){const e=this.toTextObjectWithoutValue();return this.ocsp.length&&HE(e,"OCSP",this.ocsp),this.caIssuers.length&&HE(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&HE(e,"Time Stamping",this.timeStamping),this.caRepository.length&&HE(e,"CA Repository",this.caRepository),e}}function HE(e,t,r){if(1===r.length)e[t]=r[0].toTextObject();else{const n=new zw("");r.forEach(((e,t)=>{const r=e.toTextObject(),i=`${r[zw.NAME]} ${t+1}`;let s=n[i];Array.isArray(s)||(s=[],n[i]=s),s.push(r)})),e[t]=n}}function VE(e,t,r,n){const i=t[n];i&&(Array.isArray(i)?i:[i]).forEach((t=>{"string"==typeof t&&(t=new AE("url",t)),e.push(new Ld({accessMethod:r,accessLocation:ud.parse(t.rawData,Cd)}))}))}ME.NAME="Authority Info Access";class FE extends Ww{constructor(...e){let t;if(Zh._H.isBufferSource(e[0]))t=Zh._H.toArrayBuffer(e[0]);else{const r=e[0],n=Array.isArray(e[1])?e[1].map((e=>Zh._H.toArrayBuffer(e))):[];t=ud.serialize(new Fg({type:r,values:n}))}super(t,Fg)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Value=this.values.map((e=>new zw("",{"":e}))),e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty();return e[zw.NAME]===FE.NAME&&(e[zw.NAME]=Gw.toString(this.type)),e}}FE.NAME="Attribute";class jE extends FE{constructor(...e){var t;if(Zh._H.isBufferSource(e[0]))super(e[0]);else{const t=new ew({printableString:e[0]});super(Lb,[ud.serialize(t)])}null!==(t=this.password)&&void 0!==t||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const e=ud.parse(this.values[0],ew);this.password=e.toString()}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[zw.VALUE]=this.password,e}}jE.NAME="Challenge Password";class QE extends FE{constructor(...e){var t;if(Zh._H.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new sm;for(const e of t)r.push(ud.parse(e.rawData,im));super(_b,[ud.serialize(r)])}null!==(t=this.items)&&void 0!==t||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const e=ud.parse(this.values[0],sm);this.items=e.map((e=>_E.create(ud.serialize(e))))}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.items.map((e=>e.toTextObject()));for(const r of t)e[r[zw.NAME]]=r;return e}}QE.NAME="Extensions";class qE{static register(e,t){this.items.set(e,t)}static create(e){const t=new FE(e),r=this.items.get(t.type);return r?new r(e):t}}qE.items=new Map;const zE="crypto.signatureFormatter";var GE;let $E=GE=class{static createPssParams(e,t){const r=GE.getHashAlgorithm(e);return r?new DA({hashAlgorithm:r,maskGenAlgorithm:new Zg({algorithm:IA,parameters:ud.serialize(r)}),saltLength:t}):null}static getHashAlgorithm(e){const t=ob.resolve(hw);return"string"==typeof e?t.toAsnAlgorithm({name:e}):"object"==typeof e&&e&&"name"in e?t.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(!("hash"in e))return new Zg({algorithm:cA,parameters:null});{let t;if("string"==typeof e.hash)t=e.hash;else{if(!e.hash||"object"!=typeof e.hash||!("name"in e.hash)||"string"!=typeof e.hash.name)throw new Error("Cannot get hash algorithm name");t=e.hash.name.toUpperCase()}switch(t.toLowerCase()){case"sha-1":return new Zg({algorithm:yA,parameters:null});case"sha-256":return new Zg({algorithm:gA,parameters:null});case"sha-384":return new Zg({algorithm:mA,parameters:null});case"sha-512":return new Zg({algorithm:vA,parameters:null})}}break;case"rsa-pss":if("hash"in e){if(!("saltLength"in e)||"number"!=typeof e.saltLength)throw new Error("Cannot get 'saltLength' from 'alg' argument");const t=GE.createPssParams(e.hash,e.saltLength);if(!t)throw new Error("Cannot create PSS parameters");return new Zg({algorithm:hA,parameters:ud.serialize(t)})}return new Zg({algorithm:hA,parameters:null})}return null}toWebAlgorithm(e){switch(e.algorithm){case cA:return{name:"RSASSA-PKCS1-v1_5"};case yA:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case gA:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case mA:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case vA:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case hA:if(e.parameters){const t=ud.parse(e.parameters,DA);return{name:"RSA-PSS",hash:ob.resolve(hw).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}return{name:"RSA-PSS"}}return null}};$E=GE=ld([cb()],$E),ob.registerSingleton(lw,$E);let WE=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new Zg({algorithm:wA});case"sha-256":return new Zg({algorithm:SA});case"sha-384":return new Zg({algorithm:CA});case"sha-512":return new Zg({algorithm:BA})}return null}toWebAlgorithm(e){switch(e.algorithm){case wA:return{name:"SHA-1"};case SA:return{name:"SHA-256"};case CA:return{name:"SHA-384"};case BA:return{name:"SHA-512"}}return null}};WE=ld([cb()],WE),ob.registerSingleton(lw,WE);class YE{addPadding(e,t){const r=Zh._H.toUint8Array(t),n=new Uint8Array(e);return n.set(r,e-r.length),n}removePadding(e,t=!1){let r=Zh._H.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){const e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){const r=e.namedCurve,n=YE.namedCurveSize.get(r)||YE.defaultNamedCurveSize,i=new aA,s=Zh._H.toUint8Array(t);return i.r=this.removePadding(s.slice(0,n),!0),i.s=this.removePadding(s.slice(n,n+n),!0),ud.serialize(i)}return null}toWebSignature(e,t){if("ECDSA"===e.name){const r=ud.parse(t,aA),n=e.namedCurve,i=YE.namedCurveSize.get(n)||YE.defaultNamedCurveSize,s=this.addPadding(i,this.removePadding(r.r)),a=this.addPadding(i,this.removePadding(r.s));return(0,Zh.kg)(s,a)}return null}}YE.namedCurveSize=new Map,YE.defaultNamedCurveSize=32;const JE="1.3.101.110",XE="1.3.101.111",ZE="1.3.101.112",eS="1.3.101.113";let tS=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"ed25519":t=ZE;break;case"x25519":t=JE;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=ZE;break;case"ed448":t=eS}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=JE;break;case"x448":t=XE}}return t?new Zg({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case ZE:return{name:"Ed25519"};case eS:return{name:"EdDSA",namedCurve:"Ed448"};case JE:return{name:"X25519"};case XE:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};tS=ld([cb()],tS),ob.registerSingleton(lw,tS);(class extends IE{constructor(e){IE.isAsnEncoded(e)?super(e,uw):super(e),this.tag=BE.CertificateRequestTag}onInit(e){this.tbs=ud.serialize(e.certificationRequestInfo),this.publicKey=new kE(e.certificationRequestInfo.subjectPKInfo);const t=ob.resolve(hw);this.signatureAlgorithm=t.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signature,this.attributes=e.certificationRequestInfo.attributes.map((e=>qE.create(ud.serialize(e))));const r=this.getAttribute(_b);this.extensions=[],r instanceof QE&&(this.extensions=r.items),this.subjectName=new iE(e.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(e){for(const t of this.attributes)if(t.type===e)return t;return null}getAttributes(e){return this.attributes.filter((t=>t.type===e))}getExtension(e){for(const t of this.extensions)if(t.type===e)return t;return null}getExtensions(e){return this.extensions.filter((t=>t.type===e))}async verify(e=Zw.get()){const t={...this.publicKey.algorithm,...this.signatureAlgorithm},r=await this.publicKey.export(t,["verify"],e),n=ob.resolveAll(zE).reverse();let i=null;for(const e of n)if(i=e.toWebSignature(t,this.signature),i)break;if(!i)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,r,i,this.tbs)}toTextObject(){const e=this.toTextObjectEmpty(),t=ud.parse(this.rawData,uw),r=t.certificationRequestInfo,n=new zw("",{Version:`${am[r.version]} (${r.version})`,Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const e=new zw("");for(const t of this.attributes){const r=t.toTextObject();e[r[zw.NAME]]=r}n.Attributes=e}return e.Data=n,e.Signature=new zw("",{Algorithm:$w.serializeAlgorithm(t.signatureAlgorithm),"":t.signature}),e}}).NAME="PKCS#10 Certificate Request";class rS extends IE{constructor(e){IE.isAsnEncoded(e)?super(e,cm):super(e),this.tag=BE.CertificateTag}onInit(e){const t=e.tbsCertificate;this.tbs=ud.serialize(t);let r=new Uint8Array(t.serialNumber);r.length>1&&0===r[0]&&r[1]>127&&(r=r.slice(1)),this.serialNumber=Zh.U$.ToHex(r),this.subjectName=new iE(t.subject),this.subject=new iE(t.subject).toString(),this.issuerName=new iE(t.issuer),this.issuer=this.issuerName.toString();const n=ob.resolve(hw);this.signatureAlgorithm=n.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const i=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!i)throw new Error("Cannot get 'notBefore' value");this.notBefore=i;const s=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!s)throw new Error("Cannot get 'notAfter' value");this.notAfter=s,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map((e=>_E.create(ud.serialize(e))))),this.publicKey=new kE(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter((t=>"string"==typeof e?t.type===e:t instanceof e))}async verify(e={},t=Zw.get()){let r,n;const i=e.publicKey;try{if(i)if("publicKey"in i)r={...i.publicKey.algorithm,...this.signatureAlgorithm},n=await i.publicKey.export(r,["verify"],t);else if(i instanceof kE)r={...i.algorithm,...this.signatureAlgorithm},n=await i.export(r,["verify"],t);else if(Zh._H.isBufferSource(i)){const e=new kE(i);r={...e.algorithm,...this.signatureAlgorithm},n=await e.export(r,["verify"],t)}else r={...i.algorithm,...this.signatureAlgorithm},n=i;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(r,["verify"],t)}catch(e){return!1}const s=ob.resolveAll(zE).reverse();let a=null;for(const e of s)if(a=e.toWebSignature(r,this.signature),a)break;if(!a)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const o=await t.subtle.verify(this.signatureAlgorithm,n,a,this.tbs);if(e.signatureOnly)return o;{const t=(e.date||new Date).getTime();return o&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=Zw.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=Zw.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){const e=this.toTextObjectEmpty(),t=ud.parse(this.rawData,cm),r=t.tbsCertificate,n=new zw("",{Version:`${am[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":$w.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new zw("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(n["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(n["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){const e=new zw("");for(const t of this.extensions){const r=t.toTextObject();e[r[zw.NAME]]=r}n.Extensions=e}return e.Data=n,e.Signature=new zw("",{Algorithm:$w.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}var nS;async function iS(e,r){try{if(console.log("Verifying signature with format:",r.format),!e.signatures||0===e.signatures.length)throw new Error("No signatures found in the DSSE envelope");const n=e.payload,i=t.util.decode64(n),o=e.payloadType,c=`DSSEv1 ${o.length} ${o} ${i.length} `+i,u=r.key;return console.log("publicKeyInfo.format=",r.format),r.format===Yh?(console.log("Verifying with PGP public key using OpenPGP.js"),await async function(e,r,n){try{const i=await async function({text:e,binary:t,filename:r,date:n=new Date,format:i=(void 0!==e?"utf8":"binary"),...s}){const a=void 0!==e?e:t;if(void 0===a)throw Error("createMessage: must pass options object containing `text` or `binary`");if(e&&!Q.isString(e)&&!Q.isStream(e))throw Error("createMessage: options.text must be a string or stream");if(t&&!Q.isUint8Array(t)&&!Q.isStream(t))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=Q.isStream(a),u=new aa(n);void 0!==e?u.setText(a,V.write(V.literal,i)):u.setBytes(a,V.write(V.literal,i)),void 0!==r&&u.setFilename(r);const l=new ga;l.push(u);const h=new oo(l);return h.fromStream=c,h}({text:e});let s=0;for(const e of r){s++;try{console.log("trying to verify signature number=",s);const r=e.sig,a=t.util.decode64(r),o=await Ma({armoredSignature:a}),c=await ho({message:i,signature:o,verificationKeys:n}),{verified:u,keyID:l}=c.signatures[0];try{return await u,console.log("PGP signature verification succeeded"),!0}catch(e){console.error("PGP signature verification failed:",e)}}catch(e){console.error("Error during PGP verification of signature:",e,"signature number=",s),console.info("Continue to next signature")}}}catch(e){throw console.error("Error during PGP verification:",e),new Error("PGP signature verification failed: "+e.message)}return console.log("OpenPGP none of the signatures verification succeeded"),!1}(c,e.signatures,u)):r.format===a?(console.log("Verifying with Starkbank-ECDSA"),await async function(e,r,n){let i=0,a=!1;for(const o of r){i++,console.log("Attempting starkbank-ecdsa verification for signature:",i);try{const r=o.sig,i=t.util.decode64(r),c=s.Signature.fromDer(i);a=s.Ecdsa.verify(e,c,n)}catch(e){throw console.error("Starkbank signature verification error:",e),new Error("Starkbank signature verification failed: "+e.message)}if(a)return console.log("Starkbank-ECDSA signature verification succeeded"),!0}return console.log("Starkbank-ECDSA none of the signatures verification succeeded"),!1}(c,e.signatures,u)):await async function(e,r,n){console.log("Verifying with Forge.js");let i=0;for(const s of r){i++;const r=s.keyid||"";console.log("Checking signature, signature algorithm/key ID:",r,"signature number=",i);let a=t.md.sha256.create();r.toLowerCase().includes("sha1")?a=t.md.sha1.create():r.toLowerCase().includes("sha384")?a=t.md.sha384.create():r.toLowerCase().includes("sha512")&&(a=t.md.sha512.create()),a.update(e);const o=s.sig,c=t.util.decode64(o);try{const e=n.verify(a.digest().bytes(),c);return console.log("Signature verification result:",e),e}catch(r){console.error("Verification failed with error:",r,"signature number=",i);try{console.log("Attempting alternative verification approach...");const r=t.pki.createVerifier(a.algorithm);r.update(e);const i=r.verify(n,c);return console.log("Alternative verification result:",i),i}catch(e){console.error("Alternative verification failed:",e,"signature number=",i),console.info("Continue to next signature")}}}return!1}(c,e.signatures,u)}catch(e){throw console.error("Verification error:",e),new Error(`Signature verification failed: ${e.message}`)}}async function sS(e,r,n){try{if(e.style.display="block",e.className="verification-status unknown",e.textContent="Verifying signature...",document.querySelector(".right-panel").scrollIntoView({behavior:"smooth",block:"start"}),!n.includes("-----BEGIN")||!n.includes("-----END"))return e.className="verification-status invalid",e.textContent="Error: Invalid key format. Expected PEM format.",!1;const i=await async function(e){try{if(console.log("extractPublicKeyFromPEM"),!e.includes("-----BEGIN PUBLIC KEY-----")){if(e.includes("-----BEGIN CERTIFICATE-----"))return function(e){try{return console.log("Detected X.509 certificate"),r=e,console.log("Use forge if RSA certificate"),{key:t.pki.certificateFromPem(r).publicKey,format:"certificate",pem:r}}catch(t){return console.error("Forge Failed to parse certificate, trying Web Crypto API, for ECDSA certificate:",t),getPEMFromECDSACertificate(e)}var r}(e);if(e.includes("-----BEGIN RSA PUBLIC KEY-----"))return await Xh(e);if(e.includes("-----BEGIN PGP PUBLIC KEY BLOCK-----"))return Jh(e);throw new Error("Unsupported key format. Expected PUBLIC KEY, RSA PUBLIC KEY, PGP PUBLIC KEY, or CERTIFICATE.")}try{return console.log("Detected standard public key format, testing if this is RSA key"),Xh(e)}catch(t){console.error("Failed to parse standard public key as RSA key:",t),console.log("Trying to import key using starkbank-ecdsa");try{return function(e){try{const t=s.PublicKey.fromPem(e);return console.log("starkbank-ecdsa imported successfully, key.curve=",t.curve,"returning the imported key"),{key:t,format:a,pem:e}}catch(e){throw console.error("Starkbank-ECDSA import key failed:",e,e.message),new Error("Failed to parse certificate: "+e.message)}}(e)}catch(e){throw console.error("Failed to import key using starkbank-ecdsa:",e),new Error("Failed to parse public key: "+e.message)}}}catch(e){throw console.error("Key extraction error:",e),new Error(`Failed to extract key: ${e.message}`)}}(n);return!!await iS(r,i)||(e.className="verification-status invalid",e.textContent="Signature verification failed. The DSSE envelope may have been tampered with.",!1)}catch(e){const t=document.getElementById("verificationStatus");if(t.style.display="block",t.className="verification-status invalid",t.textContent=`Error processing key: ${e.message}`,console.error("Full error:",e),e.message.includes("format")){const e=document.createElement("p");e.innerHTML="<strong>Key format issue detected.</strong><br>Make sure you're providing a valid PEM-formatted public key or certificate.",t.appendChild(e)}return!1}}function aS(e){const r=document.getElementById("error");let n,i;try{n=t.util.decode64(e.payload)}catch(t){console.error("Error decoding base64 payload:",t),n=e.payload}try{const e=new TextDecoder("utf-8"),t="string"==typeof n?n:e.decode(new Uint8Array(n.length).map(((e,t)=>n.charCodeAt(t)))),r=JSON.parse(t);i=JSON.stringify(r,null,2),console.log("Successfully parsed as JSON")}catch(e){if(console.warn("Not valid JSON, displaying as text:",e),r.textContent=`Error: Not valid JSON, displaying as text, detailed error: ${e}`,r.className="verification-status invalid",r.style.display="block","string"==typeof n)i=n;else try{i=new TextDecoder("utf-8").decode(new Uint8Array(n.length).map(((e,t)=>n.charCodeAt(t))))}catch(e){console.error("Error converting to text:",e),i="Binary content (unable to display as text)"}}return i}async function oS(e,r,n){const i=document.getElementById("verificationStatus");console.info("verifying tlog entry=",e);const s=`https://rekor.sigstore.dev/api/v1/log/entries?logIndex=${e.logIndex}`,a=await fetch(s),o=await a.json();for(const s in o){if(!o[s])return i.textContent="Error: Rekor Tlog entry not found",i.className="verification-status invalid",i.style.display="block",!1;{if(o[s].integratedTime!=e.integratedTime)return i.textContent="Error: Rekor Tlog entry integratedTime mismatch",i.className="verification-status invalid",i.style.display="block",!1;if(console.info("tlog entry integratedTime matches, continue to next tlog entry"),o[s].logIndex!=e.logIndex)return i.textContent="Error: Rekor Tlog entry logIndex mismatch",i.className="verification-status invalid",i.style.display="block",!1;console.info("tlog entry logIndex matches, continue to next tlog entry");const a=o[s].body,c=t.util.decode64(a),u=JSON.parse(c);if("dsse"!=u.kind)return i.textContent="Error: Rekor Tlog entry body kind is not dsse",i.className="verification-status invalid",i.style.display="block",!1;console.info("tlog entry body kind matches, continue to next tlog entry");const l=u.spec.signatures;for(const e of l){const s=e.signature;let a=!1;for(const e of r.signatures)e.sig==s&&(a=!0);if(!a)return i.textContent="Error: Rekor Tlog entry signature not found",i.className="verification-status invalid",i.style.display="block",!1;console.info("tlog entry signature matches, continue to next tlog entry"),console.info("All tlog entry signatures appear on dsse signatures list");const o=e.verifier;if(t.util.decode64(o).replace("-----BEGIN CERTIFICATE-----","").replace("-----END CERTIFICATE-----","").replace(/\r?\n|\r/g,"").trim()!=n)return i.textContent="Error: Rekor Tlog entry verifier mismatch",i.className="verification-status invalid",i.style.display="block",!1;console.info("tlog entry verifier matches, continue to next tlog entry")}}}return!0}rS.NAME="Certificate",function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(nS||(nS={})),_E.register(Hd,NE),_E.register(gg,DE),_E.register(Tg,RE),_E.register(qg,PE),_E.register(Kd,TE),_E.register(Hg,LE),_E.register(ig,OE),_E.register(Pd,ME),qE.register(Lb,jE),qE.register(_b,QE),ob.registerSingleton(zE,class{toAsnSignature(e,t){return Zh._H.toArrayBuffer(t)}toWebSignature(e,t){return Zh._H.toArrayBuffer(t)}}),ob.registerSingleton(zE,YE),YE.namedCurveSize.set("P-256",32),YE.namedCurveSize.set("K-256",32),YE.namedCurveSize.set("P-384",48),YE.namedCurveSize.set("P-521",66),window.resetDisplay=i,window.resetVerificationMessages=n,document.addEventListener("DOMContentLoaded",(function(){document.getElementById("fileInput").addEventListener("change",(function(e){const t=e.target.files[0]?.name||"";if(document.getElementById("fileName").textContent=t,t){const t=e.target.files[0],r=new FileReader;r.onload=function(e){document.getElementById("dsseInput").value=e.target.result},r.readAsText(t),i()}})),document.getElementById("certInput").addEventListener("change",(function(e){const t=e.target.files[0]?.name||"";if(document.getElementById("certFileName").textContent=t,t){const t=e.target.files[0],r=new FileReader;r.onload=function(e){document.getElementById("pubKeyInput").value=e.target.result},r.readAsText(t),n()}})),document.getElementById("sigstoreFileInput").addEventListener("change",(function(e){console.log("sigstoreFileInput",e.target.files[0]);const t=e.target.files[0]?.name||"";if(document.getElementById("sigstoreFileName").textContent=t,t){const t=e.target.files[0],r=new FileReader;r.onload=function(e){document.getElementById("sigstoreInput").value=e.target.result},r.readAsText(t),i()}}))})),window.processSigstore=async function(){const e=document.getElementById("verificationStatus"),t=document.getElementById("verificationWarning"),n=document.getElementById("sigstoreInput").value,s=document.getElementById("result"),a=document.getElementById("error");if(i(),!n.trim())return a.textContent="Error: Please provide input either by pasting JSON or uploading a file",void(a.style.display="block");let o,c;try{o=JSON.parse(n)}catch(e){a.textContent=`Error parsing Sigstore bundle, please verify the input is a valid JSON format: ${e.message}`,a.style.display="block"}console.info("before sigstore verify");try{c=o.dsseEnvelope}catch(e){a.textContent=`Error parsing Sigstore bundle, please verify the input is a valid Sigstore bundle: ${e.message}`,a.style.display="block"}const u=o.verificationMaterial.certificate.rawBytes;let l=function(e){var t;console.info("extractPEMFromCertificate");const n="-----BEGIN PUBLIC KEY-----\n"+function(e){const t=[];for(let r=0;r<e.length;r+=64)t.push(e.slice(r,r+64));return t.join("\n")}((t=new rS(e).publicKey.rawData,r.from(t).toString("base64")))+"\n-----END PUBLIC KEY-----";return n}(u);if(l)if(await sS(e,c,l)){const r=o.verificationMaterial.tlogEntries;if(r){let t=!0;for(const n of r){const r=n.logIndex;console.info("logIndex=",r);const i=await oS(n,c,u);console.info("tlogEntry with index=",r,"verification result is",i),i||(t=!1,e.textContent="Rekor transparency log verification failed for entry with index="+r,e.className="verification-status invalid",e.style.display="block")}t&&(e.className="verification-status valid",e.textContent="Signature verification successful! The DSSE envelope was not tampered with, Rekor transparency log verified successfully for all rekor log entries, matching: integratedTime, logIndex, body kind, signature, and certificate",e.style.display="block")}else console.info("tlogEntries not found, skipping tlog entry verification"),e.className="verification-status valid",e.textContent="Signature verification skipped",e.style.display="block",t.textContent="The provided Sigstore bundle details were not added to rekor, therefore Rekor entries verification was skipped, it is recommended to farther verify the bundle certificate using sigstore cosign tool",t.style.display="block",t.className="verification-warning"}else e.className="verification-status invalid",e.textContent="Error: Signature verification failed, cerificate verification on dsse conten failed",e.style.display="block";else e.className="verification-status invalid",e.textContent="Error: Signature verification failed, could not locate certificate in the sigstore bundle",e.style.display="block";const h=aS(c);s.textContent=h,s.style.display="block",window.innerWidth<=768&&document.querySelector(".right-panel").scrollIntoView({behavior:"smooth"})},window.processDSSE=async function(){const e=document.getElementById("verificationStatus"),t=(document.getElementById("verificationWarning"),document.getElementById("dsseInput").value),r=document.getElementById("result"),n=document.getElementById("error"),s=document.getElementById("pubKeyInput");if(i(),!t.trim())return n.textContent="Error: Please provide input either by pasting JSON or uploading a file",void(n.style.display="block");try{const n=JSON.parse(t);if(!n.payload||!n.payloadType)throw new Error("Invalid DSSE envelope: missing required fields");let i=s.value.trim();i&&await sS(e,n,i)&&(e.className="verification-status valid",e.textContent="Signature verification successful! The DSSE envelope was not tampered with, ",e.style.display="block");const a=aS(n);r.textContent=a,r.style.display="block",window.innerWidth<=768&&document.querySelector(".right-panel").scrollIntoView({behavior:"smooth"})}catch(e){n.textContent=`Error: ${e.message}`,n.style.display="block"}}})()})();